var B=Object.defineProperty;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var g=(d,t,i)=>t in d?B(d,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[t]=i,b=(d,t)=>{for(var i in t||(t={}))L.call(t,i)&&g(d,i,t[i]);if(k)for(var i of k(t))j.call(t,i)&&g(d,i,t[i]);return d};import{bk as q,F as O,am as P,av as T,bg as M,I as z,c as V,a8 as K,t as R,b as I,g as n,e as m,u as l,a as H,z as G,w as D,C,D as _,L as J,aw as Q,H as W}from"./vendor-HNRiXHBS.js";import{v as X,c as y,u as Y,q as S,w as v,t as f}from"./frappe-ui-DItCq3tW.js";import{u as Z}from"./index-DAgtU4uR.js";import{_ as ss}from"./Link-CDfjKa6y.js";import"./index-DhRAnSEM.js";/* empty css                                                                     */const es={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},os={class:"space-x-2"},ts={class:"w-3/4 mx-auto py-5"},is={class:"mb-8"},as={class:"font-semibold mb-4"},ns={class:"mb-8"},us={class:"font-semibold mb-4 mt-4"},rs={class:"checkbox-container"},ds={for:"discussion-prompt",class:"block text-lg font-medium text-gray-700 mb-4"},ls=["placeholder"],cs={__name:"DiscussionActivityForm",props:{discussionID:{type:String,required:!1}},setup(d){const t=q("$user"),i=O(),c=d,o=P({discussion_name:"",course:"",post_before:!1,use_studentgroup:!1,prompt:""});T(()=>{var s,e;a.data&&(o.discussion_name=a.data.discussion_name||"",o.course=a.data.course||"",o.post_before=a.data.post_before||!1,o.use_studentgroup=a.data.use_studentgroup||!1,o.prompt=a.data.prompt||""),c.discussionID=="new"&&!((s=t.data)!=null&&s.is_moderator)&&!((e=t.data)!=null&&e.is_instructor)&&i.push({name:"Courses"}),c.discussionID!=="new"&&a.reload(),window.addEventListener("keydown",h)});const h=s=>{s.key==="s"&&(s.ctrlKey||s.metaKey)&&(submitExam(),s.preventDefault())};M(()=>{window.removeEventListener("keydown",h)}),z(()=>c.discussionID!=="new",s=>{s&&a.reload()});const a=y({url:"frappe.client.get",makeParams(s){return{doctype:"Discussion Activity",name:c.discussionID}},auto:!1,onSuccess(s){Object.keys(s).forEach(u=>{Object.hasOwn(o,u)&&(o[u]=s[u])});let e=["post_before","use_studentgroup"];for(let u in e){let p=e[u];o[p]=!!o[p]}}}),A=y({url:"frappe.client.insert",auto:!1,makeParams(s){return{doc:b({doctype:"Discussion Activity"},o)}}}),E=y({url:"frappe.client.set_value",auto:!1,makeParams(s){return{doctype:"Discussion Activity",name:s.discussionID,fieldname:b({},o)}}}),x=()=>{var s;(s=a.data)!=null&&s.name?U():F()},F=()=>{A.submit({},{onSuccess(s){f.success(__("Discussion created successfully")),i.push({name:"DiscussionActivityForm",params:{discussionID:s.name}})},onError(s){var e;f.error(((e=s.messages)==null?void 0:e[0])||s)}})},U=()=>{var s;E.submit({discussionID:(s=a.data)==null?void 0:s.name},{onSuccess(e){f.success(__("Discussion updated successfully"))},onError(e){var u;f.error(((u=e.messages)==null?void 0:u[0])||e)}})},N=V(()=>{let s=[{label:__("Discussion Activity"),route:{name:"DiscussionActivityForm"}}];return s.push({label:c.discussionID=="new"?__("New Discussion"):o.discussion_name,route:{name:"DiscussionActivityForm",params:{discussionID:c.discussionID}}}),s}),$=V(()=>({title:c.discussionID=="new"?__("New Discussion"):o.discussion_name,description:__("Form to create and edit discussions")}));return Z($),(s,e)=>{var p,w;const u=K("router-link");return I(),R(W,null,[n("header",es,[m(l(Y),{items:N.value},null,8,["items"]),n("div",os,[(p=l(a).data)!=null&&p.name?(I(),H(u,{key:0,to:{name:"DiscussionActivitySubmissionList",params:{discussionID:l(a).data.name}}},{default:D(()=>[m(l(S),null,{default:D(()=>[C(_(s.__("Submission List")),1)]),_:1})]),_:1},8,["to"])):G("",!0),m(l(S),{variant:"solid",onClick:e[0]||(e[0]=r=>x())},{default:D(()=>[C(_(s.__("Save")),1)]),_:1})])]),n("div",ts,[n("div",is,[n("div",as,_(s.__("Details")),1),m(l(v),{modelValue:o.discussion_name,"onUpdate:modelValue":e[1]||(e[1]=r=>o.discussion_name=r),label:(w=l(a).data)!=null&&w.discussion_name?s.__("Title"):s.__("Enter a title and save the discussion to proceed"),required:!0},null,8,["modelValue","label"]),e[6]||(e[6]=n("br",null,null,-1)),m(ss,{modelValue:o.course,"onUpdate:modelValue":e[2]||(e[2]=r=>o.course=r),doctype:"Course",label:s.__("Course where this discussion will be used - you may reuse this discussion in other scheduled courses"),placeholder:s.__("Select a course"),required:!0},null,8,["modelValue","label","placeholder"]),n("div",ns,[n("div",us,_(s.__("Settings")),1),n("div",rs,[m(l(v),{modelValue:o.use_studentgroup,"onUpdate:modelValue":e[3]||(e[3]=r=>o.use_studentgroup=r),type:"checkbox",label:s.__("Check this if you want discussion to be done in student groups. Otherwise, all students will participate in the same thread.")},null,8,["modelValue","label"]),m(l(v),{modelValue:o.post_before,"onUpdate:modelValue":e[4]||(e[4]=r=>o.post_before=r),type:"checkbox",label:s.__("Check this if you want students to post before seeing other posts.")},null,8,["modelValue","label"])])]),n("label",ds,_(s.__("Discussion Prompt")),1),J(n("textarea",{id:"discussion-prompt","onUpdate:modelValue":e[5]||(e[5]=r=>o.prompt=r),placeholder:s.__("Enter a prompt for the discussion."),class:"w-full border border-gray-300 rounded-md p-2 min-h-[7rem]"},null,8,ls),[[Q,o.prompt]])])])],64)}}},vs=X(cs,[["__scopeId","data-v-77967fde"]]);export{vs as default};
//# sourceMappingURL=DiscussionActivityForm-CeLtnSS_.js.map
