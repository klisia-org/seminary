import{q as g,c as S,I as M,r as D,D as q,t as z,d as B,u as U}from"./frappe-ui-DItCq3tW.js";import{F as H,bk as E,c as C,a8 as I,t as b,b as c,z as w,g as e,a as $,e as u,w as _,u as s,D as d,bJ as G,bS as R,U as F,V as P,am as J,I as Y,C as K,H as L,O,r as Q,bT as W}from"./vendor-HNRiXHBS.js";import{_ as X}from"./CourseOutline-eLrUDwSg.js";import{f as Z,t as ee,u as se}from"./index-DAgtU4uR.js";import{_ as te}from"./InstructorAvatar-H0GgLMal.js";import{C as ne}from"./CourseCardToDo-B1zFj6R8.js";import"./index-DhRAnSEM.js";import"./settings-Dp4EIanj.js";import"./Link-CDfjKa6y.js";/* empty css                                                                     */const oe={class:"border-2 rounded-md min-w-80"},ae=["src"],re={class:"p-5"},le={key:0,class:"space-y-2"},ue={class:"space-y-4"},ie={class:"flex items-center text-ink-gray-9"},de={class:"ml-2"},ce={class:"flex items-center text-ink-gray-9"},me={class:"ml-2"},_e={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(i){const p=H(),l=E("$user"),r=i,n=C(()=>r.course.data.video_link?"https://www.youtube.com/embed/"+r.course.data.video_link:null);function k(){l.data?setTimeout(()=>{p.push({name:"Lesson",params:{courseName:r.course.data.name,chapterNumber:1,lessonNumber:1}})},2e3):(toast.success(__("You need to login to access this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},2e3))}const f=()=>{let y=!1;return r.course.data.instructors.forEach(a=>{var t;!y&&a.user==((t=l.data)==null?void 0:t.name)&&(y=!0)}),console.log(y),y};return(y,a)=>{var m,o,v,x,N,h,V,T,A,j;const t=I("router-link");return c(),b("div",oe,[i.course.data.video_link?(c(),b("iframe",{key:0,src:n.value,class:"rounded-t-md min-h-56 w-full"},null,8,ae)):w("",!0),e("div",re,[i.course.data.membership?(c(),b("div",le,[u(t,{to:{name:"Lesson",params:{courseName:i.course.name,chapterNumber:i.course.data.current_lesson?i.course.data.current_lesson.split("-")[0]:1,lessonNumber:i.course.data.current_lesson?i.course.data.current_lesson.split("-")[1]:1}}},{default:_(()=>[u(s(g),{variant:"solid",size:"md",class:"w-full"},{default:_(()=>[...a[1]||(a[1]=[e("span",null,d("Continue Learning"),-1)])]),_:1})]),_:1},8,["to"])])):(c(),$(s(g),{key:1,onClick:a[0]||(a[0]=We=>k()),variant:"solid",class:"w-full",size:"md"},{default:_(()=>[...a[2]||(a[2]=[e("span",null,d("Start Learning"),-1)])]),_:1})),(o=(m=s(l))==null?void 0:m.data)!=null&&o.is_moderator||f()?(c(),$(t,{key:2,to:{name:"CourseForm",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[3]||(a[3]=[e("span",null,d("Edit"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),u(t,{to:{name:"CourseCalendar",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[4]||(a[4]=[e("span",null,d("Subscribe to the course calendar"),-1)])]),_:1})]),_:1},8,["to"]),(x=(v=s(l))==null?void 0:v.data)!=null&&x.is_moderator||f()?(c(),$(t,{key:3,to:{name:"CourseAssessment",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[5]||(a[5]=[e("span",null,d("Configure Assessments"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(h=(N=s(l))==null?void 0:N.data)!=null&&h.is_moderator||f()?(c(),$(t,{key:4,to:{name:"StudentGroup",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[6]||(a[6]=[e("span",null,d("Configure Student Groups"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(T=(V=s(l))==null?void 0:V.data)!=null&&T.is_moderator||f()?(c(),$(t,{key:5,to:{name:"Gradebook",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[7]||(a[7]=[e("span",null,d("Gradebook"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(j=(A=s(l))==null?void 0:A.data)!=null&&j.is_moderator||f()?(c(),$(t,{key:6,to:{name:"StudentAttendanceCS",params:{courseName:i.course.data.name}}},{default:_(()=>[u(s(g),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:_(()=>[...a[8]||(a[8]=[e("span",null,d("Attendance"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),e("div",ue,[a[9]||(a[9]=e("div",{class:"mt-8 font-medium text-ink-gray-9"},d("This course has:"),-1)),e("div",ie,[u(s(G),{class:"h-4 w-4 stroke-1.5"}),e("span",de,d(i.course.data.lessons)+" "+d("Lessons"),1)]),e("div",ce,[u(s(R),{class:"h-4 w-4 stroke-1.5"}),e("span",me,d(s(Z)(i.course.data.enrollments))+" "+d("Enrolled Students"),1)])])])])}}},pe={class:"announcement-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto"},fe={class:""},ve={class:"mb-1.5 text-sm text-ink-gray-5"},be={class:""},ye={class:"mb-1.5 text-sm text-ink-gray-5"},he={class:"mb-4"},ge={class:"mb-1.5 text-sm text-ink-gray-5"},ke={__name:"AnnouncementModal",props:F({cs:{type:String,required:!0},students:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const p=P(i,"modelValue"),l=i,r=J({subject:"",replyTo:"",announcement:""}),n=()=>{r.subject="",r.replyTo="",r.announcement=""},k=S({url:"frappe.core.doctype.communication.email.make",makeParams(t){return{recipients:l.students.join(", "),cc:r.replyTo,subject:r.subject,content:r.announcement,doctype:"Course Schedule",name:l.cs,send_email:1}}}),f=t=>{k.submit({},{validate(){if(!l.students.length)return"No students in this course";if(!r.subject)return"Subject is required"},onSuccess(){p.value=!1,n(),t(),z.success(__("Announcement has been sent successfully"))},onError(m){var o;z.error(((o=m.messages)==null?void 0:o[0])||m)}})},y=t=>{p.value=!1,n(),t==null||t()};Y(p,t=>{t||n()});const a=C(()=>({title:__("Make an Announcement"),size:"xl",actions:[{label:__("Submit"),variant:"solid",onClick:t=>f(t)},{label:__("Cancel"),variant:"text",onClick:t=>y(t)}]}));return(t,m)=>(c(),$(s(q),{modelValue:p.value,"onUpdate:modelValue":m[3]||(m[3]=o=>p.value=o),options:a.value,disableOutsideClickToClose:!0},{"body-content":_(()=>[e("div",pe,[e("div",fe,[e("div",ve,[K(d(t.__("Subject"))+" ",1),m[4]||(m[4]=e("span",{class:"text-ink-red-3"},"*",-1))]),u(s(M),{type:"text",modelValue:r.subject,"onUpdate:modelValue":m[0]||(m[0]=o=>r.subject=o)},null,8,["modelValue"])]),e("div",be,[e("div",ye,d(t.__("Reply To")),1),u(s(M),{type:"text",modelValue:r.replyTo,"onUpdate:modelValue":m[1]||(m[1]=o=>r.replyTo=o)},null,8,["modelValue"])]),e("div",he,[e("div",ge,d(t.__("Announcement")),1),u(s(D),{content:r.announcement,fixedMenu:!0,onChange:m[2]||(m[2]=o=>r.announcement=o),editorClass:"prose-sm py-2 px-2 min-h-[200px] border-outline-gray-2 hover:border-outline-gray-3 rounded-b-md bg-surface-gray-3"},null,8,["content"])])])]),_:1},8,["modelValue","options"]))}},xe={class:"border-2 rounded-md min-w-80 p-5"},we={key:0},$e={class:"mb-8"},Ce={class:"flex items-center justify-between mb-2"},Ne={class:"flex items-center"},Se={class:"ml-2 text-ink-gray-7"},Ve={class:"text-sm"},Te=["innerHTML"],Ae={key:1,class:"text-sm italic text-ink-gray-5"},je={__name:"Announcements",props:{cs:{type:String,required:!0}},setup(i){const p=i,l=S({url:"seminary.seminary.api.get_announcements",makeParams(r){return{cs:p.cs}},auto:!0,cache:["announcement",p.cs]});return(r,n)=>{var k;return c(),b("div",xe,[(k=s(l).data)!=null&&k.length?(c(),b("div",we,[(c(!0),b(L,null,O(s(l).data,f=>(c(),b("div",null,[e("div",$e,[e("div",Ce,[e("div",Ne,[u(s(B),{label:f.sender_full_name,size:"lg"},null,8,["label"]),e("div",Se,d(f.sender_full_name),1)]),e("div",Ve,d(s(ee)(f.communication_date)),1)]),e("div",{class:"prose prose-sm bg-surface-menu-bar !min-w-full px-4 py-2 rounded-md",innerHTML:f.content},null,8,Te)])]))),256))])):(c(),b("div",Ae,d(r.__("No announcements")),1))])}}},Me={key:0},ze={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},Ee={class:"m-5"},Le={class:"flex justify-between w-full"},Oe={class:"md:w-2/3"},De={class:"text-3xl font-semibold text-ink-gray-9"},qe={class:"my-3 leading-6 text-ink-gray-7"},Be=["innerHTML"],Ue={class:"mt-10"},He={key:0,class:"text-lg font-semibold"},Ie={key:1,class:"text-lg font-semibold"},Ge={class:"flex flex-wrap gap-4"},Re={class:"text-center text-sm font-medium"},Fe={class:"mt-10"},Pe={class:"border-0 rounded-md min-w-80"},Je={class:"mt-5"},Ye={class:"mt-5"},Ke={key:0,class:"mt-5 flex justify-center"},Qe={class:"mt-5"},us={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(i){const p=E("$user"),l=i,r=Q(!1);console.log("CourseName prop:",l.courseName);const n=S({url:"seminary.seminary.utils.get_course_details",cache:["course",l.courseName],params:{course:l.courseName},auto:!0});console.log(n),console.log("Course props:",l.courseName);const k=S({url:"seminary.seminary.utils.get_roster",cache:["roster",l.courseName],params:{course:l.courseName},auto:!0}),f=C(()=>(k.data||[]).map(o=>o.stuemail_rc));console.log("Student Emails:",f.value);const y=()=>{r.value=!0},a=C(()=>{const o=(p==null?void 0:p.data)||{};return!!(o.is_moderator||o.is_instructor||o.is_evaluator)}),t=C(()=>{var v,x;let o=[{label:"Courses",route:{name:"Courses"}}];return o.push({label:(v=n==null?void 0:n.data)==null?void 0:v.course,route:{name:"CourseDetail",params:{courseName:(x=n==null?void 0:n.data)==null?void 0:x.name}}}),o}),m=C(()=>{var o,v;return{title:(o=n==null?void 0:n.data)==null?void 0:o.title,description:(v=n==null?void 0:n.data)==null?void 0:v.short_introduction}});return se(m),(o,v)=>{var x,N;return s(n).data?(c(),b("div",Me,[e("header",ze,[u(s(U),{class:"h-7",items:t.value},null,8,["items"])]),e("div",Ee,[e("div",Le,[e("div",Oe,[e("div",De,d(s(n).data.course),1),e("div",qe,d(s(n).data.short_introduction),1),e("div",{innerHTML:s(n).data.course_description_for_lms,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,Be),e("div",Ue,[s(n).data.instructors.length===1?(c(),b("div",He,"Instructor")):(c(),b("div",Ie,"Instructors")),v[2]||(v[2]=e("br",null,null,-1)),e("div",Ge,[(c(!0),b(L,null,O(s(n).data.instructors,h=>(c(),b("div",{key:h.instructor_name,class:"flex flex-col items-center"},[u(te,{instructor:h,size:"xl",class:"mb-2 w-20 h-20"},null,8,["instructor"]),e("div",Re,d(h.instructor_name),1)]))),128))])]),e("div",Fe,[u(X,{title:"Course Outline",courseName:s(n).data.name,showOutline:!0,allowEdit:a.value},null,8,["courseName","allowEdit"])])]),e("div",Pe,[u(_e,{course:s(n),class:"mb-4"},null,8,["course"]),e("div",Je,[u(ne,{course:l.courseName},null,8,["course"])]),e("div",Ye,[u(je,{cs:l.courseName},null,8,["cs"])]),(x=s(p).data)!=null&&x.is_moderator||(N=s(p).data)!=null&&N.is_instructor?(c(),b("div",Ke,[u(s(g),{onClick:v[0]||(v[0]=h=>y())},{suffix:_(()=>[u(s(W),{class:"h-4 stroke-1.5"})]),default:_(()=>[e("span",null,d(o.__("Make an Announcement")),1)]),_:1})])):w("",!0),e("div",Qe,[u(ke,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=h=>r.value=h),cs:l.courseName,students:f.value},null,8,["modelValue","cs","students"])])])])])])):w("",!0)}}};export{us as default};
//# sourceMappingURL=CourseDetail-6jBUIrNk.js.map
