{"version":3,"file":"ExamSubmission-5dea3c98.js","sources":["../../../../frontend/src/components/ExamQuestionEditor.vue","../../../../frontend/src/pages/ExamSubmission.vue"],"sourcesContent":["<template>\n  <TextEditor\n    :content=\"internalContent\"\n    :key=\"questionId\"\n    :editable=\"editable\"\n    :fixedMenu=\"true\"\n    :label=\"`Comment for Question ${questionId}`\"\n    :editorClass=\"'ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none'\"\n    @change=\"updateContent\"\n  />\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { TextEditor } from 'frappe-ui'\n\n\nconst props = defineProps({\n  questionId: {\n    type: String,\n    required: true,\n  },\n \n  content: {\n    type: String,\n    default: '',\n  },\n  editable: {\n    type: Boolean,\n    default: true,\n  }\n})\n\nconst emit = defineEmits(['change'])\nconsole.log('Props:', props)\n// Hold the editor content as a reactive string. This will be used by the TextEditor.\nconst internalContent = ref(props.content)\n\n// Watch for changes to the content prop and update internalContent accordingly.\nwatch(() => props.content, (newContent, oldContent) => {\n  if (newContent !== oldContent) {\n    internalContent.value = newContent\n  }\n})\n\nconst updateContent = (val) => {\n  internalContent.value = val\n  emit('change', val)\n}\n</script>","<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs v-if=\"submisisonDetails.doc\" :items=\"breadcrumbs\" />\n\t\t<div class=\"space-x-2\">\n\t\t\t<Badge\n\t\t\t\tv-if=\"submisisonDetails.isDirty\"\n\t\t\t\t:label=\"__('Not Saved')\"\n\t\t\t\tvariant=\"subtle\"\n\t\t\t\ttheme=\"orange\"\n\t\t\t/>\n\t\t\t<Button variant=\"solid\" @click=\"validateSubmission()\">\n\t\t\t\t{{ __('Save') }}\n\t\t\t</Button>\n\t\t</div>\n\t</header>\n\t<div class=\"flex items-center justify-between mb-5\">\n  <!-- Previous Button -->\n  <Button\n    variant=\"subtle\"\n    :disabled=\"currentIndex === 0\"\n    @click=\"navigateToSubmission(currentIndex - 1)\"\n  >\n    {{ __('Previous') }}\n  </Button>\n\n  <!-- Dropdown for All Submissions -->\n  <div class=\"w-1/3\">\n    <label for=\"submissionDropdown\" class=\"block text-sm font-medium text-gray-700\">\n      {{ __('Select Submission') }}\n    </label>\n    <select\n      id=\"submissionDropdown\"\n      v-model=\"currentSubmission\"\n      @change=\"navigateToSubmissionByName(currentSubmission)\"\n      class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\"\n    >\n      <option\n        v-for=\"submission in submissionlist.data\"\n        :key=\"submission.name\"\n        :value=\"submission.name\"\n      >\n        {{ submission.member_name }}\n      </option>\n    </select>\n  </div>\n\n  <!-- Next Button -->\n  <Button\n    variant=\"subtle\"\n    :disabled=\"!submissionlist.data || currentIndex === submissionlist.data.length - 1\"\n    @click=\"navigateToSubmission(currentIndex + 1)\"\n  >\n    {{ __('Next') }}\n  </Button>\n</div>\n\t<div v-if=\"submisisonDetails.doc\" class=\"w-2/3 mx-auto py-5 space-y-5\">\n\t\t<div class=\"grid grid-cols-3 gap-5\">\n\t\t\t<!-- Left Section (2/3 width) -->\n\t\t\t<div class=\"col-span-2 space-y-4\">\n\t\t\t\t<div class=\"text-xl font-semibold text-ink-gray-9\">\n\t\t\t\t\t{{ submisisonDetails.doc.member_name }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"space-y-4 border p-5 rounded-md\">\n\t\t\t\t\t<div class=\"flex items-center justify-between py-4\">\n\t\t\t\t\t\t<!-- Exam Percentage -->\n\t\t\t\t\t\t<div class=\"text-center ml-5\">\n\t\t\t\t\t\t\t<div class=\"text-3xl font-bold text-ink-gray-9\">\n\t\t\t\t\t\t\t\t{{ submisisonDetails.doc.percentage || 0 }}%\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t\tScore\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<!-- Score and Time Taken -->\n\t\t\t\t\t\t<div class=\"text-center\">\n\t\t\t\t\t\t\t<div class=\"text-3xl font-semibold text-ink-gray-9\">\n\t\t\t\t\t\t\t\t{{ submisisonDetails.doc.score }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t\tOut of {{ submisisonDetails.doc.score_out_of }} Points\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"text-center mr-5\">\n\t\t\t\t\t\t\t<div class=\"text-3xl font-semibold text-ink-gray-9 mt-2\">\n\t\t\t\t\t\t\t\t{{ formatTime(submisisonDetails.doc.time_taken) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t\tTime taken\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Questions Section -->\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(row, index) in submisisonDetails.doc.result\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tclass=\"border p-5 rounded-md space-y-4\"\n        >\n        {{ console.log(row) }}\n\t\t\t\t\t  <!-- Question Title -->\n  \t\t\t\t  <!-- Question Title -->\n  <div class=\"space-y-1\">\n    <div class=\"font-semibold text-ink-gray-9\">\n      {{ __('Question') }} {{ index + 1 }}:\n    </div>\n    <div class=\"leading-5 text-ink-gray-9\" v-html=\"row.question_name\"></div>\n  </div>\n\t\t\t\t\t <!-- Answer -->\n\t\t\t\t\t<div class=\"leading-5 text-ink-gray-7 space-x-1\">\n\t\t\t\t\t\t<span> {{ __('Your Answer') }}: </span>\n\t\t\t\t\t\t<span v-html=\"row.answer\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t  <!-- Points and Buttons -->\n  <div class=\"flex items-center justify-end space-x-5\">\n    <!-- Buttons for Auto-Grading -->\n    <div class=\"flex items-center space-x-2\">\n      <Button\n        variant=\"solid\"\n        theme=\"green\"\n        size=\"sm\"\n        @click=\"setPoints(row, row.points_out_of)\"\n      >\n        <Check class=\"w-4 h-4\" />\n      </Button>\n      <Button\n        variant=\"solid\"\n        theme=\"red\"\n        size=\"sm\"\n        @click=\"setPoints(row, 0)\"\n      >\n        <X class=\"w-4 h-4\" />\n      </Button>\n    </div>\n\n    <!-- Points Input -->\n\t<div class=\"flex items-center space-x-2\">\n  <FormControl\n    v-model=\"row.points\"\n    type=\"number\"\n    class=\"w-20 text-right\"\n\t@change=\"(val) => onPointsChange(row, val)\" \n  />\n  <span class=\"text-sm text-ink-gray-7\">\n    / {{ parseInt(row.points_out_of, 10) }} {{ __('Points') }}\n  </span>\n</div>\n  </div>\n\t\t\t\t\t\t<!-- <TextEditor\n\t\t\t\t\t\t\t:content=\"row.comments\"\n\t\t\t\t\t\t\t:label=\"__('Comment')\"\n\t\t\t\t\t\t\t:placeholder=\"__('Add a comment')\"\n              :key=\"row.name\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n              :editable=\"true\"\n\t\t\t\t\t\t\t:editorClass=\"'ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none'\"\n\t\t\t\t\t\t\t@change=\"(val) => onCommentChange(row, val)\" \n\t\t\t\t\t\t</TextEditor> -->\n\t\t\t\t\t\t\n            <ExamQuestionEditor\n            :questionId=\"row.name\"\n            :content=\"row.comments\"\n            :editable=\"true\"\n            @change=\"(val) => onCommentChange(row, val)\" <!-- Pass the updated value -->\n          </ExamQuestionEditor>\n           \n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\n\n\t\t\t<!-- Right Section (1/3 width) -->\n\t\t\t<div class=\"col-span-1 space-y-4\">\n\t\t\t\t<div class=\"space-y-4 border p-5 rounded-md\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"submisisonDetails.doc.fudge_points\"\n\t\t\t\t\t\t:label=\"__('Fudge Points')\"\n\t\t\t\t\t\t:disabled=\"false\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"submisisonDetails.doc.status\"\n\t\t\t\t\t\t:label=\"__('Status')\"\n\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t:options=\"[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Not Graded',\n\t\t\t\t\t\t\t\tvalue: 'Not Graded',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Graded',\n\t\t\t\t\t\t\t\tvalue: 'Graded',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:disabled=\"false\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"space-y-4 border p-5 rounded-md\">\n\t\t\t\t\t<Discussions\n\t\t\t\t\t\t:title=\"'Exam Comments'\"\n\t\t\t\t\t\t:doctype=\"'Exam Submission'\"\n\t\t\t\t\t\t:docname=\"submisisonDetails.doc.name\"\n\t\t\t\t\t\t:key=\"submisisonDetails.doc.name\"\n\t\t\t\t\t\ttype=\"single\"\n\t\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tcreateDocumentResource,\n\tcreateResource,\n\tBreadcrumbs,\n\tFormControl,\n\tButton,\n\tBadge,\n\tTextEditor\n} from 'frappe-ui'\nimport { computed, onBeforeUnmount, onMounted, inject, watch, watchEffect, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { showToast } from '@/utils'\nimport Discussions from '@/components/Discussions.vue'\nimport ExamQuestionEditor  from '@/components/ExamQuestionEditor.vue'\nimport { Check, X } from 'lucide-vue-next'\n\nconst router = useRouter()\nconst user = inject('$user')\n\nonMounted(() => {\n\tif (!user.data?.is_instructor && !user.data?.is_moderator)\n\t\trouter.push({ name: 'Courses' })\n\n\twindow.addEventListener('keydown', keyboardShortcut)\n  console.log('Keyboard shortcut listener added')\n})\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n  console.log('Keyboard shortcut listener removed')\n  // Clean up any other resources or listeners if needed\n})\n\nconst keyboardShortcut = (e) => {\n\tif (\n\t\te.key === 's' &&\n\t\t(e.ctrlKey || e.metaKey) &&\n\t\t!e.target.classList.contains('ProseMirror')\n\t) {\n\t\tsaveSubmission()\n\t\te.preventDefault()\n\t}\n}\n\nconst props = defineProps({\n\tsubmission: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\texamID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst submissionlist = createResource({\n  url: 'frappe.client.get_list',\n  params: {\n    doctype: 'Exam Submission',\n    filters: [\n      ['exam', '=', props.examID],\n      ['course', '=', props.courseName],\n    ],\n    fields: ['name', 'member_name'], // Fetch only necessary fields\n    order_by: 'member_name asc', // Order by member name\n  },\n  auto: true,\n});\nconsole.log('Submission List:', submissionlist)\n\nconst submisisonDetails = createDocumentResource({\n  doctype: 'Exam Submission',\n  name: props.submission,\n  auto: true, // Automatically fetch the document\n  save: {\n    async submit() {\n      try {\n        // Send the document to the backend for saving\n        const response = await frappe.call('frappe.client.save', {\n          doc: submisisonDetails.doc, // Pass the entire document, including child records\n        });\n\n        // Update the local document with the saved data\n        submisisonDetails.doc = response.message;\n\n        // Mark the document as not dirty\n        submisisonDetails.isDirty = false;\n\n        // Show a success message\n        showToast(__('Success'), __('Submission saved successfully'), 'check-circle');\n      } catch (err) {\n        // Handle errors\n        console.error('Error saving submission:', err);\n        throw err; // Re-throw the error to be handled by the caller\n      }\n    },\n  },\n});\n\nconst course = createResource({\n\turl: 'seminary.seminary.utils.get_course_details',\n\tcache: ['course', props.courseName],\n\tparams: {\n\t\tcourse: props.courseName,\n\t},\n\tauto: true,\n}) //Neded for the breadcrumbs\n\nconst breadcrumbs = computed(() => {\n\tlet items = [{ label: 'Courses', route: { name: 'Courses' } }]\n\titems.push({\n\t\tlabel: course?.data?.course,\n\t\troute: { name: 'CourseDetail', params: { courseName: props.courseName } },\n\t})\n    items.push({\n        label: 'Gradebook',\n        route: { name: 'Gradebook', params: { courseName: props.courseName} },\n    })\n\titems.push({\n\t\tlabel: 'Exam Submissions',\n\t\troute: { name: 'ExamSubmissionCS', params: { courseName: props.courseName, examID: props.examID } },\n\t})\n\treturn items\n})\n\t\t\n\t\t\t\t\t\n\n\nconst formatTime = (seconds) => {\n  if (!seconds) return '00:00:00'; // Handle null or undefined values\n  const hrs = Math.floor(seconds / 3600).toString().padStart(2, '0');\n  const mins = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${hrs}:${mins}:${secs}`;\n};\nconst setPoints = (row, points) => {\n  row.points = points;\n  row.graded = true; // Mark the question as graded\n};\n\nconst updateScoreAndPercentage = () => {\n  // Calculate the total score by summing up all row.points\n  const totalScore = (submisisonDetails.doc.result || []).reduce((sum, row) => {\n    return sum + Number(row.points || 0); // Convert row.points to a number and default to 0 if undefined\n  }, 0);\n\n  // Update the score\n  submisisonDetails.doc.score = totalScore;\n\n  // Ensure score_out_of is treated as a float\n  const scoreOutOf = parseFloat(submisisonDetails.doc.score_out_of) || 1; // Default to 1 to avoid division by 0\n  const Fudge = parseFloat(submisisonDetails.doc.fudge_points) || 0; // Default to 0 if none\n  // Calculate the exam percentage\n  const percentage = ((totalScore / scoreOutOf) * 100) + Fudge;\n  submisisonDetails.doc.percentage = parseFloat(percentage.toFixed(2)); // Ensure it's a float and round to 2 decimal places\n};\n\n// Watch for changes in row.points or fudge_points\nconst pointsArray = computed(() => {\n  return submisisonDetails.doc.result ? submisisonDetails.doc.result.map((row) => row.points) : [];\n});\n\nwatchEffect(() => {\n  if (submisisonDetails.doc && submisisonDetails.doc.result) {\n    updateScoreAndPercentage(); // Recalculate score and percentage\n  }\n});\n\n// Watch for changes in fudge_points\nwatchEffect(() => {\n  if (submisisonDetails.doc && typeof submisisonDetails.doc.fudge_points !== 'undefined') {\n    updateScoreAndPercentage(); // Recalculate score and percentage\n  }\n});\n\nconst onCommentChange = (row, value) => {\n  row.comments = value; // Update the row.comments field\n  \n};\n\nconst validateSubmission = async () => {\n  // Find ungraded questions\n  const ungradedQuestions = submisisonDetails.doc.result\n    .map((row, index) => (!row.graded ? `Question ${index + 1}` : null))\n    .filter((question) => question !== null);\n\n  if (ungradedQuestions.length > 0) {\n    // Show confirmation dialog for ungraded questions\n    const confirmSave = confirm(\n      `The following questions need grading: ${ungradedQuestions.join(', ')}. Do you want to save anyway?`\n    );\n\n    if (!confirmSave) {\n      // User canceled the save\n      return;\n    }\n  } else {\n    // If all questions are graded, set the status to 'Graded'\n    submisisonDetails.doc.status = 'Graded';\n  }\n\n  // Proceed with saving\n  await saveSubmission();\n};\n\nconst onPointsChange = (row, value) => {\n  row.graded = true; // Mark the question as graded\n  console.log(`Updated Points for Question: ${row.points}`); // Debugging log\n};\n\nconst saveSubmission = async () => {\n  try {\n    console.log('Saving submission:', submisisonDetails.doc); // Debugging log\n    await submisisonDetails.save.submit(); // Save the document\n    showToast(__('Success'), __('Submission saved successfully'), 'check');\n  } catch (err) {\n    console.error('Error saving submission:', err); // Debugging log\n    showToast(__('Error'), __(err.messages?.[0] || 'An error occurred while saving'), 'x');\n  }\n};\n\nconst currentSubmission = ref(props.submission); // Track the current submission\nconst currentIndex = computed(() =>\n  submissionlist.data?.findIndex((submission) => submission.name === currentSubmission.value)\n);\n\nconst navigateToSubmission = (index) => {\n  if (index >= 0 && index < submissionlist.data.length) {\n    const submission = submissionlist.data[index];\n    router.push({\n      name: 'ExamSubmission',\n      params: {\n        submission: submission.name,\n        courseName: props.courseName,\n        examID: props.examID,\n      },\n    });\n  }\n};\n\nconst navigateToSubmissionByName = (submissionName) => {\n  const submission = submissionlist.data.find((sub) => sub.name === submissionName);\n  if (submission) {\n    router.push({\n      name: 'ExamSubmission',\n      params: {\n        submission: submission.name,\n        courseName: props.courseName,\n        examID: props.examID,\n      },\n    });\n  }\n};\n\nwatch(currentSubmission, async (newSubmission) => {\n  if (newSubmission) {\n    console.log('Navigating to submission:', newSubmission); // Debugging log\n    submisisonDetails.name = newSubmission; // Update the document name\n    await submisisonDetails.reload(); // Reload the document\n  }\n});\n</script>\n"],"names":["props","__props","emit","__emit","internalContent","ref","watch","newContent","oldContent","updateContent","val","_createBlock","_unref","TextEditor","router","useRouter","user","inject","onMounted","_a","_b","keyboardShortcut","onBeforeUnmount","saveSubmission","submissionlist","createResource","submisisonDetails","createDocumentResource","__async","response","showToast","err","course","breadcrumbs","computed","items","formatTime","seconds","hrs","mins","secs","setPoints","row","points","updateScoreAndPercentage","totalScore","sum","scoreOutOf","Fudge","percentage","watchEffect","onCommentChange","value","validateSubmission","ungradedQuestions","index","question","onPointsChange","currentSubmission","currentIndex","submission","navigateToSubmission","navigateToSubmissionByName","submissionName","sub","newSubmission","_createElementVNode","_hoisted_1","Breadcrumbs","_hoisted_2","Badge","__","_createVNode","Button","_hoisted_3","_cache","$event","_hoisted_4","_hoisted_5","_toDisplayString","_openBlock","_createElementBlock","_Fragment","_renderList","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_createTextVNode","_hoisted_20","_hoisted_21","_hoisted_23","_hoisted_25","_hoisted_26","Check","X","_hoisted_27","FormControl","_hoisted_28","ExamQuestionEditor","_hoisted_29","_hoisted_30","_hoisted_31","Discussions"],"mappings":"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"}