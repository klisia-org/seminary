{"version":3,"file":"telemetry-9c8f0c58.js","sources":["../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/chevron-right.js","../../../../../frappe/frappe/public/js/lib/posthog.js","../../../../frontend/src/telemetry.ts"],"sourcesContent":["/**\n * @license lucide-vue-next v0.479.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronRight = createLucideIcon(\"ChevronRightIcon\", [\n  [\"path\", { d: \"m9 18 6-6-6-6\", key: \"mthhwq\" }]\n]);\n\nexport { ChevronRight as default };\n//# sourceMappingURL=chevron-right.js.map\n","!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(\".\");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement(\"script\")).type=\"text/javascript\",p.async=!0,p.src=s.api_host+\"/static/array.js\",(r=t.getElementsByTagName(\"script\")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a=\"posthog\",u.people=u.people||[],u.toString=function(t){var e=\"posthog\";return\"posthog\"!==a&&(e+=\".\"+a),t||(e+=\" (stub)\"),e},u.people.toString=function(){return u.toString(1)+\".people (stub)\"},o=\"capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags\".split(\" \"),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);\n","import { useStorage } from \"@vueuse/core\";\nimport { call } from \"frappe-ui\";\nimport \"../../../frappe/frappe/public/js/lib/posthog.js\";\n\nconst APP = \"lms\";\nconst SITENAME = window.location.hostname;\n\ndeclare global {\n  interface Window {\n    posthog: any;\n  }\n}\n\nconst telemetry = useStorage(\"telemetry\", {\n  enabled: false,\n  project_id: \"\",\n  host: \"\",\n});\n\nexport async function init() {\n  await set_enabled();\n  if (!telemetry.value.enabled) return;\n  try {\n    await set_credentials();\n    window.posthog.init(telemetry.value.project_id, {\n      api_host: telemetry.value.host,\n      autocapture: false,\n      person_profiles: \"always\",\n      capture_pageview: true,\n      capture_pageleave: true,\n      disable_session_recording: false,\n      session_recording: {\n        maskAllInputs: false,\n        maskInputOptions: {\n          password: true,\n        },\n      },\n      loaded: (posthog) => {\n        window.posthog = posthog;\n        window.posthog.identify(SITENAME);\n      },\n    });\n  } catch (e) {\n    console.trace(\"Failed to initialize telemetry\", e);\n    telemetry.value.enabled = false;\n  }\n}\n\nasync function set_enabled() {\n  if (telemetry.value.enabled) return;\n\n  await call(\"lms.lms.telemetry.is_enabled\").then((res) => {\n    telemetry.value.enabled = res;\n  });\n}\n\nasync function set_credentials() {\n  if (!telemetry.value.enabled) return;\n  if (telemetry.value.project_id && telemetry.value.host) return;\n\n  await call(\"lms.lms.telemetry.get_credentials\").then((res) => {\n    telemetry.value.project_id = res.project_id;\n    telemetry.value.host = res.telemetry_host;\n  });\n}\n\ninterface CaptureOptions {\n  data: {\n    user: string;\n    [key: string]: string | number | boolean | object;\n  };\n}\n\nexport function capture(\n  event: string,\n  options: CaptureOptions = { data: { user: \"\" } }\n) {\n  if (!telemetry.value.enabled) return;\n  window.posthog.capture(`${APP}_${event}`, options);\n}\n\nexport function recordSession() {\n  if (!telemetry.value.enabled) return;\n  if (window.posthog && window.posthog.__loaded) {\n    window.posthog.startSessionRecording();\n  }\n}\n\nexport function stopSession() {\n  if (!telemetry.value.enabled) return;\n  if (\n    window.posthog &&\n    window.posthog.__loaded &&\n    window.posthog.sessionRecordingStarted()\n  ) {\n    window.posthog.stopSessionRecording();\n  }\n}\n"],"names":["ChevronRight","createLucideIcon","t","e","o","n","r","i","s","a","g","u","APP","telemetry","useStorage","capture","event","options"],"mappings":"gDAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASK,MAACA,EAAeC,EAAiB,mBAAoB,CACxD,CAAC,OAAQ,CAAE,EAAG,gBAAiB,IAAK,QAAQ,CAAE,CAChD,CAAC,GCXA,SAASC,EAAEC,EAAE,CAAC,IAAIC,EAAEC,EAAE,EAAEC,EAAEH,EAAE,OAAO,OAAO,QAAQA,EAAEA,EAAE,GAAG,CAAA,EAAGA,EAAE,KAAK,SAASI,EAAEC,EAAEC,EAAE,CAAC,SAASC,EAAER,EAAE,EAAE,CAAC,IAAIE,EAAE,EAAE,MAAM,GAAG,EAAKA,EAAE,QAAL,IAAcF,EAAEA,EAAEE,EAAE,CAAC,CAAC,EAAE,EAAEA,EAAE,CAAC,GAAGF,EAAE,CAAC,EAAE,UAAU,CAACA,EAAE,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,UAAU,MAAM,KAAK,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAEA,EAAE,cAAc,QAAQ,GAAG,KAAK,kBAAkB,EAAE,MAAM,GAAG,EAAE,IAAIM,EAAE,SAAS,oBAAoBF,EAAEJ,EAAE,qBAAqB,QAAQ,EAAE,CAAC,GAAG,WAAW,aAAa,EAAEI,CAAC,EAAE,IAAIK,EAAER,EAAE,IAAaM,IAAT,OAAWE,EAAER,EAAEM,CAAC,EAAE,CAAE,EAACA,EAAE,UAAUE,EAAE,OAAOA,EAAE,QAAQ,GAAGA,EAAE,SAAS,SAAST,EAAE,CAAC,IAAI,EAAE,UAAU,OAAkBO,IAAZ,YAAgB,GAAG,IAAIA,GAAGP,IAAI,GAAG,WAAW,CAAC,EAAES,EAAE,OAAO,SAAS,UAAU,CAAC,OAAOA,EAAE,SAAS,CAAC,EAAE,gBAAgB,EAAEP,EAAE,kMAAkM,MAAM,GAAG,EAAEC,EAAE,EAAEA,EAAED,EAAE,OAAOC,IAAIK,EAAEC,EAAEP,EAAEC,CAAC,CAAC,EAAEF,EAAE,GAAG,KAAK,CAACI,EAAEC,EAAEC,CAAC,CAAC,CAAC,EAAEN,EAAE,KAAK,EAAE,GAAE,SAAS,OAAO,SAAS,EAAE,ECIt5B,MAAMS,EAAM,MASNC,EAAYC,EAAW,YAAa,CACxC,QAAS,GACT,WAAY,GACZ,KAAM,EACR,CAAC,EAwDe,SAAAC,EACdC,EACAC,EAA0B,CAAE,KAAM,CAAE,KAAM,EAAG,GAC7C,CACKJ,EAAU,MAAM,SACrB,OAAO,QAAQ,QAAQ,GAAGD,CAAG,IAAII,CAAK,GAAIC,CAAO,CACnD","x_google_ignoreList":[0]}