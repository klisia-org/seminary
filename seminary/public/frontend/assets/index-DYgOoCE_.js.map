{"version":3,"file":"index-DYgOoCE_.js","sources":["../../../../frontend/src/components/ProgressBar.vue","../../../../frontend/src/components/Quiz.vue","../../../../frontend/src/components/QuizBlock.vue","../../../../frontend/src/components/AssessmentPlugin.vue","../../../../frontend/src/utils/quiz.js","../../../../frontend/src/components/Assignment.vue","../../../../frontend/src/components/AssignmentBlock.vue","../../../../frontend/src/utils/assignment.js","../../../../frontend/src/components/ExamGraded.vue","../../../../frontend/src/components/UserAvatar.vue","../../../../frontend/src/components/DiscussionReplies.vue","../../../../frontend/src/components/Modals/DiscussionModal.vue","../../../../frontend/src/utils/scrollContainer.js","../../../../frontend/src/components/Discussions.vue","../../../../frontend/src/components/Exam.vue","../../../../frontend/src/components/ExamBlock.vue","../../../../frontend/src/utils/exam.js","../../../../frontend/src/components/AudioBlock.vue","../../../../frontend/src/components/VideoBlock.vue","../../../../frontend/src/components/UploadPlugin.vue","../../../../frontend/src/utils/upload.js","../../../../frontend/src/utils/markdownParser.js","../../../../frontend/src/utils/code.ts","../../../../frontend/src/components/FolderPlugin.vue","../../../../frontend/src/components/FolderBlock.vue","../../../../frontend/src/utils/foldertool.js","../../../../frontend/src/utils/index.js"],"sourcesContent":["<template>\n\t<Tooltip :text=\"`${props.progress}%`\">\n\t\t<div class=\"w-full bg-surface-gray-3 rounded-full h-1\">\n\t\t\t<div\n\t\t\t\tclass=\"bg-surface-gray-7 rounded-full\"\n\t\t\t\t:class=\"progressBarHeight\"\n\t\t\t\t:style=\"{ width: progressBarWidth }\"\n\t\t\t></div>\n\t\t</div>\n\t</Tooltip>\n</template>\n\n<script setup>\nimport { computed } from 'vue'\nimport { Tooltip } from 'frappe-ui'\n\nconst props = defineProps({\n\tprogress: {\n\t\ttype: Number,\n\t\tdefault: 0,\n\t},\n\tsize: {\n\t\ttype: String,\n\t\tdefault: 'sm',\n\t},\n})\n\nconst progressBarWidth = computed(() => {\n\tconst formattedPercentage = Math.min(Math.ceil(props.progress), 100)\n\treturn `${formattedPercentage}%`\n})\n\nconst progressBarHeight = computed(() => {\n\tif (props.size === 'sm') {\n\t\treturn 'h-1'\n\t}\n\tif (props.size === 'md') {\n\t\treturn 'h-2'\n\t}\n\tif (props.size === 'lg') {\n\t\treturn 'h-3'\n\t}\n})\n</script>\n","<template>\n\t<div v-if=\"isQuizLoaded\">\n\t\t<!-- Quiz Header -->\n\t\t<div\n\t\t\tclass=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\"\n\t\t>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`This quiz consists of ${questions.length} questions.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`Please ensure that you complete all the questions in ${quiz.data.duration} minutes.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t(\n\t\t\t\t\t\t'If you fail to do so, the quiz will be automatically submitted when the timer ends.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.passing_percentage\" class=\"leading-relaxed\">\n\t\t\t\t{{\n\t\t\t\t\t`You will have to get ${quiz.data.passing_percentage}% correct answers in order to pass the quiz.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.max_attempts\" class=\"leading-relaxed\">\n\t\t\t\t{{\n\t\t\t\t\t`You can attempt this quiz ${\n\t\t\t\t\t\tquiz.data.max_attempts === 1 ? '1 time' : `${quiz.data.max_attempts} times`\n\t\t\t\t\t}.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div v-if=\"quiz.data.duration\" class=\"flex flex-col space-x-1 my-4\">\n\t\t\t<div class=\"mb-2\">\n\t\t\t\t<span class=\"\"> {{ ('Time') }}: </span>\n\t\t\t\t<span class=\"font-semibold\">\n\t\t\t\t\t{{ formatTimer(timer) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ProgressBar :progress=\"timerProgress\" />\n\t\t</div>\n\n\t\t<!-- Start Screen -->\n<div v-if=\"!fullQuizMode\">\n  <div class=\"border text-center p-20 rounded-md\">\n    <div class=\"font-semibold text-lg\">\n      {{ quiz.data.title }}\n    </div>\n    <Button\n      v-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts) && quiz.data.qbyquestion\"\n      @click=\"startQuiz\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start') }}</span>\n    </Button>\n    <Button\n      v-else-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts)\"\n      @click=\"startQuiz2\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start full quiz') }}</span>\n    </Button>\n    <div v-else>\n      {{ 'You have already exceeded the maximum number of attempts allowed for this quiz.' }}\n    </div>\n  </div>\n</div>\n\n<!-- Question-by-Question Mode -->\n<div v-if=\"fullQuizMode === false && activeQuestion !== 0 && !quizSubmission.data && quiz.data.qbyquestion\">\n\t<div v-for=\"(question, qtidx) in questions\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"qtidx == activeQuestion - 1 && questionDetails.data\"\n\t\t\t\t\tclass=\"border rounded-md p-5\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t<span class=\"mr-2\">\n\t\t\t\t\t\t\t\t{{ `Question ${activeQuestion}` }}:\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ getInstructions(questionDetails.data) }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n\t\t\t\t\t\t\t{{ question.points }}\n\t\t\t\t\t\t\t{{ question.points == 1 ? ('Point') : ('Points') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"text-ink-gray-9 font-semibold mt-2 leading-5\"\n\t\t\t\t\t\tv-html=\"questionDetails.data.question\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div v-if=\"questionDetails.data.type == 'Choices'\" v-for=\"index in 4\">\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\tv-if=\"questionDetails.data[`option_${index}`]\"\n\t\t\t\t\t\t\tclass=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-if=\"!showAnswers.length && !questionDetails.data.multiple\"\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\"\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-else-if=\"!showAnswers.length && questionDetails.data.multiple\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-else-if=\"quiz.data.show_answers\"\n\t\t\t\t\t\t\t\tv-for=\"(answer, idx) in showAnswers\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div v-if=\"index - 1 == idx\">\n\t\t\t\t\t\t\t\t\t<CheckCircle\n\t\t\t\t\t\t\t\t\t\tv-if=\"answer == 1\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-green-800\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<MinusCircle\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"answer == 2\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-ink-green-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<XCircle\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"answer == 0\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-red-600\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<MinusCircle v-else class=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"ml-2\"\n\t\t\t\t\t\t\t\tv-html=\"questionDetails.data[`option_${index}`]\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"questionDetails.data[`explanation_${index}`]\"\n\t\t\t\t\t\t\tclass=\"mt-2 text-xs\"\n\t\t\t\t\t\t\tv-show=\"showAnswers.length\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ questionDetails.data[`explanation_${index}`] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else-if=\"questionDetails.data.type == 'User Input'\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"possibleAnswer\"\n\t\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\t\t:disabled=\"showAnswers.length ? true : false\"\n\t\t\t\t\t\t\tclass=\"my-2\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"showAnswers.length\">\n\t\t\t\t\t\t\t<Badge v-if=\"showAnswers[0]\" :label=\"('Correct')\" theme=\"green\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t<Badge v-else theme=\"red\" :label=\"('Incorrect')\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t\tclass=\"mt-4\"\n\t\t\t\t\t\t\t:content=\"possibleAnswer\"\n\t\t\t\t\t\t\t@change=\"(val) => (possibleAnswer = val)\"\n\t\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center justify-between mt-4\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t{{ `Question ${activeQuestion} of ${questions.length}` }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"\n\t\t\t\t\t\t\t\tquiz.data.show_answers &&\n\t\t\t\t\t\t\t\t!showAnswers.length \n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t@click=\"checkAnswer()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Check') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-else-if=\"activeQuestion != questions.length\"\n\t\t\t\t\t\t\t@click=\"nextQuestion()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Next') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button v-else @click=\"submitQuiz()\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Submit') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n<!-- Full Quiz Mode: All questions at once -->\n<div v-if=\"fullQuizMode && all_questions_details.data && all_questions_details.data.length > 0\">\n  <div v-for=\"(question, qtidx) in all_questions_details.data\" :key=\"question.name\" class=\"border rounded-md p-5 mb-4\">\n    <!-- Render each question header, text, and answer options -->\n    <div class=\"flex justify-between\">\n      <div class=\"text-sm text-ink-gray-5\">\n        <span class=\"mr-2\">{{ `Question ${qtidx + 1}` }}:</span>\n        <span>{{ getInstructions(question) }}</span>\n      </div>\n      <div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n        {{ question.points || 0 }} {{ question.points == 1 ? ('Point') : ('Points') }}\n      </div>\n    </div>\n    <div class=\"text-ink-gray-9 font-semibold mt-2 leading-5\" v-html=\"question.question_detail\"></div>\n    <!-- Answer Options -->\n    <div v-if=\"question.type == 'Choices'\" v-for=\"index in 4\">\n      <label\n        v-if=\"question[`option_${index}`]\"\n        class=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\"\n      >\n        <input\n          v-if=\"!question.multiple\"\n          type=\"radio\"\n          :name=\"`question_${qtidx}`\"\n          class=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n          @change=\"recordAnswer(qtidx, question[`option_${index}`])\"\n        />\n        <input\n          v-else-if=\"question.multiple\"\n          type=\"checkbox\"\n          :name=\"`question_${qtidx}`\"\n          class=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n          @change=\"toggleAnswer(qtidx, question[`option_${index}`])\"\n        />\n        <span class=\"ml-2\" v-html=\"question[`option_${index}`]\"></span>\n      </label>\n    </div>\n    <!-- User Input Option -->\n    <div v-else-if=\"question.type == 'User Input'\">\n      <FormControl v-model=\"answers[qtidx]\" type=\"textarea\" class=\"my-2\" />\n    </div>\n  </div>\n  <!-- Submit Button -->\n  <div class=\"text-center mt-4\">\n    <Button @click=\"submitQuizComplete()\">\n      <span>{{ ('Submit Your Quiz') }}</span>\n    </Button>\n  </div>\n</div>\n\n<!-- Quiz Summary (if quizSubmission.data exists) -->\n<div v-else-if=\"quizSubmission.data\" class=\"border rounded-md p-20 text-center space-y-4\">\n  <div class=\"text-lg font-semibold\">{{ ('Quiz Summary') }}</div>\n  <div class=\"text-ink-gray-9\">\n    {{ `You got ${Math.ceil(quizSubmission.data.percentage)}% correct answers with a score of ${quizSubmission.data.score} out of ${quizSubmission.data.score_out_of}` }}\n  </div>\n  <div class=\"mt-6\">\n    <div v-for=\"(question, qtidx) in detailedQuestions\" :key=\"question.question_name\" class=\"border rounded-md p-5 mb-4\">\n      <!-- Question Header -->\n      <div class=\"flex justify-between\">\n        <div class=\"text-lg text-ink-gray-5\">\n          <span class=\"mr-2\">{{ `Question ${qtidx + 1}` }}:</span>\n\t\t  <span v-html=\"question.question_detail\"></span>\n        </div>\n      </div>\n\n      <!-- User Answer -->\n      <div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Your Answer:') }}</strong> {{ question.user_answer || 'No Answer' }}\n      </div>\n\n      <!-- Correct Answer -->\n      <div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Correct Answer:') }}</strong> {{ question.correct_answer || 'No Correct Answer' }}\n      </div>\n\n      <!-- Explanation -->\n      <div v-if=\"question.explanation\" class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Explanation:') }}</strong> {{ question.explanation }}\n      </div>\n\n      <!-- Correct/Incorrect Indicator -->\n      <div class=\"mt-4\">\n        <Badge v-if=\"quizResults[qtidx]?.is_correct?.[0] === 1\" :label=\"('Correct')\" theme=\"green\">\n          <template #prefix>\n            <CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n          </template>\n        </Badge>\n        <Badge v-else :label=\"('Incorrect')\" theme=\"red\">\n          <template #prefix>\n            <XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n          </template>\n        </Badge>\n      </div>\n    </div>\n  </div>\n  <Button @click=\"resetQuiz()\" class=\"mt-4\">\n    <span>{{ ('Try Again') }}</span>\n  </Button>\n</div>\n\t</div>\n\t<div v-else>\n\t\t<p>Loading quiz data...</p>\n\t</div>\n</template>\n<script setup>\nimport {Badge, Button, call, createResource, ListView, TextEditor, FormControl, toast} from 'frappe-ui'\nimport { ref, watch, reactive, inject, computed } from 'vue'\nimport { createToast } from '@/utils/'\nimport { CheckCircle, XCircle, MinusCircle } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\n\nconst user = inject('$user')\nconst fullQuizMode = ref(false);\nconst activeQuestion = ref(0)\nconst currentQuestion = ref('')\nconst selectedOptions = reactive([0, 0, 0, 0])\nconst showAnswers = reactive([])\nlet questions = reactive([])\nconst possibleAnswer = ref(null)\nconst timer = ref(0)\nlet timerInterval = null\nconst router = useRouter()\nconst elapsedTime = ref(0); // Tracks the time taken in seconds\nconst answers = reactive({}); // Stores the answers for each question\n\n\nconst props = defineProps({\n\tquizName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\n// Ensure `quiz.data` is properly initialized and loaded\nconst quiz = createResource({\n    url: 'frappe.client.get',\n    makeParams(values) {\n        return {\n            doctype: 'Quiz',\n            name: props.quizName,\n        };\n    },\n    cache: ['quiz', props.quizName],\n    auto: true,\n    transform(data) {\n        if (!data) {\n            console.error(\"Quiz data is null or undefined.\"); // Debugging\n            return null;\n        }\n        data.duration = parseInt(data.duration) || 0; // Ensure duration is a valid number\n        return data;\n    },\n    onSuccess(data) {\n        if (data) {\n            populateQuestions();\n            setupTimer();\n        } else {\n            console.error(\"Failed to load quiz data.\"); // Debugging\n        }\n    },\n    onError(err) {\n        console.error(\"Error loading quiz data:\", err); // Debugging\n    },\n});\n\n// Add a computed property to check if `quiz.data` is loaded\nconst isQuizLoaded = computed(() => !!quiz.data);\n\nconst populateQuestions = () => {\n    let data = quiz.data;\n    if (data.shuffle_questions) {\n        // Shuffle the questions\n        const shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n        // Limit the number of questions if required\n        questions = data.limit_questions_to\n            ? shuffledQuestions.slice(0, data.limit_questions_to)\n            : shuffledQuestions;\n    } else {\n        // Use the original questions if no shuffle is required\n        questions = data.questions;\n    }\n\t\n}\n\nconst setupTimer = () => {\n\tif (quiz.data.duration) {\n\t\ttimer.value = quiz.data.duration * 60\n\t}\n}\n\nconst startTimer = () => {\n    timerInterval = setInterval(() => {\n        if (quiz.data.duration) {\n            timer.value--;\n            if (timer.value == 0) {\n                clearInterval(timerInterval);\n                submitQuiz();\n            }\n        }\n        elapsedTime.value++; // Always increment elapsed time\n    }, 1000);\n};\n\nconst formatTimer = (seconds) => {\n\tconst hrs = Math.floor(seconds / 3600)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst mins = Math.floor((seconds % 3600) / 60)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst secs = (seconds % 60).toString().padStart(2, '0')\n\treturn hrs != '00' ? `${hrs}:${mins}:${secs}` : `${mins}:${secs}`\n}\n\nconst timerProgress = computed(() => {\n\treturn (timer.value / (quiz.data.duration * 60)) * 100\n})\n\nconst shuffleArray = (array) => {\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tconst j = Math.floor(Math.random() * (i + 1))\n\t\t;[array[i], array[j]] = [array[j], array[i]]\n\t}\n\treturn array\n}\n\nconst attempts = createResource({\n\turl: 'frappe.client.get_list',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz Submission',\n\t\t\tfilters: {\n\t\t\t\tmember: user.data?.name,\n\t\t\t\tquiz: quiz.data?.name,\n\t\t\t},\n\t\t\tfields: [\n\t\t\t\t'name',\n\t\t\t\t'creation',\n\t\t\t\t'score',\n\t\t\t\t'score_out_of',\n\t\t\t\t'percentage',\n\t\t\t\t'passing_percentage',\n\t\t\t],\n\t\t\torder_by: 'creation desc',\n\t\t}\n\t},\n\ttransform(data) {\n\t\tdata.forEach((submission, index) => {\n\t\t\tsubmission.creation = timeAgo(submission.creation)\n\t\t\tsubmission.idx = index + 1\n\t\t})\n\t},\n})\n\nwatch(\n\t() => quiz.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tpopulateQuestions()\n\t\t\t\n\t\t}\n\t\tif (newData && quiz.data.max_attempts) {\n\t\t\tattempts.reload()\n\t\t\tresetQuiz()\n\t\t}\n\t}\n)\n\nconst quizSubmission = createResource({\n    url: 'seminary.seminary.doctype.quiz.quiz.quiz_summary',\n    makeParams(values) {\n        // Add null-safe checks for `quiz.data`\n        if (!quiz.data) {\n            return {}; // Return an empty object to avoid errors\n        }\n        const timeTaken = quiz.data.duration\n            ? quiz.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n            : elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n       \n\n        return {\n            quiz: quiz.data.name,\n            course: router.currentRoute.value.params.courseName,\n            results: values?.results || localStorage.getItem(`${quiz.data.name}_results`), // Ensure `results` is properly initialized\n            time_taken: timeTaken, // Pass the correct time_taken\n        };\n    },\n    onSuccess(data) {\n       \n        if (data.corrected_answers) {\n            all_questions_details.data = data.corrected_answers.map((question) => ({\n                ...question,\n                user_answer: question.user_answer || null, // Ensure user_answer is included\n                correct_answer: question.correct_answer || null, // Ensure correct_answer is included\n            }));\n        }\n    },\n    onError(err) {\n        console.error(\"Error loading quiz summary:\", err); // Debugging\n    },\n    auto: true, // Re-enable auto-fetch\n});\n\nconst questionDetails = createResource({\n\turl: 'seminary.seminary.utils.get_question_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestion: currentQuestion.value,\n\t\t}\n\t},\n\t\n})\n\nwatch(activeQuestion, (value) => {\n\tif (value > 0) {\n\t\tcurrentQuestion.value = quiz.data.questions[value - 1].question\n\t\tquestionDetails.reload()\n\t}\n})\n\nwatch(\n\t() => props.quizName,\n\t(newName) => {\n\t\tif (newName) {\n\t\t\tquiz.reload()\n\t\t}\n\t}\n)\n\nconst all_questions_details = createResource({\n\turl: 'seminary.seminary.utils.get_all_questions_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestions: questions.map((q) => q.name), // Ensure only question names are sent\n\t\t}\n\t},\n})\n\n\n\nconst startQuiz = () => {\n\tactiveQuestion.value = 1\n\tlocalStorage.removeItem(quiz.data.title)\n\tstartTimer()\n}\n\nconst startQuiz2 = () => {\n    localStorage.removeItem(quiz.data.title);\n    fullQuizMode.value = true; // Set full quiz mode flag\n    startTimer();\n    all_questions_details.reload(); // Ensure the resource is reloaded\n    \n}\n\n\nconst markAnswer = (index) => {\n\tif (!questionDetails.data.multiple)\n\t\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tselectedOptions[index - 1] = selectedOptions[index - 1] ? 0 : 1\n}\n\nconst getAnswers = () => {\n\tlet answers = []\n\tconst type = questionDetails.data.type\n\n\tif (type == 'Choices') {\n\t\tselectedOptions.forEach((value, index) => {\n\t\t\tif (selectedOptions[index])\n\t\t\t\tanswers.push(questionDetails.data[`option_${index + 1}`])\n\t\t})\n\t} else {\n\t\tanswers.push(possibleAnswer.value)\n\t}\n\n\treturn answers\n}\n\nconst checkAnswer = () => {\n    let answers = getAnswers();\n    if (!answers.length) {\n        createToast({\n            title: 'Please select an option',\n            icon: 'alert-circle',\n            iconClasses: 'text-yellow-600 bg-yellow-100 rounded-full',\n            position: 'top-center',\n        });\n        return;\n    }\n\n    createResource({\n        url: 'seminary.seminary.doctype.quiz.quiz.check_answer',\n        params: {\n            question: currentQuestion.value,\n            type: questionDetails.data.type,\n            answers: JSON.stringify(answers),\n        },\n        auto: true,\n        onSuccess(data) {\n            let type = questionDetails.data.type;\n            if (type === 'Choices') {\n                selectedOptions.forEach((option, index) => {\n                    if (option) {\n                        showAnswers[index] = option && data[index];\n                    } else if (data[index] === 2) {\n                        showAnswers[index] = 2;\n                    } else {\n                        showAnswers[index] = undefined;\n                    }\n                });\n            } else {\n                showAnswers.push(data);\n            }\n            addToLocalStorage();\n            if (!quiz.data.show_answers) {\n                resetQuestion();\n            }\n        },\n    });\n};\n\nconst addToLocalStorage = () => {\n    let quizData = JSON.parse(localStorage.getItem(quiz.data.title)) || [];\n    let questionData = {\n        question_name: currentQuestion.value,\n        answer: getAnswers().join(),\n        is_correct: showAnswers.filter((answer) => {\n\t\t\treturn answer != undefined\n\t\t}),\n    };\n\n    // Check if the question already exists in localStorage\n    const existingIndex = quizData.findIndex(\n        (item) => item.question_name === questionData.question_name\n    );\n\n    if (existingIndex !== -1) {\n        // Update the existing question data\n        quizData[existingIndex] = questionData;\n    } else {\n        // Add the new question data\n        quizData ? quizData.push(questionData) : (quizData = [questionData])\n    }\n\n    \n  localStorage.setItem(quiz.data.title, JSON.stringify(quizData));\n  localStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(quizData)); // Save results for submission\n\n};\n\nconst nextQuestion = () => {\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t} else {\n\t\taddToLocalStorage()\n\t\tresetQuestion()\n\t}\n}\n\nconst resetQuestion = () => {\n\tif (activeQuestion.value == quiz.data.questions.length) return\n\tactiveQuestion.value = activeQuestion.value + 1\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tpossibleAnswer.value = null\n}\n\nconst submitQuiz = () => {\n\t\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t\tsetTimeout(() => {\n\t\t\tcreateSubmission()\n\t\t}, 500)\n\t\treturn\n\t}\n\tcreateSubmission()\n\tconsole.log('Quiz submitted with Submit Quiz button and asnwers shown')\n}\n\nconst submitQuizComplete = async () => {\n\tconst results = [];\n\tconst detailedQuestions = []; // Array to store detailed question data\n\n\t// Iterate through all questions and collect answers\n\tfor (let i = 0; i < all_questions_details.data.length; i++) {\n\t\tconst question = all_questions_details.data[i];\n\t\tconst answer = answers[i]?.[0] || \"\"; // Get the first recorded answer or an empty string\n\n\t\t\n\n\t\t// Call the backend to validate the answer\n\t\tconst response = await call('seminary.seminary.doctype.quiz.quiz.check_answer', {\n\t\t\tquestion: question.question, // Pass the unique question identifier\n\t\t\ttype: question.type,\n\t\t\tanswers: JSON.stringify([answer]), // Send the answer as an array\n\t\t});\n\n\t\t// Extract only the relevant value for `is_correct`\n\t\tconst is_correct = Array.isArray(response) ? [response.find((val) => val === 1) || 0] : [response];\n\n\t\tresults.push({\n\t\t\tquestion_name: question.question, // Use the unique question identifier\n\t\t\tanswer: answer, // Use the single answer string\n\t\t\tis_correct: is_correct, // Ensure this contains only the relevant value\n\t\t});\n\n\t\t// Add detailed question data (correct_answer will be fetched later)\n\t\tdetailedQuestions.push({\n\t\t\tquestion_name: question.question,\n\t\t\tquestion_detail: question.question_detail,\n\t\t\tuser_answer: answer,\n\t\t\tcorrect_answer: null, // Placeholder for correct answer\n\t\t\texplanation: question.explanation || null,\n\t\t});\n\t}\n\n\n\t// Submit the quiz results\n\tquizSubmission.submit(\n\t\t{ results: JSON.stringify(results) }, // Ensure results is passed as a string\n\t\t{\n\t\t\tonSuccess: async (data) => {\n\t\t\t\t\n\n\t\t\t\t// Fetch correct answers from the backend\n\t\t\t\tconst correctAnswers = await call('seminary.seminary.doctype.quiz.quiz.get_all_question_results', {\n\t\t\t\t\tquestions: questions.map(q => q.question),\n\t\t\t\t});\n\n\t\t\t\t// Update detailedQuestions with correct answers and explanations\n\t\t\t\tdetailedQuestions.forEach((question) => {\n\t\t\t\t\tconst correctAnswer = correctAnswers.find((item) => item.name === question.question_name);\n\t\t\t\t\tif (correctAnswer) {\n\t\t\t\t\t\tquestion.correct_answer = correctAnswer.correct_option;\n\t\t\t\t\t\tquestion.explanation = correctAnswer.correct_explanation || question.explanation;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Store detailed question data in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_questions`, JSON.stringify(detailedQuestions));\n\t\t\t\t\n\n\t\t\t\t// Store results in localStorage for use in `makeParams`\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(results));\n\n\t\t\t\t// Store the quiz summary in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_summary`, JSON.stringify(data));\n\t\t\t\t\n\n\t\t\t\tquizSubmission.reload(); // Reload the quiz summary and corrected answers\n\t\t\t\tfullQuizMode.value = false; // Exit full quiz mode to show the summary\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconsole.error(\"Error submitting quiz:\", err);\n\t\t\t},\n\t\t}\n\t);\n};\n\nconst createSubmission = () => {\n\tconst results = localStorage.getItem(`${quiz.data.name}_results`); // Retrieve results from localStorage\n  if (!results) {\n    console.error(\"No results found to submit.\"); // Debugging\n    return;\n  }\n\n  quizSubmission.submit(\n    { results }, // Pass results to the backend\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tmarkLessonProgress()\n\t\t\t\tif (quiz.data && quiz.data.max_attempts) attempts.reload()\n\t\t\t\tif (quiz.data.duration) clearInterval(timerInterval)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconst errorTitle = err?.message || ''\n\t\t\t\tif (errorTitle.includes('MaximumAttemptsExceededError')) {\n\t\t\t\t\tconst errorMessage = err.messages?.[0] || err\n\t\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.reload()\n\t\t\t\t\t}, 3000)\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst resetQuiz = () => {\n\tactiveQuestion.value = 0\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tquizSubmission.reset()\n\tpopulateQuestions()\n\tsetupTimer()\n\telapsedTime.value = 0 // Reset elapsed time\n}\n\nconst getInstructions = (question) => {\n\tif (question.type == 'Choices')\n\t\tif (question.multiple) return ('Choose all answers that apply')\n\t\telse return ('Choose one answer')\n\telse return ('Type your answer')\n}\n\nconst markLessonProgress = () => {\n\t\n\tif (router.currentRoute.value.name === 'Lesson') {\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: router.currentRoute.value.params.courseName,\n\t\t\tchapter_number: router.currentRoute.value.params.chapterNumber,\n\t\t\tlesson_number: router.currentRoute.value.params.lessonNumber,\n\t\t}).then(() => {\n\t\t\tif (fullQuizMode.value) {\n\t\t\t\tquizSubmission.reload(); // Ensure the quiz summary is reloaded for full quiz mode\n\t\t\t}\n\t\t});\n\t}\n};\n\nconst getSubmissionColumns = () => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'No.',\n\t\t\tkey: 'idx',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Date',\n\t\t\tkey: 'creation',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Score',\n\t\t\tkey: 'score',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Score out of',\n\t\t\tkey: 'score_out_of',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Percentage',\n\t\t\tkey: 'percentage',\n\t\t\talign: 'center',\n\t\t}\n\t]\n}\n\nconst recordAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and stores the selected answer\n\tanswers[qtidx] = [answer];\n\t\n};\n\nconst toggleAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and handles multiple answers\n\tif (!answers[qtidx]) {\n\t\tanswers[qtidx] = [];\n\t}\n\tconst index = answers[qtidx].indexOf(answer);\n\tif (index === -1) {\n\t\tanswers[qtidx].push(answer); // Add the answer if not already selected\n\t} else {\n\t\tanswers[qtidx].splice(index, 1); // Remove the answer if already selected\n\t}\n\t\n};\n\nwatch(\n\t() => all_questions_details.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tconsole.log(\"All questions details updated\"); // Debugging\n\t\t} else {\n\t\t\tconsole.warn(\"No data available in all_questions_details.\"); // Debugging\n\t\t}\n\t}\n)\n\n// Load detailed question data and results from localStorage\nconst detailedQuestions = ref([]);\nconst quizResults = ref([]);\n\nwatch(\n  () => quizSubmission.data,\n  () => {\n    if (quizSubmission.data) {\n      const questions = localStorage.getItem(`${quiz.data.name}_questions`);\n      const results = localStorage.getItem(`${quiz.data.name}_results`);\n      detailedQuestions.value = questions ? JSON.parse(questions) : [];\n      quizResults.value = results ? JSON.parse(results) : [];\n    }\n  }\n);\n</script>","<template>\n\t<Quiz v-if=\"user.data\" :quizName=\"quiz\"></Quiz>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the quiz.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Quiz from '@/components/Quiz.vue'\n\nconst user = inject('$user')\nconst props = defineProps({\n\tquiz: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:options=\"{\n\t\t\tsize: 'xl',\n\t\t}\"\n\t>\n\t\t<template #body>\n\t\t\t<button style=\"opacity: 0; position: absolute;\">Fallback Focus</button>\n\t\t\t<div class=\"p-5 space-y-4\">\n\t\t\t\t<div v-if=\"type == 'quiz'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add a quiz to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"type == 'exam'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an exam to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an assignment to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-if=\"type == 'quiz'\"\n\t\t\t\t\t\tv-model=\"quiz\"\n\t\t\t\t\t\tdoctype=\"Quiz\"\n\t\t\t\t\t\t:label=\"__('Select a quiz')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else-if=\"type == 'exam'\"\n\t\t\t\t\t\tv-model=\"exam\"\n\t\t\t\t\t\tdoctype=\"Exam Activity\"\n\t\t\t\t\t\t:label=\"__('Select an exam')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tv-model=\"assignment\"\n\t\t\t\t\t\tdoctype=\"Assignment Activity\"\n\t\t\t\t\t\t:label=\"__('Select an assignment')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex justify-end space-x-2\">\n\t\t\t\t\t<Button variant=\"solid\" @click=\"addAssessment()\">\n\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, Button } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\nimport Link from '@/components/Controls/Link.vue'\n\nconst show = ref(false)\nconst quiz = ref(null)\nconst assignment = ref(null)\nconst exam = ref(null)\n\nconst props = defineProps({\n\ttype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tonAddition: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\n\nonMounted(async () => {\n\tawait nextTick()\n\tshow.value = true\n})\n\nconst addAssessment = () => {\n\tif (props.type == 'quiz') {\n\t\tprops.onAddition(quiz.value)\n\t} else if (props.type == 'exam') {\n\t\tprops.onAddition(exam.value)\n\t} else {\n\t\tprops.onAddition(assignment.value)\n\t}\n\tshow.value = false\n}\n\nconst redirectToForm = () => {\n\tif (props.type == 'quiz') window.open('/seminary/quizzes/new', '_blank')\n\telse if (props.type == 'exam') window.open('/seminary/exams/new', '_blank')\n\telse window.open('/seminary/assignments/new', '_blank')\n}\n</script>","import QuizBlock from '@/components/QuizBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { CircleHelp } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Quiz {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CircleHelp, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Quiz'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderQuiz(this.data.quiz)\n\t\t} else {\n\t\t\tthis.renderQuizModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderQuiz(quiz) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(QuizBlock, {\n\t\t\t\tquiz: quiz,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Quiz: ${quiz}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderQuizModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'quiz',\n\t\t\tonAddition: (quiz) => {\n\t\t\t\tthis.data.quiz = quiz\n\t\t\t\tthis.renderQuiz(quiz)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tquiz: this.data.quiz,\n\t\t}\n\t}\n}","<template>\n\t<div\n\t\tv-if=\"assignment.data\"\n\t\tclass=\"grid grid-cols-[65%,35%] h-full\"\n\t\t:class=\"{ 'border rounded-lg': !showTitle }\"\n\t>\n\t\t<div class=\"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t<div v-if=\"showTitle\" class=\"text-lg font-semibold mb-5 text-ink-gray-9\">\n\t\t\t\t<div v-if=\"submissionName === 'new'\">\n\t\t\t\t\t{{ __('Submission by') }} {{ user.data?.full_name }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('Submission by') }} {{ submissionResource.doc?.member_name }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"text-sm text-ink-gray-7 font-medium mb-2\">\n\t\t\t\t{{ __('Question') }}:\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-html=\"assignment.data.question\"\n\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal\"\n\t\t\t></div>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col\">\n\t\t\t<div class=\"p-5\">\n\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t<div class=\"font-semibold text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Submission') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t<Badge v-if=\"isDirty\" theme=\"orange\">\n\t\t\t\t\t\t\t{{ __('Not Saved') }} \n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tv-else-if=\"submissionResource.doc?.status\"\n\t\t\t\t\t\t\t:theme=\"statusTheme\"\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ submissionResource.doc?.status }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Button variant=\"solid\" @click=\"submitAssignment()\">\n\t\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"\n\t\t\t\t\t\tsubmissionName != 'new' &&\n\t\t\t\t\t\t!['Pass', 'Fail', 'Graded'].includes(submissionResource.doc?.status) &&\n\t\t\t\t\t\tsubmissionResource.doc?.owner == user.data?.name\n\t\t\t\t\t\"\n\t\t\t\t\tclass=\"bg-blue-200 p-3 rounded-md leading-5 text-sm mb-4\"\n\t\t\t\t>\n\t\t\t\t\t{{ __(\"You've successfully submitted the assignment.\") }}\n\t\t\t\t\t{{\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\"Once the moderator grades your submission, you'll find the details here.\"\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t\t{{ __('Feel free to make edits to your submission if needed, until it is graded.') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showUploader()\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t{{ __('Add your assignment as {0}').format(assignment.data.type) }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FileUploader\n\t\t\t\t\t\tv-if=\"!submissionFile\"\n\t\t\t\t\t\t:fileTypes=\"getType()\"\n\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t@success=\"(file) => saveSubmission(file)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t: __('Upload File')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FileUploader>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<div class=\"flex text-ink-gray-7\">\n\t\t\t\t\t\t\t<div class=\"border self-start rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t:href=\"submissionFile.file_url\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\tclass=\"flex flex-col cursor-pointer !no-underline\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t{{ submissionFile.file_name }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-5 mt-1\">\n\t\t\t\t\t\t\t\t\t{{ getFileSize(submissionFile.file_size) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<X\n\t\t\t\t\t\t\t\tv-if=\"canModifyAssignment\"\n\t\t\t\t\t\t\t\t@click=\"removeSubmission()\"\n\t\t\t\t\t\t\t\tclass=\"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"assignment.data.type == 'URL'\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t{{ __('Enter a URL') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"answer\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:readonly=\"!canModifyAssignment\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<div class=\"text-sm mb-4\">\n\t\t\t\t\t\t{{ __('Write your answer here') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t:content=\"answer\"\n\t\t\t\t\t\t@change=\"(val) => (answer = val)\"\n\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"\n\t\t\t\t\t\tuser.data?.name == submissionResource.doc?.owner &&\n\t\t\t\t\t\tsubmissionResource.doc?.comments\n\t\t\t\t\t\"\n\t\t\t\t\tclass=\"mt-8 p-3 bg-blue-200 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2\">\n\t\t\t\t\t\t{{ __('Comments by') }}: {{ submissionResource.doc?.evaluator || __('Evaluator') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"leading-5\">\n\t\t\t\t\t\t<div v-html=\"submissionResource.doc.comments\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Grading -->\n\t\t\t\t<div v-if=\"canGradeSubmission\" class=\"mt-8 space-y-4\">\n\t\t\t\t\t<div class=\"font-semibold mb-2 text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Grading') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-if=\"submissionResource.doc\"\n\t\t\t\t\t\tv-model=\"submissionResource.doc.status\"\n\t\t\t\t\t\t:label=\"__('Grading Status')\"\n\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t:options=\"submissionStatusOptions\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-if=\"submissionResource.doc\"\n\t\t\t\t\t\tv-model=\"submissionResource.doc.grade\"\n\t\t\t\t\t\t:label=\"__('Score')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t{{ __('Comments') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t\t:content=\"comments\"\n\t\t\t\t\t\t\t@change=\"\n\t\t\t\t\t\t\t\t(val) => {\n\t\t\t\t\t\t\t\t\tcomments = val\n\t\t\t\t\t\t\t\t\tisDirty = true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tcall,\n\tcreateResource,\n\tcreateDocumentResource,\n\tFileUploader,\n\tFormControl,\n\tTextEditor,\n\ttoast\n} from 'frappe-ui'\nimport { computed, inject, onMounted, onBeforeUnmount, ref, watch } from 'vue'\nimport { FileText, X } from 'lucide-vue-next'\nimport { getFileSize } from '@/utils'\nimport { useRouter } from 'vue-router'\n\nconst submissionFile = ref(null)\nconst answer = ref(null)\nconst comments = ref(null)\nconst router = useRouter()\nconst user = inject('$user')\nconst showTitle = router.currentRoute.value.name == 'AssignmentSubmission'\nconst isDirty = ref(false)\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tsubmissionName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n})\n\nonMounted(() => {\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tconsole.log('User: ', user.data)\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitAssignment()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst assignment = createResource({\n\turl: 'frappe.client.get',\n\tparams: {\n\t\tdoctype: 'Assignment Activity',\n\t\tname: props.assignmentID,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (props.submissionName != 'new') {\n\t\t\tsubmissionResource.reload()\n\t\t}\n\t},\n})\n\nconst newSubmission = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tlet doc = {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tassignment: props.assignmentID,\n\t\t\tmember: user.data?.name,\n\t\t\tcourse: router.currentRoute.value.params.courseName\n\t\t}\n\t\tif (showUploader()) {\n\t\t\tdoc.assignment_attachment = submissionFile.value.file_url\n\t\t} else {\n\t\t\tdoc.answer = answer.value\n\t\t}\n\t\treturn {\n\t\t\tdoc: doc,\n\t\t}\n\t},\n})\n\nconst imageResource = createResource({\n\turl: 'seminary.seminary.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tsubmissionFile.value = data\n\t},\n})\n\nconst submissionResource = createDocumentResource({\n\tdoctype: 'Assignment Submission',\n\tname: props.submissionName,\n\tonError(err) {\n\t\ttoast.error(err.messages?.[0] || err)\n\t},\n\tauto: false,\n\tcache: [user.data?.name, props.assignmentID],\n})\n\nwatch(submissionResource, () => {\n\tif (submissionResource.doc) {\n\t\tif (submissionResource.doc.assignment_attachment) {\n\t\t\timageResource.reload({\n\t\t\t\timage: submissionResource.doc.assignment_attachment,\n\t\t\t})\n\t\t}\n\t\tif (submissionResource.doc.answer) {\n\t\t\tanswer.value = submissionResource.doc.answer\n\t\t}\n\t\tif (submissionResource.doc.comments) {\n\t\t\tcomments.value = submissionResource.doc.comments\n\t\t}\n\t\tif (submissionResource.isDirty) {\n\t\t\tisDirty.value = true\n\t\t} else if (showUploader() && !submissionFile.value) {\n\t\t\tisDirty.value = true\n\t\t} else if (!showUploader() && !answer.value) {\n\t\t\tisDirty.value = true\n\t\t} else {\n\t\t\tisDirty.value = false\n\t\t}\n\t}\n})\n\nwatch(submissionFile, () => {\n\tif (props.submissionName == 'new' && submissionFile.value) {\n\t\tisDirty.value = true\n\t}\n})\n\nwatch(\n  () => submissionResource.doc?.grade,\n  (newGrade, oldGrade) => {\n    if (newGrade !== oldGrade && submissionResource.doc) {\n      submissionResource.doc.status = 'Graded'; // Automatically set status to \"Graded\"\n      isDirty.value = true; // Mark the form as dirty to indicate unsaved changes\n    }\n  }\n);\n\nconst submitAssignment = () => {\n\tif (props.submissionName != 'new') {\n\t\tlet evaluator =\n\t\t\tsubmissionResource.doc && submissionResource.doc.owner != user.data?.name\n\t\t\t\t? user.data?.name\n\t\t\t\t: null\n\n\t\tsubmissionResource.setValue.submit(\n\t\t\t{\n\t\t\t\t...submissionResource.doc,\n\t\t\t\tassignment_attachment: submissionFile.value?.file_url,\n\t\t\t\tevaluator: evaluator,\n\t\t\t\tcomments: comments.value,\n\t\t\t\tanswer: answer.value,\n\t\t\t\t\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(__('Changed successfully'))\n\t\t\t\t\tisDirty.value = false;\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t} else {\n\t\taddNewSubmission()\n\t}\n}\n\nconst addNewSubmission = () => {\n\tnewSubmission.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Assignment submitted successfully'))\n\t\t\t\tif (router.currentRoute.value.name == 'AssignmentSubmission') {\n\t\t\t\t\trouter.push({\n\t\t\t\t\t\tname: 'AssignmentSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tassignmentID: props.assignmentID,\n\t\t\t\t\t\t\tsubmissionName: data.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tmarkLessonProgress()\n\t\t\t\t\trouter.go()\n\t\t\t\t}\n\t\t\t\tsubmissionResource.name = data.name\n\t\t\t\tisDirty.value = false;\n\t\t\t\tsubmissionResource.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveSubmission = (file) => {\n\tisDirty.value = true\n\tsubmissionFile.value = file\n}\n\nconst markLessonProgress = () => {\n\tif (router.currentRoute.value.name == 'Lesson') {\n\t\tlet courseName = router.currentRoute.value.params.courseName\n\t\tlet chapterNumber = router.currentRoute.value.params.chapterNumber\n\t\tlet lessonNumber = router.currentRoute.value.params.lessonNumber\n\t\tconsole.log(\"Chapter Number: \", chapterNumber)\n\t\tconsole.log(\"Lesson Number: \", lessonNumber)\n\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: courseName,\n\t\t\tchapter_number: chapterNumber,\n\t\t\tlesson_number: lessonNumber,\n\t\t})\n\t}\n}\n\nconst getType = () => {\n\tconst type = assignment.data?.type\n\tif (type == 'Image') {\n\t\treturn ['image/*']\n\t} else if (type == 'Document') {\n\t\treturn [\n\t\t\t'.doc',\n\t\t\t'.docx',\n\t\t\t'.xml',\n\t\t\t'application/msword',\n\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t]\n\t} else if (type == 'PDF') {\n\t\treturn ['.pdf']\n\t}\n}\n\nconst validateFile = (file) => {\n\tlet type = assignment.data?.type\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (type == 'Image' && !['jpg', 'jpeg', 'png'].includes(extension)) {\n\t\treturn 'Only image file is allowed.'\n\t} else if (\n\t\ttype == 'Document' &&\n\t\t!['doc', 'docx', 'xml'].includes(extension)\n\t) {\n\t\treturn 'Only document file is allowed.'\n\t} else if (type == 'PDF' && !['pdf'].includes(extension)) {\n\t\treturn 'Only PDF file is allowed.'\n\t}\n}\n\nconst removeSubmission = () => {\n\tisDirty.value = true\n\tsubmissionFile.value = null\n}\n\nconst canGradeSubmission = computed(() => {\n\treturn (\n\t\t(user.data?.is_moderator ||\n\t\t\tuser.data?.is_evaluator ||\n\t\t\tuser.data?.is_instructor) &&\n\t\tprops.submissionName != 'new' &&\n\t\trouter.currentRoute.value.name == 'AssignmentSubmission'\n\t)\n})\n\nconst canModifyAssignment = computed(() => {\n\treturn (\n\t\t!submissionResource.doc ||\n\t\t(submissionResource.doc?.owner == user.data?.name &&\n\t\t\tsubmissionResource.doc?.status == 'Not Graded')\n\t)\n})\n\nconst submissionStatusOptions = computed(() => {\n\treturn [\n\t\t{ label: 'Not Graded', value: 'Not Graded' },\n\t\t{ label: 'Graded', value: 'Graded' },\n\t\t{ label: 'Pass', value: 'Pass' },\n\t\t{ label: 'Fail', value: 'Fail' },\n\t]\n})\n\nconst statusTheme = computed(() => {\n\tif (!submissionResource.doc) {\n\t\treturn 'orange'\n\t} else if (submissionResource.doc.status == 'Pass' || submissionResource.doc.status == 'Graded') {\n\t\treturn 'green'\n\t} else if (submissionResource.doc.status == 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n})\n\nconst showUploader = () => {\n\treturn ['PDF', 'Image', 'Document'].includes(assignment.data?.type)\n}\n</script>\n","<template>\n\t<Assignment\n\t\tv-if=\"user.data && submission.data\"\n\t\t:assignmentID=\"assignmentID\"\n\t\t:submissionName=\"submission.data?.name || 'new'\"\n\t/>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the assignment.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject, watch } from 'vue'\nimport { Button, createResource } from 'frappe-ui'\nimport Assignment from '@/components/Assignment.vue'\n\nconst user = inject('$user')\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst submission = createResource({\n\turl: 'frappe.client.get_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tfieldname: 'name',\n\t\t\tfilters: {\n\t\t\t\tassignment: props.assignmentID,\n\t\t\t\tmember: user.data?.name,\n\t\t\t},\n\t\t}\n\t},\n\tauto: true,\n})\n</script>\n","import { Pencil } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport AssignmentBlock from '@/components/AssignmentBlock.vue'\nimport translationPlugin from '../translation'\nimport { usersStore } from '@/stores/user'\nimport router from '../router'\n\nexport class Assignment {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(Pencil, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Assignment'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderAssignment(this.data.assignment)\n\t\t} else {\n\t\t\tthis.renderAssignmentModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderAssignment(assignment) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(AssignmentBlock, {\n\t\t\t\tassignmentID: assignment,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Assignment: ${assignment}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderAssignmentModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'assignment',\n\t\t\tonAddition: (assignment) => {\n\t\t\t\tthis.data.assignment = assignment\n\t\t\t\tthis.renderAssignment(assignment)\n\t\t\t},\n\t\t\t\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tassignment: this.data.assignment,\n\t\t}\n\t}\n}\n","<template>\n  <div v-if=\"submisisonDetails.loading\" class=\"text-center py-5\">\n    <p>Loading submission details...</p>\n  </div>\n  <div v-else-if=\"submisisonDetails.doc\" class=\"space-y-5\">\n    <div class=\"grid grid-cols-3 gap-3\">\n      <!-- Left Section (3/3 width) -->\n      <div class=\"col-span-3 space-y-4\">\n        <div class=\"space-y-4 border p-2 rounded-md\">\n          <div class=\"flex items-center justify-between py-4\">\n            <!-- Exam Percentage -->\n            <div class=\"text-center ml-5\">\n              <div class=\"text-3xl font-bold text-ink-gray-9\">\n                {{ submisisonDetails.doc.percentage || 0 }}%\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Score</div>\n            </div>\n\n            <!-- Score and Time Taken -->\n            <div class=\"text-center\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9\">\n                {{ submisisonDetails.doc.score }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">\n                Out of {{ submisisonDetails.doc.score_out_of }} Points\n              </div>\n            </div>\n            <div class=\"text-center mr-5\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9 mt-2\">\n                {{ formatTime(submisisonDetails.doc.time_taken) }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Time taken</div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Questions Section -->\n        <div\n          v-for=\"(row, index) in submisisonDetails.doc.result\"\n          :key=\"index\"\n          class=\"border p-5 rounded-md space-y-4 \"\n        >\n          <!-- Question Title -->\n          <div class=\"space-y-1\">\n            <div class=\"font-semibold text-ink-gray-9 text-left\">\n              {{ __('Question') }} {{ index + 1 }}:\n            </div>\n            <div class=\"leading-5 text-ink-gray-9 text-left\" v-html=\"row.question_name\"></div>\n          </div>\n          <!-- Answer -->\n          <div class=\"leading-5 text-ink-gray-7 space-x-1 text-left\">\n            <span> {{ __('Your Answer') }}: </span>\n            <span v-html=\"row.answer\"></span>\n          </div>\n          <!-- Points -->\n          <div class=\"flex justify-end items-center space-x-2\">\n            <span class=\"text-sm text-ink-gray-7 text-xl\">\n              {{ row.points }} / {{ parseInt(row.points_out_of, 10) }} {{ __('Points') }}\n            </span>\n          </div>\n          <!-- Comments -->\n          <div v-if=\"row.comments\" class=\"leading-5 text-ink-gray-7 text-xl space-x-1 text-left\">\n            <span> {{ __('Comments') }}: </span>\n            <span v-html=\"row.comments\"></span>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  </div>\n  <div v-else>\n    <p>Debug: No submission details found.</p>\n  </div>\n</template>\n\n<script setup>\nimport { createDocumentResource } from 'frappe-ui';\nimport { watch, inject } from 'vue';\n\n\n// const socket = inject('$socket')\n// if (socket) {\n  \n//     console.log('ExamGraded socket :', socket); // Debugging log\n   \n//   } else {\n//     console.log('ExamGraded socket is not available'); // Debugging log\n//   }\n\nconst props = defineProps({\n  submission: {\n    type: Object,\n    required: true,\n  },\n});\n\nconsole.log('ExamGraded received submission:', props.submission); // Debugging log\n\nconst submisisonDetails = createDocumentResource({\n  doctype: 'Exam Submission',\n  name: props.submission,\n  auto: true,\n});\nconsole.log('ExamGraded submisisonDetails:', submisisonDetails); // Debugging log\n\nwatch(\n  () => submisisonDetails.doc,\n  (newDoc) => {\n    submisisonDetails.loading = false;\n    console.log('ExamGraded updated with new submission details:', newDoc); // Debugging log\n  }\n);\n\nconst formatTime = (seconds) => {\n  if (!seconds) return '00:00:00'; // Handle null or undefined values\n  const hrs = Math.floor(seconds / 3600).toString().padStart(2, '0');\n  const mins = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${hrs}:${mins}:${secs}`;\n};\n</script>","<template>\n\t<Tooltip :text=\"user.full_name\">\n\t\t<Avatar\n\t\t\tclass=\"avatar border border-outline-gray-2 cursor-auto\"\n\t\t\tv-if=\"user\"\n\t\t\t:label=\"user.full_name\"\n\t\t\t:image=\"user.user_image\"\n\t\t\t:size=\"size\"\n\t\t\tv-bind=\"$attrs\"\n\t\t/>\n\t</Tooltip>\n</template>\n<script setup>\nimport { Avatar, Tooltip } from 'frappe-ui'\nconst props = defineProps({\n\tuser: {\n\t\ttype: Object,\n\t\tdefault: null,\n\t},\n\tsize: {\n\t\ttype: String,\n\t},\n})\n</script>\n","<template>\n\t<div class=\"mt-6\">\n\t\t<div v-if=\"!singleThread\" class=\"flex items-center mb-5\">\n\t\t\t<Button variant=\"outline\" @click=\"showTopics = true\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ChevronLeft class=\"w-5 h-5 stroke-1.5 text-ink-gray-7\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<span class=\"text-lg font-semibold ml-2 text-ink-gray-9\">\n\t\t\t\t{{ topic.title }}\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div v-for=\"(reply, index) in replies.data\" :key=\"reply.name\">\n\t\t\t<div\n\t\t\t\tclass=\"py-3\"\n\t\t\t\t:class=\"{ 'border-b': index + 1 != replies.data.length }\"\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center justify-between mb-2\">\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<UserAvatar :user=\"reply.user\" class=\"mr-2\" />\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ reply.user?.full_name || reply.owner }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-2\">\n\t\t\t\t\t\t\t{{ timeAgo(reply.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Dropdown\n\t\t\t\t\t\tv-if=\"user.data.name == reply.owner && !reply.editable\"\n\t\t\t\t\t\t:options=\"[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Edit',\n\t\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\t\treply.editable = true\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Delete',\n\t\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\t\tdeleteReply(reply)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t<MoreHorizontal class=\"w-4 h-4 stroke-1.5 cursor-pointer\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t\t<div v-if=\"reply.editable\">\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"postEdited(reply)\">\n\t\t\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"reply.editable = false\">\n\t\t\t\t\t\t\t{{ __('Discard') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"reply.editable\">\n\t\t\t\t\t<TextEditor\n\t\t\t\t\t:content=\"reply.reply\"\n\t\t\t\t\t@change=\"(val) => (reply.reply = val)\"\n\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t:editorClass=\"'ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none'\"\n\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"formatted-reply\">\n\t\t\t\t\t<div v-html=\"reply.reply\" class=\"p-2\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<textarea\n\t\t\tv-show=\"renderEditor\"\n\t\t\tclass=\"mt-5\"\n\t\t\t:value=\"newReply\"\n\t\t\t@input=\"(value) => (newReply = value)\"\n\t\t\tplaceholder=\"Type your reply here...\"\n\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t/>\n\t\t<div class=\"flex justify-between mt-2\">\n\t\t\t<span> </span>\n\t\t\t<Button @click=\"postReply()\">\n\t\t\t\t<span>\n\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t</span>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { createResource, TextEditor, Button, Dropdown } from 'frappe-ui'\nimport { timeAgo } from '../utils'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { ChevronLeft, MoreHorizontal } from 'lucide-vue-next'\nimport { ref, inject, onMounted, onUnmounted, toRaw, watch } from 'vue'\nimport { createToast } from '../utils'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst socket = initSocket(); // Initialize the socket once\nconst isLoadingUsers = ref(false); // Add a loading state\nconst showTopics = defineModel('showTopics')\nconst newReply = ref('')\nconst user = inject('$user')\nconsole.log('User data:', user.data.is_student); // Debugging log\nconst mentionUsers = ref([])\nconst renderEditor = ref(false); // Keep it false initially\n\nconst props = defineProps({\n\ttopic: {\n\t\ttype: Object,\n\t\trequired: true,\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n})\nconst editorKey = `editor-${props.topic.name}`; // Set the key based on the topic name\n\nonMounted(() => {\n\tconsole.log('DiscussionReplies mounted. Registering socket listeners.');\n\tconsole.log('Topic received:', props.topic.name); // Debugging log\n\n\t// Call fetchMentionUsers to ensure renderEditor is updated\n\tfetchMentionUsers();\n\n\treplies.reload(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tconsole.log('Replies fetched successfully:', data); // Debugging log\n\t\t\t},\n\t\t\tonError(error) {\n\t\t\t\tconsole.error('Error fetching replies:', error); // Debugging log\n\t\t\t},\n\t\t}\n\t);\n\n\tsocket.on('publish_message', (data) => {\n\t\treplies.reload();\n\t});\n\tsocket.on('update_message', (data) => {\n\t\treplies.reload();\n\t});\n\tsocket.on('delete_message', (data) => {\n\t\treplies.reload();\n\t});\n\n\t// Defer rendering the editor until the component is fully mounted\n\trenderEditor.value = true;\n\tconsole.log('TextEditor renderEditor set to true.');\n\tconsole.log('Editor key:', editorKey); // Debugging log\n\t\n});\n\nwatch(\n\tprops.topic,\n\t(newTopic, oldTopic) => {\n\t\tif (newTopic.name !== oldTopic.name) {\n\t\t\teditorKey.value = `editor-${newTopic.name}`; // Update key when topic changes\n\t\t\tconsole.log('Editor key updated:', editorKey.value);\n\t\t}\n\t}\n);\n\nwatch(\n\tnewReply,\n\t(value) => {\n\t\tconsole.log('New reply value:', value); // Debugging log\n\t\tif (!value) {\n\t\t\tconsole.warn('Reply is empty. Ensure the input is being updated correctly.');\n\t\t}\n\t}\n);\n\nwatch(\n\trenderEditor,\n\t(value) => {\n\t\tif (value) {\n\t\t\tconsole.log('TextEditor is now visible and ready for initialization.');\n\t\t}\n\t}\n);\n\nconst replies = createResource({\n  url: 'seminary.seminary.utils.get_discussion_replies',\n  auto: false, // Do not fetch automatically\n  makeParams() {\n    return {\n      topic: props.topic.name,\n    };\n  },\n  onSuccess(data) {\n    console.log('Replies fetched successfully:', data); // Debugging log\n  },\n  onError(error) {\n    console.error('Error fetching replies:', error); // Debugging log\n  },\n});\n\n\nconst newReplyResource = createResource({\n\turl: 'seminary.seminary.utils.insert_discussion_reply',\n\tmakeParams(values) {\n\t\treturn {\t\t\n\t\t\t\treply: newReply.value, // Use newReply.value directly\n\t\t\t\ttopic: props.topic.name,\n\t\t\t\n\t\t}\n\t},\n\tonSuccess(data) {\n    console.log('Discussion saved successfully:', data); // Debugging log\n  },\n  onError(error) {\n    console.error('Error inserting replies:', error); // Debugging log\n  },\n});\n\nconst fetchMentionUsers = () => {\n\tconsole.log('User data in fetchMentionUsers:', user.data); // Debugging log\n  if (user.data?.is_student) {\n    renderEditor.value = true;\n  } else {\n    isLoadingUsers.value = true; // Set loading state\n    allUsers.reload(\n      {},\n      {\n        onSuccess(data) {\n          mentionUsers.value = Object.values(data).map((user) => {\n            return {\n              value: user.name,\n              label: user.full_name,\n            };\n          });\n          renderEditor.value = true; // Render the editor after users are loaded\n          isLoadingUsers.value = false; // Reset loading state\n        },\n        onError(err) {\n          console.error('Error fetching mention users:', err);\n          isLoadingUsers.value = false; // Reset loading state\n        },\n      }\n    );\n  }\n};\n\nconst postReply = () => {\n\tnewReplyResource.submit(\n\t\t{},\n\t\t{\n\t\t\n\t\t\tonSuccess() {\n\t\t\t\tnewReply.value = ''\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tcreateToast({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\ttext: err.messages?.[0] || err,\n\t\t\t\t\ticon: 'x',\n\t\t\t\t\ticonClasses: 'bg-surface-red-5 text-ink-white rounded-md p-px',\n\t\t\t\t\tposition: 'top-center',\n\t\t\t\t\ttimeout: 10,\n\t\t\t\t})\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editReplyResource = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t\tfieldname: 'reply',\n\t\t\tvalue: values.reply,\n\t\t}\n\t},\n})\n\nconst postEdited = (reply) => {\n\teditReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t\treply: reply.reply,\n\t\t},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!reply.reply) {\n\t\t\t\t\treturn 'Reply cannot be empty'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\treply.editable = false\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst deleteReplyResource = createResource({\n\turl: 'frappe.client.delete',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t}\n\t},\n})\n\nconst deleteReply = (reply) => {\n\tdeleteReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst allUsers = createResource({\n\t\turl: 'seminary.seminary.utils.get_all_users',\n\t\t\n\t})\nconsole.log('All Users:', allUsers) // Debugging log\n</script>\n","<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:disableOutsideClickToClose=\"true\"\n\t\t:options=\"dialogOptions\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"discussion-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto\">\n\t\t\t\t<div>\n\t\t\t\t\t<FormControl v-model=\"topic.title\" :label=\"__('Title')\" type=\"text\" />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"mb-1.5 text-sm text-ink-gray-5\">\n\t\t\t\t\t\t{{ __('Details') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t:content=\"topic.reply\"\n\t\t\t\t\t\t@change=\"(val) => (topic.reply = val)\"\n\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FormControl, TextEditor, createResource, toast } from 'frappe-ui'\nimport { computed, reactive, watch } from 'vue'\nimport { singularize } from '@/utils'\n\nconst show = defineModel()\nconst topics = defineModel('reloadTopics')\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst topic = reactive({\n\ttitle: '',\n\treply: '',\n})\n\nconst resetTopic = () => {\n\ttopic.title = ''\n\ttopic.reply = ''\n}\n\nconst topicResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Topic',\n\t\t\t\treference_doctype: props.doctype,\n\t\t\t\treference_docname: props.docname,\n\t\t\t\ttitle: topic.title,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst replyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Reply',\n\t\t\t\ttopic: values.topic,\n\t\t\t\treply: topic.reply,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitTopic = (close) => {\n\ttopicResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!topic.title) {\n\t\t\t\t\treturn 'Title cannot be empty.'\n\t\t\t\t}\n\t\t\t\tif (!topic.reply) {\n\t\t\t\t\treturn 'Reply cannot be empty.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess(data) {\n\t\t\t\treplyResource.submit(\n\t\t\t\t\t{\n\t\t\t\t\t\ttopic: data.name,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\tshow.value = false\n\t\t\t\t\t\ttopics.value.reload()\n\t\t\t\t\t\tresetTopic()\n\t\t\t\t\t\tclose()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst handleCancel = (close) => {\n\tshow.value = false\n\tresetTopic()\n\tclose?.()\n}\n\nwatch(show, (value) => {\n\tif (!value) {\n\t\tresetTopic()\n\t}\n})\n\nconst dialogOptions = computed(() => ({\n\ttitle: singularize(props.title),\n\tsize: '2xl',\n\tactions: [\n\t\t{\n\t\t\tlabel: __('Post'),\n\t\t\tvariant: 'solid',\n\t\t\tonClick: (close) => submitTopic(close),\n\t\t},\n\t\t{\n\t\t\tlabel: __('Cancel'),\n\t\t\tvariant: 'text',\n\t\t\tonClick: (close) => handleCancel(close),\n\t\t},\n\t],\n}))\n</script>\n","export function scrollTo(...options) {\n\tif (!options || options.length === 0) return\n\tconst container = getScrollContainer()\n\tif (!container) return\n\tcontainer.scrollTo(...options)\n}\n\nexport function getScrollContainer() {\n\t// window.scrollContainer is reference to the scroll container in DesktopLayout.vue and MobileLayout.vue\n\treturn window.scrollContainer\n}\n","<template>\n\t<div>\n\t\t<Button v-if=\"!singleThread && props.type === 'multi'\"  class=\"float-right\" @click=\"openTopicModal()\">\n\t\t\t{{ __('New {0}').format(singularize(title)) }}\n\t\t</Button>\n\t\t<div class=\"text-xl font-semibold text-ink-gray-9\">\n\t\t\t{{ __(title) }}\n\t\t</div>\n\t</div>\n\t<div v-if=\"loading && props.type === 'single'\">\n\t\t<div class=\"text-center py-10\">\n\t\t\t<span>Loading discussion...</span>\n\t\t</div>\n\t</div>\n\t<div v-if=\"props.type === 'single' && !loading\">\n\t\t\n\t\t<div\n\t\tclass=\"flex flex-col items-center justify-center\"\n\t>\n\t\n\t</div>\n\t\t<DiscussionModal\n\t\tv-model=\"showTopicModal\"\n\t\t:title=\"title\"\n\t\t:doctype=\"props.doctype\"\n\t\t:docname=\"props.docname\"\n\t\t\n\t/>\n\t\t<DiscussionReplies v-if=\"currentTopic.value\" :topic=\"currentTopic.value\" :singleThread=\"true\" v-model:showTopics=\"showTopics\"/>\n\t</div>\n\t<div v-if=\"topics.data?.length && !singleThread\">\n\t\t<div v-if=\"showTopics\" v-for=\"(topic, index) in topics.data\" :key=\"index\">\n\t\t\t<div\n\t\t\t\t@click=\"showReplies(topic)\"\n\t\t\t\tclass=\"flex items-center cursor-pointer py-5 w-full\"\n\t\t\t\t:class=\"{ 'border-b': index + 1 != topics.data.length }\"\n\t\t\t>\n\t\t\t\t<UserAvatar :user=\"topic.user\" size=\"2xl\" class=\"mr-4\" />\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"text-lg font-semibold mb-1 text-ink-gray-7\">\n\t\t\t\t\t\t{{ topic.title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ topic.user.full_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-3\">\n\t\t\t\t\t\t\t{{ timeAgo(topic.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else>\n\t\t\t<DiscussionReplies\n\t\t\t\t:topic=\"currentTopic\"\n\t\t\t\tv-model:showTopics=\"showTopics\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n\t<div\n\t\tv-else\n\t\tclass=\"flex flex-col items-center justify-center border-2 border-dashed mt-5 py-8 rounded-md\"\n\t>\n\t\t<MessageSquareText class=\"w-7 h-7 text-ink-gray-4 stroke-1.5 mr-2\" />\n\t\t<div class=\"\">\n\t\t\t<div v-if=\"emptyStateTitle\" class=\"font-medium mb-2\">\n\t\t\t\t{{ __(emptyStateTitle) }}\n\t\t\t</div>\n\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t{{ __(emptyStateText) }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<DiscussionModal\n\t\tv-model=\"showTopicModal\"\n\t\t:title=\"__('New {0}').format(title)\"\n\t\t:doctype=\"props.doctype\"\n\t\t:docname=\"props.docname\"\n\t\tv-model:reloadTopics=\"topics\"\n\t/>\n</template>\n<script setup>\nconsole.log('Discussions.vue script setup executed'); // Debugging: Ensure script is running\n\nimport { createResource, Button } from 'frappe-ui'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { singularize, timeAgo } from '../utils'\nimport { ref, onMounted, inject, watch } from 'vue'\nimport DiscussionReplies from '@/components/DiscussionReplies.vue'\nimport DiscussionModal from '@/components/Modals/DiscussionModal.vue'\nimport { MessageSquareText } from 'lucide-vue-next'\nimport { getScrollContainer } from '@/utils/scrollContainer'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst showTopics = ref(true)\nconst currentTopic = ref(null)\nconst user = inject('$user')\nconst showTopicModal = ref(false)\nconst loading = ref(true); // Add a loading state\nconst socketConnected = ref(false); // Track socket connection status\n\n// Initialize the socket directly\nconst socket = initSocket(); // Use the default namespace or specify one if needed\n\nif (!socket) {\n  console.error('Socket connection not initialized in Discussions.vue.');\n} else {\n  console.log('Socket connection initialized in Discussions.vue:', socket);\n\n  // Add event listeners for debugging and connection tracking\n  socket.on('connect', () => {\n    console.log('Socket connected:', socket.id);\n    socketConnected.value = true; // Mark socket as connected\n  });\n\n  socket.on('connect_error', (error) => {\n    console.error('Socket connection error:', error);\n  });\n\n  socket.on('disconnect', (reason) => {\n    console.warn('Socket disconnected:', reason);\n    socketConnected.value = false; // Mark socket as disconnected\n  });\n}\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\temptyStateTitle: {\n\t\ttype: String,\n\t\tdefault: '',\n\t},\n\temptyStateText: {\n\t\ttype: String,\n\t\tdefault: 'Start a discussion',\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\tscrollToBottom: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\ttype: {\n    type: String,\n    default: 'multi', // Default to multi-topic mode but can be single for assignment feedback\n  },\n})\n\n// Watch for socket connection and execute onMounted logic once connected\nwatch(socketConnected, (isConnected) => {\n  if (isConnected) {\n    console.log('Socket is connected, proceeding with onMounted logic.');\n    executeOnMountedLogic();\n  }\n});\n\nconst executeOnMountedLogic = () => {\n  console.log('onMounted logic executed'); // Debugging: Ensure this is called\n  console.log('Props:', props); // Debugging: Log props\n\n  if (user.data) {\n    if (props.type === 'single') {\n      console.log('Single-topic mode detected'); // Debugging\n      singleTopicResource.reload(); // Trigger the resource to fetch the single topic\n\t  console.log('Topic', currentTopic.value)\n    } else {\n      loading.value = false; // Immediately stop loading for multi-topic mode\n    }\n    topics.reload();\n  }\n\n  socket.on('new_discussion_topic', (data) => {\n    topics.refresh();\n  });\n\n  if (props.scrollToBottom) {\n    setTimeout(() => {\n      scrollToEnd();\n    }, 100);\n  }\n};\n\nconst scrollToEnd = () => {\n\tlet scrollContainer = getScrollContainer()\n\tscrollContainer.scrollTop = scrollContainer.scrollHeight\n}\n\nconst singleTopicResource = createResource({\n  url: 'seminary.seminary.utils.ensure_single_topic',\n  cache: false, // No need to cache this since it's a one-time call\n  makeParams() {\n    return {\n      doctype: props.doctype,\n      docname: props.docname,\n      title: props.title,\n    };\n  },\n  onSuccess(data) {\n    console.log('Ensure single topic response:', data); // Debugging\n    if (data) {\n      currentTopic.value = data; // Set the single topic as the current topic\n\t  console.log('Current topic set:', currentTopic.value); // Debugging\n      showTopics.value = false; // Automatically show replies for the single topic\n\t  loading.value = false; // Mark loading as complete\n    }\n    console.log('Changed loading to:', loading.value); // Debugging\n  },\n  onError(error) {\n    console.error('Error ensuring single topic:', error); // Log the error\n    loading.value = false; // Ensure loading is stopped even on error\n  },\n});\n\n\nconst topics = createResource({\n\turl: 'seminary.seminary.utils.get_discussion_topics',\n\tcache: ['topics', props.doctype, props.docname],\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: props.doctype,\n\t\t\tdocname: props.docname,\n\t\t\tsingle_thread: props.singleThread,\n\t\t}\n\t},\n})\n\nconst showReplies = (topic) => {\n\tshowTopics.value = false\n\tcurrentTopic.value = topic\n}\n\nconst openTopicModal = () => {\n\tshowTopicModal.value = true\n}\n</script>\n","<template>\n  <div v-if=\"isExamLoaded\">\n    <!-- Exam Header -->\n    <div  v-if=\"!hasSubmittedExam\" class=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\">\n      <div class=\"leading-5\">\n        {{ `This exam consists of ${exam.data.questions.length}` }}\n        {{ exam.data.questions.length === 1 ? 'question' : 'questions' }}.\n      </div>\n      <div v-if=\"exam.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`Please ensure that you complete all the questions in ${exam.data.duration} minutes.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"exam.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t(\n\t\t\t\t\t\t'If you fail to do so, the exam will be automatically submitted when the timer ends.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n    </div>\n    \t      \n        <div v-if=\"hasSubmittedExam && (submission_anystatus?.data || attempts.data?.[0])\" class=\"space-y-4 border p-5 rounded-md\">\n          <Discussions\n            :title=\"'Exam Comments'\"\n            :doctype=\"'Exam Submission'\"\n            :docname=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\"\n            :key=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\"\n            type=\"single\"\n          />\n        </div>\n      \n    <div v-if=\"exam.data.duration && !hasSubmittedExam\" class=\"flex flex-col space-x-1 my-4\">\n\t\t\t<div class=\"mb-2\">\n\t\t\t\t<span class=\"\"> {{ ('Time') }}: </span>\n\t\t\t\t<span class=\"font-semibold\">\n\t\t\t\t\t{{ formatTimer(timer) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ProgressBar :progress=\"timerProgress\" />\n\t\t</div>\n  \t\t<!-- Start Screen -->\n<div v-if=\"!fullExamMode && !is_instructor()\">\n  <div class=\"border text-center p-20 rounded-md\">\n    <div class=\"font-semibold text-lg\">\n      {{ exam.data.title }}\n    </div>\n    <Button\n      v-if=\"exam.data.qbyquestion && !hasSubmittedExam\"\n      @click=\"startExam\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start') }}</span>\n    </Button>\n    <Button\n      v-else-if=\"!hasSubmittedExam\"\n      @click=\"startExam2\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start Exam') }}</span>\n    </Button>\n    <div v-else-if=\"hasSubmittedExam && submission?.data?.name\" class=\"w-full max-w-4xl mx-auto py-5\">\n      <ExamGraded :submission=\"submission.data.name\" />\n    </div>\n    <div v-else >\n      {{ 'You have already submitted this exam. As soon as it is graded, you will see the feedback here.' }}\n    </div>\n  </div>\n</div>\n\n    <!-- Full Exam Mode -->\n    <div v-if=\"fullExamMode || is_instructor()\">\n      <div class=\"border text-center p-20 rounded-md\">\n  <div class=\"font-semibold text-lg text-ink-gray-9 mt-3 mb-3\">\n    {{ exam.data.title }}\n  </div>\n  <router-link\n    v-if=\"is_instructor()\"\n    :to=\"{\n      name: 'ExamForm',\n      params: {\n        examID: exam.data.name,\n      },\n    }\"\n    class=\"flex items-center text-gray-400 mb-3 mr-4 hover:text-gray-600\"\n  >\n    <SquarePen class=\"w-5 h-5 mr-2\" />\n    <span class=\"tooltip\" data-tooltip=\"Edit this exam\">Edit</span>\n  </router-link>\n  \n      <div v-for=\"(question, index) in exam.data.questions\" :key=\"question.name\" class=\"relative border rounded-md p-5 mb-4\">\n        <div class=\"absolute -top-3 -left-3 bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm\">\n            {{ index + 1 }}\n        </div>\n        \n            \n          <div class=\"text-ink-gray-9 text-sm font-semibold text-right\">\n            {{ question.points }} {{ question.points === 1 ? 'Point' : 'Points' }}\n          </div>\n        \n        <div class=\"text-ink-gray-9 text-left font-semibold mt-2 leading-5\">\n          <div v-html=\"question.question_detail || 'No question detail provided.'\"></div>\n        </div>\n        <div class=\"mt-4\">\n          <textarea\n            v-model=\"answers[question.name]\"\n            class=\"border rounded-md p-2 w-full\"\n            placeholder=\"Type your answer here\"\n            @change=\"(val) => updateAnswer(question.name, val)\" \n          />\n        </div>\n      </div>\n      <div class=\"text-center mt-4\">\n        <Button @click=\"submitExam\">\n          <span>{{ 'Submit Your Exam' }}</span>\n        </Button>\n      </div>\n    </div>\n  </div>\n  </div>\n</template>\n\n<script setup>\nimport {Badge, Button, call, createResource, TextEditor, FormControl, frappeRequest, toast} from 'frappe-ui'\nimport { ref, watch, reactive, inject, computed, toRaw, onMounted } from 'vue'\nimport { CheckCircle, XCircle, MinusCircle, SquarePen } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\nimport ExamGraded from '@/components/ExamGraded.vue'\nimport Discussions from '@/components/Discussions.vue'\nconst user = inject('$user')\nconst timer = ref(0);\nlet timerInterval = null;\nconst elapsedTime = ref(0);\nconst answer = ref('');\nconst answers = ref({}); // Use ref instead of reactive\nconst questions = ref([]);\nconst fullExamMode = ref(false); // Always in full exam mode\nconst router = useRouter()\nlet user_is_instructor = false\n// const socket = inject('$socket')\n\n// if (!socket) {\n//   console.error('Socket connection not found in Exam.vue. Ensure $socket is provided.');\n// } else {\n//   console.log('Socket connection established in Exam.vue:', socket);\n\n//   socket.on('new_discussion_topic', (data) => {\n//     console.log('New discussion topic received:', data);\n//   });\n// }\n// Props\nconst props = defineProps({\nexamName: {\n  type: String,\n  required: true,\n},\n\n});\nconsole.log('Exam Name (PROPS):', props.examName); // Debugging log\n\n// Exam resource\nconst exam = createResource({\nurl: 'frappe.client.get',\nmakeParams(values) {\n  return {\n    doctype: 'Exam Activity',\n    name: props.examName,\n  };\n},\ncache: ['exam', props.examName],\nauto: true,\ntransform(data) {\n  if (!data) {\n    console.error('Exam data is null or undefined.');\n    return null;\n  }\n  data.duration = parseInt(data.duration) || 0;\n  return data;\n},\nonSuccess(data) {\n      if (data) {\n        // console.log('Loaded exam data:', data); // Debugging\n        // console.log('Exam Name:', exam.data?.name); // Debugging log\n        // console.log('User Name:', user.data?.name); // Debugging log\n        data.questions = data.questions || []; // Ensure questions is always an array\n        \n          // populateQuestions();\n          // setupTimer();\n      } else {\n          console.error(\"Failed to load exam data.\"); // Debugging\n      }\n  },\n  onError(err) {\n      console.error(\"Error loading exam data:\", err); // Debugging\n  },\n});\n\n// Check if exam data is loaded\nconst isExamLoaded = computed(() => {\n// console.log('Exam data on isExamLoaded:', exam.data); // Debugging\nreturn !!exam.data;\n});\n\nconst hasSubmittedExam = computed(() => {\n  return attempts.data?.length > 0;\n});\n\nconst instructors = createResource({\n  url: 'seminary.seminary.utils.get_instructors',\n  makeParams(values) {\n    const courseName = router.currentRoute.value.params.courseName;\n    if (!courseName) {\n      console.error('Course name is undefined in route parameters.');\n      return {};\n    }\n    return {\n      course: courseName,\n    };\n  },\n  auto: true,\n});\n\nconst is_instructor = () => {\n // console.log('Fetching instructors of course:', router.currentRoute.value.params.courseName); // Debugging\n  if (instructors.data) {\n    instructors.data.forEach((instructor) => {\n      if (instructor.user === user.data?.name) {\n        user_is_instructor = true;\n      }\n    });\n  }\n  return user_is_instructor;\n};\n\n// // Populate questions (shuffle and limit)\n// const populateQuestions = () => {\n//   if (!exam.data || !exam.data.questions) {\n//     console.warn('No questions found in exam data.'); // Debugging\n//     return;\n//   }\n\n//   const data = exam.data;\n//   if (data.shuffle_questions) {\n//         // Shuffle the questions\n//         const shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n//         // Limit the number of questions if required\n//         questions.value = data.limit_questions_to\n//             ? shuffledQuestions.slice(0, data.limit_questions_to)\n//             : shuffledQuestions;\n//     } else {\n//         // Use the original questions if no shuffle is required\n//         questions.value = data.questions;\n//     }\n  \n// \tconsole.log(\"Populated questions:\", questions)\n// };\n\n// Timer setup\nlet timerStartTime = null; // Store the start time\nconst startTimer = () => {\n  if (exam.data.duration) {\n    // If duration is set, initialize the timer with the duration\n    timer.value = exam.data.duration * 60; // Total duration in seconds\n    timerStartTime = Date.now(); // Record the start time\n    const endTime = timerStartTime + timer.value * 1000; // Calculate the end time\n\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      const remainingTime = Math.max(0, Math.floor((endTime - currentTime) / 1000)); // Calculate remaining time\n\n      timer.value = remainingTime; // Update the timer value\n      elapsedTime.value = exam.data.duration * 60 - remainingTime; // Calculate elapsed time\n\n      if (remainingTime <= 0) {\n        clearInterval(timerInterval);\n        submitExam(); // Automatically submit the exam when the timer ends\n      }\n    }, 1000);\n  } else {\n    // If duration is null, track elapsed time only\n    timerStartTime = Date.now(); // Record the start time\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      elapsedTime.value = Math.floor((currentTime - timerStartTime) / 1000); // Calculate elapsed time in seconds\n    }, 1000);\n  }\n};\n\n// Format timer\nconst formatTimer = (seconds) => {\n  const mins = Math.floor(seconds / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${mins}:${secs}`;\n};\n\n// Timer progress\nconst timerProgress = computed(() => {\n  return (timer.value / (exam.data.duration * 60)) * 100;\n});\n\n// Shuffle array utility\nconst shuffleArray = (array) => {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n  return array;\n};\n\nwatch(answers, (newAnswers) => {\n//console.log('Answers updated:', newAnswers);\n}, { deep: true });\n\nconst get_answers = () => {\n\nconst rawAnswers = toRaw(answers.value); // Extract plain data from the reactive object\nreturn Object.entries(rawAnswers).map(([questionName, answer]) => ({\n  question: questionName,\n  answer: answer,\n}));\n};\n\nconst updateAnswer = (questionName, value) => {\nanswers[questionName] = value;\n};\n\nconst attempts = createResource({\n  url: 'frappe.client.get_list',\n  makeParams(values) {\n    return {\n      doctype: 'Exam Submission',\n      filters: {\n        member: user.data?.name,\n        exam: props.examName,\n      },\n      fields: ['name', 'creation'],\n      order_by: 'creation desc',\n    };\n  },\n  auto: true,\n  transform(data) {\n   \n    //console.log('Fetched attempts:', data); // Debugging log\n    data.forEach((submission, index) => {\n      submission.creation = timeAgo(submission.creation);\n      submission.idx = index + 1;\n    });\n  },\n});\n\nwatch(\n  () => attempts.data,\n  (newData) => {\n    console.log('Attempts data updated:', newData); // Debugging log\n  }\n);\n\n// Submit exam\nconst submitExam = async () => {\ntry {\n  const submittedAnswers = get_answers();\n  //console.log('Submitting exam with answers:', submittedAnswers);\n  //console.log(\"Course Name:\", router.currentRoute.value.params.courseName);\n  const timeTaken = exam.data.duration\n            ? exam.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n            : elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n  //  API call\n  await call('seminary.seminary.doctype.exam_submission.exam_submission.create_exam_submission', {\n    exam: props.examName,\n    course: router.currentRoute.value.params.courseName,\n    member: user.data?.name,\n    answers: submittedAnswers,\n    time_taken: timeTaken,\n  });\n\n  toast.success(__('Your exam was submitted successfully.')) ;\n  clearInterval(timerInterval);\n} catch (error) {\n  console.error('Error during exam submission:', error);\n  toast.error(err.messages?.[0] || err)\n}\n};\n\nconst startExam = () => {\n\tactiveQuestion.value = 1\n\tlocalStorage.removeItem(exam.data.title)\n\tstartTimer()\n}\n\nconst startExam2 = () => {\n    localStorage.removeItem(exam.data.title);\n    fullExamMode.value = true; // Set full exam mode flag\n    startTimer();\n    // all_questions_details.reload(); // Ensure the resource is reloaded\n    \n}\n\nconst submission = createResource({\n\turl: 'frappe.client.get_value',\n\tparams: {\n\t\tdoctype: 'Exam Submission',\n\t\tfieldname: 'name',\n\t\tfilters: {\n\t\t\texam: props.examName,\n\t\t\tmember: user.data?.name,\n\t\t\tstatus: 'Graded',\n\t\t},\n\t},\n\tauto: false, // Disable auto-fetch\n\ttransform(data) {\n\t\tconsole.log('Fetched submission data:', data); // Debugging log\n\t\treturn data;\n\t},\n\tonError(err) {\n\t\tconsole.error('Error fetching submission:', err); // Debugging log\n\t},\n});\n\n\nconst submission_anystatus = createResource({\n\turl: 'frappe.client.get_value',\n\tparams: {\n\t\tdoctype: 'Exam Submission',\n\t\tfieldname: 'name',\n\t\tfilters: {\n\t\t\texam: props.examName,\n\t\t\tmember: user.data?.name,\n\t\t},\n\t},\n\tauto: false, // Disable auto-fetch\n\ttransform(data) {\n\t\tconsole.log('Fetched submission AnyStatus:', data.name); // Debugging log\n\t\treturn data;\n\t},\n\tonError(err) {\n\t\tconsole.error('Error fetching submission:', err); // Debugging log\n\t},\n});\n\n\nonMounted(() => {\n\n\t// Load submission resources on mount\n\tsubmission.reload();\n\tsubmission_anystatus.reload();\n});\n\t\n</script>\n\n<style>\n/* Tooltip styling */\n.tooltip {\n  position: relative;\n  cursor: pointer;\n}\n\n.tooltip::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background-color: #333;\n  color: #fff;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.tooltip:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n</style>","<template>\n\t<Exam v-if=\"user.data\" :examName=\"exam\" ></Exam>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the exam.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Exam from '@/components/Exam.vue'\n\nconst user = inject('$user')\n\n\nconst props = defineProps({\n\texam: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\t\n})\n\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","import ExamBlock from '@/components/ExamBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { BookOpenCheck } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Exam {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(BookOpenCheck, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Exam'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderExam(this.data.exam)\n\t\t} else {\n\t\t\tthis.renderExamModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderExam(exam) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(ExamBlock, {\n\t\t\t\texam: exam,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Exam: ${exam}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderExamModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'exam',\n\t\t\tonAddition: (exam) => {\n\t\t\t\tthis.data.exam = exam\n\t\t\t\tthis.renderExam(exam)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router); // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\texam: this.data.exam,\n\t\t}\n\t}\n}","<template>\n\t<div>\n\t\t<!-- <audio width=\"100%\" controls controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio> -->\n\t\t<audio @ended=\"handleAudioEnd\" controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio>\n\t\t<div class=\"flex items-center space-x-2 shadow rounded-lg p-1 w-1/2\">\n\t\t\t<Button variant=\"ghost\" @click=\"togglePlay\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play v-if=\"!isPlaying\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<Pause v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs text-ink-gray-9 font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!isMuted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch } from 'vue'\nimport { Play, Pause, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst isPlaying = ref(false)\nconst audio = ref(null)\nlet isMuted = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\taudio.value = document.querySelector('audio')\n\t\taudio.value.onloadedmetadata = () => {\n\t\t\tduration.value = audio.value.duration\n\t\t}\n\t\taudio.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = audio.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst togglePlay = () => {\n\tif (audio.value.paused) {\n\t\taudio.value.play()\n\t\tisPlaying.value = true\n\t} else {\n\t\taudio.value.pause()\n\t\tisPlaying.value = false\n\t}\n}\n\nconst toggleMute = () => {\n\taudio.value.muted = !audio.value.muted\n\tisMuted.value = audio.value.muted\n}\n\nconst changeCurrentTime = () => {\n\taudio.value.currentTime = currentTime.value\n}\n\nconst handleAudioEnd = () => {\n\tisPlaying.value = false\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nwatch(isPlaying, (newVal) => {\n\tif (newVal) {\n\t\taudio.value.play()\n\t} else {\n\t\taudio.value.pause()\n\t}\n})\n</script>\n<style>\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\tappearance: none;\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -150px 0 0 150px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<div ref=\"videoContainer\" class=\"video-block group relative\">\n\t\t<video\n\t\t\t@timeupdate=\"updateTime\"\n\t\t\t@ended=\"videoEnded\"\n\t\t\t@click=\"togglePlay\"\n\t\t\toncontextmenu=\"return false\"\n\t\t\tclass=\"rounded-lg border border-gray-100 group cursor-pointer\"\n\t\t\tref=\"videoRef\"\n\t\t>\n\t\t\t<source :src=\"fileURL\" :type=\"type\" />\n\t\t</video>\n\t\t<div\n\t\t\tclass=\"flex items-center space-x-2 bg-surface-gray-3 rounded-md p-0.5 absolute bottom-3 w-[98%] left-0 right-0 mx-auto invisible group-hover:visible\"\n\t\t>\n\t\t\t<Button variant=\"ghost\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play\n\t\t\t\t\t\tv-if=\"!playing\"\n\t\t\t\t\t\t@click=\"playVideo\"\n\t\t\t\t\t\tclass=\"w-4 h-4 text-ink-gray-9\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Pause v-else @click=\"pauseVideo\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!muted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleFullscreen\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Maximize class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { ref, onMounted, computed } from 'vue'\nimport { Play, Pause, Maximize, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst videoRef = ref(null)\nconst videoContainer = ref(null)\nlet playing = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\nlet muted = ref(false)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\ttype: {\n\t\ttype: String,\n\t\tdefault: 'video/mp4',\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\tvideoRef.value.onloadedmetadata = () => {\n\t\t\tduration.value = videoRef.value.duration\n\t\t}\n\t\tvideoRef.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = videoRef.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst fileURL = computed(() => {\n\tif (isYoutube) {\n\t\tlet url = props.file\n\t\tif (url.includes('watch?v=')) {\n\t\t\turl = url.replace('watch?v=', 'embed/')\n\t\t}\n\t\treturn `${url}?autoplay=0&controls=0&disablekb=1&playsinline=1&cc_load_policy=1&cc_lang_pref=auto`\n\t}\n\treturn props.file\n})\n\nconst isYoutube = computed(() => {\n\treturn props.type == 'video/youtube'\n})\n\nconst playVideo = () => {\n\tvideoRef.value.play()\n\tplaying.value = true\n}\n\nconst pauseVideo = () => {\n\tvideoRef.value.pause()\n\tplaying.value = false\n}\n\nconst togglePlay = () => {\n\tif (playing.value) {\n\t\tpauseVideo()\n\t} else {\n\t\tplayVideo()\n\t}\n}\n\nconst videoEnded = () => {\n\tplaying.value = false\n}\n\nconst toggleMute = () => {\n\tvideoRef.value.muted = !videoRef.value.muted\n\tmuted.value = videoRef.value.muted\n}\n\nconst changeCurrentTime = () => {\n\tvideoRef.value.currentTime = currentTime.value\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nconst toggleFullscreen = () => {\n\tif (document.fullscreenElement) {\n\t\tdocument.exitFullscreen()\n\t} else {\n\t\tvideoContainer.value.requestFullscreen()\n\t}\n}\n</script>\n\n<style scoped>\n.video-block {\n\twidth: 100%;\n\tmax-width: 900px;\n\tmargin: 0 auto;\n}\n\n.video-block video {\n\twidth: 100%;\n\theight: auto;\n}\n\niframe {\n\twidth: 100%;\n\tmin-height: 500px;\n}\n\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -500px 0 0 500px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<FileUploader\n\t\t:fileTypes=\"['image/*', 'video/*', 'audio/*', '.pdf']\"\n\t\t:validateFile=\"validateFile\"\n\t\t@success=\"(data) => addFile(data)\"\n\t\tref=\"fileUploader\"\n\t\tclass=\"hide\"\n\t/>\n</template>\n<script setup>\nimport { FileUploader } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\n\nconst fileUploader = ref(null)\nconst emit = defineEmits(['fileUploaded'])\n\nconst props = defineProps({\n\tonFileUploaded: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\nonMounted(async () => {\n\tawait nextTick()\n\tconst fileInput = fileUploader.value.$el.querySelector('input[type=\"file\"]')\n\tif (fileInput) {\n\t\tfileInput.click()\n\t}\n})\n\nconst addFile = (file) => {\n\tprops.onFileUploaded({\n\t\tfile_url: file.file_url,\n\t\tfile_type: file.file_type,\n\t})\n}\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'mp4', 'mov', 'mp3', 'pdf'].includes(extension)) {\n\t\treturn 'Only image and video files are allowed.'\n\t}\n}\n\nconst isVideo = (type) => {\n\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n}\n\nconst isAudio = (type) => {\n\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n}\n</script>\n","import AudioBlock from '@/components/AudioBlock.vue'\nimport VideoBlock from '@/components/VideoBlock.vue'\nimport UploadPlugin from '@/components/UploadPlugin.vue'\nimport { h, createApp } from 'vue'\nimport { Upload as UploadIcon } from 'lucide-vue-next'\nimport translationPlugin from '../translation'\n\nexport class Upload {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(UploadIcon, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: 'Upload',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\n\t\tif (this.data && this.data.file_url) {\n\t\t\tthis.renderFile(this.data)\n\t\t} else {\n\t\t\tthis.renderFileUploader()\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\trenderFile(file) {\n\t\tif (this.isVideo(file.file_type)) {\n\t\t\tconst app = createApp(VideoBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (this.isAudio(file.file_type)) {\n\t\t\tconst app = createApp(AudioBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (file.file_type == 'PDF') {\n\t\t\tthis.wrapper.innerHTML = `<iframe src=\"https://docs.google.com/viewer?url=${\n\t\t\t\twindow.location.origin\n\t\t\t}${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)}&embedded=true\" width='100%' height='700px' class=\"mb-4\" type=\"application/pdf\"></iframe>`\n\t\t\treturn\n\t\t} else {\n\t\t\tthis.wrapper.innerHTML = `<img class=\"mb-4\" src=${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)} width='100%'>`\n\t\t\treturn\n\t\t}\n\t}\n\n\trenderFileUploader() {\n\t\tconst app = createApp(UploadPlugin, {\n\t\t\tonFileUploaded: (file) => {\n\t\t\t\tthis.data.file_url = file.file_url\n\t\t\t\tthis.data.file_type = file.file_type\n\t\t\t\tthis.renderFile(file)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.file_url || !savedData.file_type) {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tfile_url: this.data.file_url,\n\t\t\tfile_type: this.data.file_type,\n\t\t}\n\t}\n\n\tisVideo(type) {\n\t\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n\t}\n\n\tisAudio(type) {\n\t\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n\t}\n}\n","import { CodeXml } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\n\nexport class Markdown {\n\tconstructor({ data, api, readOnly, config }) {\n\t\tthis.api = api\n\t\tthis.data = data || {}\n\t\tthis.config = config || {}\n\t\tthis.text = data.text || ''\n\t\tthis.readOnly = readOnly\n\t\tthis.placeholder = __(\"Type '/' for commands or select text to format\")\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get conversionConfig() {\n\t\treturn {\n\t\t\texport: 'text',\n\t\t\timport: 'text',\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CodeXml, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tonPaste(event) {\n\t\tconst data = {\n\t\t\ttext: event.detail.data.innerHTML,\n\t\t}\n\n\t\tthis.data = data\n\t\twindow.requestAnimationFrame(() => {\n\t\t\tif (!this.wrapper) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.wrapper.innerHTML = this.data.text || ''\n\t\t})\n\t}\n\n\tstatic get pasteConfig() {\n\t\treturn {\n\t\t\ttags: ['P'],\n\t\t}\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tthis.wrapper.classList.add('cdx-block', 'ce-paragraph')\n\t\tthis.wrapper.innerHTML = this.text\n\n\t\tif (!this.readOnly) {\n\t\t\tthis.wrapper.contentEditable = true\n\t\t\tthis.wrapper.innerHTML = this.text\n\n\t\t\tthis.wrapper.addEventListener('input', (event) => {\n\t\t\t\tlet value = event.target.textContent\n\t\t\t\tif (event.keyCode === 32 && value.startsWith('#')) {\n\t\t\t\t\tthis.convertToHeader(event, value)\n\t\t\t\t} else if (event.keyCode == 189) {\n\t\t\t\t\tthis.convertBlock('list', {\n\t\t\t\t\t\tstyle: 'unordered',\n\t\t\t\t\t})\n\t\t\t\t} else if (/^[a-zA-Z]/.test(event.key)) {\n\t\t\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t})\n\t\t\t\t} else if (event.keyCode === 13 || event.keyCode === 190) {\n\t\t\t\t\tthis.parseContent(event)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\t_togglePlaceholder() {\n\t\tconst blocks = document.querySelectorAll(\n\t\t\t'.cdx-block.ce-paragraph[data-placeholder]'\n\t\t)\n\t\tblocks.forEach((block) => {\n\t\t\tif (block !== this.wrapper) {\n\t\t\t\tdelete block.dataset.placeholder\n\t\t\t}\n\t\t})\n\t\tif (this.wrapper.innerHTML.trim() === '') {\n\t\t\tthis.wrapper.dataset.placeholder = this.placeholder\n\t\t} else {\n\t\t\tdelete this.wrapper.dataset.placeholder\n\t\t}\n\t}\n\n\tconvertToHeader(event, value) {\n\t\tevent.preventDefault()\n\t\tif (['#', '##', '###', '####', '#####', '######'].includes(value)) {\n\t\t\tlet level = value.length\n\t\t\tevent.target.textContent = ''\n\t\t\tthis.convertBlock('header', {\n\t\t\t\tlevel: level,\n\t\t\t})\n\t\t}\n\t}\n\n\tparseContent(event) {\n\t\tevent.preventDefault()\n\t\tlet previousLine = this.wrapper.textContent\n\t\tif (event.keyCode === 190) {\n\t\t\tpreviousLine = previousLine + '.'\n\t\t}\n\n\t\tif (previousLine && this.hasImage(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('image')\n\t\t} else if (previousLine && this.hasLink(previousLine)) {\n\t\t\tconst { text, url } = this.extractLink(previousLine)\n\t\t\tconst anchorTag = `<a href=\"${url}\" target=\"_blank\">${text}</a>`\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine.replace(/\\[.+?\\]\\(.+?\\)/, anchorTag),\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('- ')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'unordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('- ', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('1.')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'ordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('1.', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && this.canBeEmbed(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('embed', {\n\t\t\t\tsource: previousLine,\n\t\t\t})\n\t\t} else {\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine,\n\t\t\t})\n\t\t}\n\t}\n\n\tasync convertBlock(type, data, index = null) {\n\t\tconst currentIndex = this.api.blocks.getCurrentBlockIndex()\n\t\tconst currentBlock = this.api.blocks.getBlockByIndex(currentIndex)\n\t\tawait this.api.blocks.convert(currentBlock.id, type, data)\n\t\tthis.api.caret.focus(true)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\ttext: blockContent.innerHTML,\n\t\t}\n\t}\n\n\thasImage(line) {\n\t\treturn /!\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractImage(line) {\n\t\tconst match = line.match(/!\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { alt: match[1], url: match[2] }\n\t\t}\n\t\treturn { alt: '', url: '' }\n\t}\n\n\thasLink(line) {\n\t\treturn /\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractLink(line) {\n\t\tconst match = line.match(/\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { text: match[1], url: match[2] }\n\t\t}\n\t\treturn { text: '', url: '' }\n\t}\n\n\tcanBeEmbed(line) {\n\t\treturn /^https?:\\/\\/.+/.test(line.trim())\n\t}\n}\n\nexport default Markdown","import { Code } from \"lucide-vue-next\"\nimport { h, createApp } from \"vue\"\nimport hljs from 'highlight.js/lib/core';\n\n\nconst DEFAULT_THEMES = ['light', 'dark'];\nconst COMMON_LANGUAGES = {\n\tnone: 'Auto-detect', apache: 'Apache', bash: 'Bash', cs: 'C#', cpp: 'C++', css: 'CSS', coffeescript: 'CoffeeScript', diff: 'Diff',\n\tgo: 'Go', html: 'HTML, XML', http: 'HTTP', json: 'JSON', java: 'Java', javascript: 'JavaScript', kotlin: 'Kotlin',\n\tless: 'Less', lua: 'Lua', makefile: 'Makefile', markdown: 'Markdown', nginx: 'Nginx', objectivec: 'Objective-C',\n\tphp: 'PHP', perl: 'Perl', properties: 'Properties', python: 'Python', ruby: 'Ruby', rust: 'Rust', scss: 'SCSS',\n\tsql: 'SQL', shell: 'Shell Session', swift: 'Swift', toml: 'TOML, also INI', typescript: 'TypeScript', yaml: 'YAML',\n\tplaintext: 'Plaintext'\n};\n\nexport class CodeBox {\n\tapi: any;\n\tconfig: { themeName: any; themeURL: any; useDefaultTheme: any; };\n\treadOnly: boolean;\n\tdata: { code: any; language: any; theme: any; };\n\thighlightScriptID: string;\n\thighlightCSSID: string;\n\tcodeArea: HTMLDivElement;\n\tselectInput: HTMLInputElement;\n\tselectDropIcon: HTMLElement;\n\n\tconstructor({ data, api, config, readOnly }) {\n\t\tthis.api = api;\n\t\tthis.readOnly = readOnly;\n\t\tthis.config = {\n\t\t\tthemeName: config.themeName && typeof config.themeName === 'string' ? config.themeName : '',\n\t\t\tthemeURL: config.themeURL && typeof config.themeURL === 'string' ? config.themeURL : '',\n\t\t\tuseDefaultTheme: (config.useDefaultTheme && typeof config.useDefaultTheme === 'string'\n\t\t\t\t&& DEFAULT_THEMES.includes(config.useDefaultTheme.toLowerCase())) ? config.useDefaultTheme : 'dark',\n\t\t};\n\t\tthis.data = {\n\t\t\tcode: data.code && typeof data.code === 'string' ? data.code : '',\n\t\t\tlanguage: data.language && typeof data.language === 'string' ? data.language : 'Auto-detect',\n\t\t\ttheme: data.theme && typeof data.theme === 'string' ? data.theme : this._getThemeURLFromConfig(),\n\t\t};\n\t\tthis.highlightScriptID = 'highlightJSScriptElement';\n\t\tthis.highlightCSSID = 'highlightJSCSSElement';\n\t\tthis.codeArea = document.createElement('div');\n\t\tthis.selectInput = document.createElement('input');\n\t\tthis.selectDropIcon = document.createElement('i');\n\n\t\tthis._injectHighlightJSCSSElement();\n\n\t\tthis.api.listeners.on(window, 'click', this._closeAllLanguageSelects, true);\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get sanitize() {\n\t\treturn {\n\t\t\tcode: true,\n\t\t\tlanguage: false,\n\t\t\ttheme: false,\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () => h(Code, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t});\n\n\t\tconst div = document.createElement('div');\n\t\tapp.mount(div);\n\n\t\treturn {\n\t\t\ttitle: 'CodeBox',\n\t\t\ticon: div.innerHTML\n\t\t};\n\t}\n\n\tstatic get displayInToolbox() {\n\t\treturn true;\n\t}\n\n\tstatic get enableLineBreaks() {\n\t\treturn true;\n\t}\n\n\trender() {\n\t\tconst codeAreaHolder = document.createElement('pre');\n\t\tconst languageSelect = this._createLanguageSelectElement();\n\n\t\tcodeAreaHolder.setAttribute('class', 'codeBoxHolder');\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\t\tthis.codeArea.setAttribute('contenteditable', 'true');\n\t\tthis.codeArea.innerHTML = this.data.code;\n\t\tthis.api.listeners.on(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.on(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\n\t\tcodeAreaHolder.appendChild(this.codeArea);\n\t\t!this.readOnly && codeAreaHolder.appendChild(languageSelect);\n\n\t\treturn codeAreaHolder;\n\t}\n\n\tsave(blockContent) {\n\t\treturn Object.assign(this.data, { code: this.codeArea.innerHTML, theme: this._getThemeURLFromConfig() });\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.code.trim()) return false;\n\t\treturn true;\n\t}\n\n\tdestroy() {\n\t\tthis.api.listeners.off(window, 'click', this._closeAllLanguageSelects, true);\n\t\tthis.api.listeners.off(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.off(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\t\tthis.api.listeners.off(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\t}\n\n\t_createLanguageSelectElement() {\n\t\tconst selectHolder = document.createElement('div');\n\t\tconst selectPreview = document.createElement('div');\n\t\tconst languages = Object.entries(COMMON_LANGUAGES);\n\n\t\tselectHolder.setAttribute('class', 'codeBoxSelectDiv');\n\n\t\tthis.selectDropIcon.setAttribute('class', `codeBoxSelectDropIcon ${this.config.useDefaultTheme}`);\n\t\tthis.selectDropIcon.innerHTML = '&#8595;';\n\t\tthis.selectInput.setAttribute('class', `codeBoxSelectInput ${this.config.useDefaultTheme}`);\n\t\tthis.selectInput.setAttribute('type', 'text');\n\t\tthis.selectInput.setAttribute('readonly', 'true');\n\t\tthis.selectInput.value = this.data.language;\n\t\tthis.api.listeners.on(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\n\t\tselectPreview.setAttribute('class', 'codeBoxSelectPreview');\n\n\t\tlanguages.forEach(language => {\n\t\t\tconst selectItem = document.createElement('p');\n\t\t\tselectItem.setAttribute('class', `codeBoxSelectItem ${this.config.useDefaultTheme}`);\n\t\t\tselectItem.setAttribute('data-key', language[0]);\n\t\t\tselectItem.textContent = language[1];\n\t\t\tthis.api.listeners.on(selectItem, 'click', event => this._handleSelectItemClick(event, language), false);\n\n\t\t\tselectPreview.appendChild(selectItem);\n\t\t});\n\n\t\tselectHolder.appendChild(this.selectDropIcon);\n\t\tselectHolder.appendChild(this.selectInput);\n\t\tselectHolder.appendChild(selectPreview);\n\n\t\treturn selectHolder;\n\t}\n\n\t_highlightCodeArea(event) {\n\t\thljs.highlightBlock(this.codeArea);\n\t}\n\n\t_handleCodeAreaPaste(event) {\n\t\tevent.stopPropagation();\n\t}\n\n\t_handleSelectInputClick(event) {\n\t\tevent.target.nextSibling.classList.toggle('codeBoxShow');\n\t}\n\n\t_handleSelectItemClick(event, language) {\n\t\tevent.target.parentNode.parentNode.querySelector('.codeBoxSelectInput').value = language[1];\n\t\tevent.target.parentNode.classList.remove('codeBoxShow');\n\t\tthis.codeArea.removeAttribute('class');\n\t\tthis.data.language = language[0];\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\t\n\t\thljs.highlightElement(this.codeArea);\n\t}\n\n\t_closeAllLanguageSelects() {\n\t\tconst selectPreviews = document.querySelectorAll('.codeBoxSelectPreview');\n\t\tfor (let i = 0, len = selectPreviews.length; i < len; i++) selectPreviews[i].classList.remove('codeBoxShow');\n\t}\n\n\t_injectHighlightJSCSSElement() {\n\t\tconst highlightJSCSSElement = document.querySelector(`#${this.highlightCSSID}`);\n\t\tlet highlightJSCSSURL = this._getThemeURLFromConfig();\n\t\tif (!highlightJSCSSElement) {\n\t\t\tconst link = document.createElement('link');\n\t\t\tconst head = document.querySelector('head');\n\t\t\tlink.setAttribute('rel', 'stylesheet');\n\t\t\tlink.setAttribute('href', highlightJSCSSURL);\n\t\t\tlink.setAttribute('id', this.highlightCSSID);\n\n\t\t\tif (head) head.appendChild(link);\n\t\t}\n\t\telse highlightJSCSSElement.setAttribute('href', highlightJSCSSURL);\n\t}\n\n\t_getThemeURLFromConfig() {\n\t\tlet themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-${this.config.useDefaultTheme}.min.css`;\n\n\t\tif (this.config.themeName) themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/${this.config.themeName}.min.css`;\n\t\tif (this.config.themeURL) themeURL = this.config.themeURL;\n\n\t\treturn themeURL;\n\t}\n}\n\n\nexport default CodeBox;","<template>\n  <div class=\"Folder\">\n    <h3>Manage Course Folders</h3>\n    <div>\n      <label>\n        <input type=\"radio\" v-model=\"folderAction\" value=\"select\" />\n        Select Existing Folder    \n      </label>\n      <label class=\"ml-4\">\n        <input type=\"radio\" v-model=\"folderAction\" value=\"create\" />\n        Create New Folder\n      </label>\n    </div>\n    \n    <div v-if=\"folderAction === 'select'\" class=\"mt-4 mb-4\">\n      <Link \n        v-model=\"selectedFolder\"\n        doctype=\"Course Folder\"\n        options=\"foldername\"\n        :label=\"__('Select a folder')\"\n        \n            \n        />\n    </div>\n\n    <div v-if=\"folderAction === 'create'\">\n      <input type=\"text\" v-model=\"newFolderName\" placeholder=\"Enter folder name\" />\n      <Link\n        v-model=\"course\"\n        doctype=\"Course\"\n        :label=\"__('Select a course')\"\n        />\n      <button @click=\"createFolder\">Create Folder</button>\n    </div>\n\n    <div v-if=\"selectedFolder\" class=\"block mt-6 space-y-6\">\n      <div>\n        <div class=\"text-sm font-medium text-ink-gray-9\">{{ __('Current Folder') }}</div>\n        <div class=\"mt-1 flex flex-wrap items-center gap-1 text-sm text-ink-gray-6\">\n          <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n            <button\n              type=\"button\"\n              class=\"rounded px-1.5 py-0.5 text-ink-gray-7 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n              @click=\"navigateToBreadcrumb(index)\"\n            >\n              {{ crumb.label }}\n            </button>\n            <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-wrap items-center gap-2\">\n        <input\n          type=\"text\"\n          v-model=\"newSubfolderName\"\n          :placeholder=\"__('New sub-folder name')\"\n          class=\"flex-1 rounded border border-outline-gray-3 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none\"\n        />\n        <Button size=\"sm\" @click=\"createSubfolder\">\n          {{ __('Create Sub-folder') }}\n        </Button>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders yet.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"folder in subfolders\"\n            :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <button\n              type=\"button\"\n              class=\"flex-1 text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\"\n            >\n              {{ folder.file_name }}\n            </button>\n          </li>\n        </ul>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files found in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"file in files\"\n            :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <a\n              :href=\"file.file_url\"\n              download\n              class=\"flex-1 truncate text-sm text-blue-600 hover:underline\"\n            >\n              {{ file.file_name }}\n            </a>\n            <Tooltip :text=\"__('Delete File')\" placement=\"bottom\">\n              <Trash2\n                @click.prevent=\"removeFile(file.file_url)\"\n                class=\"h-4 w-4 cursor-pointer text-red-500\"\n              />\n            </Tooltip>\n          </li>\n        </ul>\n      </div>\n\n      <div\n        class=\"rounded-md border-2 border-dashed border-outline-gray-3 p-6 text-center text-sm transition-colors duration-200 hover:border-outline-gray-4\"\n        :class=\"{ 'bg-blue-50 border-blue-500 text-blue-700': isDragActive }\"\n        @dragenter.prevent.stop=\"onDragEnter\"\n        @dragover.prevent.stop=\"onDragOver\"\n        @dragleave.prevent.stop=\"onDragLeave\"\n        @drop.prevent.stop=\"onDrop\"\n        @click=\"triggerFileSelect\"\n      >\n        <p class=\"font-medium\">{{ __('Drop files here or click to upload') }}</p>\n        <p class=\"mt-1 text-ink-gray-6\">\n          {{ __('Files will be added to') }} {{ currentFolderName }}\n        </p>\n        <input ref=\"fileInputRef\" type=\"file\" class=\"hidden\" multiple @change=\"uploadFiles\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { createResource, Button, Tooltip } from 'frappe-ui';\nimport { onMounted, ref, watch } from 'vue';\nimport Link from '@/components/Controls/Link.vue';\nimport { FolderTool } from '@/utils/foldertool'; // Corrected to named import\nimport { useRoute } from 'vue-router';\nimport { Trash2 } from 'lucide-vue-next';\n\nconst route = useRoute();\n\nconst folderAction = ref('select');\nconst selectedFolder = ref(null);\nconst foldername = ref(''); // Declare foldername globally\nconst newFolderName = ref('');\nconst files = ref([]);\nconst folders = ref([]);\nconst course = ref(null);\nconst currentFolderId = ref(null);\nconst currentFolderName = ref('');\nconst breadcrumbStack = ref([]);\nconst subfolders = ref([]);\nconst isDragActive = ref(false);\nconst newSubfolderName = ref('');\nconst fileInputRef = ref(null);\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  );\n};\n\nconst fetchCourse = async () => {\n  const courseName = route.params.courseName;\n  console.log(\"Course Name: \", courseName);\n  if (courseName) {\n    const resource = createResource({\n      url: 'frappe.client.get_value',\n      makeParams(values) {\n        return {\n          doctype: 'Course Schedule',\n          fieldname: 'course',\n          filters: {\n            name: courseName,\n          },\n        };\n      },\n    });\n    const result = await resource.fetch(); // Wait for the resource to fetch data\n    course.value = result.course; // Assign the fetched course value\n    console.log(\"Fetched Course: \", course.value);\n  } else {\n    console.error(\"Course name not found in route params\");\n  return null;\n}};\n\nconst props = defineProps({\n  onAddition: {\n    type: Function,\n    required: false,\n  },\n  initialFolder: {\n    type: String,\n    default: null,\n  },\n})\n\nconst addFolder = () => {\n  if (!foldername.value) {\n    return;\n  }\n\n  const folder = foldername.value;\n  if (typeof props.onAddition === 'function') {\n    props.onAddition(folder);\n  }\n};\n\nconst initializeFromFolder = async (folderLabel, { refreshFolders = true } = {}) => {\n  const targetFolder = folderLabel?.trim();\n  if (!targetFolder) {\n    return;\n  }\n\n  if (refreshFolders || !folders.value.length) {\n    await fetchFolders();\n  }\n\n  const matchingFolder = folders.value.find(\n    (folder) => folder.foldername === targetFolder || folder.name === targetFolder\n  );\n\n  if (matchingFolder) {\n    if (selectedFolder.value !== matchingFolder.name) {\n      selectedFolder.value = matchingFolder.name;\n    }\n    return;\n  }\n\n  foldername.value = targetFolder;\n  currentFolderName.value = targetFolder;\n  breadcrumbStack.value = [\n    {\n      id: null,\n      label: targetFolder,\n      folderName: targetFolder,\n    },\n  ];\n  await fetchFiles({ folderLabel: targetFolder });\n  breadcrumbStack.value = [\n    {\n      id: currentFolderId.value,\n      label: currentFolderName.value || targetFolder,\n      folderName: foldername.value || targetFolder,\n    },\n  ];\n};\n\nconst fetchFolders = async () => {\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    return [];\n  }\n\n  const foldersResource = createResource({\n    url: 'frappe.client.get_list',\n    makeParams() {\n      return {\n        doctype: 'Course Folder',\n        filters: {\n          course: course.value,\n        },\n        fields: ['name', 'foldername', 'file_reference', 'parent_folder'],\n      };\n    },\n  });\n\n  const result = await foldersResource.fetch();\n  folders.value = result;\n  return folders.value;\n};\n\nconst createFolder = async () => {\n  if (!newFolderName.value) {\n    alert('Folder name is required');\n    return;\n  }\n\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    alert('Please select a course before creating a folder.');\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    const folder = await tool.createCourseFolder(course.value, newFolderName.value);\n\n    folders.value.push({\n      name: folder.name,\n      foldername: folder.foldername,\n      file_reference: folder.file_reference,\n      parent_folder: folder.parent_folder,\n    });\n    foldername.value = folder.foldername;\n    currentFolderId.value = folder.file_reference;\n    currentFolderName.value = folder.foldername;\n    selectedFolder.value = folder.name;\n    breadcrumbStack.value = [\n      {\n        id: currentFolderId.value,\n        label: currentFolderName.value,\n        folderName: folder.foldername,\n      },\n    ];\n    folderAction.value = 'select';\n    newFolderName.value = '';\n    await fetchFiles({ folderId: currentFolderId.value, folderLabel: currentFolderName.value });\n  } catch (error) {\n    console.error('Error creating folder:', error);\n    alert(error.message || 'Failed to create folder.');\n  }\n};\n\nconst fetchFiles = async ({ folderId, folderLabel } = {}) => {\n  const targetFolderId = folderId ?? currentFolderId.value;\n  const targetFolderLabel = folderLabel ?? currentFolderName.value ?? foldername.value;\n\n  if (!targetFolderId && !targetFolderLabel) {\n    console.warn('No folder selected for fetching files.');\n    return;\n  }\n\n  try {\n    const FilesInFolder = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params: {\n        folder_id: targetFolderId,\n        foldername: targetFolderLabel,\n      },\n      auto: true,\n    });\n    const result = await FilesInFolder.fetch();\n    const entries = result?.entries || [];\n\n    subfolders.value = entries.filter((entry) => entry.is_folder);\n    files.value = entries.filter((entry) => !entry.is_folder);\n\n    currentFolderId.value = result?.folder_id || targetFolderId;\n    currentFolderName.value = result?.folder_name || targetFolderLabel;\n  foldername.value = currentFolderName.value;\n\n  } catch (error) {\n    console.error('Error fetching files:', error);\n    subfolders.value = [];\n    files.value = [];\n  }\n};\n\nconst uploadFiles = async (event, droppedFiles = null) => {\n  const fileList = droppedFiles || event?.target?.files;\n  if (!fileList || !fileList.length) {\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n\n  try {\n    const formData = new FormData();\n    for (const file of fileList) {\n      formData.append('files', file);\n    }\n    if (currentFolderId.value) {\n      formData.append('folder_id', currentFolderId.value);\n    }\n    if (currentFolderName.value) {\n      formData.append('foldername', currentFolderName.value);\n    }\n\n    const csrfToken = getCsrfToken();\n    if (!csrfToken) {\n      alert('Session expired. Refresh the page and try again.');\n      return;\n    }\n\n    const response = await fetch('/api/method/seminary.api.folder_upload.upload_folder', {\n      method: 'POST',\n      body: formData,\n      headers: {\n        'X-Frappe-CSRF-Token': csrfToken,\n      },\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({}));\n      console.error('Error uploading files:', error);\n      alert(`Error: ${error.message || 'Failed to upload files.'}`);\n      return;\n    }\n\n    console.log('Files uploaded successfully.');\n    if (event?.target) {\n      event.target.value = '';\n    }\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error uploading files:', error);\n    alert('An error occurred while uploading files.');\n  } finally {\n    isDragActive.value = false;\n  }\n};\n\nconst removeFile = async (fileUrl) => {\n  const csrfToken = getCsrfToken();\n  if (!csrfToken) {\n    alert('Session expired. Refresh the page and try again.');\n    return;\n  }\n  await fetch('/api/method/seminary.api.folder_upload.delete_file', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Frappe-CSRF-Token': csrfToken,\n      },\n      body: JSON.stringify({ file_url: fileUrl }),\n      credentials: 'include',\n    }).then((response) => response.json());\n\n  await fetchFiles();\n};\n\nconst onDragEnter = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  isDragActive.value = true;\n};\n\nconst onDragOver = (event) => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  event.preventDefault();\n  event.stopPropagation();\n  event.dataTransfer.dropEffect = 'copy';\n  isDragActive.value = true;\n};\n\nconst onDragLeave = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  isDragActive.value = false;\n};\n\nconst onDrop = async (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder before uploading.');\n    return;\n  }\n  const droppedFiles = event.dataTransfer?.files;\n  if (droppedFiles?.length) {\n    await uploadFiles(null, droppedFiles);\n  }\n  isDragActive.value = false;\n};\n\nconst triggerFileSelect = () => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n  fileInputRef.value?.click();\n};\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return;\n  }\n  breadcrumbStack.value = [\n    ...breadcrumbStack.value,\n    {\n      id: folder.name,\n      label: folder.file_name,\n      folderName: folder.file_name,\n    },\n  ];\n  currentFolderId.value = folder.name;\n  currentFolderName.value = folder.file_name;\n  await fetchFiles({ folderId: folder.name, folderLabel: folder.file_name });\n};\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return;\n  }\n  const target = breadcrumbStack.value[index];\n  breadcrumbStack.value = breadcrumbStack.value.slice(0, index + 1);\n  currentFolderId.value = target.id;\n  currentFolderName.value = target.label;\n  foldername.value = target.folderName || target.label;\n  await fetchFiles({ folderId: target.id, folderLabel: target.folderName || target.label });\n};\n\nconst createSubfolder = async () => {\n  if (!newSubfolderName.value) {\n    alert('Sub-folder name is required.');\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    await tool.createSubfolder({\n      parentFolderId: currentFolderId.value,\n      parentFolderName: currentFolderName.value,\n      subfolderName: newSubfolderName.value,\n    });\n\n    newSubfolderName.value = '';\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error creating sub-folder:', error);\n    alert(error.message || 'Failed to create sub-folder.');\n  }\n};\n\n// Watch selectedFolder and update folder state\nwatch(selectedFolder, async (newFolder) => {\n  if (newFolder) {\n    try {\n      const resource = createResource({\n        url: 'frappe.client.get_value',\n        makeParams() {\n          return {\n            doctype: 'Course Folder',\n            fieldname: ['foldername', 'file_reference', 'parent_folder'],\n            filters: {\n              name: newFolder,\n            },\n          };\n        },\n      });\n      const result = await resource.fetch();\n      foldername.value = result?.foldername || '';\n      currentFolderId.value = result?.file_reference || null;\n      currentFolderName.value = result?.foldername || '';\n      breadcrumbStack.value = [\n        {\n          id: currentFolderId.value,\n          label: currentFolderName.value,\n          folderName: foldername.value,\n        },\n      ];\n      addFolder();\n      await fetchFiles({\n        folderId: currentFolderId.value,\n        folderLabel: currentFolderName.value,\n      });\n    } catch (error) {\n      console.error('Error fetching foldername:', error);\n    }\n  } else {\n    foldername.value = '';\n    currentFolderId.value = null;\n    currentFolderName.value = '';\n    breadcrumbStack.value = [];\n    subfolders.value = [];\n    files.value = [];\n  }\n});\n\nlet hasMounted = false;\n\nonMounted(async () => {\n  hasMounted = true;\n  await fetchCourse();\n  await fetchFolders();\n  if (props.initialFolder) {\n    await initializeFromFolder(props.initialFolder, { refreshFolders: false });\n  }\n});\n\nwatch(\n  () => props.initialFolder,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return;\n    }\n    const trimmedValue = newValue?.trim();\n    const previous = oldValue?.trim();\n    if (!trimmedValue || trimmedValue === previous) {\n      return;\n    }\n    await initializeFromFolder(trimmedValue);\n  }\n);\n</script>\n\n<style scoped>\n.Folder {\n  margin: 20px;\n  border: 2px solid #ccc;\n  padding: 10px;\n  border-radius: 5px;\n}\n</style>\n","<template>\n  <div class=\"flex flex-col gap-4 rounded-lg border-2 border-gray-200 p-4 mb-4\">\n    <div class=\"flex flex-col gap-1\">\n      <h4 class=\"text-lg font-semibold text-ink-gray-9\">{{ currentFolderName || folderName }}</h4>\n      <div class=\"text-sm text-ink-gray-6 flex flex-wrap items-center gap-1\" v-if=\"breadcrumbStack.length\">\n        <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n          <button\n            type=\"button\"\n            class=\"rounded px-1.5 py-0.5 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n            :class=\"index === breadcrumbStack.length - 1 ? 'font-medium text-ink-gray-8 cursor-default' : 'text-ink-gray-7'\"\n            @click=\"index === breadcrumbStack.length - 1 ? null : navigateToBreadcrumb(index)\"\n          >\n            {{ crumb.label }}\n          </button>\n          <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n        </template>\n      </div>\n    </div>\n\n    <div v-if=\"errorMessage\" class=\"rounded border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700\">\n      {{ errorMessage }}\n    </div>\n    <div v-else-if=\"isLoading\" class=\"text-sm text-ink-gray-6\">\n      {{ __('Loading folder contents') }}\n    </div>\n    <template v-else>\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders in this location.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"folder in subfolders\"\n            :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <button\n              type=\"button\"\n              class=\"text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\"\n            >\n              {{ folder.file_name }}\n            </button>\n            <span class=\"text-xs text-ink-gray-5\">{{ __('Folder') }}</span>\n          </li>\n        </ul>\n      </section>\n\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files available in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"file in files\"\n            :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <a :href=\"file.file_url\" download class=\"flex-1 truncate text-sm text-blue-600 hover:underline\">\n              {{ file.file_name }}\n            </a>\n            <span class=\"text-xs text-ink-gray-5\">{{ humanFileSize(file.file_size) }}</span>\n          </li>\n        </ul>\n      </section>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { createResource } from 'frappe-ui'\n\nconst props = defineProps({\n  folder: {\n    type: [Object, String],\n    required: true,\n  },\n})\n\nconst folderName = computed(() => {\n  if (typeof props.folder === 'string') {\n    return props.folder\n  }\n  if (props.folder && typeof props.folder === 'object') {\n    return props.folder.folder || props.folder.foldername || ''\n  }\n  return ''\n})\n\nconst isLoading = ref(false)\nconst errorMessage = ref('')\nconst files = ref([])\nconst subfolders = ref([])\nconst currentFolderId = ref(null)\nconst currentFolderName = ref('')\nconst breadcrumbStack = ref([])\nlet hasMounted = false\n\nconst humanFileSize = (value) => {\n  if (!value && value !== 0) {\n    return ''\n  }\n  const size = Number(value)\n  if (Number.isNaN(size)) {\n    return ''\n  }\n  if (size >= 1048576) {\n    return `${(size / 1048576).toFixed(2)} MB`\n  }\n  if (size >= 1024) {\n    return `${(size / 1024).toFixed(2)} KB`\n  }\n  return `${size} B`\n}\n\nconst buildParams = ({ folderId = null, folderLabel = null }) => {\n  const params = {}\n  if (folderId) {\n    params.folder_id = folderId\n  }\n  const labelCandidate = folderLabel ?? folderName.value\n  if (!folderId && labelCandidate) {\n    params.foldername = labelCandidate\n  }\n  return params\n}\n\nconst loadFolder = async ({ folderId = null, folderLabel = null } = {}) => {\n  const params = buildParams({ folderId, folderLabel })\n  if (!params.folder_id && !params.foldername) {\n    return null\n  }\n  isLoading.value = true\n  errorMessage.value = ''\n\n  try {\n    const resource = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params,\n      auto: true,\n    })\n    const result = await resource.fetch()\n    const entries = result?.entries || []\n    subfolders.value = entries.filter((entry) => entry.is_folder)\n    files.value = entries.filter((entry) => !entry.is_folder)\n    currentFolderId.value = result?.folder_id || folderId || null\n    currentFolderName.value = result?.folder_name || folderLabel || folderName.value || ''\n    return {\n      id: currentFolderId.value,\n      label: currentFolderName.value,\n    }\n  } catch (error) {\n    console.error('Error fetching folder contents:', error)\n    errorMessage.value = error?.message || __('Unable to load folder contents.')\n    subfolders.value = []\n    files.value = []\n    return null\n  } finally {\n    isLoading.value = false\n  }\n}\n\nconst openRootFolder = async () => {\n  const root = await loadFolder({ folderLabel: folderName.value })\n  if (root) {\n    breadcrumbStack.value = [root]\n  }\n}\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return\n  }\n  const crumb = await loadFolder({ folderId: folder.name, folderLabel: folder.file_name })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value, crumb]\n  }\n}\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return\n  }\n  const target = breadcrumbStack.value[index]\n  const crumb = await loadFolder({ folderId: target.id, folderLabel: target.label })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value.slice(0, index), crumb]\n  }\n}\n\nonMounted(async () => {\n  hasMounted = true\n  await openRootFolder()\n})\n\nwatch(\n  () => folderName.value,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return\n    }\n    const trimmed = (newValue || '').trim()\n    const previous = (oldValue || '').trim()\n    if (!trimmed || trimmed === previous) {\n      return\n    }\n    await openRootFolder()\n  },\n)\n</script>\n","import { h, createApp } from 'vue';\nimport FolderPlugin from '@/components/FolderPlugin.vue';\nimport FolderBlock from '@/components/FolderBlock.vue';\nimport { FolderOpen } from 'lucide-vue-next';\nimport translationPlugin from '../translation'\nimport router from '@/router'\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  )\n}\n\nexport class FolderTool {\n  constructor({ data, api, readOnly }) {\n    this.data = data;\n    this.readOnly = readOnly\n    this.api = api;\n    this.wrapper = undefined;\n    this.vueApp = null;\n  }\n\n  static get toolbox() {\n    const app = createApp({\n      render: () =>\n        h(FolderOpen, { size: 18, strokeWidth: 1.5, color: 'black' }),\n    });\n\n    const div = document.createElement('div');\n    app.mount(div);\n\n    return {\n      title: 'Folder',\n      icon: div.innerHTML,\n    };\n  }\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n  render() {\n    this.wrapper = document.createElement('div')\n    if (this.data && this.data.folder) {\n      this.renderFolder(this.data.folder)\n    } else {\n      this.renderFolderModal()\n    }\n    return this.wrapper\n  }\n\n  destroyApp() {\n    if (this.vueApp) {\n      this.vueApp.unmount()\n      this.vueApp = null\n    }\n    if (this.wrapper) {\n      this.wrapper.innerHTML = ''\n    }\n  }\n\n  renderFolder(folderName) {\n    if (this.readOnly) {\n      this.destroyApp()\n      this.vueApp = createApp(FolderBlock, {\n        folder: folderName,\n      })\n      this.vueApp.use(translationPlugin)\n      this.vueApp.use(router)\n      this.vueApp.mount(this.wrapper)\n      return\n    }\n    this.renderFolderModal(folderName)\n  }\n\n  renderFolderModal(initialFolder = null) {\n    if (this.readOnly) {\n      return\n    }\n    this.destroyApp()\n    this.vueApp = createApp(FolderPlugin, {\n      initialFolder,\n      onAddition: (folder) => {\n        if (!this.data) {\n          this.data = {}\n        }\n        this.data.folder = folder\n      },\n    })\n    this.vueApp.use(translationPlugin)\n    this.vueApp.use(router)\n    this.vueApp.mount(this.wrapper)\n  }\n  \n    save(blockContent) {\n      return {\n        folder: this.data?.folder,\n      }\n    }\n\n    destroy() {\n      this.destroyApp()\n    }\n\n    async createCourseFolder(courseName, folderName) {\n      const trimmedFolderName = folderName?.trim()\n      if (!trimmedFolderName) {\n        throw new Error('Folder name is required to create a course folder')\n      }\n      if (!courseName) {\n        throw new Error('Course is required to create a course folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/resource/Course Folder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          course: courseName,\n          foldername: trimmedFolderName,\n        }),\n      })\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create course folder')\n      }\n\n      const data = responseData?.data || responseData\n      if (!this.data) {\n        this.data = {}\n      }\n      this.data.folder = data?.foldername || trimmedFolderName\n      return data\n    }\n\n    async createSubfolder({ parentFolderId, parentFolderName, subfolderName }) {\n      const trimmedSubfolderName = subfolderName?.trim()\n      if (!trimmedSubfolderName) {\n        throw new Error('Sub-folder name is required')\n      }\n\n      if (!parentFolderId && !parentFolderName) {\n        throw new Error('Parent folder information is required to create a sub-folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/method/seminary.api.folder_upload.create_subfolder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          parent_folder_id: parentFolderId,\n          parent_foldername: parentFolderName,\n          subfoldername: trimmedSubfolderName,\n        }),\n      })\n\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create sub-folder')\n      }\n\n      return responseData?.message || responseData?.data || responseData\n    }\n  }","import { toast } from 'frappe-ui'\nimport { useTimeAgo } from '@vueuse/core'\nimport { Quiz } from '@/utils/quiz'\nimport { Assignment } from '@/utils/assignment'\nimport { Exam} from '@/utils/exam'\nimport { Upload } from '@/utils/upload'\nimport { Markdown } from '@/utils/markdownParser'\nimport Header from '@editorjs/header'\nimport Paragraph from '@editorjs/paragraph'\nimport { CodeBox } from '@/utils/code'\nimport NestedList from '@editorjs/nested-list'\nimport InlineCode from '@editorjs/inline-code'\nimport { watch } from 'vue'\nimport dayjs from '@/utils/dayjs'\nimport Embed from '@editorjs/embed'\nimport SimpleImage from '@editorjs/simple-image'\nimport Table from '@editorjs/table'\nimport { FolderTool } from '@/utils/foldertool'\n\nexport function createToast(options) {\n\ttoast({\n\t\tposition: 'bottom-right',\n\t\t...options,\n\t})\n}\n\nexport function timeAgo(date) {\n\treturn useTimeAgo(date).value\n}\n\nexport function formatTime(timeString) {\n\tif (!timeString) return ''\n\tconst [hour, minute] = timeString.split(':').map(Number)\n\n\t// Create a Date object with dummy values for day, month, and year\n\tconst dummyDate = new Date(0, 0, 0, hour, minute)\n\n\t// Use Intl.DateTimeFormat to format the time in 12-hour format\n\tconst formattedTime = new Intl.DateTimeFormat('en-US', {\n\t\thour: 'numeric',\n\t\tminute: 'numeric',\n\t\thour12: true,\n\t}).format(dummyDate)\n\n\treturn formattedTime\n}\n\nexport function formatNumber(number) {\n\treturn number.toLocaleString('en-IN', {\n\t\tmaximumFractionDigits: 0,\n\t})\n}\n\nexport function formatNumberIntoCurrency(number, currency) {\n\tif (number) {\n\t\treturn number.toLocaleString('en-IN', {\n\t\t\tmaximumFractionDigits: 0,\n\t\t\tstyle: 'currency',\n\t\t\tcurrency: currency,\n\t\t})\n\t}\n\treturn ''\n}\n\n// create a function that formats numbers in thousands to k\n\nexport function formatAmount(amount) {\n\tif (amount > 999) {\n\t\treturn (amount / 1000).toFixed(1) + 'k'\n\t}\n\treturn amount\n}\n\nexport function convertToTitleCase(str) {\n\tif (!str) {\n\t\treturn ''\n\t}\n\n\treturn str\n\t\t.toLowerCase()\n\t\t.split(' ')\n\t\t.map(function (word) {\n\t\t\treturn word.charAt(0).toUpperCase().concat(word.substr(1))\n\t\t})\n\t\t.join(' ')\n}\nexport function getFileSize(file_size) {\n\tlet value = parseInt(file_size)\n\tif (value > 1048576) {\n\t\treturn (value / 1048576).toFixed(2) + 'M'\n\t} else if (value > 1024) {\n\t\treturn (value / 1024).toFixed(2) + 'K'\n\t}\n\treturn value\n}\n\nexport function showToast(title, text, icon, iconClasses = null) {\n\tif (!iconClasses) {\n\t\tif (icon == 'check') {\n\t\t\ticonClasses = 'bg-surface-green-3 text-ink-white rounded-md p-px'\n\t\t} else if (icon == 'alert-circle') {\n\t\t\ticonClasses = 'bg-yellow-600 text-ink-white rounded-md p-px'\n\t\t} else {\n\t\t\ticonClasses = 'bg-surface-red-5 text-ink-white rounded-md p-px'\n\t\t}\n\t}\n\tcreateToast({\n\t\ttitle: title,\n\t\ttext: htmlToText(text),\n\t\ticon: icon,\n\t\ticonClasses: iconClasses,\n\t\tposition: icon == 'check' ? 'bottom-right' : 'top-center',\n\t\ttimeout: 5,\n\t})\n}\n\nexport function getImgDimensions(imgSrc) {\n\treturn new Promise((resolve) => {\n\t\tlet img = new Image()\n\t\timg.onload = function () {\n\t\t\tlet { width, height } = img\n\t\t\tresolve({ width, height, ratio: width / height })\n\t\t}\n\t\timg.src = imgSrc\n\t})\n}\n\nexport function updateDocumentTitle(meta) {\n\twatch(\n\t\t() => meta,\n\t\t(meta) => {\n\t\t\tif (!meta.value.title) return\n\t\t\tif (meta.value.title && meta.value.subtitle) {\n\t\t\t\tdocument.title = `${meta.value.title} | ${meta.value.subtitle}`\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (meta.value.title) {\n\t\t\t\tdocument.title = `${meta.value.title}`\n\t\t\t\treturn\n\t\t\t}\n\t\t},\n\t\t{ immediate: true, deep: true }\n\t)\n}\n\nexport function htmlToText(html) {\n\tconst div = document.createElement('div')\n\tdiv.innerHTML = html\n\treturn div.textContent || div.innerText || ''\n}\n\nexport function getEditorTools() {\n\treturn {\n\t\theader: {\n\t\t\tclass: Header,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Header',\n\t\t\t},\n\t\t},\n\t\tassignment: Assignment,\n\t\tquiz: Quiz,\n\t\texam: Exam,\n\t\tupload: Upload,\n\t\tmarkdown: {\n\t\t\tclass: Markdown,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\timage: SimpleImage,\n\t\ttable: {\n\t\t\tclass: Table,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\tparagraph: {\n\t\t\tclass: Paragraph,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tpreserveBlank: true,\n\t\t\t},\n\t\t},\n\t\tcodeBox: {\n\t\t\tclass: CodeBox,\n\t\t\tconfig: {\n\t\t\t\tthemeURL:\n\t\t\t\t\t'https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-dark.min.css',\n\t\t\t\tthemeName: 'atom-one-dark',\n\t\t\t\tuseDefaultTheme: 'dark',\n\t\t\t},\n\t\t},\n\t\tlist: {\n\t\t\tclass: NestedList,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tdefaultStyle: 'ordered',\n\t\t\t},\n\t\t},\n\t\tinlineCode: {\n\t\t\tclass: InlineCode,\n\t\t\tshortcut: 'CMD+SHIFT+M',\n\t\t},\n\t\tembed: {\n\t\t\tclass: Embed,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tservices: {\n\t\t\t\t\tyoutube: {\n\t\t\t\t\t\tregex: /(?:https?:\\/\\/)?(?:www\\.)?(?:(?:youtu\\.be\\/)|(?:youtube\\.com)\\/(?:v\\/|u\\/\\w\\/|embed\\/|watch))(?:(?:\\?v=)?([^#&?=]*))?((?:[?&]\\w*=\\w*)*)/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.youtube.com/embed/<%= remote_id %>',\n\t\t\t\t\t\thtml: '<iframe style=\"width:100%; height: 30rem;\" frameborder=\"0\" allowfullscreen></iframe>',\n\t\t\t\t\t\theight: 320,\n\t\t\t\t\t\twidth: 580,\n\t\t\t\t\t\tid: ([id, params]) => {\n\t\t\t\t\t\t\tif (!params && id) {\n\t\t\t\t\t\t\t\treturn id\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst paramsMap = {\n\t\t\t\t\t\t\t\tstart: 'start',\n\t\t\t\t\t\t\t\tend: 'end',\n\t\t\t\t\t\t\t\tt: 'start',\n\t\t\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\t\t\ttime_continue: 'start',\n\t\t\t\t\t\t\t\tlist: 'list',\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet newParams = params\n\t\t\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t\t\t.split('&')\n\t\t\t\t\t\t\t\t.map((param) => {\n\t\t\t\t\t\t\t\t\tconst [name, value] = param.split('=')\n\n\t\t\t\t\t\t\t\t\tif (!id && name === 'v') {\n\t\t\t\t\t\t\t\t\t\tid = value\n\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (!paramsMap[name]) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tvalue === 'LL' ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('RDMM') ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('FL')\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn `${paramsMap[name]}=${value}`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.filter((param) => !!param)\n\n\t\t\t\t\t\t\treturn id + '?' + newParams.join('&')\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tvimeo: true,\n\t\t\t\t\tcodepen: true,\n\t\t\t\t\taparat: {\n\t\t\t\t\t\tregex: /(?:http[s]?:\\/\\/)?(?:www.)?aparat\\.com\\/v\\/([^\\/\\?\\&]+)\\/?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame',\n\t\t\t\t\t\thtml: '<iframe style=\"margin: 0 auto; width: 100%; height: 25rem;\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe>',\n\t\t\t\t\t\theight: 300,\n\t\t\t\t\t\twidth: 600,\n\t\t\t\t\t},\n\t\t\t\t\tgithub: true,\n\t\t\t\t\tslides: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/pub/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdrive: {\n\t\t\t\t\t\tregex: /https:\\/\\/drive\\.google\\.com\\/file\\/d\\/([A-Za-z0-9_-]+)\\/view(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://drive.google.com/file/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 25rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdocsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/document\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/document/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tsheetsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/spreadsheets\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/spreadsheets/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tslidesPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tcodesandbox: {\n\t\t\t\t\t\tregex: /^https:\\/\\/codesandbox\\.io\\/(?:embed\\/)?([A-Za-z0-9_-]+)(?:\\?[^\\/]*)?$/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://codesandbox.io/embed/<%= remote_id %>?view=editor+%2B+preview&module=%2Findex.html',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;' sandbox='allow-mods allow-forms allow-popups allow-scripts allow-same-origin' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tfolder: {\n\t\t\tclass: FolderTool,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Add a folder with files',\n\t\t\t\tuploadEndpoint: '/api/upload-folder', // Example endpoint for folder uploads\n\t\t\t\trenderFiles: (files) => {\n\t\t\t\t\treturn files.map(file => `<a href=\"${file.url}\" download>${file.name}</a>`).join('<br>');\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t}\n}\n\nexport function getTimezones() {\n\treturn [\n\t\t'Pacific/Midway',\n\t\t'Pacific/Pago_Pago',\n\t\t'Pacific/Honolulu',\n\t\t'America/Anchorage',\n\t\t'America/Vancouver',\n\t\t'America/Los_Angeles',\n\t\t'America/Tijuana',\n\t\t'America/Edmonton',\n\t\t'America/Denver',\n\t\t'America/Phoenix',\n\t\t'America/Mazatlan',\n\t\t'America/Winnipeg',\n\t\t'America/Regina',\n\t\t'America/Chicago',\n\t\t'America/Mexico_City',\n\t\t'America/Guatemala',\n\t\t'America/El_Salvador',\n\t\t'America/Managua',\n\t\t'America/Costa_Rica',\n\t\t'America/Montreal',\n\t\t'America/New_York',\n\t\t'America/Indianapolis',\n\t\t'America/Panama',\n\t\t'America/Bogota',\n\t\t'America/Lima',\n\t\t'America/Halifax',\n\t\t'America/Puerto_Rico',\n\t\t'America/Caracas',\n\t\t'America/Santiago',\n\t\t'America/St_Johns',\n\t\t'America/Montevideo',\n\t\t'America/Araguaina',\n\t\t'America/Argentina/Buenos_Aires',\n\t\t'America/Godthab',\n\t\t'America/Sao_Paulo',\n\t\t'Atlantic/Azores',\n\t\t'Canada/Atlantic',\n\t\t'Atlantic/Cape_Verde',\n\t\t'UTC',\n\t\t'Etc/Greenwich',\n\t\t'Europe/Belgrade',\n\t\t'CET',\n\t\t'Atlantic/Reykjavik',\n\t\t'Europe/Dublin',\n\t\t'Europe/London',\n\t\t'Europe/Lisbon',\n\t\t'Africa/Casablanca',\n\t\t'Africa/Nouakchott',\n\t\t'Europe/Oslo',\n\t\t'Europe/Copenhagen',\n\t\t'Europe/Brussels',\n\t\t'Europe/Berlin',\n\t\t'Europe/Helsinki',\n\t\t'Europe/Amsterdam',\n\t\t'Europe/Rome',\n\t\t'Europe/Stockholm',\n\t\t'Europe/Vienna',\n\t\t'Europe/Luxembourg',\n\t\t'Europe/Paris',\n\t\t'Europe/Zurich',\n\t\t'Europe/Madrid',\n\t\t'Africa/Bangui',\n\t\t'Africa/Algiers',\n\t\t'Africa/Tunis',\n\t\t'Africa/Harare',\n\t\t'Africa/Nairobi',\n\t\t'Europe/Warsaw',\n\t\t'Europe/Prague',\n\t\t'Europe/Budapest',\n\t\t'Europe/Sofia',\n\t\t'Europe/Istanbul',\n\t\t'Europe/Athens',\n\t\t'Europe/Bucharest',\n\t\t'Asia/Nicosia',\n\t\t'Asia/Beirut',\n\t\t'Asia/Damascus',\n\t\t'Asia/Jerusalem',\n\t\t'Asia/Amman',\n\t\t'Africa/Tripoli',\n\t\t'Africa/Cairo',\n\t\t'Africa/Johannesburg',\n\t\t'Europe/Moscow',\n\t\t'Asia/Baghdad',\n\t\t'Asia/Kuwait',\n\t\t'Asia/Riyadh',\n\t\t'Asia/Bahrain',\n\t\t'Asia/Qatar',\n\t\t'Asia/Aden',\n\t\t'Asia/Tehran',\n\t\t'Africa/Khartoum',\n\t\t'Africa/Djibouti',\n\t\t'Africa/Mogadishu',\n\t\t'Asia/Dubai',\n\t\t'Asia/Muscat',\n\t\t'Asia/Baku',\n\t\t'Asia/Kabul',\n\t\t'Asia/Yekaterinburg',\n\t\t'Asia/Tashkent',\n\t\t'Asia/Calcutta',\n\t\t'Asia/Kathmandu',\n\t\t'Asia/Novosibirsk',\n\t\t'Asia/Almaty',\n\t\t'Asia/Dacca',\n\t\t'Asia/Krasnoyarsk',\n\t\t'Asia/Dhaka',\n\t\t'Asia/Bangkok',\n\t\t'Asia/Saigon',\n\t\t'Asia/Jakarta',\n\t\t'Asia/Irkutsk',\n\t\t'Asia/Shanghai',\n\t\t'Asia/Hong_Kong',\n\t\t'Asia/Taipei',\n\t\t'Asia/Kuala_Lumpur',\n\t\t'Asia/Singapore',\n\t\t'Australia/Perth',\n\t\t'Asia/Yakutsk',\n\t\t'Asia/Seoul',\n\t\t'Asia/Tokyo',\n\t\t'Australia/Darwin',\n\t\t'Australia/Adelaide',\n\t\t'Asia/Vladivostok',\n\t\t'Pacific/Port_Moresby',\n\t\t'Australia/Brisbane',\n\t\t'Australia/Sydney',\n\t\t'Australia/Hobart',\n\t\t'Asia/Magadan',\n\t\t'SST',\n\t\t'Pacific/Noumea',\n\t\t'Asia/Kamchatka',\n\t\t'Pacific/Fiji',\n\t\t'Pacific/Auckland',\n\t\t'Asia/Kolkata',\n\t\t'Europe/Kiev',\n\t\t'America/Tegucigalpa',\n\t\t'Pacific/Apia',\n\t]\n}\n\nexport function getUserTimezone() {\n\ttry {\n\t\tconst timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\t\tconst supportedTimezones = getTimezones()\n\n\t\tif (supportedTimezones.includes(timezone)) {\n\t\t\treturn timezone // e.g., 'Asia/Calcutta', 'America/New_York', etc.\n\t\t} else {\n\t\t\tthrow Error('unsupported timezone')\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('Error getting timezone:', error)\n\t\treturn null\n\t}\n}\n\nexport function getSidebarLinks() {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Courses',\n\t\t\ticon: 'BookOpen',\n\t\t\tto: 'Courses',\n\t\t\tactiveFor: [\n\t\t\t\t'Courses',\n\t\t\t\t'CourseDetail',\n\t\t\t\t'Lesson',\n\t\t\t\t'CourseForm',\n\t\t\t\t'LessonForm',\n\t\t\t],\n\t\t},\n\t\n\t\t{\n\t\t\tlabel: 'Statistics',\n\t\t\ticon: 'TrendingUp',\n\t\t\tto: 'Statistics',\n\t\t\tactiveFor: ['Statistics'],\n\t\t},\n\t]\n}\n\nexport function getFormattedDateRange(\n\tstartDate,\n\tendDate,\n\tformat = 'DD MMM YYYY'\n) {\n\tif (startDate === endDate) {\n\t\treturn dayjs(startDate).format(format)\n\t}\n\treturn `${dayjs(startDate).format(format)} - ${dayjs(endDate).format(\n\t\tformat\n\t)}`\n}\n\nexport function getLineStartPosition(string, position) {\n\tconst charLength = 1\n\tlet char = ''\n\n\twhile (char !== '\\n' && position > 0) {\n\t\tposition = position - charLength\n\t\tchar = string.substr(position, charLength)\n\t}\n\n\tif (char === '\\n') {\n\t\tposition += 1\n\t}\n\n\treturn position\n}\n\nexport function singularize(word) {\n\tconst endings = {\n\t\tves: 'fe',\n\t\ties: 'y',\n\t\ti: 'us',\n\t\tzes: 'ze',\n\t\tses: 's',\n\t\tes: 'e',\n\t\ts: '',\n\t}\n\treturn word.replace(\n\t\tnew RegExp(`(${Object.keys(endings).join('|')})$`),\n\t\t(r) => endings[r]\n\t)\n}\n\nexport const validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'webp'].includes(extension)) {\n\t\treturn __('Only image file is allowed.')\n\t}\n}\n\nexport const escapeHTML = (text) => {\n\tif (!text) return ''\n\tlet escape_html_mapping = {\n\t\t'&': '&amp;',\n\t\t'<': '&lt;',\n\t\t'>': '&gt;',\n\t\t'\"': '&quot;',\n\t\t\"'\": '&#39;',\n\t\t'`': '&#x60;',\n\t\t'=': '&#x3D;',\n\t}\n\n\treturn String(text).replace(\n\t\t/[&<>\"'`=]/g,\n\t\t(char) => escape_html_mapping[char] || char\n\t)\n}\n"],"names":["props","__props","progressBarWidth","computed","progressBarHeight","_createBlock","_unref","Tooltip","_createElementVNode","_hoisted_1","_normalizeClass","user","inject","fullQuizMode","ref","activeQuestion","currentQuestion","selectedOptions","reactive","showAnswers","questions","possibleAnswer","timer","timerInterval","router","useRouter","elapsedTime","answers","quiz","createResource","values","data","populateQuestions","setupTimer","err","isQuizLoaded","shuffledQuestions","shuffleArray","startTimer","submitQuiz","formatTimer","seconds","hrs","mins","secs","timerProgress","array","i","j","attempts","_a","_b","submission","index","timeAgo","watch","newData","resetQuiz","quizSubmission","timeTaken","all_questions_details","question","__spreadProps","__spreadValues","questionDetails","value","newName","q","startQuiz","startQuiz2","markAnswer","getAnswers","checkAnswer","createToast","option","addToLocalStorage","resetQuestion","quizData","questionData","answer","existingIndex","item","nextQuestion","createSubmission","submitQuizComplete","__async","results","detailedQuestions","response","call","is_correct","val","correctAnswers","correctAnswer","markLessonProgress","toast","getInstructions","recordAnswer","qtidx","toggleAnswer","quizResults","_createElementBlock","_hoisted_2","_hoisted_3","_toDisplayString","_openBlock","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_cache","_hoisted_10","_createVNode","ProgressBar","_hoisted_11","_hoisted_12","_hoisted_13","Button","_hoisted_15","_Fragment","_renderList","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_22","$event","idx","_hoisted_25","CheckCircle","MinusCircle","XCircle","_vShow","_hoisted_27","FormControl","_hoisted_28","Badge","_hoisted_29","TextEditor","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_38","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","redirectToLogin","Quiz","__","show","assignment","exam","onMounted","nextTick","addAssessment","redirectToForm","Dialog","Link","close","api","readOnly","app","createApp","h","CircleHelp","div","QuizBlock","translationPlugin","userResource","usersStore","AssessmentPlugin","blockContent","submissionFile","comments","showTitle","isDirty","keyboardShortcut","e","submitAssignment","onBeforeUnmount","submissionResource","newSubmission","doc","showUploader","imageResource","createDocumentResource","newGrade","oldGrade","evaluator","_c","addNewSubmission","saveSubmission","file","courseName","chapterNumber","lessonNumber","getType","type","validateFile","extension","removeSubmission","canGradeSubmission","canModifyAssignment","submissionStatusOptions","statusTheme","_hoisted_14","FileText","X","FileUploader","uploading","progress","openFileSelector","_hoisted_21","_hoisted_23","_hoisted_24","_hoisted_26","Assignment","Pencil","AssignmentBlock","submisisonDetails","newDoc","formatTime","row","_mergeProps","$attrs","socket","initSocket","isLoadingUsers","showTopics","_useModel","newReply","mentionUsers","renderEditor","editorKey","fetchMentionUsers","replies","error","newTopic","oldTopic","newReplyResource","allUsers","postReply","editReplyResource","postEdited","reply","deleteReplyResource","deleteReply","ChevronLeft","UserAvatar","Dropdown","_withCtx","open","MoreHorizontal","topics","topic","resetTopic","topicResource","replyResource","submitTopic","handleCancel","dialogOptions","singularize","getScrollContainer","currentTopic","showTopicModal","loading","socketConnected","reason","isConnected","executeOnMountedLogic","singleTopicResource","scrollToEnd","scrollContainer","showReplies","openTopicModal","DiscussionModal","DiscussionReplies","MessageSquareText","fullExamMode","user_is_instructor","isExamLoaded","hasSubmittedExam","instructors","is_instructor","instructor","timerStartTime","endTime","currentTime","remainingTime","submitExam","newAnswers","get_answers","rawAnswers","toRaw","questionName","updateAnswer","submittedAnswers","startExam","startExam2","submission_anystatus","Discussions","ExamGraded","_component_router_link","SquarePen","Exam","BookOpenCheck","ExamBlock","isPlaying","audio","isMuted","duration","togglePlay","toggleMute","changeCurrentTime","handleAudioEnd","time","minutes","newVal","Pause","Play","VolumeX","Volume2","videoRef","videoContainer","playing","muted","fileURL","isYoutube","url","playVideo","pauseVideo","videoEnded","toggleFullscreen","_ctx","args","Maximize","fileUploader","fileInput","addFile","Upload","UploadIcon","VideoBlock","AudioBlock","UploadPlugin","savedData","Markdown","config","CodeXml","event","block","level","previousLine","text","anchorTag","currentIndex","currentBlock","line","match","DEFAULT_THEMES","COMMON_LANGUAGES","CodeBox","__publicField","Code","codeAreaHolder","languageSelect","selectHolder","selectPreview","languages","language","selectItem","hljs","selectPreviews","len","highlightJSCSSElement","highlightJSCSSURL","link","head","themeURL","route","useRoute","folderAction","selectedFolder","foldername","newFolderName","files","folders","course","currentFolderId","currentFolderName","breadcrumbStack","subfolders","isDragActive","newSubfolderName","fileInputRef","getCsrfToken","fetchCourse","result","addFolder","folder","initializeFromFolder","_0","_1","folderLabel","refreshFolders","targetFolder","fetchFolders","matchingFolder","fetchFiles","createFolder","FolderTool","folderId","targetFolderId","targetFolderLabel","entries","entry","uploadFiles","droppedFiles","fileList","formData","csrfToken","removeFile","fileUrl","onDragEnter","onDragOver","onDragLeave","onDrop","triggerFileSelect","openSubfolder","navigateToBreadcrumb","target","createSubfolder","newFolder","hasMounted","newValue","oldValue","trimmedValue","previous","crumb","Trash2","_withModifiers","folderName","isLoading","errorMessage","humanFileSize","size","buildParams","params","labelCandidate","loadFolder","openRootFolder","root","trimmed","FolderOpen","FolderBlock","initialFolder","FolderPlugin","trimmedFolderName","responseData","serverMessage","parentFolderId","parentFolderName","subfolderName","trimmedSubfolderName","options","date","useTimeAgo","formatAmount","amount","getFileSize","file_size","updateDocumentTitle","meta","getEditorTools","Header","SimpleImage","Table","Paragraph","NestedList","InlineCode","Embed","id","paramsMap","newParams","param","name","word","endings","r"],"mappings":"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"}