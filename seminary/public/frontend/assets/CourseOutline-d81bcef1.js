var Q=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var F=(t,i)=>{var o={};for(var l in t)pe.call(t,l)&&i.indexOf(l)<0&&(o[l]=t[l]);if(t!=null&&Q)for(var l of Q(t))i.indexOf(l)<0&&me.call(t,l)&&(o[l]=t[l]);return o};var X=(t,i,o)=>new Promise((l,e)=>{var v=p=>{try{r(o.next(p))}catch(g){e(g)}},c=p=>{try{r(o.throw(p))}catch(g){e(g)}},r=p=>p.done?l(p.value):Promise.resolve(p.value).then(v,c);r((o=o.apply(t,i)).next())});import{r as D,m as U,a2 as le,K as A,a3 as oe,l as B,a4 as re,i as j,s as ne,y as _e,z as Z,a as fe,c as E,n as he,o as m,f as x,w as b,e as h,h as y,b as u,a5 as ve,d as P,_ as R,A as T,t as S,g as O,D as ge,Y as ke,x as ye,j as be,U as I,F as L,k as G,Z as J,P as W,a6 as Ce,a7 as xe}from"./index-02404b00.js";import{F as Se,h as ie,i as De,s as w,T as we,j as $e}from"./index-e83657f9.js";import{o as $,b as ee,c as te,t as Pe,d as z,A as q,e as Me,N as ae,f as V,a as Ne}from"./plus-8456e85b.js";import{c as Oe,C as Ee}from"./telemetry-9c8f0c58.js";import{u as Ve}from"./settings-72635992.js";import{X as Fe}from"./Link-a70f2c53.js";import{B as Te}from"./book-open-check-0ff0eb37.js";import{F as Be}from"./file-up-039e81f5.js";import{C as ze}from"./check-23b76c05.js";function se(t,i){if(t)return t;let o=i!=null?i:"button";if(typeof o=="string"&&o.toLowerCase()==="button")return"button"}function Ie(t,i){let o=D(se(t.value.type,t.value.as));return U(()=>{o.value=se(t.value.type,t.value.as)}),le(()=>{var l;o.value||$(i)&&$(i)instanceof HTMLButtonElement&&!((l=$(i))!=null&&l.hasAttribute("type"))&&(o.value="button")}),o}var Le=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Le||{});let ue=Symbol("DisclosureContext");function H(t){let i=j(ue,null);if(i===null){let o=new Error(`<${t} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,H),o}return i}let ce=Symbol("DisclosurePanelContext");function Re(){return j(ce,null)}let Ue=A({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(t,{slots:i,attrs:o}){let l=D(t.defaultOpen?0:1),e=D(null),v=D(null),c={buttonId:D(`headlessui-disclosure-button-${ee()}`),panelId:D(`headlessui-disclosure-panel-${ee()}`),disclosureState:l,panel:e,button:v,toggleDisclosure(){l.value=te(l.value,{0:1,1:0})},closeDisclosure(){l.value!==1&&(l.value=1)},close(r){c.closeDisclosure();let p=(()=>r?r instanceof HTMLElement?r:r.value instanceof HTMLElement?$(r):$(c.button):$(c.button))();p==null||p.focus()}};return oe(ue,c),Pe(B(()=>te(l.value,{0:z.Open,1:z.Closed}))),()=>{let C=t,{defaultOpen:r}=C,p=F(C,["defaultOpen"]),g={open:l.value===0,close:c.close};return q({theirProps:p,ourProps:{},slot:g,slots:i,attrs:o,name:"Disclosure"})}}}),Ae=A({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(t,{attrs:i,slots:o,expose:l}){let e=H("DisclosureButton"),v=Re(),c=B(()=>v===null?!1:v.value===e.panelId.value);U(()=>{c.value||t.id!==null&&(e.buttonId.value=t.id)}),re(()=>{c.value||(e.buttonId.value=null)});let r=D(null);l({el:r,$el:r}),c.value||le(()=>{e.button.value=r.value});let p=Ie(B(()=>({as:t.as,type:i.type})),r);function g(){var a;t.disabled||(c.value?(e.toggleDisclosure(),(a=$(e.button))==null||a.focus()):e.toggleDisclosure())}function C(a){var n;if(!t.disabled)if(c.value)switch(a.key){case V.Space:case V.Enter:a.preventDefault(),a.stopPropagation(),e.toggleDisclosure(),(n=$(e.button))==null||n.focus();break}else switch(a.key){case V.Space:case V.Enter:a.preventDefault(),a.stopPropagation(),e.toggleDisclosure();break}}function M(a){switch(a.key){case V.Space:a.preventDefault();break}}return()=>{var a;let n={open:e.disclosureState.value===0},N=t,{id:d}=N,s=F(N,["id"]),k=c.value?{ref:r,type:p.value,onClick:g,onKeydown:C}:{id:(a=e.buttonId.value)!=null?a:d,ref:r,type:p.value,"aria-expanded":e.disclosureState.value===0,"aria-controls":e.disclosureState.value===0||$(e.panel)?e.panelId.value:void 0,disabled:t.disabled?!0:void 0,onClick:g,onKeydown:C,onKeyup:M};return q({ourProps:k,theirProps:s,slot:n,attrs:i,slots:o,name:"DisclosureButton"})}}}),je=A({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:i,slots:o,expose:l}){let e=H("DisclosurePanel");U(()=>{t.id!==null&&(e.panelId.value=t.id)}),re(()=>{e.panelId.value=null}),l({el:e.panel,$el:e.panel}),oe(ce,e.panelId);let v=Me(),c=B(()=>v!==null?(v.value&z.Open)===z.Open:e.disclosureState.value===0);return()=>{var r;let p={open:e.disclosureState.value===0,close:e.close},a=t,{id:g}=a,C=F(a,["id"]),M={id:(r=e.panelId.value)!=null?r:g,ref:e.panel};return q({ourProps:M,theirProps:C,slot:p,attrs:i,slots:o,features:ae.RenderStrategy|ae.Static,visible:c.value,name:"DisclosurePanel"})}}});/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=ne("FilePenLineIcon",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=ne("MonitorPlayIcon",[["path",{d:"M10 7.75a.75.75 0 0 1 1.142-.638l3.664 2.249a.75.75 0 0 1 0 1.278l-3.664 2.25a.75.75 0 0 1-1.142-.64z",key:"1pctta"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]]),Ke={class:"space-y-4 text-base"},Ye={key:0},Qe={class:"mb-4"},Xe={key:1,class:""},Ze={class:"flex items-center"},Ge={class:"border rounded-md p-2 mr-2"},Je={class:"flex flex-col"},We={class:"text-sm text-ink-gray-4 mt-1"},et={__name:"ChapterModal",props:_e({course:{type:String,required:!0},chapterDetail:{type:Object}},{modelValue:{},modelModifiers:{},outline:{},outlineModifiers:{}}),emits:["update:modelValue","update:outline"],setup(t){const i=Z(t,"modelValue"),o=Z(t,"outline");Ve();const l=t,e=fe({title:"",is_scorm_package:0,scorm_package:null}),v=E({url:"seminary.seminary.api.upsert_chapter",makeParams(a){var n;return{chapter_title:e.chapter_title,course:l.course,is_scorm_package:e.is_scorm_package,scorm_package:e.scorm_package,name:(n=l.chapterDetail)==null?void 0:n.name}}}),c=E({url:"frappe.client.insert",makeParams(a){return{doc:{doctype:"Course Schedule Chapter Reference",chapter:a.name,parent:l.course,parenttype:"Course Schedule",parentfield:"chapters"}}}}),r=a=>X(this,null,function*(){v.submit({},{validate(){return p()},onSuccess:n=>{Oe("chapter_created"),c.submit({name:n.name},{onSuccess(d){g(),o.value.reload(),w(__("Success"),__("Chapter added successfully"),"check")},onError(d){var s;w(__("Error"),((s=d.messages)==null?void 0:s[0])||d,"x")}}),a()},onError(n){var d;w(__("Error"),((d=n.messages)==null?void 0:d[0])||n,"x")}})}),p=()=>{if(!e.chapter_title)return __("Chapter Title is required");if(e.is_scorm_package&&!e.scorm_package)return __("Please upload a SCORM package or uncheck the SCORM package option")},g=()=>{e.chapter_title="",e.is_scorm_package=0,e.scorm_package=null},C=a=>{v.submit({},{validate(){if(!e.chapter_title)return"Chapter Title is required"},onSuccess(){o.value.reload(),w(__("Success"),__("Chapter updated successfully"),"check"),a()},onError(n){var d;w(__("Error"),((d=n.messages)==null?void 0:d[0])||n,"x")}})};he(()=>l.chapterDetail,a=>{e.chapter_title=a==null?void 0:a.chapter_title,e.is_scorm_package=a==null?void 0:a.is_scorm_package,e.scorm_package=a==null?void 0:a.scorm_package});const M=a=>{if(a.name.split(".").pop().toLowerCase()!=="zip")return __("Only zip files are allowed")};return(a,n)=>(m(),x(u(ge),{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=d=>i.value=d),options:{title:t.chapterDetail?a.__("Edit Chapter"):a.__("Add Chapter"),size:"lg",actions:[{label:t.chapterDetail?a.__("Edit"):a.__("Create"),variant:"solid",onClick:d=>t.chapterDetail?C(d):r(d)}]}},{"body-content":b(()=>[h("div",Ke,[y(u(Ne),{label:"Title",modelValue:e.chapter_title,"onUpdate:modelValue":n[0]||(n[0]=d=>e.chapter_title=d),required:!0},null,8,["modelValue"]),y(u(ve),{size:"sm",label:a.__("SCORM Package"),description:a.__("Enable this only if you want to upload a SCORM package as a chapter."),modelValue:e.is_scorm_package,"onUpdate:modelValue":n[1]||(n[1]=d=>e.is_scorm_package=d)},null,8,["label","description","modelValue"]),e.is_scorm_package?(m(),P("div",Ye,[e.scorm_package?(m(),P("div",Xe,[h("div",Ze,[h("div",Ge,[y(u(ie),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),h("div",Je,[h("span",null,S(e.scorm_package.file_name),1),h("span",We,S(u(De)(e.scorm_package.file_size)),1)]),y(u(Fe),{onClick:n[3]||(n[3]=()=>e.scorm_package=null),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})])])):(m(),x(u(Se),{key:0,fileTypes:[".zip"],validateFile:M,onSuccess:n[2]||(n[2]=d=>e.scorm_package=d)},{default:b(({file:d,progress:s,uploading:k,openFileSelector:N})=>[h("div",Qe,[y(u(R),{onClick:N,loading:k},{default:b(()=>[T(S(k?`Uploading ${s}%`:"Upload an zip file"),1)]),_:2},1032,["onClick","loading"])])]),_:1}))])):O("",!0)])]),_:1},8,["modelValue","options"]))}},tt={class:"text-base"},at={class:"grid grid-cols-[70%,30%] mb-4 px-2"},st=["onClick"],lt={class:"flex ml-auto space-x-4"},ot={class:"flex flex-col items-start text-sm leading-5 group"},rt={class:"flex items-center"},nt={key:0,class:"rounded-md bg-[#E6F4FF] p-2 w-full mt-2"},it={key:1,class:"rounded-md bg-[#E6F7F4] p-2 mt-2"},ut={class:"flex mt-2 mb-4 pl-8"},yt={__name:"CourseOutline",props:{courseName:{type:String,required:!0},showOutline:{type:Boolean,default:!1},title:{type:String,default:""},allowEdit:{type:Boolean,default:!1},getProgress:{type:Boolean,default:!1}},setup(t){const i=ke(),o=ye(),l=j("$user"),e=D(!1),v=D(null),c=t,r=E({url:"seminary.seminary.utils.get_course_outline",cache:["course_outline",c.courseName],params:{course:c.courseName,progress:c.getProgress},auto:!0});E({url:"seminary.seminary.utils.get_course_title",cache:["course_title",c.courseName],params:{course:c.courseName},auto:!0}),E({url:"seminary.seminary.api.delete_lesson",makeParams(s){return{lesson:s.lesson,chapter:s.chapter}},onSuccess(){r.reload(),w("Success","Lesson deleted successfully","check")}}),E({url:"seminary.seminary.api.update_lesson_index",makeParams(s){return{lesson:s.lesson,sourceChapter:s.sourceChapter,targetChapter:s.targetChapter,idx:s.idx}},onSuccess(){w("Success","Lesson moved successfully","check")}});const p=s=>s==i.params.chapterNumber||s==1,g=(s=null)=>{v.value=s,e.value=!0},C=()=>v.value,M=E({url:"seminary.seminary.api.delete_chapter",makeParams(s){return{chapter:s.chapter}},onSuccess(){r.reload(),w("Success","Chapter deleted successfully","check")}}),a=s=>{console.log("trashChapter called with:",s),xe({title:__("Delete this chapter?"),message:__("Deleting this chapter will also delete all its lessons and permanently remove it from the course. This action cannot be undone. Are you sure you want to continue?"),actions:[{label:__("Delete"),theme:"red",variant:"solid",onClick(k){M.submit({chapter:s}),k()}}]})},n=s=>{if(s.is_scorm_package&&(event.preventDefault(),!c.allowEdit)){if(!l.data){w(__("You are not enrolled"),__("Please enroll for this course to view this lesson"),"alert-circle");return}o.push({name:"SCORMChapter",params:{courseName:c.courseName,chapterName:s.name}})}},d=s=>i.params.chapterNumber==s.split(".")[0]&&i.params.lessonNumber==s.split(".")[1];return(s,k)=>{var K;const N=be("router-link");return m(),P(L,null,[h("div",tt,[h("div",at,[k[3]||(k[3]=h("div",{class:"font-semibold text-lg leading-5 text-ink-gray-9"},null,-1)),y(u(R),{size:"sm",onClick:k[0]||(k[0]=f=>g())},{default:b(()=>[T(S(s.__("Add Chapter")),1)]),_:1})]),h("div",{class:I({"border-2 rounded-md py-2 px-2":t.showOutline&&((K=u(r).data)==null?void 0:K.length)})},[(m(!0),P(L,null,G(u(r).data,(f,de)=>(m(),x(u(Ue),{key:f.name,defaultOpen:p(f.idx)},{default:b(({open:Y})=>[y(u(Ae),{ref_for:!0,ref:"",class:"flex items-center w-full p-2 group"},{default:b(()=>[y(u(Ee),{class:I([{"rotate-90 transform duration-200":Y,"duration-200":!Y,hidden:f.is_scorm_package,open:de==1},"h-4 w-4 text-ink-gray-9 stroke-1"])},null,8,["class"]),h("div",{class:"text-base text-left text-ink-gray-9 font-medium leading-5 ml-2",onClick:_=>n(f)},S(f.chapter_title),9,st),h("div",lt,[y(u(J),{text:s.__("Edit Chapter"),placement:"bottom"},{default:b(()=>[y(u(qe),{onClick:W(_=>g(f),["prevent"]),class:"h-4 w-4 text-ink-gray-9 invisible group-hover:visible"},null,8,["onClick"])]),_:2},1032,["text"]),y(u(J),{text:s.__("Delete Chapter"),placement:"bottom"},{default:b(()=>[y(u(we),{onClick:W(_=>a(f.name),["prevent"]),class:"h-4 w-4 text-red-500 invisible group-hover:visible"},null,8,["onClick"])]),_:2},1032,["text"])])]),_:2},1536),f.is_scorm_package?O("",!0):(m(),x(u(je),{key:0},{default:b(()=>[(m(!0),P(L,null,G(f.lessons,_=>(m(),P("div",{key:_.name,class:I(["outline-lesson pl-8 py-2 pr-4 text-ink-gray-9",d(_.number)?"bg-surface-selected":""])},[y(N,{to:{name:"Lesson",params:{courseName:t.courseName,chapterNumber:_.number.split(".")[0],lessonNumber:_.number.split(".")[1]}}},{default:b(()=>[h("div",ot,[h("div",rt,[_.icon==="icon-youtube"?(m(),x(u(He),{key:0,class:"h-4 w-4 stroke-1 mr-2"})):_.icon==="icon-quiz"?(m(),x(u($e),{key:1,class:"h-4 w-4 stroke-1 mr-2"})):_.icon==="icon-exam"?(m(),x(u(Te),{key:2,class:"h-4 w-4 stroke-1 mr-2"})):_.icon==="icon-assignment"?(m(),x(u(Be),{key:3,class:"h-4 w-4 stroke-1 mr-2"})):_.icon==="icon-list"?(m(),x(u(ie),{key:4,class:"h-4 w-4 text-ink-gray-9 stroke-1 mr-2"})):O("",!0),T(" "+S(_.lesson_title)+" ",1),_.is_complete?(m(),x(u(ze),{key:5,class:"h-4 w-4 text-green-700 ml-2"})):O("",!0)]),_.preview?(m(),P("div",nt,S(_.preview),1)):O("",!0),_.due_date?(m(),P("div",it,S(s.__("Due: ")+new Intl.DateTimeFormat(u(l).data.language||"en-US",{dateStyle:"medium"}).format(new Date(_.due_date))),1)):O("",!0)])]),_:2},1032,["to"])],2))),128)),h("div",ut,[f.is_scorm_package?O("",!0):(m(),x(N,{key:0,to:{name:"LessonForm",params:{courseName:t.courseName,chapterNumber:f.idx,lessonNumber:f.lessons.length+1}}},{default:b(()=>[y(u(R),null,{default:b(()=>[T(S(s.__("Add Lesson")),1)]),_:1})]),_:1},8,["to"]))])]),_:2},1024))]),_:2},1032,["defaultOpen"]))),128))],2)]),y(et,{modelValue:e.value,"onUpdate:modelValue":k[1]||(k[1]=f=>e.value=f),outline:u(r),"onUpdate:outline":k[2]||(k[2]=f=>Ce(r)?r.value=f:null),course:t.courseName,chapterDetail:C()},null,8,["modelValue","outline","course","chapterDetail"])],64)}}};export{yt as _};
//# sourceMappingURL=CourseOutline-d81bcef1.js.map
