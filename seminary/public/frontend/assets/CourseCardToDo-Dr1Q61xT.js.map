{"version":3,"file":"CourseCardToDo-Dr1Q61xT.js","sources":["../../../../frontend/src/utils/useCourseToDo.js","../../../../frontend/src/components/CourseCardToDo.vue"],"sourcesContent":["// utils/useCourseToDo.js\nimport { createResource } from 'frappe-ui'\nimport { computed } from 'vue'\n\nexport function useCourseToDo(courseName, user) {\n\n  const isStudent =  user?.data?.is_student\n  const isInstructor =  user?.data?.is_instructor\n    console.log(\"useCourseToDo\", courseName, user?.data?.name, isStudent, isInstructor)\n  const course = createResource({\n    url: 'seminary.seminary.utils.get_course_details',\n    cache: ['course', courseName],\n    params: { course: courseName },\n    auto: true,\n  })\n\n  const assessments = createResource({\n    url: 'seminary.seminary.utils.get_assessments',\n    cache: ['assessments', courseName],\n    params: { course: courseName },\n  })\n\n  const missingAssessments = createResource({\n    url: 'seminary.seminary.utils.get_missingassessments',\n    cache: ['missingassessments', courseName],\n    params: {\n      course: courseName,\n      member: user?.data?.name,\n    },\n  })\n\n  const assessmentsToGrade = createResource({\n    url: 'seminary.seminary.utils.get_assessments_tograde',\n    cache: ['assessments_tograde', courseName],\n    params: { course: courseName },\n  })\n\n\n  const countToDoItems = computed(() => {\n    const countMissing = missingAssessments.data?.length || 0\n    const countDueSoon = (assessments.data || []).filter(a => new Date(a.due_date) >= new Date()).length\n    const countToGrade = assessmentsToGrade.data?.length || 0\n    if (isStudent) {\n      return countMissing + countDueSoon\n    }\n    if (isInstructor) {\n      return countToGrade\n    }\n  })\n  console.log(\"Course: \", courseName, 'countToDoItems', countToDoItems.value)\n  return {\n    course,\n    assessments,\n    missingAssessments,\n    assessmentsToGrade,\n    isStudent,\n    isInstructor,\n    countToDoItems,\n  }\n}\n","<template>\n  <div v-if=\"course\" class=\"border-2 rounded-md min-w-80 p-5\">\n    <div v-if=\"singleCourse\" class=\"text-3xl font-semibold text-ink-gray-9 text-center\">\n      {{ __(\"To Do\") }}\n    </div>\n\n    <!-- Student View -->\n    <div v-if=\"course.data?.course && isStudent\" class=\"text-ink-gray-7\">\n      <section v-if=\"missingAssessments.data?.length\" class=\"missing-assessments mt-4\">\n        <h3 class=\"text-xl font-semibold text-ink-gray-9\">{{ __(\"Missing Assessments\") }}</h3>\n        <ul>\n          <li v-for=\"assessment in missingAssessments.data\" :key=\"assessment.id\" class=\"text-ink-gray-7\">\n            {{ assessment.title }} ({{ __('Due') }}: {{ formatDate(assessment.due_date) }})\n          </li>\n        </ul>\n      </section>\n\n      <section v-if=\"assessments?.data?.length\" class=\"due-soon mt-4\">\n        <h3>{{ __('Due Soon') }}</h3>\n        <ul>\n          <li v-for=\"assessment in assessments.data.filter(a => new Date(a.due_date) >= new Date()).slice(0, 5)\"\n            :key=\"assessment.id\">\n            {{ assessment.title }} ({{ __('Due') }}: {{ formatDate(assessment.due_date) }})\n          </li>\n        </ul>\n      </section>\n\n      <section v-if=\"!missingAssessments.data?.length && !assessments.data?.length\" class=\"no-assessments mt-4\">\n        <h3 class=\"text-xl font-semibold text-ink-gray-9\">\n          {{ __(\"Congrats! No assessments for now.\") }}\n        </h3>\n      </section>\n    </div>\n\n    <!-- Instructor View -->\n    <div v-if=\"course.data?.course && isInstructor && assessmentsToGrade.data?.length\" class=\"text-ink-gray-7\">\n      <div v-for=\"assessmentTG in assessmentsToGrade.data\" :key=\"assessmentTG.title\" class=\"text-ink-gray-7 mt-4\">\n        <ul>\n          <router-link v-if=\"assessmentTG.Type === 'Exam'\"\n            :to=\"{ name: 'ExamSubmissionCS', params: { courseName: props.course, examID: assessmentTG.assessmentID } }\"\n            class=\"text-ink-gray-7 mt-4 flex items-center space-x-2\">\n            <BookOpenCheck class=\"h-4 w-4 stroke-1.5\" />\n            <span>{{ assessmentTG.title }} ({{ assessmentTG.ToGrade }} {{ __(\" to grade\") }})</span>\n          </router-link>\n\n          <router-link v-else-if=\"assessmentTG.Type === 'Assignment'\"\n            :to=\"{ name: 'AssignmentSubmissionCS', params: { courseName: props.course, assignmentID: assessmentTG.assessmentID } }\"\n            class=\"text-ink-gray-7 flex items-center space-x-2\">\n            <FileUp class=\"h-4 w-4 stroke-1.5\" />\n            <span>{{ assessmentTG.title }} ({{ assessmentTG.ToGrade }} {{ __(\" to grade\") }})</span>\n          </router-link>\n        </ul>\n      </div>\n    </div>\n\n    <div v-if=\"course.data?.course && isInstructor && !assessmentsToGrade.data?.length\" class=\"text-ink-gray-7\">\n      <PartyPopper class=\"size-20 mx-auto stroke-1 text-gray-500 mt-5\" />\n      <h3 class=\"text-xl text-center font-semibold text-gray-500 mt-5\">\n        {{ __('Congrats! No assessments to grade for now.') }}\n      </h3>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { PartyPopper, BookOpenCheck, FileUp } from 'lucide-vue-next'\nimport { useCourseToDo } from '@/utils/useCourseToDo'\nimport dayjs from '@/utils/dayjs'\nimport { inject } from 'vue'\n\nconst user = inject('$user')\nconst props = defineProps({\n  course: {\n    type: String,\n    required: true,\n  },\n  singleCourse: {\n    type: Boolean,\n    default: true,\n  },\n})\n\nconst {\n  course,\n  assessments,\n  missingAssessments,\n  assessmentsToGrade,\n  isStudent,\n  isInstructor,\n} = useCourseToDo(props.course, user)\n\nconst formatDate = (date) => dayjs(date).fromNow()\n</script>\n\n<style scoped>\n.course-card-todo {\n  padding: 1rem;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  background-color: #f9f9f9;\n}\n\nsection {\n  margin-bottom: 1.5rem;\n}\n\nul {\n  list-style: none;\n  padding: 0;\n}\n\nli {\n  margin-bottom: 0.5rem;\n}\n</style>"],"names":["useCourseToDo","courseName","user","isStudent","_a","isInstructor","_b","_c","course","createResource","assessments","missingAssessments","_d","assessmentsToGrade","countToDoItems","computed","countMissing","countDueSoon","a","countToGrade","inject","props","__props","formatDate","date","dayjs","_unref","_openBlock","_createElementBlock","_hoisted_1","_hoisted_2","_toDisplayString","__","_hoisted_3","_hoisted_4","_createElementVNode","_hoisted_5","_Fragment","_renderList","assessment","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","assessmentTG","_createBlock","_component_router_link","_createVNode","BookOpenCheck","FileUp","_hoisted_10","PartyPopper","_hoisted_11"],"mappings":"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"}