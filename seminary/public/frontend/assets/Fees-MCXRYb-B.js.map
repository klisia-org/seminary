{"version":3,"file":"Fees-MCXRYb-B.js","sources":["../../../../frontend/src/pages/Fees.vue"],"sourcesContent":["<template>\n\t<div v-if=\"isStudent\">\n\n\t\t<h2\n\t\t\tclass=\"text-xl font-bold text-gray-800 sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\">\n\t\t\t{{ __('My Financial Status') }}\n\t\t</h2>\n\n\n\t\t<div v-if=\"studentInfo.scholarships && studentInfo.scholarships?.[0]?.scholarship\"\n\t\t\tclass=\"flex flex-col items-center justify-center p-3\">\n\t\t\t<h2 class=\"text-lg font-bold text-gray-800\">\n\t\t\t\t{{ __('Scholarship') }}: {{ studentInfo.scholarships[0].scholarship }}\n\t\t\t</h2>\n\t\t\t<br>\n\t\t</div>\n\t\t<div v-else class=\"flex flex-col items-center justify-center\">\n\t\t\t<p class=\"text-lg font-bold text-gray-800\"> </p>\n\t\t</div>\n\n\t\t<div v-if=\"tableData.rows.length > 0\" class=\"px-5 py-4\">\n\t\t\t<ListView :columns=\"tableData.columns\" :rows=\"tableData.rows\" :options=\"{\n\t\t\t\tselectable: false,\n\t\t\t\tshowTooltip: false,\n\t\t\t\tonRowClick: () => { },\n\t\t\t}\" row-key=\"id\" v-if=\"tableData.rows.length > 0\">\n\t\t\t\t<ListHeader>\n\t\t\t\t\t<ListHeaderItem v-for=\"column in tableData.columns\" :key=\"column.key\" :item=\"column\" />\n\t\t\t\t</ListHeader>\n\t\t\t\t<ListRow v-for=\"row in tableData.rows\" :key=\"row.id\" :row=\"row\" v-slot=\"{ column, item }\">\n\t\t\t\t\t<ListRowItem :item=\"item\" :align=\"column.align\">\n\t\t\t\t\t\t<Badge v-if=\"column.key === 'status'\" variant=\"subtle\" :theme=\"row.status === 'Paid' ? (bg_color = 'green') : (bg_color = 'red')\n\t\t\t\t\t\t\t\" size=\"md\" :label=\"item\" />\n\t\t\t\t\t\t<Button v-if=\"column.key === 'cta' && row.status === 'Paid'\" @click=\"openInvoicePDF(row)\"\n\t\t\t\t\t\t\tclass=\"hover:bg-gray-900 hover:text-white\" icon-left=\"download\" label=\"Download Invoice\" />\n\n\t\t\t\t\t\t<Button v-if=\"column.key === 'cta' &&\n\t\t\t\t\t\t\t(row.status === 'Unpaid' || row.status === 'Overdue')\n\t\t\t\t\t\t\" @click=\"openModal(row)\" class=\"hover:bg-gray-900 hover:text-white flex flex-column items-center justify-center\"\n\t\t\t\t\t\t\ticon-left=\"credit-card\" label=\"Pay Now\" />\n\t\t\t\t\t</ListRowItem>\n\t\t\t\t</ListRow>\n\t\t\t</ListView>\n\t\t\t<!-- <FeesPaymentDialog v-if=\"currentRow\" :row=\"currentRow\" :student=\"studentInfo\" v-model=\"showPaymentDialog\"\n\t\t\t\t@success=\"success()\" /> -->\n\t\t</div>\n\n\t\t<div v-else>\n\t\t\t<MissingData message=\"No Fees found\" />\n\t\t</div>\n\t</div>\n\t<div v-else class=\"flex flex-col items-center justify-center\">\n\t\t<p class=\"text-lg font-bold text-gray-500\">{{ __('Student Financial Status are only displayed for Students') }}\n\t\t</p>\n\t</div>\n</template>\n\n<script setup>\n\nimport {\n\tListView,\n\tListHeader,\n\tListHeaderItem,\n\tListRow,\n\tListRowItem,\n\tBadge,\n\tcreateResource,\n\tToast,\n\tFeatherIcon,\n} from 'frappe-ui'\nimport { reactive, ref, inject } from 'vue'\n\n// import FeesPaymentDialog from '@/components/FeesPaymentDialog.vue'\n// import { studentStore } from '@/stores/student'\nimport MissingData from '@/components/MissingData.vue'\nimport { createToast } from '@/utils'\nimport { usersStore } from '../stores/user'\n\n\nlet studentInfo = usersStore()\n\n\nconst user = inject('$user')\n\nconst start = ref(0)\n\nlet userResource = usersStore()\n\nlet isStudent = user.data.is_student\n\nlet student = user.data.student\n\nconst scholarshipsResource = createResource({\n\turl: 'seminary.seminary.api.get_scholarship',\n\tparams: {\n\t\tstudent: student,\n\t},\n\tonSuccess: (response) => {\n\t\tstudentInfo.scholarships = response\n\t},\n\tauto: true,\n})\n\nconsole.log(\"Student Scholarships:\", studentInfo.scholarships)\n\nconst feesResource = createResource({\n\turl: 'seminary.seminary.api.get_student_invoices',\n\tparams: {\n\t\tstudent: student,\n\t},\n\tonSuccess: (response) => {\n\t\tresponse = response.sort((a, b) => {\n\t\t\tconst statusOrder = { Unpaid: 0, Paid: 1 }\n\n\t\t\tconst statusA = statusOrder[a.status]\n\t\t\tconst statusB = statusOrder[b.status]\n\n\t\t\tif (statusA !== statusB) {\n\t\t\t\treturn statusA - statusB\n\t\t\t}\n\n\t\t})\n\t\ttableData.rows = response\n\t},\n\tauto: true,\n})\n\nconst tableData = reactive({\n\trows: [],\n\tcolumns: [\n\t\t{\n\t\t\tlabel: __('Name'),\n\t\t\tkey: 'name',\n\t\t\twidth: 1,\n\t\t},\n\n\t\t{\n\t\t\tlabel: __('Customer'),\n\t\t\tkey: 'customer',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Posting Date'),\n\t\t\tkey: 'posting_date',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Total Amount'),\n\t\t\tkey: 'total',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Outstanding Amount'),\n\t\t\tkey: 'outstanding_amount',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Status'),\n\t\t\tkey: 'status',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Invoice'),\n\t\t\tkey: 'cta',\n\t\t\twidth: 1,\n\t\t},\n\t],\n})\n\nconst currentRow = ref(null)\nconst showPaymentDialog = ref(false)\n\nconst openInvoicePDF = (row) => {\n\tlet url = `/api/method/frappe.utils.print_format.download_pdf?\n\t\tdoctype=${encodeURIComponent('Sales Invoice')}\n\t\t&name=${encodeURIComponent(row.name)}\n\t\t&format=${encodeURIComponent('Standard')}\n\t`\n\twindow.open(url, '_blank')\n}\n\nconst openModal = (row) => {\n\tcurrentRow.value = row\n\tshowPaymentDialog.value = true\n}\n\nconst success = () => {\n\tfeesResource.reload()\n\tcreateToast({\n\t\ttitle: __('Payment Successful'),\n\t\ticon: 'check',\n\t\ticonClasses: 'text-green-600',\n\t})\n}\n</script>"],"names":["studentInfo","usersStore","user","inject","ref","isStudent","student","createResource","response","a","b","statusOrder","statusA","statusB","tableData","reactive","currentRow","showPaymentDialog","openInvoicePDF","row","url","openModal","_unref","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","__","_openBlock","_hoisted_3","_hoisted_4","_hoisted_5","_cache","_hoisted_6","_createBlock","ListView","_createVNode","ListHeader","_Fragment","_renderList","column","ListHeaderItem","ListRow","item","ListRowItem","Badge","bg_color","_component_Button","$event","_hoisted_7","MissingData","_hoisted_8","_hoisted_9"],"mappings":"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"}