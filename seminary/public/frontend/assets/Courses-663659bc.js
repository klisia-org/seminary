import{i as F,r as p,u as q,c as D,m as E,n as v,a as N,l as T,d as i,e as o,t as c,b as u,F as _,k as x,h as w,g as y,p as L,v as B,j as M,o as r,f as P,w as R,q as $,B as O}from"./index-99ce2d99.js";import{u as U,C as G,P as H}from"./CourseCardToDo-5c5caf61.js";import"./book-open-check-a8ea3893.js";import"./file-up-49390357.js";const J={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},K={class:"flex items-center"},Q={class:"text-xl font-semibold text-ink-gray-9"},W={class:"p-5 flex flex-row gap-4 w-full mx-auto"},X={class:"w-1/4 p-4"},Y={key:0},Z={class:"text-md font-medium mb-2"},ee={key:0},te={key:0,class:"text-xl text-center font-semibold text-gray-500 mt-5"},se={key:1,class:"text-xl text-center font-semibold text-gray-500 mt-5"},oe={class:"w-3/4"},ae={class:"flex gap-4 mb-5"},re=["value"],ie=["value"],le={key:0,class:"flex flex-wrap justify-start gap-4"},ne={class:"p-4 text-container"},ce={class:"text-2xl font-semibold"},ue={class:"short-introduction text-ink-gray-7 text-sm"},me={class:"academic-term text-right mt-auto"},de={key:1,class:"flex flex-col items-center justify-center text-sm text-ink-gray-5 italic mt-48"},xe={__name:"Courses",setup(_e){var S;const n=F("$user");p(0),q();let d=n.data.is_student;n.data.is_moderator;let A=n.data.is_instructor;n.data.is_system_manager;const h=p(""),k=D({url:"frappe.client.get_value",params:{doctype:"Academic Term",fieldname:"title",filters:{iscurrent_acterm:1}},auto:!0,onSuccess:t=>{t!=null&&t.title?(h.value=t.title,console.log("Current Academic Term on success:",t.title)):console.log("Current Academic Term: undefined")}});E(()=>{k.reload()}),v(()=>k.data,t=>{t!=null&&t.title?h.value=t.title:console.log("Current Academic Term: undefined")},{immediate:!0}),v(()=>h.value,t=>{t&&(l.academic_term=t,console.log("Updated filters.academic_term:",l.academic_term))});const l=N({course:"",academic_term:((S=k.data)==null?void 0:S.title)||""});console.log(l.academic_term);const b=D({url:d?"seminary.seminary.utils.get_courses_for_student":"seminary.seminary.utils.get_courses",params:d?{student:n.data.name}:{},onSuccess:t=>{j.rows=t.sort((e,a)=>e.academic_term<a.academic_term?-1:e.academic_term>a.academic_term?1:e.course<a.course?-1:e.course>a.course?1:0)},auto:!0}),j=N({rows:[],columns:[{label:"Name",key:"name",width:1},{label:"Course",key:"course",width:1},{label:"Academic Term",key:"academic_term",width:1},{label:"Start Date",key:"c_datestart",width:1},{label:"End Date",key:"c_dateend",width:1},{label:"Image",key:"course_image",width:1}]}),V=T(()=>{var t;return[...new Set((t=b.data)==null?void 0:t.map(e=>e.course))]}),z=T(()=>{var t;return[...new Set((t=b.data)==null?void 0:t.map(e=>e.academic_term))]}),f=T(()=>{var t;return((t=b.data)==null?void 0:t.filter(e=>(!l.course||e.course===l.course)&&(!l.academic_term||e.academic_term===l.academic_term)))||[]}),g=p({}),m=p([]);v(f,t=>{if(!t)return;const e=[];t.forEach(a=>{g.value[a.name]||(g.value[a.name]=U(a.name,n),console.log("Created instance for course:",a.name,g.value[a.name]));const s=g.value[a.name],C=s.countToDoItems;console.log("Starting if statement with count:",C,"for todoInstance:",s),s&&C>0&&e.push({course:a,count:C})}),console.log("List: ",e),m.value=e,console.log("Updated courseToDoList:",m.value)});let I=!0;return v(()=>f,t=>{if(I){I=!1;return}Array.isArray(t)||(console.error("newFilteredCourses is not an array:",t),t=[]);const e=t.map(a=>{const s=U(a.name,n);return{course:a,count:s.countToDoItems.value,hasItems:s.countToDoItems.value>0}}).filter(a=>a.hasItems);m.value=e,console.log("Updated courseToDoList:",m.value)},{immediate:!0}),(t,e)=>{const a=M("router-link");return r(),i(_,null,[o("header",J,[o("div",K,[o("h1",Q,c(u(d)?"My Courses":"All Courses"),1)])]),o("div",W,[o("div",X,[e[2]||(e[2]=o("h2",{class:"text-lg font-semibold mb-4"},"To Do",-1)),u(d)||u(A)?(r(),i("div",Y,[(r(!0),i(_,null,x(m.value,s=>(r(),i("div",{key:s.course.name},[o("h3",Z,c(s.course.name),1),w(G,{course:s.course.name,singleCourse:!1},null,8,["course"])]))),128)),m.value.length===0?(r(),i("div",ee,[w(u(H),{class:"size-20 mx-auto stroke-1 text-gray-500 mt-5"}),u(d)?(r(),i("h3",te," Congrats! No assessments to do!")):y("",!0),u(A)?(r(),i("h3",se," Congrats! No assessments to grade!")):y("",!0)])):y("",!0)])):y("",!0)]),o("div",oe,[o("div",ae,[o("div",null,[e[4]||(e[4]=o("label",{for:"courseFilter",class:"block text-sm font-medium text-gray-700"},"Course",-1)),L(o("select",{id:"courseFilter","onUpdate:modelValue":e[0]||(e[0]=s=>l.course=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[3]||(e[3]=o("option",{value:""},"All Courses",-1)),(r(!0),i(_,null,x(V.value,s=>(r(),i("option",{key:s,value:s},c(s),9,re))),128))],512),[[B,l.course]])]),o("div",null,[e[6]||(e[6]=o("label",{for:"academicTermFilter",class:"block text-sm font-medium text-gray-700"},"Academic Term",-1)),L(o("select",{id:"academicTermFilter","onUpdate:modelValue":e[1]||(e[1]=s=>l.academic_term=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[5]||(e[5]=o("option",{value:""},"All Terms",-1)),(r(!0),i(_,null,x(z.value,s=>(r(),i("option",{key:s,value:s},c(s),9,ie))),128))],512),[[B,l.academic_term]])])]),f.value.length?(r(),i("div",le,[(r(!0),i(_,null,x(f.value,s=>(r(),P(a,{to:{name:"CourseDetail",params:{courseName:s.name}},key:s.name,class:"course_card"},{default:R(()=>[o("div",{class:"course-image",style:$({backgroundImage:`url(${encodeURI(s.course_image)})`})},null,4),o("div",ne,[o("h3",ce,c(s.course),1),o("div",ue,c(s.short_introduction),1),o("div",me,c(s.academic_term),1)])]),_:2},1032,["to"]))),128))])):(r(),i("div",de,[w(u(O),{class:"size-10 mx-auto stroke-1 text-ink-gray-4"}),e[7]||(e[7]=o("div",{class:"text-2xl font-medium mb-1"},[o("span",null,"No courses found")],-1))]))])])],64)}}};export{xe as default};
//# sourceMappingURL=Courses-663659bc.js.map
