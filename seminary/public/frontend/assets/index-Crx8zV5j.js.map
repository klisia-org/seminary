{"version":3,"file":"index-Crx8zV5j.js","sources":["../../../../frontend/src/components/ProgressBar.vue","../../../../frontend/src/components/Quiz.vue","../../../../frontend/src/components/QuizBlock.vue","../../../../frontend/src/components/AssessmentPlugin.vue","../../../../frontend/src/utils/quiz.js","../../../../frontend/src/components/Assignment.vue","../../../../frontend/src/components/AssignmentBlock.vue","../../../../frontend/src/utils/assignment.js","../../../../frontend/src/components/ExamGraded.vue","../../../../frontend/src/components/UserAvatar.vue","../../../../frontend/src/components/DiscussionReplies.vue","../../../../frontend/src/components/Modals/DiscussionModal.vue","../../../../frontend/src/utils/scrollContainer.js","../../../../frontend/src/components/Discussions.vue","../../../../frontend/src/components/Exam.vue","../../../../frontend/src/components/ExamBlock.vue","../../../../frontend/src/utils/exam.js","../../../../frontend/src/components/DiscussionActivity.vue","../../../../frontend/src/components/DiscussionActivityBlock.vue","../../../../frontend/src/utils/discussionactivity.js","../../../../frontend/src/components/AudioBlock.vue","../../../../frontend/src/components/VideoBlock.vue","../../../../frontend/src/components/UploadPlugin.vue","../../../../frontend/src/utils/upload.js","../../../../frontend/src/utils/markdownParser.js","../../../../frontend/src/utils/code.ts","../../../../frontend/src/components/FolderPlugin.vue","../../../../frontend/src/components/FolderBlock.vue","../../../../frontend/src/utils/foldertool.js","../../../../frontend/src/utils/index.js"],"sourcesContent":["<template>\n\t<Tooltip :text=\"`${props.progress}%`\">\n\t\t<div class=\"w-full bg-surface-gray-3 rounded-full h-1\">\n\t\t\t<div\n\t\t\t\tclass=\"bg-surface-gray-7 rounded-full\"\n\t\t\t\t:class=\"progressBarHeight\"\n\t\t\t\t:style=\"{ width: progressBarWidth }\"\n\t\t\t></div>\n\t\t</div>\n\t</Tooltip>\n</template>\n\n<script setup>\nimport { computed } from 'vue'\nimport { Tooltip } from 'frappe-ui'\n\nconst props = defineProps({\n\tprogress: {\n\t\ttype: Number,\n\t\tdefault: 0,\n\t},\n\tsize: {\n\t\ttype: String,\n\t\tdefault: 'sm',\n\t},\n})\n\nconst progressBarWidth = computed(() => {\n\tconst formattedPercentage = Math.min(Math.ceil(props.progress), 100)\n\treturn `${formattedPercentage}%`\n})\n\nconst progressBarHeight = computed(() => {\n\tif (props.size === 'sm') {\n\t\treturn 'h-1'\n\t}\n\tif (props.size === 'md') {\n\t\treturn 'h-2'\n\t}\n\tif (props.size === 'lg') {\n\t\treturn 'h-3'\n\t}\n})\n</script>\n","<template>\n\t<div v-if=\"isQuizLoaded\">\n\t\t<!-- Quiz Header -->\n\t\t<div class=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\">\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(`This quiz consists of '${questions.length}' questions`)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(`Please ensure that you complete all the questions in ${quiz.data.duration} minutes.`)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'If you fail to do so, the quiz will be automatically submitted when the timer ends.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.passing_percentage\" class=\"leading-relaxed\">\n\t\t\t\t{{ __(\n\t\t\t\t\t`You will have to get ${quiz.data.passing_percentage}% correct answers in order to pass the quiz.`\n\t\t\t\t) }}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.max_attempts\" class=\"leading-relaxed\">\n\t\t\t\t{{\n\t\t\t\t\t__(`You can attempt this quiz ${quiz.data.max_attempts === 1 ? __('1 time') : `${quiz.data.max_attempts}\n\t\t\t\ttimes`\n\t\t\t\t\t\t}.`)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div v-if=\"quiz.data.duration\" class=\"flex flex-col space-x-1 my-4\">\n\t\t\t<div class=\"mb-2\">\n\t\t\t\t<span class=\"\"> {{ __('Time') }}: </span>\n\t\t\t\t<span class=\"font-semibold\">\n\t\t\t\t\t{{ formatTimer(timer) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ProgressBar :progress=\"timerProgress\" />\n\t\t</div>\n\n\t\t<!-- Start Screen -->\n\t\t<div v-if=\"!fullQuizMode\">\n\t\t\t<div class=\"border text-center p-20 rounded-md\">\n\t\t\t\t<div class=\"font-semibold text-lg\">\n\t\t\t\t\t{{ quiz.data.title }}\n\t\t\t\t</div>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts) && quiz.data.qbyquestion\"\n\t\t\t\t\t@click=\"startQuiz\" class=\"mt-2\">\n\t\t\t\t\t<span>{{ __('Start') }}</span>\n\t\t\t\t</Button>\n\t\t\t\t<Button v-else-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts)\"\n\t\t\t\t\t@click=\"startQuiz2\" class=\"mt-2\">\n\t\t\t\t\t<span>{{ ('Start full quiz') }}</span>\n\t\t\t\t</Button>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('You have already exceeded the maximum number of attempts allowed for this quiz.') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Question-by-Question Mode -->\n\t\t<div v-if=\"fullQuizMode === false && activeQuestion !== 0 && !quizSubmission.data && quiz.data.qbyquestion\">\n\t\t\t<div v-for=\"(question, qtidx) in questions\">\n\t\t\t\t<div v-if=\"qtidx == activeQuestion - 1 && questionDetails.data\" class=\"border rounded-md p-5\">\n\t\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t<span class=\"mr-2\">\n\t\t\t\t\t\t\t\t{{ __('Question') }} {{ activeQuestion }}:\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ getInstructions(questionDetails.data) }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n\t\t\t\t\t\t\t{{ question.points }}\n\t\t\t\t\t\t\t{{ question.points == 1 ? __('Point') : __('Points') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"text-ink-gray-9 font-semibold mt-2 leading-5\" v-html=\"questionDetails.data.question\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"questionDetails.data.type == 'Choices'\" v-for=\"index in 4\">\n\t\t\t\t\t\t<label v-if=\"questionDetails.data[`option_${index}`]\"\n\t\t\t\t\t\t\tclass=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\">\n\t\t\t\t\t\t\t<input v-if=\"!showAnswers.length && !questionDetails.data.multiple\" type=\"radio\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\" />\n\n\t\t\t\t\t\t\t<input v-else-if=\"!showAnswers.length && questionDetails.data.multiple\" type=\"checkbox\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\" />\n\t\t\t\t\t\t\t<div v-else-if=\"quiz.data.show_answers\" v-for=\"(answer, idx) in showAnswers\">\n\t\t\t\t\t\t\t\t<div v-if=\"index - 1 == idx\">\n\t\t\t\t\t\t\t\t\t<CheckCircle v-if=\"answer == 1\" class=\"w-4 h-4 text-green-800\" />\n\t\t\t\t\t\t\t\t\t<MinusCircle v-else-if=\"answer == 2\" class=\"w-4 h-4 text-ink-green-2\" />\n\t\t\t\t\t\t\t\t\t<XCircle v-else-if=\"answer == 0\" class=\"w-4 h-4 text-red-600\" />\n\t\t\t\t\t\t\t\t\t<MinusCircle v-else class=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span class=\"ml-2\" v-html=\"questionDetails.data[`option_${index}`]\">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div v-if=\"questionDetails.data[`explanation_${index}`]\" class=\"mt-2 text-xs\"\n\t\t\t\t\t\t\tv-show=\"showAnswers.length\">\n\t\t\t\t\t\t\t{{ questionDetails.data[`explanation_${index}`] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else-if=\"questionDetails.data.type == 'User Input'\">\n\t\t\t\t\t\t<FormControl v-model=\"possibleAnswer\" type=\"textarea\"\n\t\t\t\t\t\t\t:disabled=\"showAnswers.length ? true : false\" class=\"my-2\" />\n\t\t\t\t\t\t<div v-if=\"showAnswers.length\">\n\t\t\t\t\t\t\t<Badge v-if=\"showAnswers[0]\" :label=\"__('Correct')\" theme=\"green\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t<Badge v-else theme=\"red\" :label=\"__('Incorrect')\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<TextEditor class=\"mt-4\" :content=\"possibleAnswer\" @change=\"(val) => (possibleAnswer = val)\"\n\t\t\t\t\t\t\t:editable=\"true\" :fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center justify-between mt-4\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t{{ __('Question') }} {{ activeQuestion }} {{ __('of') }} {{ questions.length }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button v-if=\"\n\t\t\t\t\t\t\tquiz.data.show_answers &&\n\t\t\t\t\t\t\t!showAnswers.length\n\t\t\t\t\t\t\" @click=\"checkAnswer()\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ __('Check') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button v-else-if=\"activeQuestion != questions.length\" @click=\"nextQuestion()\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ __('Next') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button v-else @click=\"submitQuiz()\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ __('Submit') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Full Quiz Mode: All questions at once -->\n\t\t<div v-if=\"fullQuizMode && all_questions_details.data && all_questions_details.data.length > 0\">\n\t\t\t<div v-for=\"(question, qtidx) in all_questions_details.data\" :key=\"question.name\"\n\t\t\t\tclass=\"border rounded-md p-5 mb-4\">\n\t\t\t\t<!-- Render each question header, text, and answer options -->\n\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t<span class=\"mr-2\">{{ __('Question') }} {{ qtidx + 1 }}:</span>\n\t\t\t\t\t\t<span>{{ getInstructions(question) }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n\t\t\t\t\t\t{{ question.points || 0 }} {{ question.points == 1 ? __('Point') : __('Points') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"text-ink-gray-9 font-semibold mt-2 leading-5\" v-html=\"question.question_detail\"></div>\n\t\t\t\t<!-- Answer Options -->\n\t\t\t\t<div v-if=\"question.type == 'Choices'\" v-for=\"index in 4\">\n\t\t\t\t\t<label v-if=\"question[`option_${index}`]\"\n\t\t\t\t\t\tclass=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\">\n\t\t\t\t\t\t<input v-if=\"!question.multiple\" type=\"radio\" :name=\"`question_${qtidx}`\"\n\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t@change=\"recordAnswer(qtidx, question[`option_${index}`])\" />\n\t\t\t\t\t\t<input v-else-if=\"question.multiple\" type=\"checkbox\" :name=\"`question_${qtidx}`\"\n\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t@change=\"toggleAnswer(qtidx, question[`option_${index}`])\" />\n\t\t\t\t\t\t<span class=\"ml-2\" v-html=\"question[`option_${index}`]\"></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<!-- User Input Option -->\n\t\t\t\t<div v-else-if=\"question.type == 'User Input'\">\n\t\t\t\t\t<FormControl v-model=\"answers[qtidx]\" type=\"textarea\" class=\"my-2\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<!-- Submit Button -->\n\t\t\t<div class=\"text-center mt-4\">\n\t\t\t\t<Button @click=\"submitQuizComplete()\">\n\t\t\t\t\t<span>{{ __('Submit Your Quiz') }}</span>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Quiz Summary (if quizSubmission.data exists) -->\n\t\t<div v-else-if=\"quizSubmission.data\" class=\"border rounded-md p-20 text-center space-y-4\">\n\t\t\t<div class=\"text-lg font-semibold\">{{ __('Quiz Summary') }}</div>\n\t\t\t<div class=\"text-ink-gray-9\">\n\t\t\t\t{{ __(`You got ${Math.ceil(quizSubmission.data.percentage)}% correct answers with a score of\n\t\t\t\t${quizSubmission.data.score} out of ${quizSubmission.data.score_out_of}`) }}\n\t\t\t</div>\n\t\t\t<div class=\"mt-6\">\n\t\t\t\t<div v-for=\"(question, qtidx) in detailedQuestions\" :key=\"question.question_name\"\n\t\t\t\t\tclass=\"border rounded-md p-5 mb-4\">\n\t\t\t\t\t<!-- Question Header -->\n\t\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t\t<div class=\"text-lg text-ink-gray-5\">\n\t\t\t\t\t\t\t<span class=\"mr-2\">{{ __('Question') }} {{ qtidx + 1 }}:</span>\n\t\t\t\t\t\t\t<span v-html=\"question.question_detail\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- User Answer -->\n\t\t\t\t\t<div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n\t\t\t\t\t\t<strong>{{ __('Your Answer:') }}</strong> {{ question.user_answer || __('No Answer') }}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Correct Answer -->\n\t\t\t\t\t<div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n\t\t\t\t\t\t<strong>{{ __('Correct Answer:') }}</strong> {{ question.correct_answer ||\n\t\t\t\t\t\t\t__('No Correct Answer') }}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Explanation -->\n\t\t\t\t\t<div v-if=\"question.explanation\" class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n\t\t\t\t\t\t<strong>{{ __('Explanation:') }}</strong> {{ question.explanation }}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Correct/Incorrect Indicator -->\n\t\t\t\t\t<div class=\"mt-4\">\n\t\t\t\t\t\t<Badge v-if=\"quizResults[qtidx]?.is_correct?.[0] === 1\" :label=\"__('Correct')\" theme=\"green\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge v-else :label=\"__('Incorrect')\" theme=\"red\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Button @click=\"resetQuiz()\" class=\"mt-4\">\n\t\t\t\t<span>{{ __('Try Again') }}</span>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n\t<div v-else>\n\t\t<p>Loading quiz data...</p>\n\t</div>\n</template>\n<script setup>\nimport { Badge, Button, call, createResource, ListView, TextEditor, FormControl, toast } from 'frappe-ui'\nimport { ref, watch, reactive, inject, computed } from 'vue'\nimport { createToast } from '@/utils/'\nimport { CheckCircle, XCircle, MinusCircle } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\n\nconst user = inject('$user')\nconst fullQuizMode = ref(false);\nconst activeQuestion = ref(0)\nconst currentQuestion = ref('')\nconst selectedOptions = reactive([0, 0, 0, 0])\nconst showAnswers = reactive([])\nlet questions = reactive([])\nconst possibleAnswer = ref(null)\nconst timer = ref(0)\nlet timerInterval = null\nconst router = useRouter()\nconst elapsedTime = ref(0); // Tracks the time taken in seconds\nconst answers = reactive({}); // Stores the answers for each question\n\n\nconst props = defineProps({\n\tquizName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\n// Ensure `quiz.data` is properly initialized and loaded\nconst quiz = createResource({\n\turl: 'frappe.client.get',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz',\n\t\t\tname: props.quizName,\n\t\t};\n\t},\n\tcache: ['quiz', props.quizName],\n\tauto: true,\n\ttransform(data) {\n\t\tif (!data) {\n\t\t\tconsole.error(\"Quiz data is null or undefined.\"); // Debugging\n\t\t\treturn null;\n\t\t}\n\t\tdata.duration = parseInt(data.duration) || 0; // Ensure duration is a valid number\n\t\treturn data;\n\t},\n\tonSuccess(data) {\n\t\tif (data) {\n\t\t\tpopulateQuestions();\n\t\t\tsetupTimer();\n\t\t} else {\n\t\t\tconsole.error(\"Failed to load quiz data.\"); // Debugging\n\t\t}\n\t},\n\tonError(err) {\n\t\tconsole.error(\"Error loading quiz data:\", err); // Debugging\n\t},\n});\n\n// Add a computed property to check if `quiz.data` is loaded\nconst isQuizLoaded = computed(() => !!quiz.data);\n\nconst populateQuestions = () => {\n\tlet data = quiz.data;\n\tif (data.shuffle_questions) {\n\t\t// Shuffle the questions\n\t\tconst shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n\t\t// Limit the number of questions if required\n\t\tquestions = data.limit_questions_to\n\t\t\t? shuffledQuestions.slice(0, data.limit_questions_to)\n\t\t\t: shuffledQuestions;\n\t} else {\n\t\t// Use the original questions if no shuffle is required\n\t\tquestions = data.questions;\n\t}\n\n}\n\nconst setupTimer = () => {\n\tif (quiz.data.duration) {\n\t\ttimer.value = quiz.data.duration * 60\n\t}\n}\n\nconst startTimer = () => {\n\ttimerInterval = setInterval(() => {\n\t\tif (quiz.data.duration) {\n\t\t\ttimer.value--;\n\t\t\tif (timer.value == 0) {\n\t\t\t\tclearInterval(timerInterval);\n\t\t\t\tsubmitQuiz();\n\t\t\t}\n\t\t}\n\t\telapsedTime.value++; // Always increment elapsed time\n\t}, 1000);\n};\n\nconst formatTimer = (seconds) => {\n\tconst hrs = Math.floor(seconds / 3600)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst mins = Math.floor((seconds % 3600) / 60)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst secs = (seconds % 60).toString().padStart(2, '0')\n\treturn hrs != '00' ? `${hrs}:${mins}:${secs}` : `${mins}:${secs}`\n}\n\nconst timerProgress = computed(() => {\n\treturn (timer.value / (quiz.data.duration * 60)) * 100\n})\n\nconst shuffleArray = (array) => {\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tconst j = Math.floor(Math.random() * (i + 1))\n\t\t\t;[array[i], array[j]] = [array[j], array[i]]\n\t}\n\treturn array\n}\n\nconst attempts = createResource({\n\turl: 'frappe.client.get_list',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz Submission',\n\t\t\tfilters: {\n\t\t\t\tmember: user.data?.name,\n\t\t\t\tquiz: quiz.data?.name,\n\t\t\t},\n\t\t\tfields: [\n\t\t\t\t'name',\n\t\t\t\t'creation',\n\t\t\t\t'score',\n\t\t\t\t'score_out_of',\n\t\t\t\t'percentage',\n\t\t\t\t'passing_percentage',\n\t\t\t],\n\t\t\torder_by: 'creation desc',\n\t\t}\n\t},\n\ttransform(data) {\n\t\tdata.forEach((submission, index) => {\n\t\t\tsubmission.creation = timeAgo(submission.creation)\n\t\t\tsubmission.idx = index + 1\n\t\t})\n\t},\n})\n\nwatch(\n\t() => quiz.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tpopulateQuestions()\n\n\t\t}\n\t\tif (newData && quiz.data.max_attempts) {\n\t\t\tattempts.reload()\n\t\t\tresetQuiz()\n\t\t}\n\t}\n)\n\nconst quizSubmission = createResource({\n\turl: 'seminary.seminary.doctype.quiz.quiz.quiz_summary',\n\tmakeParams(values) {\n\t\t// Add null-safe checks for `quiz.data`\n\t\tif (!quiz.data) {\n\t\t\treturn {}; // Return an empty object to avoid errors\n\t\t}\n\t\tconst timeTaken = quiz.data.duration\n\t\t\t? quiz.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n\t\t\t: elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n\n\n\t\treturn {\n\t\t\tquiz: quiz.data.name,\n\t\t\tcourse: router.currentRoute.value.params.courseName,\n\t\t\tresults: values?.results || localStorage.getItem(`${quiz.data.name}_results`), // Ensure `results` is properly initialized\n\t\t\ttime_taken: timeTaken, // Pass the correct time_taken\n\t\t};\n\t},\n\tonSuccess(data) {\n\n\t\tif (data.corrected_answers) {\n\t\t\tall_questions_details.data = data.corrected_answers.map((question) => ({\n\t\t\t\t...question,\n\t\t\t\tuser_answer: question.user_answer || null, // Ensure user_answer is included\n\t\t\t\tcorrect_answer: question.correct_answer || null, // Ensure correct_answer is included\n\t\t\t}));\n\t\t}\n\t},\n\tonError(err) {\n\t\tconsole.error(\"Error loading quiz summary:\", err); // Debugging\n\t},\n\tauto: true, // Re-enable auto-fetch\n});\n\nconst questionDetails = createResource({\n\turl: 'seminary.seminary.utils.get_question_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestion: currentQuestion.value,\n\t\t}\n\t},\n\n})\n\nwatch(activeQuestion, (value) => {\n\tif (value > 0) {\n\t\tcurrentQuestion.value = quiz.data.questions[value - 1].question\n\t\tquestionDetails.reload()\n\t}\n})\n\nwatch(\n\t() => props.quizName,\n\t(newName) => {\n\t\tif (newName) {\n\t\t\tquiz.reload()\n\t\t}\n\t}\n)\n\nconst all_questions_details = createResource({\n\turl: 'seminary.seminary.utils.get_all_questions_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestions: questions.map((q) => q.name), // Ensure only question names are sent\n\t\t}\n\t},\n})\n\n\n\nconst startQuiz = () => {\n\tactiveQuestion.value = 1\n\tlocalStorage.removeItem(quiz.data.title)\n\tstartTimer()\n}\n\nconst startQuiz2 = () => {\n\tlocalStorage.removeItem(quiz.data.title);\n\tfullQuizMode.value = true; // Set full quiz mode flag\n\tstartTimer();\n\tall_questions_details.reload(); // Ensure the resource is reloaded\n\n}\n\n\nconst markAnswer = (index) => {\n\tif (!questionDetails.data.multiple)\n\t\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tselectedOptions[index - 1] = selectedOptions[index - 1] ? 0 : 1\n}\n\nconst getAnswers = () => {\n\tlet answers = []\n\tconst type = questionDetails.data.type\n\n\tif (type == 'Choices') {\n\t\tselectedOptions.forEach((value, index) => {\n\t\t\tif (selectedOptions[index])\n\t\t\t\tanswers.push(questionDetails.data[`option_${index + 1}`])\n\t\t})\n\t} else {\n\t\tanswers.push(possibleAnswer.value)\n\t}\n\n\treturn answers\n}\n\nconst checkAnswer = () => {\n\tlet answers = getAnswers();\n\tif (!answers.length) {\n\t\tcreateToast({\n\t\t\ttitle: __('Please select an option'),\n\t\t\ticon: 'alert-circle',\n\t\t\ticonClasses: 'text-yellow-600 bg-yellow-100 rounded-full',\n\t\t\tposition: 'top-center',\n\t\t});\n\t\treturn;\n\t}\n\n\tcreateResource({\n\t\turl: 'seminary.seminary.doctype.quiz.quiz.check_answer',\n\t\tparams: {\n\t\t\tquestion: currentQuestion.value,\n\t\t\ttype: questionDetails.data.type,\n\t\t\tanswers: JSON.stringify(answers),\n\t\t},\n\t\tauto: true,\n\t\tonSuccess(data) {\n\t\t\tlet type = questionDetails.data.type;\n\t\t\tif (type === 'Choices') {\n\t\t\t\tselectedOptions.forEach((option, index) => {\n\t\t\t\t\tif (option) {\n\t\t\t\t\t\tshowAnswers[index] = option && data[index];\n\t\t\t\t\t} else if (data[index] === 2) {\n\t\t\t\t\t\tshowAnswers[index] = 2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshowAnswers[index] = undefined;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tshowAnswers.push(data);\n\t\t\t}\n\t\t\taddToLocalStorage();\n\t\t\tif (!quiz.data.show_answers) {\n\t\t\t\tresetQuestion();\n\t\t\t}\n\t\t},\n\t});\n};\n\nconst addToLocalStorage = () => {\n\tlet quizData = JSON.parse(localStorage.getItem(quiz.data.title)) || [];\n\tlet questionData = {\n\t\tquestion_name: currentQuestion.value,\n\t\tanswer: getAnswers().join(),\n\t\tis_correct: showAnswers.filter((answer) => {\n\t\t\treturn answer != undefined\n\t\t}),\n\t};\n\n\t// Check if the question already exists in localStorage\n\tconst existingIndex = quizData.findIndex(\n\t\t(item) => item.question_name === questionData.question_name\n\t);\n\n\tif (existingIndex !== -1) {\n\t\t// Update the existing question data\n\t\tquizData[existingIndex] = questionData;\n\t} else {\n\t\t// Add the new question data\n\t\tquizData ? quizData.push(questionData) : (quizData = [questionData])\n\t}\n\n\n\tlocalStorage.setItem(quiz.data.title, JSON.stringify(quizData));\n\tlocalStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(quizData)); // Save results for submission\n\n};\n\nconst nextQuestion = () => {\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t} else {\n\t\taddToLocalStorage()\n\t\tresetQuestion()\n\t}\n}\n\nconst resetQuestion = () => {\n\tif (activeQuestion.value == quiz.data.questions.length) return\n\tactiveQuestion.value = activeQuestion.value + 1\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tpossibleAnswer.value = null\n}\n\nconst submitQuiz = () => {\n\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t\tsetTimeout(() => {\n\t\t\tcreateSubmission()\n\t\t}, 500)\n\t\treturn\n\t}\n\tcreateSubmission()\n\tconsole.log('Quiz submitted with Submit Quiz button and asnwers shown')\n}\n\nconst submitQuizComplete = async () => {\n\tconst results = [];\n\tconst detailedQuestions = []; // Array to store detailed question data\n\n\t// Iterate through all questions and collect answers\n\tfor (let i = 0; i < all_questions_details.data.length; i++) {\n\t\tconst question = all_questions_details.data[i];\n\t\tconst answer = answers[i]?.[0] || \"\"; // Get the first recorded answer or an empty string\n\n\n\n\t\t// Call the backend to validate the answer\n\t\tconst response = await call('seminary.seminary.doctype.quiz.quiz.check_answer', {\n\t\t\tquestion: question.question, // Pass the unique question identifier\n\t\t\ttype: question.type,\n\t\t\tanswers: JSON.stringify([answer]), // Send the answer as an array\n\t\t});\n\n\t\t// Extract only the relevant value for `is_correct`\n\t\tconst is_correct = Array.isArray(response) ? [response.find((val) => val === 1) || 0] : [response];\n\n\t\tresults.push({\n\t\t\tquestion_name: question.question, // Use the unique question identifier\n\t\t\tanswer: answer, // Use the single answer string\n\t\t\tis_correct: is_correct, // Ensure this contains only the relevant value\n\t\t});\n\n\t\t// Add detailed question data (correct_answer will be fetched later)\n\t\tdetailedQuestions.push({\n\t\t\tquestion_name: question.question,\n\t\t\tquestion_detail: question.question_detail,\n\t\t\tuser_answer: answer,\n\t\t\tcorrect_answer: null, // Placeholder for correct answer\n\t\t\texplanation: question.explanation || null,\n\t\t});\n\t}\n\n\n\t// Submit the quiz results\n\tquizSubmission.submit(\n\t\t{ results: JSON.stringify(results) }, // Ensure results is passed as a string\n\t\t{\n\t\t\tonSuccess: async (data) => {\n\n\n\t\t\t\t// Fetch correct answers from the backend\n\t\t\t\tconst correctAnswers = await call('seminary.seminary.doctype.quiz.quiz.get_all_question_results', {\n\t\t\t\t\tquestions: questions.map(q => q.question),\n\t\t\t\t});\n\n\t\t\t\t// Update detailedQuestions with correct answers and explanations\n\t\t\t\tdetailedQuestions.forEach((question) => {\n\t\t\t\t\tconst correctAnswer = correctAnswers.find((item) => item.name === question.question_name);\n\t\t\t\t\tif (correctAnswer) {\n\t\t\t\t\t\tquestion.correct_answer = correctAnswer.correct_option;\n\t\t\t\t\t\tquestion.explanation = correctAnswer.correct_explanation || question.explanation;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Store detailed question data in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_questions`, JSON.stringify(detailedQuestions));\n\n\n\t\t\t\t// Store results in localStorage for use in `makeParams`\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(results));\n\n\t\t\t\t// Store the quiz summary in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_summary`, JSON.stringify(data));\n\n\n\t\t\t\tquizSubmission.reload(); // Reload the quiz summary and corrected answers\n\t\t\t\tfullQuizMode.value = false; // Exit full quiz mode to show the summary\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconsole.error(\"Error submitting quiz:\", err);\n\t\t\t},\n\t\t}\n\t);\n};\n\nconst createSubmission = () => {\n\tconst results = localStorage.getItem(`${quiz.data.name}_results`); // Retrieve results from localStorage\n\tif (!results) {\n\t\tconsole.error(\"No results found to submit.\"); // Debugging\n\t\treturn;\n\t}\n\n\tquizSubmission.submit(\n\t\t{ results }, // Pass results to the backend\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tmarkLessonProgress()\n\t\t\t\tif (quiz.data && quiz.data.max_attempts) attempts.reload()\n\t\t\t\tif (quiz.data.duration) clearInterval(timerInterval)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconst errorTitle = err?.message || ''\n\t\t\t\tif (errorTitle.includes('MaximumAttemptsExceededError')) {\n\t\t\t\t\tconst errorMessage = err.messages?.[0] || err\n\t\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.reload()\n\t\t\t\t\t}, 3000)\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst resetQuiz = () => {\n\tactiveQuestion.value = 0\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tquizSubmission.reset()\n\tpopulateQuestions()\n\tsetupTimer()\n\telapsedTime.value = 0 // Reset elapsed time\n}\n\nconst getInstructions = (question) => {\n\tif (question.type == 'Choices')\n\t\tif (question.multiple) return (__('Choose all answers that apply'))\n\t\telse return (__('Choose one answer'))\n\telse return (__('Type your answer'))\n}\n\nconst markLessonProgress = () => {\n\n\tif (router.currentRoute.value.name === 'Lesson') {\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: router.currentRoute.value.params.courseName,\n\t\t\tchapter_number: router.currentRoute.value.params.chapterNumber,\n\t\t\tlesson_number: router.currentRoute.value.params.lessonNumber,\n\t\t}).then(() => {\n\t\t\tif (fullQuizMode.value) {\n\t\t\t\tquizSubmission.reload(); // Ensure the quiz summary is reloaded for full quiz mode\n\t\t\t}\n\t\t});\n\t}\n};\n\nconst getSubmissionColumns = () => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('No.'),\n\t\t\tkey: 'idx',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Date'),\n\t\t\tkey: 'creation',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Score'),\n\t\t\tkey: 'score',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Score out of'),\n\t\t\tkey: 'score_out_of',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Percentage'),\n\t\t\tkey: 'percentage',\n\t\t\talign: 'center',\n\t\t}\n\t]\n}\n\nconst recordAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and stores the selected answer\n\tanswers[qtidx] = [answer];\n\n};\n\nconst toggleAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and handles multiple answers\n\tif (!answers[qtidx]) {\n\t\tanswers[qtidx] = [];\n\t}\n\tconst index = answers[qtidx].indexOf(answer);\n\tif (index === -1) {\n\t\tanswers[qtidx].push(answer); // Add the answer if not already selected\n\t} else {\n\t\tanswers[qtidx].splice(index, 1); // Remove the answer if already selected\n\t}\n\n};\n\nwatch(\n\t() => all_questions_details.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tconsole.log(\"All questions details updated\"); // Debugging\n\t\t} else {\n\t\t\tconsole.warn(\"No data available in all_questions_details.\"); // Debugging\n\t\t}\n\t}\n)\n\n// Load detailed question data and results from localStorage\nconst detailedQuestions = ref([]);\nconst quizResults = ref([]);\n\nwatch(\n\t() => quizSubmission.data,\n\t() => {\n\t\tif (quizSubmission.data) {\n\t\t\tconst questions = localStorage.getItem(`${quiz.data.name}_questions`);\n\t\t\tconst results = localStorage.getItem(`${quiz.data.name}_results`);\n\t\t\tdetailedQuestions.value = questions ? JSON.parse(questions) : [];\n\t\t\tquizResults.value = results ? JSON.parse(results) : [];\n\t\t}\n\t}\n);\n</script>","<template>\n\t<Quiz v-if=\"user.data\" :quizName=\"quiz\"></Quiz>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the quiz.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Quiz from '@/components/Quiz.vue'\n\nconst user = inject('$user')\nconst props = defineProps({\n\tquiz: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:options=\"{\n\t\t\tsize: 'xl',\n\t\t}\"\n\t>\n\t\t<template #body>\n\t\t\t<button style=\"opacity: 0; position: absolute;\">Fallback Focus</button>\n\t\t\t<div class=\"p-5 space-y-4\">\n\t\t\t\t<div v-if=\"type == 'quiz'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add a quiz to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"type == 'exam'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an exam to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"type == 'discussionactivity'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add a discussion activity to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an assignment to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-if=\"type == 'quiz'\"\n\t\t\t\t\t\tv-model=\"quiz\"\n\t\t\t\t\t\tdoctype=\"Quiz\"\n\t\t\t\t\t\t:label=\"__('Select a quiz')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else-if=\"type == 'exam'\"\n\t\t\t\t\t\tv-model=\"exam\"\n\t\t\t\t\t\tdoctype=\"Exam Activity\"\n\t\t\t\t\t\t:label=\"__('Select an exam')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else-if=\"type == 'discussionactivity'\"\n\t\t\t\t\t\tv-model=\"discussionactivity\"\n\t\t\t\t\t\tdoctype=\"Discussion Activity\"\n\t\t\t\t\t\t:label=\"__('Select a discussion activity')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tv-model=\"assignment\"\n\t\t\t\t\t\tdoctype=\"Assignment Activity\"\n\t\t\t\t\t\t:label=\"__('Select an assignment')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex justify-end space-x-2\">\n\t\t\t\t\t<Button variant=\"solid\" @click=\"addAssessment()\">\n\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, Button } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\nimport Link from '@/components/Controls/Link.vue'\n\nconst show = ref(false)\nconst quiz = ref(null)\nconst assignment = ref(null)\nconst exam = ref(null)\nconst discussionactivity = ref(null)\n\nconst props = defineProps({\n\ttype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tonAddition: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\n\nonMounted(async () => {\n\tawait nextTick()\n\tshow.value = true\n})\n\nconst addAssessment = () => {\n\tif (props.type == 'quiz') {\n\t\tprops.onAddition(quiz.value)\n\t} else if (props.type == 'exam') {\n\t\tprops.onAddition(exam.value)\n\t} else if (props.type == 'discussionactivity') {\n\t\tprops.onAddition(discussionactivity.value)\n\t} else {\n\t\tprops.onAddition(assignment.value)\n\t}\n\tshow.value = false\n}\n\nconst redirectToForm = () => {\n\tif (props.type == 'quiz') window.open('/seminary/quizzes/new', '_blank')\n\telse if (props.type == 'exam') window.open('/seminary/exams/new', '_blank')\n\telse if (props.type == 'discussionactivity') window.open('/seminary/discussion-activity/new', '_blank')\n\telse window.open('/seminary/assignments/new', '_blank')\n}\n</script>","import QuizBlock from '@/components/QuizBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { CircleHelp } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Quiz {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CircleHelp, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Quiz'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderQuiz(this.data.quiz)\n\t\t} else {\n\t\t\tthis.renderQuizModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderQuiz(quiz) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(QuizBlock, {\n\t\t\t\tquiz: quiz,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Quiz: ${quiz}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderQuizModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'quiz',\n\t\t\tonAddition: (quiz) => {\n\t\t\t\tthis.data.quiz = quiz\n\t\t\t\tthis.renderQuiz(quiz)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tquiz: this.data.quiz,\n\t\t}\n\t}\n}","<template>\n\t<div v-if=\"assignment.data\" class=\"grid grid-cols-[65%,35%] h-full\" :class=\"{ 'border rounded-lg': !showTitle }\">\n\t\t<div class=\"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t<div v-if=\"showTitle\" class=\"text-lg font-semibold mb-5 text-ink-gray-9\">\n\t\t\t\t<div v-if=\"submissionName === 'new'\">\n\t\t\t\t\t{{ __('Submission by') }} {{ user.data?.full_name }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('Submission by') }} {{ submissionResource.doc?.member_name }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"text-sm text-ink-gray-7 font-medium mb-2\">\n\t\t\t\t{{ __('Question') }}:\n\t\t\t</div>\n\t\t\t<div v-html=\"assignment.data.question\"\n\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal\">\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col\">\n\t\t\t<div class=\"p-5\">\n\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t<div class=\"font-semibold text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Submission') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t<Badge v-if=\"isDirty\" theme=\"orange\">\n\t\t\t\t\t\t\t{{ __('Not Saved') }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge v-else-if=\"submissionResource.doc?.status\" :theme=\"statusTheme\" size=\"lg\">\n\t\t\t\t\t\t\t{{ submissionResource.doc?.status }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Button variant=\"solid\" @click=\"submitAssignment()\">\n\t\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"\n\t\t\t\t\tsubmissionName != 'new' &&\n\t\t\t\t\t!['Pass', 'Fail', 'Graded'].includes(submissionResource.doc?.status) &&\n\t\t\t\t\tsubmissionResource.doc?.owner == user.data?.name\n\t\t\t\t\" class=\"bg-blue-200 p-3 rounded-md leading-5 text-sm mb-4\">\n\t\t\t\t\t{{ __(\"You've successfully submitted the assignment.\") }}\n\t\t\t\t\t{{\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\"Once the moderator grades your submission, you'll find the details here.\"\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t\t{{ __('Feel free to make edits to your submission if needed, until it is graded.') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showUploader()\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t{{ __('Add your assignment as {0}').format(assignment.data.type) }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FileUploader v-if=\"!submissionFile\" :fileTypes=\"getType()\" :validateFile=\"validateFile\"\n\t\t\t\t\t\t@success=\"(file) => saveSubmission(file)\">\n\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t: __('Upload File')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FileUploader>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<div class=\"flex text-ink-gray-7\">\n\t\t\t\t\t\t\t<div class=\"border self-start rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a :href=\"submissionFile.file_url\" target=\"_blank\"\n\t\t\t\t\t\t\t\tclass=\"flex flex-col cursor-pointer !no-underline\">\n\t\t\t\t\t\t\t\t<span class=\"text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t{{ submissionFile.file_name }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-5 mt-1\">\n\t\t\t\t\t\t\t\t\t{{ getFileSize(submissionFile.file_size) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<X v-if=\"canModifyAssignment\" @click=\"removeSubmission()\"\n\t\t\t\t\t\t\t\tclass=\"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"assignment.data.type == 'URL'\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t{{ __('Enter a URL') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl v-model=\"answer\" type=\"text\" :readonly=\"!canModifyAssignment\" />\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<div class=\"text-sm mb-4\">\n\t\t\t\t\t\t{{ __('Write your answer here') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor :content=\"answer\" @change=\"(val) => (answer = val)\" :editable=\"true\" :fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\" />\n\t\t\t\t</div>\n\n\t\t\t\t<div v-if=\"\n\t\t\t\t\tuser.data?.name == submissionResource.doc?.owner &&\n\t\t\t\t\tsubmissionResource.doc?.comments\n\t\t\t\t\" class=\"mt-8 p-3 bg-blue-200 rounded-md\">\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2\">\n\t\t\t\t\t\t{{ __('Comments by') }}: {{ submissionResource.doc?.evaluator || __('Evaluator') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"leading-5\">\n\t\t\t\t\t\t<div v-html=\"submissionResource.doc.comments\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Grading -->\n\t\t\t\t<div v-if=\"canGradeSubmission\" class=\"mt-8 space-y-4\">\n\t\t\t\t\t<div class=\"font-semibold mb-2 text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Grading') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.status\"\n\t\t\t\t\t\t:label=\"__('Grading Status')\" type=\"select\" :options=\"submissionStatusOptions\" />\n\t\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.grade\"\n\t\t\t\t\t\t:label=\"__('Score')\" type=\"number\" />\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t{{ __('Comments') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<TextEditor :content=\"comments\" @change=\"\n\t\t\t\t\t\t\t(val) => {\n\t\t\t\t\t\t\t\tcomments = val\n\t\t\t\t\t\t\t\tisDirty = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\" :editable=\"true\" :fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tcall,\n\tcreateResource,\n\tcreateDocumentResource,\n\tFileUploader,\n\tFormControl,\n\tTextEditor,\n\ttoast\n} from 'frappe-ui'\nimport { computed, inject, onMounted, onBeforeUnmount, ref, watch } from 'vue'\nimport { FileText, X } from 'lucide-vue-next'\nimport { getFileSize } from '@/utils'\nimport { useRouter } from 'vue-router'\n\nconst submissionFile = ref(null)\nconst answer = ref(null)\nconst comments = ref(null)\nconst router = useRouter()\nconst user = inject('$user')\nconst showTitle = router.currentRoute.value.name == 'AssignmentSubmission'\nconst isDirty = ref(false)\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tsubmissionName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n})\n\nonMounted(() => {\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tconsole.log('User: ', user.data)\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitAssignment()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst assignment = createResource({\n\turl: 'frappe.client.get',\n\tparams: {\n\t\tdoctype: 'Assignment Activity',\n\t\tname: props.assignmentID,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (props.submissionName != 'new') {\n\t\t\tsubmissionResource.reload()\n\t\t}\n\t},\n})\n\nconst newSubmission = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tlet doc = {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tassignment: props.assignmentID,\n\t\t\tmember: user.data?.name,\n\t\t\tcourse: router.currentRoute.value.params.courseName\n\t\t}\n\t\tif (showUploader()) {\n\t\t\tdoc.assignment_attachment = submissionFile.value.file_url\n\t\t} else {\n\t\t\tdoc.answer = answer.value\n\t\t}\n\t\treturn {\n\t\t\tdoc: doc,\n\t\t}\n\t},\n})\n\nconst imageResource = createResource({\n\turl: 'seminary.seminary.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tsubmissionFile.value = data\n\t},\n})\n\nconst submissionResource = createDocumentResource({\n\tdoctype: 'Assignment Submission',\n\tname: props.submissionName,\n\tonError(err) {\n\t\ttoast.error(err.messages?.[0] || err)\n\t},\n\tauto: false,\n\tcache: [user.data?.name, props.assignmentID],\n})\n\nwatch(submissionResource, () => {\n\tif (submissionResource.doc) {\n\t\tif (submissionResource.doc.assignment_attachment) {\n\t\t\timageResource.reload({\n\t\t\t\timage: submissionResource.doc.assignment_attachment,\n\t\t\t})\n\t\t}\n\t\tif (submissionResource.doc.answer) {\n\t\t\tanswer.value = submissionResource.doc.answer\n\t\t}\n\t\tif (submissionResource.doc.comments) {\n\t\t\tcomments.value = submissionResource.doc.comments\n\t\t}\n\t\tif (submissionResource.isDirty) {\n\t\t\tisDirty.value = true\n\t\t} else if (showUploader() && !submissionFile.value) {\n\t\t\tisDirty.value = true\n\t\t} else if (!showUploader() && !answer.value) {\n\t\t\tisDirty.value = true\n\t\t} else {\n\t\t\tisDirty.value = false\n\t\t}\n\t}\n})\n\nwatch(submissionFile, () => {\n\tif (props.submissionName == 'new' && submissionFile.value) {\n\t\tisDirty.value = true\n\t}\n})\n\nwatch(\n\t() => submissionResource.doc?.grade,\n\t(newGrade, oldGrade) => {\n\t\tif (newGrade !== oldGrade && submissionResource.doc) {\n\t\t\tsubmissionResource.doc.status = 'Graded'; // Automatically set status to \"Graded\"\n\t\t\tisDirty.value = true; // Mark the form as dirty to indicate unsaved changes\n\t\t}\n\t}\n);\n\nconst submitAssignment = () => {\n\tif (props.submissionName != 'new') {\n\t\tlet evaluator =\n\t\t\tsubmissionResource.doc && submissionResource.doc.owner != user.data?.name\n\t\t\t\t? user.data?.name\n\t\t\t\t: null\n\n\t\tsubmissionResource.setValue.submit(\n\t\t\t{\n\t\t\t\t...submissionResource.doc,\n\t\t\t\tassignment_attachment: submissionFile.value?.file_url,\n\t\t\t\tevaluator: evaluator,\n\t\t\t\tcomments: comments.value,\n\t\t\t\tanswer: answer.value,\n\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(__('Changed successfully'))\n\t\t\t\t\tisDirty.value = false;\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t} else {\n\t\taddNewSubmission()\n\t}\n}\n\nconst addNewSubmission = () => {\n\tnewSubmission.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Assignment submitted successfully'))\n\t\t\t\tif (router.currentRoute.value.name == 'AssignmentSubmission') {\n\t\t\t\t\trouter.push({\n\t\t\t\t\t\tname: 'AssignmentSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tassignmentID: props.assignmentID,\n\t\t\t\t\t\t\tsubmissionName: data.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tmarkLessonProgress()\n\t\t\t\t\trouter.go()\n\t\t\t\t}\n\t\t\t\tsubmissionResource.name = data.name\n\t\t\t\tisDirty.value = false;\n\t\t\t\tsubmissionResource.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveSubmission = (file) => {\n\tisDirty.value = true\n\tsubmissionFile.value = file\n}\n\nconst markLessonProgress = () => {\n\tif (router.currentRoute.value.name == 'Lesson') {\n\t\tlet courseName = router.currentRoute.value.params.courseName\n\t\tlet chapterNumber = router.currentRoute.value.params.chapterNumber\n\t\tlet lessonNumber = router.currentRoute.value.params.lessonNumber\n\t\tconsole.log(\"Chapter Number: \", chapterNumber)\n\t\tconsole.log(\"Lesson Number: \", lessonNumber)\n\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: courseName,\n\t\t\tchapter_number: chapterNumber,\n\t\t\tlesson_number: lessonNumber,\n\t\t})\n\t}\n}\n\nconst getType = () => {\n\tconst type = assignment.data?.type\n\tif (type == 'Image') {\n\t\treturn ['image/*']\n\t} else if (type == 'Document') {\n\t\treturn [\n\t\t\t'.doc',\n\t\t\t'.docx',\n\t\t\t'.xml',\n\t\t\t'application/msword',\n\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t]\n\t} else if (type == 'PDF') {\n\t\treturn ['.pdf']\n\t}\n}\n\nconst validateFile = (file) => {\n\tlet type = assignment.data?.type\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (type == 'Image' && !['jpg', 'jpeg', 'png'].includes(extension)) {\n\t\treturn __('Only image file is allowed.')\n\t} else if (\n\t\ttype == 'Document' &&\n\t\t!['doc', 'docx', 'xml'].includes(extension)\n\t) {\n\t\treturn __('Only document file is allowed.')\n\t} else if (type == 'PDF' && !['pdf'].includes(extension)) {\n\t\treturn __('Only PDF file is allowed.')\n\t}\n}\n\nconst removeSubmission = () => {\n\tisDirty.value = true\n\tsubmissionFile.value = null\n}\n\nconst canGradeSubmission = computed(() => {\n\treturn (\n\t\t(user.data?.is_moderator ||\n\t\t\tuser.data?.is_evaluator ||\n\t\t\tuser.data?.is_instructor) &&\n\t\tprops.submissionName != 'new' &&\n\t\trouter.currentRoute.value.name == 'AssignmentSubmission'\n\t)\n})\n\nconst canModifyAssignment = computed(() => {\n\treturn (\n\t\t!submissionResource.doc ||\n\t\t(submissionResource.doc?.owner == user.data?.name &&\n\t\t\tsubmissionResource.doc?.status == 'Not Graded')\n\t)\n})\n\nconst submissionStatusOptions = computed(() => {\n\treturn [\n\t\t{ label: __('Not Graded'), value: 'Not Graded' },\n\t\t{ label: __('Graded'), value: 'Graded' },\n\t\t{ label: __('Pass'), value: 'Pass' },\n\t\t{ label: __('Fail'), value: 'Fail' },\n\t]\n})\n\nconst statusTheme = computed(() => {\n\tif (!submissionResource.doc) {\n\t\treturn 'orange'\n\t} else if (submissionResource.doc.status == 'Pass' || submissionResource.doc.status == 'Graded') {\n\t\treturn 'green'\n\t} else if (submissionResource.doc.status == 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n})\n\nconst showUploader = () => {\n\treturn ['PDF', 'Image', 'Document'].includes(assignment.data?.type)\n}\n</script>\n","<template>\n\t<Assignment\n\t\tv-if=\"user.data && submission.data\"\n\t\t:assignmentID=\"assignmentID\"\n\t\t:submissionName=\"submission.data?.name || 'new'\"\n\t/>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the assignment.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject, watch } from 'vue'\nimport { Button, createResource } from 'frappe-ui'\nimport Assignment from '@/components/Assignment.vue'\n\nconst user = inject('$user')\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst submission = createResource({\n\turl: 'frappe.client.get_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tfieldname: 'name',\n\t\t\tfilters: {\n\t\t\t\tassignment: props.assignmentID,\n\t\t\t\tmember: user.data?.name,\n\t\t\t},\n\t\t}\n\t},\n\tauto: true,\n})\n</script>\n","import { Pencil } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport AssignmentBlock from '@/components/AssignmentBlock.vue'\nimport translationPlugin from '../translation'\nimport { usersStore } from '@/stores/user'\nimport router from '../router'\n\nexport class Assignment {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(Pencil, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Assignment'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderAssignment(this.data.assignment)\n\t\t} else {\n\t\t\tthis.renderAssignmentModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderAssignment(assignment) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(AssignmentBlock, {\n\t\t\t\tassignmentID: assignment,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Assignment: ${assignment}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderAssignmentModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'assignment',\n\t\t\tonAddition: (assignment) => {\n\t\t\t\tthis.data.assignment = assignment\n\t\t\t\tthis.renderAssignment(assignment)\n\t\t\t},\n\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tassignment: this.data.assignment,\n\t\t}\n\t}\n}\n","<template>\n  <div v-if=\"submisisonDetails.loading\" class=\"text-center py-5\">\n    <p>Loading submission details...</p>\n  </div>\n  <div v-else-if=\"submisisonDetails.doc\" class=\"space-y-5\">\n    <div class=\"grid grid-cols-3 gap-3\">\n      <!-- Left Section (3/3 width) -->\n      <div class=\"col-span-3 space-y-4\">\n        <div class=\"space-y-4 border p-2 rounded-md\">\n          <div class=\"flex items-center justify-between py-4\">\n            <!-- Exam Percentage -->\n            <div class=\"text-center ml-5\">\n              <div class=\"text-3xl font-bold text-ink-gray-9\">\n                {{ submisisonDetails.doc.percentage || 0 }}%\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Score</div>\n            </div>\n\n            <!-- Score and Time Taken -->\n            <div class=\"text-center\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9\">\n                {{ submisisonDetails.doc.score }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">\n                Out of {{ submisisonDetails.doc.score_out_of }} Points\n              </div>\n            </div>\n            <div class=\"text-center mr-5\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9 mt-2\">\n                {{ formatTime(submisisonDetails.doc.time_taken) }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Time taken</div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Questions Section -->\n        <div v-for=\"(row, index) in submisisonDetails.doc.result\" :key=\"index\" class=\"border p-5 rounded-md space-y-4 \">\n          <!-- Question Title -->\n          <div class=\"space-y-1\">\n            <div class=\"font-semibold text-ink-gray-9 text-left\">\n              {{ __('Question') }} {{ index + 1 }}:\n            </div>\n            <div class=\"leading-5 text-ink-gray-9 text-left\" v-html=\"row.question_name\"></div>\n          </div>\n          <!-- Answer -->\n          <div class=\"leading-5 text-ink-gray-7 space-x-1 text-left\">\n            <span> {{ __('Your Answer') }}: </span>\n            <span v-html=\"row.answer\"></span>\n          </div>\n          <!-- Points -->\n          <div class=\"flex justify-end items-center space-x-2\">\n            <span class=\"text-sm text-ink-gray-7 text-xl\">\n              {{ row.points }} / {{ parseInt(row.points_out_of, 10) }} {{ __('Points') }}\n            </span>\n          </div>\n          <!-- Comments -->\n          <div v-if=\"row.comments\" class=\"leading-5 text-ink-gray-7 text-xl space-x-1 text-left\">\n            <span> {{ __('Comments') }}: </span>\n            <span v-html=\"row.comments\"></span>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  </div>\n  <div v-else>\n    <p>Debug: No submission details found.</p>\n  </div>\n</template>\n\n<script setup>\nimport { createDocumentResource } from 'frappe-ui';\nimport { watch, inject } from 'vue';\n\n\n// const socket = inject('$socket')\n// if (socket) {\n\n//     console.log('ExamGraded socket :', socket); // Debugging log\n\n//   } else {\n//     console.log('ExamGraded socket is not available'); // Debugging log\n//   }\n\nconst props = defineProps({\n  submission: {\n    type: String,\n    required: true,\n  },\n});\n\nconsole.log('ExamGraded received submission:', props.submission); // Debugging log\n\nconst submisisonDetails = createDocumentResource({\n  doctype: 'Exam Submission',\n  name: props.submission,\n  auto: true,\n});\nconsole.log('ExamGraded submisisonDetails:', submisisonDetails); // Debugging log\n\nwatch(\n  () => submisisonDetails.doc,\n  (newDoc) => {\n    submisisonDetails.loading = false;\n    console.log('ExamGraded updated with new submission details:', newDoc); // Debugging log\n  }\n);\n\nconst formatTime = (seconds) => {\n  if (!seconds) return '00:00:00'; // Handle null or undefined values\n  const hrs = Math.floor(seconds / 3600).toString().padStart(2, '0');\n  const mins = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${hrs}:${mins}:${secs}`;\n};\n</script>","<template>\n\t<Tooltip :text=\"user.full_name\">\n\t\t<Avatar\n\t\t\tclass=\"avatar border border-outline-gray-2 cursor-auto\"\n\t\t\tv-if=\"user\"\n\t\t\t:label=\"user.full_name\"\n\t\t\t:image=\"user.user_image\"\n\t\t\t:size=\"size\"\n\t\t\tv-bind=\"$attrs\"\n\t\t/>\n\t</Tooltip>\n</template>\n<script setup>\nimport { Avatar, Tooltip } from 'frappe-ui'\nconst props = defineProps({\n\tuser: {\n\t\ttype: Object,\n\t\tdefault: null,\n\t},\n\tsize: {\n\t\ttype: String,\n\t},\n})\n</script>\n","<template>\n\t<div class=\"mt-6\">\n\t\t<div v-if=\"!singleThread\" class=\"flex items-center mb-5\">\n\t\t\t<Button variant=\"outline\" @click=\"showTopics = true\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ChevronLeft class=\"w-5 h-5 stroke-1.5 text-ink-gray-7\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<span class=\"text-lg font-semibold ml-2 text-ink-gray-9\">\n\t\t\t\t{{ topic.title }}\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div v-for=\"(reply, index) in replies.data\">\n\t\t\t<div class=\"py-3\" :class=\"{ 'border-b': index + 1 != replies.data.length }\">\n\t\t\t\t<div class=\"flex items-center justify-between mb-2\">\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<UserAvatar :user=\"reply.user\" class=\"mr-2\" />\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ reply.user.full_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-2\">\n\t\t\t\t\t\t\t{{ timeAgo(reply.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Dropdown v-if=\"\n\t\t\t\t\t\tuser.data.name == reply.owner && !reply.editable && !readOnlyMode\n\t\t\t\t\t\" :options=\"[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: __('Edit'),\n\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\treply.editable = true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: __('Delete'),\n\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\tdeleteReply(reply)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]\">\n\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t<MoreHorizontal class=\"w-4 h-4 stroke-1.5 cursor-pointer\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t\t<div v-if=\"reply.editable\">\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"postEdited(reply)\">\n\t\t\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"reply.editable = false\">\n\t\t\t\t\t\t\t{{ __('Discard') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<TextEditor :content=\"reply.reply\" @change=\"(val) => (reply.reply = val)\"\n\t\t\t\t\t:editable=\"reply.editable || false\" :fixedMenu=\"reply.editable || false\" :editorClass=\"reply.editable\n\t\t\t\t\t\t? 'ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none'\n\t\t\t\t\t\t: 'prose-sm'\n\t\t\t\t\t\t\" />\n\t\t\t</div>\n\t\t</div>\n\n\t\t<TextEditor v-if=\"renderEditor && !readOnlyMode\" class=\"mt-5\" :content=\"newReply\" :mentions=\"mentionUsers\"\n\t\t\t@change=\"(val) => (newReply = val)\" placeholder=\"Type your reply here...\" :fixedMenu=\"true\"\n\t\t\teditorClass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none border border-outline-gray-2 rounded-b-md min-h-[7rem] py-1 px-2\" />\n\t\t<div v-if=\"!readOnlyMode\" class=\"flex justify-between mt-2\">\n\t\t\t<span> </span>\n\t\t\t<Button @click=\"postReply()\">\n\t\t\t\t<span>\n\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t</span>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { createResource, TextEditor, Button, Dropdown, toast } from 'frappe-ui'\nimport { timeAgo } from '@/utils'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { ChevronLeft, MoreHorizontal } from 'lucide-vue-next'\nimport { ref, inject, onMounted, onUnmounted } from 'vue'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst showTopics = defineModel('showTopics')\nconst newReply = ref('')\nconst user = inject('$user')\nconst allUsers = inject('$allUsers')\nconst mentionUsers = ref([])\nconst renderEditor = ref(false)\nconst readOnlyMode = window.read_only_mode\n\nconst socketConnected = ref(false); // Track socket connection status\n\n// Initialize the socket directly\nconst socket = initSocket(); // Use the default namespace or specify one if needed\n\nif (!socket) {\n\tconsole.error('Socket connection not initialized in Discussions.vue.');\n} else {\n\tconsole.log('Socket connection initialized in Discussions.vue:', socket);\n\n\t// Add event listeners for debugging and connection tracking\n\tsocket.on('connect', () => {\n\t\tconsole.log('Socket connected:', socket.id);\n\t\tsocketConnected.value = true; // Mark socket as connected\n\t});\n\n\tsocket.on('connect_error', (error) => {\n\t\tconsole.error('Socket connection error:', error);\n\t});\n\n\tsocket.on('disconnect', (reason) => {\n\t\tconsole.warn('Socket disconnected:', reason);\n\t\tsocketConnected.value = false; // Mark socket as disconnected\n\t});\n}\n\nconst props = defineProps({\n\ttopic: {\n\t\ttype: Object,\n\t\trequired: true,\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n})\n\nonMounted(() => {\n\tsocket.on('publish_message', (data) => {\n\t\treplies.reload()\n\t})\n\tsocket.on('update_message', (data) => {\n\t\treplies.reload()\n\t})\n\tsocket.on('delete_message', (data) => {\n\t\treplies.reload()\n\t})\n\tfetchMentionUsers()\n})\n\nconst replies = createResource({\n\turl: 'seminary.seminary.utils.get_discussion_replies',\n\tcache: ['replies', props.topic],\n\tmakeParams(values) {\n\t\treturn {\n\t\t\ttopic: props.topic.name,\n\t\t}\n\t},\n\tauto: true,\n})\n\nconst newReplyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Reply',\n\t\t\t\treply: newReply.value,\n\t\t\t\ttopic: props.topic.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst fetchMentionUsers = () => {\n\tif (user.data?.is_student) {\n\t\trenderEditor.value = true\n\t} else {\n\t\tallUsers.reload(\n\t\t\t{},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tmentionUsers.value = Object.values(data).map((user) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tvalue: user.name,\n\t\t\t\t\t\t\tlabel: user.full_name,\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\trenderEditor.value = true\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t}\n}\n\nconst postReply = () => {\n\tnewReplyResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!newReply.value) {\n\t\t\t\t\treturn __('Reply cannot be empty')\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\tnewReply.value = ''\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editReplyResource = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t\tfieldname: 'reply',\n\t\t\tvalue: values.reply,\n\t\t}\n\t},\n})\n\nconst postEdited = (reply) => {\n\teditReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t\treply: reply.reply,\n\t\t},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!reply.reply) {\n\t\t\t\t\treturn __('Reply cannot be empty')\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\treply.editable = false\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst deleteReplyResource = createResource({\n\turl: 'frappe.client.delete',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t}\n\t},\n})\n\nconst deleteReply = (reply) => {\n\tdeleteReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nonUnmounted(() => {\n\tsocket.off('publish_message')\n\tsocket.off('update_message')\n\tsocket.off('delete_message')\n})\n</script>","<template>\n\t<Dialog v-model=\"show\" :disableOutsideClickToClose=\"true\" :options=\"dialogOptions\">\n\t\t<template #body-content>\n\t\t\t<div class=\"discussion-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto\">\n\t\t\t\t<div>\n\t\t\t\t\t<FormControl v-model=\"topic.title\" :label=\"__('Title')\" type=\"text\" />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"mb-1.5 text-sm text-ink-gray-5\">\n\t\t\t\t\t\t{{ __('Details') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor :content=\"topic.reply\" @change=\"(val) => (topic.reply = val)\" :editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FormControl, TextEditor, createResource, toast } from 'frappe-ui'\nimport { computed, reactive, watch } from 'vue'\nimport { singularize } from '@/utils'\n\nconst show = defineModel()\nconst topics = defineModel('reloadTopics')\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst topic = reactive({\n\ttitle: '',\n\treply: '',\n})\n\nconst resetTopic = () => {\n\ttopic.title = ''\n\ttopic.reply = ''\n}\n\nconst topicResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Topic',\n\t\t\t\treference_doctype: props.doctype,\n\t\t\t\treference_docname: props.docname,\n\t\t\t\ttitle: topic.title,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst replyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Reply',\n\t\t\t\ttopic: values.topic,\n\t\t\t\treply: topic.reply,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitTopic = (close) => {\n\ttopicResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!topic.title) {\n\t\t\t\t\treturn __('Title cannot be empty.')\n\t\t\t\t}\n\t\t\t\tif (!topic.reply) {\n\t\t\t\t\treturn __('Reply cannot be empty.')\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess(data) {\n\t\t\t\treplyResource.submit(\n\t\t\t\t\t{\n\t\t\t\t\t\ttopic: data.name,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\tshow.value = false\n\t\t\t\t\t\t\ttopics.value.reload()\n\t\t\t\t\t\t\tresetTopic()\n\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst handleCancel = (close) => {\n\tshow.value = false\n\tresetTopic()\n\tclose?.()\n}\n\nwatch(show, (value) => {\n\tif (!value) {\n\t\tresetTopic()\n\t}\n})\n\nconst dialogOptions = computed(() => ({\n\ttitle: singularize(props.title),\n\tsize: '2xl',\n\tactions: [\n\t\t{\n\t\t\tlabel: __('Post'),\n\t\t\tvariant: 'solid',\n\t\t\tonClick: (close) => submitTopic(close),\n\t\t},\n\t\t{\n\t\t\tlabel: __('Cancel'),\n\t\t\tvariant: 'text',\n\t\t\tonClick: (close) => handleCancel(close),\n\t\t},\n\t],\n}))\n</script>\n","export function scrollTo(...options) {\n\tif (!options || options.length === 0) return\n\tconst container = getScrollContainer()\n\tif (!container) return\n\tcontainer.scrollTo(...options)\n}\n\nexport function getScrollContainer() {\n\t// window.scrollContainer is reference to the scroll container in DesktopLayout.vue and MobileLayout.vue\n\treturn window.scrollContainer\n}\n","<template>\n\t<div>\n\t\t<Button v-if=\"!singleThread && props.type === 'multi'\" class=\"float-right\" @click=\"openTopicModal()\">\n\t\t\t{{ __('New {0}').format(singularize(title)) }}\n\t\t</Button>\n\t\t<div class=\"text-xl font-semibold text-ink-gray-9\">\n\t\t\t{{ __(title) }}\n\t\t</div>\n\t</div>\n\t<div v-if=\"loading && props.type === 'single'\">\n\t\t<div class=\"text-center py-10\">\n\t\t\t<span>Loading discussion...</span>\n\t\t</div>\n\t</div>\n\t<div v-if=\"props.type === 'single' && !loading\">\n\n\t\t<div class=\"flex flex-col items-center justify-center\">\n\n\t\t</div>\n\t\t<DiscussionModal v-model=\"showTopicModal\" :title=\"title\" :doctype=\"props.doctype\" :docname=\"props.docname\" />\n\t\t<DiscussionReplies v-if=\"currentTopic.value\" :topic=\"currentTopic.value\" :singleThread=\"true\"\n\t\t\tv-model:showTopics=\"showTopics\" />\n\t</div>\n\t<div v-if=\"topics.data?.length && !singleThread\">\n\t\t<div v-if=\"showTopics\" v-for=\"(topic, index) in topics.data\" :key=\"index\">\n\t\t\t<div @click=\"showReplies(topic)\" class=\"flex items-center cursor-pointer py-5 w-full\"\n\t\t\t\t:class=\"{ 'border-b': index + 1 != topics.data.length }\">\n\t\t\t\t<UserAvatar :user=\"topic.user\" size=\"2xl\" class=\"mr-4\" />\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"text-lg font-semibold mb-1 text-ink-gray-7\">\n\t\t\t\t\t\t{{ topic.title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ topic.user.full_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-3\">\n\t\t\t\t\t\t\t{{ timeAgo(topic.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else>\n\t\t\t<DiscussionReplies :topic=\"currentTopic\" v-model:showTopics=\"showTopics\" />\n\t\t</div>\n\t</div>\n\t<div v-else class=\"flex flex-col items-center justify-center border-2 border-dashed mt-5 py-8 rounded-md\">\n\t\t<MessageSquareText class=\"w-7 h-7 text-ink-gray-4 stroke-1.5 mr-2\" />\n\t\t<div class=\"\">\n\t\t\t<div v-if=\"emptyStateTitle\" class=\"font-medium mb-2\">\n\t\t\t\t{{ __(emptyStateTitle) }}\n\t\t\t</div>\n\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t{{ __(emptyStateText) }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<DiscussionModal v-model=\"showTopicModal\" :title=\"__('New {0}').format(title)\" :doctype=\"props.doctype\"\n\t\t:docname=\"props.docname\" v-model:reloadTopics=\"topics\" />\n</template>\n<script setup>\nconsole.log('Discussions.vue script setup executed'); // Debugging: Ensure script is running\n\nimport { createResource, Button } from 'frappe-ui'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { singularize, timeAgo } from '../utils'\nimport { ref, onMounted, inject, watch } from 'vue'\nimport DiscussionReplies from '@/components/DiscussionReplies.vue'\nimport DiscussionModal from '@/components/Modals/DiscussionModal.vue'\nimport { MessageSquareText } from 'lucide-vue-next'\nimport { getScrollContainer } from '@/utils/scrollContainer'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst showTopics = ref(true)\nconst currentTopic = ref(null)\nconst user = inject('$user')\nconst showTopicModal = ref(false)\nconst loading = ref(true); // Add a loading state\nconst socketConnected = ref(false); // Track socket connection status\n\n// Initialize the socket directly\nconst socket = initSocket(); // Use the default namespace or specify one if needed\n\nif (!socket) {\n\tconsole.error('Socket connection not initialized in Discussions.vue.');\n} else {\n\tconsole.log('Socket connection initialized in Discussions.vue:', socket);\n\n\t// Add event listeners for debugging and connection tracking\n\tsocket.on('connect', () => {\n\t\tconsole.log('Socket connected:', socket.id);\n\t\tsocketConnected.value = true; // Mark socket as connected\n\t});\n\n\tsocket.on('connect_error', (error) => {\n\t\tconsole.error('Socket connection error:', error);\n\t});\n\n\tsocket.on('disconnect', (reason) => {\n\t\tconsole.warn('Socket disconnected:', reason);\n\t\tsocketConnected.value = false; // Mark socket as disconnected\n\t});\n}\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\temptyStateTitle: {\n\t\ttype: String,\n\t\tdefault: '',\n\t},\n\temptyStateText: {\n\t\ttype: String,\n\t\tdefault: __('Start a discussion'),\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\tscrollToBottom: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\ttype: {\n\t\ttype: String,\n\t\tdefault: 'multi', // Default to multi-topic mode but can be single for assignment feedback\n\t},\n})\n\n// Watch for socket connection and execute onMounted logic once connected\nwatch(socketConnected, (isConnected) => {\n\tif (isConnected) {\n\t\tconsole.log('Socket is connected, proceeding with onMounted logic.');\n\t\texecuteOnMountedLogic();\n\t}\n});\n\nconst executeOnMountedLogic = () => {\n\tconsole.log('onMounted logic executed'); // Debugging: Ensure this is called\n\tconsole.log('Props:', props); // Debugging: Log props\n\n\tif (user.data) {\n\t\tif (props.type === 'single') {\n\t\t\tconsole.log('Single-topic mode detected'); // Debugging\n\t\t\tsingleTopicResource.reload(); // Trigger the resource to fetch the single topic\n\t\t\tconsole.log('Topic', currentTopic.value)\n\t\t} else {\n\t\t\tloading.value = false; // Immediately stop loading for multi-topic mode\n\t\t}\n\t\ttopics.reload();\n\t}\n\n\tsocket.on('new_discussion_topic', (data) => {\n\t\ttopics.refresh();\n\t});\n\n\tif (props.scrollToBottom) {\n\t\tsetTimeout(() => {\n\t\t\tscrollToEnd();\n\t\t}, 100);\n\t}\n};\n\nconst scrollToEnd = () => {\n\tlet scrollContainer = getScrollContainer()\n\tscrollContainer.scrollTop = scrollContainer.scrollHeight\n}\n\nconst singleTopicResource = createResource({\n\turl: 'seminary.seminary.utils.ensure_single_topic',\n\tcache: false, // No need to cache this since it's a one-time call\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: props.doctype,\n\t\t\tdocname: props.docname,\n\t\t\ttitle: props.title,\n\t\t};\n\t},\n\tonSuccess(data) {\n\t\tconsole.log('Ensure single topic response:', data); // Debugging\n\t\tif (data) {\n\t\t\tcurrentTopic.value = data; // Set the single topic as the current topic\n\t\t\tconsole.log('Current topic set:', currentTopic.value); // Debugging\n\t\t\tshowTopics.value = false; // Automatically show replies for the single topic\n\t\t\tloading.value = false; // Mark loading as complete\n\t\t}\n\t\tconsole.log('Changed loading to:', loading.value); // Debugging\n\t},\n\tonError(error) {\n\t\tconsole.error('Error ensuring single topic:', error); // Log the error\n\t\tloading.value = false; // Ensure loading is stopped even on error\n\t},\n});\n\n\nconst topics = createResource({\n\turl: 'seminary.seminary.utils.get_discussion_topics',\n\tcache: ['topics', props.doctype, props.docname],\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: props.doctype,\n\t\t\tdocname: props.docname,\n\t\t\tsingle_thread: props.singleThread,\n\t\t}\n\t},\n})\n\nconst showReplies = (topic) => {\n\tshowTopics.value = false\n\tcurrentTopic.value = topic\n}\n\nconst openTopicModal = () => {\n\tshowTopicModal.value = true\n}\n</script>\n","<template>\n  <div v-if=\"isExamLoaded\">\n    <!-- Exam Header -->\n    <div v-if=\"!hasSubmittedExam\" class=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\">\n      <div class=\"leading-5\">\n        {{ __('This exam consists of ') + exam.data.questions.length }}\n        {{ exam.data.questions.length === 1 ? __('question') : __('questions') }}.\n      </div>\n      <div v-if=\"exam.data?.duration\" class=\"leading-5\">\n        {{\n          `Please ensure that you complete all the questions in ${exam.data.duration} minutes.`\n        }}\n      </div>\n      <div v-if=\"exam.data?.duration\" class=\"leading-5\">\n        {{\n          (\n            __('If you fail to do so, the exam will be automatically submitted when the timer ends.')\n\n        )\n        }}\n      </div>\n    </div>\n\n    <div v-if=\"hasSubmittedExam && (submission_anystatus?.data || attempts.data?.[0])\"\n      class=\"space-y-4 border p-5 rounded-md\">\n      <Discussions :title=\"'Exam Comments'\" :doctype=\"'Exam Submission'\"\n        :docname=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\"\n        :key=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\" type=\"single\" />\n    </div>\n\n    <div v-if=\"exam.data.duration && !hasSubmittedExam\" class=\"flex flex-col space-x-1 my-4\">\n      <div class=\"mb-2\">\n        <span class=\"\"> {{ __('Time') }}: </span>\n        <span class=\"font-semibold\">\n          {{ formatTimer(timer) }}\n        </span>\n      </div>\n      <ProgressBar :progress=\"timerProgress\" />\n    </div>\n    <!-- Start Screen -->\n    <div v-if=\"!fullExamMode && !is_instructor()\">\n      <div class=\"border text-center p-20 rounded-md\">\n        <div class=\"font-semibold text-lg\">\n          {{ exam.data.title }}\n        </div>\n        <Button v-if=\"exam.data.qbyquestion && !hasSubmittedExam\" @click=\"startExam\" class=\"mt-2\">\n          <span>{{ __('Start') }}</span>\n        </Button>\n        <Button v-else-if=\"!hasSubmittedExam\" @click=\"startExam2\" class=\"mt-2\">\n          <span>{{ __('Start Exam') }}</span>\n        </Button>\n        <div v-else-if=\"hasSubmittedExam && submission?.data?.name\" class=\"w-full max-w-4xl mx-auto py-5\">\n          <ExamGraded :submission=\"submission.data.name\" />\n        </div>\n        <div v-else>\n          {{ __('You have already submitted this exam. As soon as it is graded, you will see the feedback here.') }}\n        </div>\n      </div>\n    </div>\n\n    <!-- Full Exam Mode -->\n    <div v-if=\"fullExamMode || is_instructor()\">\n      <div class=\"border text-center p-20 rounded-md\">\n        <div class=\"font-semibold text-lg text-ink-gray-9 mt-3 mb-3\">\n          {{ exam.data.title }}\n        </div>\n        <router-link v-if=\"is_instructor()\" :to=\"{\n          name: 'ExamForm',\n          params: {\n            examID: exam.data.name,\n          },\n        }\" class=\"flex items-center text-gray-400 mb-3 mr-4 hover:text-gray-600\">\n          <SquarePen class=\"w-5 h-5 mr-2\" />\n          <span class=\"tooltip\" data-tooltip=\"Edit this exam\">Edit</span>\n        </router-link>\n\n        <div v-for=\"(question, index) in exam.data.questions\" :key=\"question.name\"\n          class=\"relative border rounded-md p-5 mb-4\">\n          <div\n            class=\"absolute -top-3 -left-3 bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm\">\n            {{ index + 1 }}\n          </div>\n\n\n          <div class=\"text-ink-gray-9 text-sm font-semibold text-right\">\n            {{ question.points }} {{ question.points === 1 ? __('Point') : __('Points') }}\n          </div>\n\n          <div class=\"text-ink-gray-9 text-left font-semibold mt-2 leading-5\">\n            <div v-html=\"question.question_detail || __('No question detail provided.')\"></div>\n          </div>\n          <div class=\"mt-4\">\n            <textarea v-if=\"answers && answers[question.name] !== undefined\" v-model=\"answers[question.name]\" rows=\"7\"\n              class=\"border rounded-md p-2 w-full resize-y\" :placeholder=\"__('Type your answer here')\"\n              @input=\"(event) => updateAnswer(question.name, event.target.value)\" />\n          </div>\n        </div>\n        <div class=\"text-center mt-4\">\n          <Button @click=\"submitExam\">\n            <span>{{ __('Submit Your Exam') }}</span>\n          </Button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { Button, call, createResource, toast } from 'frappe-ui'\nimport { ref, watch, inject, computed, toRaw, onMounted, onBeforeUnmount } from 'vue'\nimport { CheckCircle, XCircle, MinusCircle, SquarePen } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\nimport ExamGraded from '@/components/ExamGraded.vue'\nimport Discussions from '@/components/Discussions.vue'\nconst user = inject('$user')\nconst timer = ref(0);\nlet timerInterval = null;\nconst elapsedTime = ref(0);\nconst answer = ref('');\nconst answers = ref({}); // Use ref instead of reactive\nconst questions = ref([]);\nconst fullExamMode = ref(false); // Always in full exam mode\nconst router = useRouter()\nlet user_is_instructor = false\n\nconst ensureAnswersInitialized = (questionsList = []) => {\n  const existingAnswers = { ...answers.value };\n  const initialized = {};\n\n  questionsList.forEach((question) => {\n    const current = existingAnswers[question.name];\n    initialized[question.name] = typeof current === 'string' ? current : '';\n  });\n\n  answers.value = initialized;\n};\n// const socket = inject('$socket')\n\n// if (!socket) {\n//   console.error('Socket connection not found in Exam.vue. Ensure $socket is provided.');\n// } else {\n//   console.log('Socket connection established in Exam.vue:', socket);\n\n//   socket.on('new_discussion_topic', (data) => {\n//     console.log('New discussion topic received:', data);\n//   });\n// }\n// Props\nconst props = defineProps({\n  examName: {\n    type: String,\n    required: true,\n  },\n\n});\nconsole.log('Exam Name (PROPS):', props.examName); // Debugging log\n\n// Exam resource\nconst exam = createResource({\n  url: 'frappe.client.get',\n  makeParams(values) {\n    return {\n      doctype: 'Exam Activity',\n      name: props.examName,\n    };\n  },\n  cache: ['exam', props.examName],\n  auto: true,\n  transform(data) {\n    if (!data) {\n      console.error('Exam data is null or undefined.');\n      return null;\n    }\n    data.duration = parseInt(data.duration) || 0;\n    return data;\n  },\n  onSuccess(data) {\n    if (data) {\n      // console.log('Loaded exam data:', data); // Debugging\n      // console.log('Exam Name:', exam.data?.name); // Debugging log\n      // console.log('User Name:', user.data?.name); // Debugging log\n      data.questions = data.questions || []; // Ensure questions is always an array\n      ensureAnswersInitialized(data.questions);\n\n      // populateQuestions();\n      // setupTimer();\n    } else {\n      console.error(\"Failed to load exam data.\"); // Debugging\n    }\n  },\n  onError(err) {\n    console.error(\"Error loading exam data:\", err); // Debugging\n  },\n});\n\n// Check if exam data is loaded\nconst isExamLoaded = computed(() => {\n  // console.log('Exam data on isExamLoaded:', exam.data); // Debugging\n  return !!exam.data;\n});\n\nconst hasSubmittedExam = computed(() => {\n  return attempts.data?.length > 0;\n});\n\nconst instructors = createResource({\n  url: 'seminary.seminary.utils.get_instructors',\n  makeParams(values) {\n    const courseName = router.currentRoute.value.params.courseName;\n    if (!courseName) {\n      console.error('Course name is undefined in route parameters.');\n      return {};\n    }\n    return {\n      course: courseName,\n    };\n  },\n  auto: true,\n});\n\nwatch(\n  () => instructors.data,\n  (list) => {\n    if (!Array.isArray(list)) {\n      return;\n    }\n    const wasInstructor = user_is_instructor;\n    user_is_instructor = list.some((instructor) => instructor.user === user.data?.name);\n    if (!wasInstructor && user_is_instructor && exam.data?.questions?.length) {\n      ensureAnswersInitialized(exam.data.questions);\n    }\n  },\n);\n\nconst is_instructor = () => {\n  // console.log('Fetching instructors of course:', router.currentRoute.value.params.courseName); // Debugging\n  if (instructors.data) {\n    instructors.data.forEach((instructor) => {\n      if (instructor.user === user.data?.name) {\n        user_is_instructor = true;\n      }\n    });\n  }\n  return user_is_instructor;\n};\n\n// // Populate questions (shuffle and limit)\n// const populateQuestions = () => {\n//   if (!exam.data || !exam.data.questions) {\n//     console.warn('No questions found in exam data.'); // Debugging\n//     return;\n//   }\n\n//   const data = exam.data;\n//   if (data.shuffle_questions) {\n//         // Shuffle the questions\n//         const shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n//         // Limit the number of questions if required\n//         questions.value = data.limit_questions_to\n//             ? shuffledQuestions.slice(0, data.limit_questions_to)\n//             : shuffledQuestions;\n//     } else {\n//         // Use the original questions if no shuffle is required\n//         questions.value = data.questions;\n//     }\n\n// \tconsole.log(\"Populated questions:\", questions)\n// };\n\n// Timer setup\nlet timerStartTime = null; // Store the start time\nconst startTimer = () => {\n  if (exam.data.duration) {\n    // If duration is set, initialize the timer with the duration\n    timer.value = exam.data.duration * 60; // Total duration in seconds\n    timerStartTime = Date.now(); // Record the start time\n    const endTime = timerStartTime + timer.value * 1000; // Calculate the end time\n\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      const remainingTime = Math.max(0, Math.floor((endTime - currentTime) / 1000)); // Calculate remaining time\n\n      timer.value = remainingTime; // Update the timer value\n      elapsedTime.value = exam.data.duration * 60 - remainingTime; // Calculate elapsed time\n\n      if (remainingTime <= 0) {\n        clearInterval(timerInterval);\n        submitExam(); // Automatically submit the exam when the timer ends\n      }\n    }, 1000);\n  } else {\n    // If duration is null, track elapsed time only\n    timerStartTime = Date.now(); // Record the start time\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      elapsedTime.value = Math.floor((currentTime - timerStartTime) / 1000); // Calculate elapsed time in seconds\n    }, 1000);\n  }\n};\n\n// Format timer\nconst formatTimer = (seconds) => {\n  const mins = Math.floor(seconds / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${mins}:${secs}`;\n};\n\n// Timer progress\nconst timerProgress = computed(() => {\n  return (timer.value / (exam.data.duration * 60)) * 100;\n});\n\n// Shuffle array utility\nconst shuffleArray = (array) => {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n  return array;\n};\n\nwatch(answers, (newAnswers) => {\n  //console.log('Answers updated:', newAnswers);\n}, { deep: true });\n\nconst get_answers = () => {\n\n  const rawAnswers = toRaw(answers.value); // Extract plain data from the reactive object\n  return Object.entries(rawAnswers).map(([questionName, answer]) => ({\n    question: questionName,\n    answer: answer,\n  }));\n};\n\nconst updateAnswer = (questionName, value) => {\n  answers.value[questionName] = value;\n};\n\nconst attempts = createResource({\n  url: 'frappe.client.get_list',\n  makeParams(values) {\n    return {\n      doctype: 'Exam Submission',\n      filters: {\n        member: user.data?.name,\n        exam: props.examName,\n      },\n      fields: ['name', 'creation'],\n      order_by: 'creation desc',\n    };\n  },\n  auto: true,\n  transform(data) {\n\n    //console.log('Fetched attempts:', data); // Debugging log\n    data.forEach((submission, index) => {\n      submission.creation = timeAgo(submission.creation);\n      submission.idx = index + 1;\n    });\n  },\n});\n\nwatch(\n  () => attempts.data,\n  (newData) => {\n    console.log('Attempts data updated:', newData); // Debugging log\n  }\n);\n\n// Submit exam\nconst submitExam = async () => {\n  try {\n    const submittedAnswers = get_answers();\n    //console.log('Submitting exam with answers:', submittedAnswers);\n    //console.log(\"Course Name:\", router.currentRoute.value.params.courseName);\n    const timeTaken = exam.data.duration\n      ? exam.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n      : elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n    //  API call\n    await call('seminary.seminary.doctype.exam_submission.exam_submission.create_exam_submission', {\n      exam: props.examName,\n      course: router.currentRoute.value.params.courseName,\n      member: user.data?.name,\n      answers: submittedAnswers,\n      time_taken: timeTaken,\n    });\n\n    toast.success(__('Your exam was submitted successfully.'));\n    clearInterval(timerInterval);\n  } catch (error) {\n    console.error('Error during exam submission:', error);\n    toast.error(err.messages?.[0] || err)\n  }\n};\n\nconst startExam = () => {\n  activeQuestion.value = 1\n  localStorage.removeItem(exam.data.title)\n  startTimer()\n  ensureAnswersInitialized(exam.data?.questions || []);\n}\n\nconst startExam2 = () => {\n  localStorage.removeItem(exam.data.title);\n  fullExamMode.value = true; // Set full exam mode flag\n  startTimer();\n  ensureAnswersInitialized(exam.data?.questions || []);\n  // all_questions_details.reload(); // Ensure the resource is reloaded\n\n}\n\nconst submission = createResource({\n  url: 'frappe.client.get_value',\n  params: {\n    doctype: 'Exam Submission',\n    fieldname: 'name',\n    filters: {\n      exam: props.examName,\n      member: user.data?.name,\n      status: 'Graded',\n    },\n  },\n  auto: false, // Disable auto-fetch\n  transform(data) {\n    console.log('Fetched submission data:', data); // Debugging log\n    return data;\n  },\n  onError(err) {\n    console.error('Error fetching submission:', err); // Debugging log\n  },\n});\n\n\nconst submission_anystatus = createResource({\n  url: 'frappe.client.get_value',\n  params: {\n    doctype: 'Exam Submission',\n    fieldname: 'name',\n    filters: {\n      exam: props.examName,\n      member: user.data?.name,\n    },\n  },\n  auto: false, // Disable auto-fetch\n  transform(data) {\n    console.log('Fetched submission AnyStatus:', data.name); // Debugging log\n    return data;\n  },\n  onError(err) {\n    console.error('Error fetching submission:', err); // Debugging log\n  },\n});\n\n\nonMounted(() => {\n\n  // Load submission resources on mount\n  submission.reload();\n  submission_anystatus.reload();\n});\n\nonBeforeUnmount(() => {\n  if (timerInterval) {\n    clearInterval(timerInterval);\n  }\n});\n\n</script>\n\n<style>\n/* Tooltip styling */\n.tooltip {\n  position: relative;\n  cursor: pointer;\n}\n\n.tooltip::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background-color: #333;\n  color: #fff;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.tooltip:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n</style>","<template>\n\t<Exam v-if=\"user.data\" :examName=\"exam\" ></Exam>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the exam.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Exam from '@/components/Exam.vue'\n\nconst user = inject('$user')\n\n\nconst props = defineProps({\n\texam: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\n})\n\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","import ExamBlock from '@/components/ExamBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { BookOpenCheck } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Exam {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(BookOpenCheck, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Exam'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderExam(this.data.exam)\n\t\t} else {\n\t\t\tthis.renderExamModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderExam(exam) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(ExamBlock, {\n\t\t\t\texam: exam,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Exam: ${exam}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderExamModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'exam',\n\t\t\tonAddition: (exam) => {\n\t\t\t\tthis.data.exam = exam\n\t\t\t\tthis.renderExam(exam)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router); // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\texam: this.data.exam,\n\t\t}\n\t}\n}","<template v-if=\"discussionReady\">\n\t<div v-if=\"discussion.data\" class=\"grid grid-cols-[65%,35%] h-full\" :class=\"{ 'border rounded-lg': !showTitle }\">\n\t\t<div class=\"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t<div v-if=\"showTitle\" class=\"text-lg font-semibold mb-5 text-ink-gray-9\">\n\t\t\t\t<div v-if=\"submissionName === 'new'\">\n\t\t\t\t\t{{ __('Submission by') }} {{ user.data?.full_name }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('Submission by') }} {{ submissionResource.doc?.member_name }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"text-lg text-ink-gray-7 font-medium mb-2\">\n\t\t\t\t{{ __('Discussion Prompt') }}:\n\t\t\t</div>\n\t\t\t<div v-html=\"discussion.data.prompt\"\n\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal\"\n\t\t\t\t</div>\n\n\t\t\t\t<div v-if=\"\n\t\t\t\t\tall_discussions.data && (hasSavedSubmission || (!hasSavedSubmission && !post_before) || !isStudent)\n\t\t\t\t\" class=\"flex-1 border-l p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t\t\t<div v-if=\"!isStudent\" class=\"mb-4 mt-4\">\n\t\t\t\t\t\t<label for=\"groupFilter\" class=\"block text-sm font-medium text-gray-700\">\n\t\t\t\t\t\t\t{{ __('Filter by Group') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<select id=\"groupFilter\" v-model=\"selectedGroupFilter\"\n\t\t\t\t\t\t\tclass=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\">\n\t\t\t\t\t\t\t<option value=\"all\">{{ __('All Groups') }}</option>\n\t\t\t\t\t\t\t<option v-for=\"group in studentGroups\" :key=\"group.student_group\"\n\t\t\t\t\t\t\t\t:value=\"group.student_group\">\n\t\t\t\t\t\t\t\t{{ group.student_group || 'No group' }}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<div v-for=\"discussion in filteredDiscussions\" :key=\"discussion.name\"\n\t\t\t\t\t\tclass=\"mb-6 border-round border-gray-300 p-4 bg-surface-white shadow-sm\">\n\t\t\t\t\t\t<div class=\"original-post mb-4\">\n\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ discussion.student_name }}</div>\n\t\t\t\t\t\t\t<div v-html=\"discussion.original_post\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ formatDate(discussion.creation) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a v-if=\"discussion.original_attachment\" :href=\"discussion.original_attachment\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\" class=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"replies pl-4 border-l border-gray-300\">\n\t\t\t\t\t\t\t<div v-for=\"reply in discussion.replies\" :key=\"reply.creation\" class=\"mb-2\">\n\t\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ reply.member_name || reply.owner }}</div>\n\t\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t\t{{ formatDate(reply.reply_dt) }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-html=\"reply.reply\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t\t<a v-if=\"reply.reply_attach\" :href=\"reply.reply_attach\" target=\"_blank\"\n\t\t\t\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"new-reply mt-4 space-y-2\">\n\t\t\t\t\t\t\t<textarea v-model=\"discussion.new_reply\" :placeholder=\"__('Write a reply...')\"\n\t\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t<FileUploader v-if=\"!replyFiles[discussion.name]\" :fileTypes=\"getType()\"\n\t\t\t\t\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t\t\t@success=\"(file) => saveReplyAttachment(discussion.name, file)\">\n\t\t\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\" variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: __('Attach File')\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t\t\t<div v-else class=\"flex items-center space-x-2 text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"border rounded-md p-2\">\n\t\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col leading-5\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm\">{{ replyFiles[discussion.name].file_name }}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(replyFiles[discussion.name].file_size) }}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Button variant=\"subtle\" size=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"removeReplyAttachment(discussion.name)\">\n\t\t\t\t\t\t\t\t\t\t\t{{ __('Remove') }}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Button variant=\"solid\" :disabled=\"!canSubmitReply(discussion)\"\n\t\t\t\t\t\t\t\t\t@click=\"handleReplySubmit(discussion)\">\n\t\t\t\t\t\t\t\t\t{{ __('Post Reply') }}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"!hasSavedSubmission && post_before && isStudent\" class=\"text-ink-gray-5 mt-5\">\n\t\t\t\t\t{{ __('You have to make your original post before seeing other posts.') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"text-ink-gray-5 mt-5\">\n\t\t\t\t\t{{ __('No discussions available yet.') }}\n\t\t\t\t\t{{ 'All discussions', all_discussions.data }}\n\t\t\t\t\t{{ 'hasSavedSubmission', hasSavedSubmission }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"canGradeSubmission\" class=\"mt-8 space-y-4\">\n\t\t\t\t<div class=\"font-semibold mb-2 text-ink-gray-9\">\n\t\t\t\t\t{{ __('Grading') }}\n\t\t\t\t</div>\n\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.status\"\n\t\t\t\t\t:label=\"__('Grading Status')\" type=\"select\" :options=\"submissionStatusOptions\" />\n\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.grade\" :label=\"__('Score')\"\n\t\t\t\t\ttype=\"number\" />\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t{{ __('Comments') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<textarea v-model=\"comments\" @input=\"isDirty = true\"\n\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"!hasSavedSubmission\" class=\"text-md mb-4\">\n\t\t\t\t<div class=\"flex flex-col\">\n\n\t\t\t\t\t<div class=\"p-5\">\n\t\t\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<Badge v-if=\"isDirty\" theme=\"orange\">\n\t\t\t\t\t\t\t\t\t{{ __('Not Saved') }}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t<Badge v-else-if=\"submissionResource.doc?.status\" :theme=\"statusTheme\" size=\"lg\">\n\t\t\t\t\t\t\t\t\t{{ submissionResource.doc?.status }}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t<Button variant=\"solid\" @click=\"submitDiscussion()\">\n\t\t\t\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div v-if=\"!hasSavedSubmission\" class=\"text-md mb-4\">\n\t\t\t\t\t\t\t{{ __('Write your main post here') }}\n\t\t\t\t\t\t\t<textarea v-model=\"original_post\" @input=\"isDirty = true\"\n\t\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none\"></textarea>\n\n\t\t\t\t\t\t\t<div class=\"text-md text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ __('You may also add an attachment') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<FileUploader v-if=\"!submissionFile\" :fileTypes=\"getType()\" :validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t@success=\"(file) => saveSubmission(file)\">\n\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t: __('Upload File')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t<div class=\"flex text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t<div class=\"border self-start rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<a :href=\"submissionFile.file_url\" target=\"_blank\"\n\t\t\t\t\t\t\t\t\t\tclass=\"flex flex-col cursor-pointer !no-underline\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t\t\t{{ submissionFile.file_name }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-5 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(submissionFile.file_size) }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t<X v-if=\"canModifyDiscussion\" @click=\"removeSubmission()\"\n\t\t\t\t\t\t\t\t\t\tclass=\"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"text-md mb-4 ml-2\">\n\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2 mt-4\">\n\t\t\t\t\t{{ __('Your submission has been saved:') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-for=\"submission in savedsubmission.data\" :key=\"submission.name || submission.creation\">\n\t\t\t\t\t<div class=\"font-semibold mb-1\">\n\t\t\t\t\t\t{{ formatDate(submission.creation) }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>{{ submission.original_post }}</div>\n\t\t\t\t\t<a v-if=\"submission.original_attachment\" :href=\"submission.original_attachment\" target=\"_blank\"\n\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t</a>\n\t\t\t\t\t<div class=\"replies pl-4 border-l border-gray-300\">\n\t\t\t\t\t\t<div v-for=\"reply in submission.replies\" :key=\"reply.creation\" class=\"mb-2\">\n\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ reply.member_name || reply.owner }}</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ formatDate(reply.reply_dt) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-html=\"reply.reply\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t<a v-if=\"reply.reply_attach\" :href=\"reply.reply_attach\" target=\"_blank\"\n\t\t\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"new-reply mt-4 space-y-2\">\n\t\t\t\t\t\t<textarea v-model=\"submission.new_reply\" :placeholder=\"__('Write a reply...')\"\n\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t<FileUploader v-if=\"!replyFiles[submission.name]\" :fileTypes=\"getType()\"\n\t\t\t\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t\t@success=\"(file) => saveReplyAttachment(submission.name, file)\">\n\t\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\" variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: __('Attach File')\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t\t<div v-else class=\"flex items-center space-x-2 text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t<div class=\"border rounded-md p-2\">\n\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col leading-5\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm\">{{ replyFiles[submission.name].file_name }}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(replyFiles[submission.name].file_size) }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Button variant=\"subtle\" size=\"sm\" @click=\"removeReplyAttachment(submission.name)\">\n\t\t\t\t\t\t\t\t\t\t{{ __('Remove') }}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button variant=\"solid\" :disabled=\"!canSubmitReply(submission)\"\n\t\t\t\t\t\t\t\t@click=\"handleReplySubmit(submission)\">\n\t\t\t\t\t\t\t\t{{ __('Post Reply') }}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div v-if=\"\n\t\t\t\tuser.data?.name == submissionResource.doc?.owner &&\n\t\t\t\tsubmissionResource.doc?.comments\n\t\t\t\" class=\"mt-8 p-3 bg-blue-200 rounded-md\">\n\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2\">\n\t\t\t\t\t{{ __('Comments by') }}: {{ submissionResource.doc?.evaluator || __('Evaluator') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"leading-5\">\n\t\t\t\t\t<div v-html=\"submissionResource.doc.comments\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t</div>\n\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tcall,\n\tcreateResource,\n\tcreateDocumentResource,\n\tFileUploader,\n\tFormControl,\n\ttoast\n} from 'frappe-ui'\nimport { computed, inject, onMounted, onBeforeUnmount, ref, watch, toRaw } from 'vue'\nimport dayjsModule from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport { FileText, X } from 'lucide-vue-next'\nimport { getFileSize } from '@/utils'\nimport { useRouter } from 'vue-router'\n\n\n\nconst dayjs = typeof dayjsModule === 'function' ? dayjsModule : dayjsModule.default\ndayjs.extend(relativeTime)\n\nconst submissionFile = ref(null)\nconst original_post = ref('')\nconst comments = ref('')\nconst router = useRouter()\nconst user = inject('$user')\nconst showTitle = router.currentRoute.value.name == 'DiscussionActivitySubmission'\nconst isDirty = ref(false)\nconst replyFiles = ref({})\nconst isStudent = computed(() => user.data?.is_student || false)\nconst studentGroups = ref([]);\nconst selectedGroupFilter = ref('all')\nconst Student = ref('');\nconst courseName = computed(() => router.currentRoute.value.params.courseName)\nconst discussionID = computed(() => props.discussionID)\nconst owner = computed(() => user.data?.name)\n\n\nconst saveReplyAttachment = (itemName, file) => {\n\treplyFiles.value = {\n\t\t...replyFiles.value,\n\t\t[itemName]: file,\n\t}\n}\n\nconst discussionReady = computed(() => {\n\tcourseName.value && discussionID.value && owner.value\n})\n\nconst removeReplyAttachment = (itemName) => {\n\tconst { [itemName]: _removed, ...rest } = replyFiles.value\n\treplyFiles.value = rest\n}\n\nconst canSubmitReply = (item) => {\n\treturn Boolean(item?.new_reply && item.new_reply.toString().trim().length)\n}\n\nconst props = defineProps({\n\tdiscussionID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tsubmissionName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n\tcanGradeSubmission: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t\trequired: false,\n\t},\n})\n\nonMounted(() => {\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tconsole.log('User: ', user.data?.name)\n\tconsole.log('Discussion ID: ', props.discussionID)\n\tconsole.log(\"Course Name: \", router.currentRoute.value.params.courseName)\n\treloadDiscussionLists()\n\tStudentData.reload().then(() => {\n\t\tconsole.log('Student data after reload:', Student.value)\n\t\tconsole.log('Student group:', Student.value?.student_group)\n\t})\n\tconsole.log('Saved Submission Data on Mount:', savedsubmission.data)\n\tconsole.log('hasSavedSubmission:', hasSavedSubmission.value)\n\tfetchStudentGroups()\n\tfilteredDiscussions.value; // Trigger initial computation\n\n\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitDiscussion()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst discussion = createResource({\n\turl: 'frappe.client.get',\n\tparams: {\n\t\tdoctype: 'Discussion Activity',\n\t\tname: props.discussionID,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (props.submissionName != 'new') {\n\t\t\tsubmissionResource.reload()\n\t\t}\n\t},\n})\n\nconsole.log(\"Submission Name: \", props.submissionName)\nconst post_before = computed(() => {\n\treturn discussion.data?.post_before\n})\n\nconst formatDate = (dateString) => {\n\tif (dateString && dateString.includes('.')) {\n\t\treturn dayjs(dateString.split('.')[0]).fromNow();\n\t}\n\treturn dayjs(dateString).fromNow();\n};\n\nfunction getFrappeDateTime() {\n\tconst now = new Date();\n\t// Get microseconds (JavaScript only provides milliseconds, so we multiply by 1000)\n\tconst microseconds = Math.floor(now.getMilliseconds() * 1000);\n\n\t// Format with padStart for proper zero-padding\n\tconst formatted = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}.${String(microseconds).padStart(6, '0')}`;\n\n\treturn formatted;\n}\nconst handleReplySubmit = (item) => {\n\tif (!canSubmitReply(item)) {\n\t\treturn\n\t}\n\n\tconst attachment = replyFiles.value[item.name]\n\tconst studentid = Student.value?.student || null\n\tconst member_name = Student.value?.student_name || user.data?.full_name\n\tconst reply_dt = getFrappeDateTime()\n\treplyResource.submit(\n\t\t{\n\t\t\tname: item.name,\n\t\t\treply: item.new_reply,\n\t\t\treply_attach: attachment,\n\t\t\tstudent: studentid,\n\t\t\tmember_name: member_name,\n\t\t\tparent: item.name,\n\t\t\treply_dt: reply_dt,\n\t\t\tparentfield: 'replies',\n\t\t\tparenttype: 'Discussion Submission'\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\ttoast.success(__('Reply posted successfully'))\n\t\t\t\titem.new_reply = ''\n\t\t\t\tif (attachment) {\n\t\t\t\t\tremoveReplyAttachment(item.name)\n\t\t\t\t}\n\t\t\t\trefreshDiscussionLists()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\n//Logic for fetching all discussions and their replies\nconst all_discussions = createResource({\n\turl: 'seminary.seminary.api.get_discussion_submissions',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tdiscussion_id: props.discussionID,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tdata?.forEach((discussion) => {\n\t\t\tif (discussion && typeof discussion.new_reply === 'undefined') {\n\t\t\t\tdiscussion.new_reply = ''\n\t\t\t}\n\t\t})\n\t\tconsole.log(\"All Discussions Data Fetched: \", data)\n\n\t},\n})\n\n//Get student data from user to avoid errors with instructor and get other fields\n\nconst StudentData = createResource({\n\turl: 'seminary.seminary.api.get_student_group',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tuser: user.data?.name,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tStudent.value = data\n\t\tconsole.log('Student fetched:', Student.value)\n\t}\n})\n\n\n\n// Fetch the saved discussion by the user if it exists\nconst savedsubmission = createResource({\n\turl: 'seminary.seminary.api.get_user_discussion_submission',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tdiscussion_id: props.discussionID,\n\t\t\towner: user.data?.name,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tconsole.log('Saved submission fetched:', data)\n\t}\n})\n\nconst hasSavedSubmission = computed(() =>\n\tArray.isArray(savedsubmission.data) && savedsubmission.data.length > 0\n)\n\n\n// Watch for when all required data becomes available\nwatch(discussionReady, async (hasData) => {\n\tif (hasData) {\n\t\tawait reloadDiscussionLists()\n\t}\n})\n\nconst reloadDiscussionLists = async () => {\n\ttry {\n\t\t// No need for null checks since we know data exists\n\t\tawait all_discussions.reload({\n\t\t\tcourse_name: courseName.value,\n\t\t\tdiscussion_id: discussionID.value,\n\t\t})\n\n\t\tawait savedsubmission.reload({\n\t\t\tcourse_name: courseName.value,\n\t\t\tdiscussion_id: discussionID.value,\n\t\t\towner: owner.value,\n\t\t})\n\t} catch (error) {\n\t\tconsole.error(\"Error reloading discussion lists:\", error)\n\t}\n}\n\n\n\nconst filteredDiscussions = computed(() => {\n\n\tlet filter_discussions = toRaw(all_discussions.data)\n\tconsole.log(\"Discussions before filtering: \", filter_discussions)\n\t// For students - show only their group if use_studentgroup is enabled\n\n\tif (isStudent.value) {\n\t\tif (discussion.data?.use_studentgroup) {\n\t\t\tlet selectedGroupFilter = studentGroup\n\t\t\treturn filter_discussions.filter(discussion =>\n\t\t\t\tdiscussion.student_group === selectedGroupFilter.value\n\t\t\t)\n\t\t} else {\n\t\t\treturn filter_discussions\n\t\t}\n\t} else {\n\t\t// For instructors - apply group filter\n\t\tif (!isStudent.value && selectedGroupFilter.value !== 'all') {\n\t\t\treturn filter_discussions.filter(discussion =>\n\t\t\t\tdiscussion.student_group === selectedGroupFilter.value\n\t\t\t)\n\t\t}\n\t\treturn filter_discussions\n\t}\n})\n\n\nconst refreshDiscussionLists = () => {\n\treloadDiscussionLists()\n}\n\n\n\nconst newSubmission = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tlet doc = {\n\t\t\tdoctype: 'Discussion Submission',\n\t\t\tdisc_activity: props.discussionID,\n\t\t\tdisc_title: discussion.data?.discussion_name,\n\t\t\tmember: user.data?.name,\n\t\t\tcoursesc: router.currentRoute.value.params.courseName,\n\t\t\toriginal_post: original_post.value,\n\t\t\toriginal_attachment: submissionFile.value?.file_url || null,\n\t\t\tstudent_name: Student.value?.student_name || user.data?.full_name,\n\t\t\tstudent: Student.value?.student || null,\n\t\t}\n\t\treturn {\n\t\t\tdoc: doc,\n\t\t}\n\t},\n})\n\nconst replyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tconst attachment = values.reply_attach\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Submission Replies',\n\t\t\t\tmember: user.data?.name,\n\t\t\t\treply: values.reply,\n\t\t\t\tstudent: values.student,\n\t\t\t\tmember_name: values.member_name || user.data?.full_name,\n\t\t\t\treply_dt: values.reply_dt,\n\t\t\t\tparent: values.name,\n\t\t\t\tparentfield: 'replies',\n\t\t\t\tparenttype: 'Discussion Submission',\n\t\t\t\treply_attach: attachment?.file_url || null,\n\t\t\t},\n\t\t}\n\t},\n\tauto: false,\n})\n\nconst imageResource = createResource({\n\turl: 'seminary.seminary.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tsubmissionFile.value = data\n\t},\n})\n\nconst submissionResource = createDocumentResource({\n\tdoctype: 'Discussion Submission',\n\tname: props.submissionName,\n\tonError(err) {\n\t\ttoast.error(err.messages?.[0] || err)\n\t},\n\tauto: false,\n\tcache: [user.data?.name, props.discussionID],\n})\n\nwatch(submissionResource, () => {\n\tif (submissionResource.doc) {\n\t\tif (submissionResource.doc.original_attachment) {\n\t\t\timageResource.reload({\n\t\t\t\timage: submissionResource.doc.original_attachment,\n\t\t\t})\n\t\t}\n\t\toriginal_post.value = submissionResource.doc.original_post || ''\n\t\tconsole.log(\"Original Post: \", original_post.value)\n\t\tcomments.value = submissionResource.doc.comments || ''\n\t\tconst hasFile = Boolean(submissionFile.value)\n\t\tconst hasOriginalPost = Boolean(original_post.value)\n\n\t\tif (submissionResource.isDirty) {\n\t\t\tisDirty.value = true\n\t\t} else if (!hasFile && !hasOriginalPost) {\n\t\t\tisDirty.value = true\n\t\t} else {\n\t\t\tisDirty.value = false\n\t\t}\n\t}\n})\n\n\nwatch(submissionFile, () => {\n\tif (props.submissionName == 'new' && submissionFile.value) {\n\t\tisDirty.value = true\n\t}\n})\n\nwatch(\n\t() => submissionResource.doc?.grade,\n\t(newGrade, oldGrade) => {\n\t\tif (newGrade !== oldGrade && submissionResource.doc) {\n\t\t\tsubmissionResource.doc.status = 'Graded'; // Automatically set status to \"Graded\"\n\t\t\tisDirty.value = true; // Mark the form as dirty to indicate unsaved changes\n\t\t}\n\t}\n);\n\nconst submitDiscussion = () => {\n\tif (props.submissionName != 'new') {\n\t\tlet evaluator =\n\t\t\tsubmissionResource.doc && submissionResource.doc.owner != user.data?.name\n\t\t\t\t? user.data?.name\n\t\t\t\t: null\n\n\t\tsubmissionResource.setValue.submit(\n\t\t\t{\n\t\t\t\t...submissionResource.doc,\n\t\t\t\toriginal_attachment: submissionFile.value?.file_url,\n\t\t\t\tevaluator: evaluator,\n\t\t\t\tcomments: comments.value,\n\t\t\t\toriginal_post: original_post.value,\n\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(__('Changed successfully'))\n\t\t\t\t\tisDirty.value = false;\n\t\t\t\t\trefreshDiscussionLists()\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t} else {\n\t\taddNewSubmission()\n\t}\n}\n\nconst addNewSubmission = () => {\n\tnewSubmission.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Discussion submitted successfully'))\n\t\t\t\tif (router.currentRoute.value.name == 'DiscussionSubmission') {\n\t\t\t\t\trouter.push({\n\t\t\t\t\t\tname: 'DiscussionSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tdiscussionID: props.discussionID,\n\t\t\t\t\t\t\tsubmissionName: data.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tmarkLessonProgress()\n\t\t\t\t\trouter.go()\n\t\t\t\t}\n\t\t\t\tsubmissionResource.name = data.name\n\t\t\t\tisDirty.value = false;\n\t\t\t\tsubmissionResource.reload()\n\t\t\t\trefreshDiscussionLists()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveSubmission = (file) => {\n\tisDirty.value = true\n\tsubmissionFile.value = file\n}\n\nconst markLessonProgress = () => {\n\tif (router.currentRoute.value.name == 'Lesson') {\n\t\tlet courseName = router.currentRoute.value.params.courseName\n\t\tlet chapterNumber = router.currentRoute.value.params.chapterNumber\n\t\tlet lessonNumber = router.currentRoute.value.params.lessonNumber\n\t\tconsole.log(\"Chapter Number: \", chapterNumber)\n\t\tconsole.log(\"Lesson Number: \", lessonNumber)\n\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: courseName,\n\t\t\tchapter_number: chapterNumber,\n\t\t\tlesson_number: lessonNumber,\n\t\t})\n\t}\n}\n\nconst getType = () => {\n\treturn [\n\t\t'image/*',\n\t\t'.pdf',\n\t\t'.doc',\n\t\t'.docx',\n\t\t'.xml',\n\t\t'application/msword',\n\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t]\n}\n\nconst validateFile = (file) => {\n\tconst extension = file.name.split('.').pop()?.toLowerCase()\n\tconst allowedExtensions = ['jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'xml']\n\tconst isImage = file.type?.startsWith('image/')\n\tif (isImage) {\n\t\treturn\n\t}\n\tif (!extension || !allowedExtensions.includes(extension)) {\n\t\treturn __('Only images, PDF, or Word documents are allowed.')\n\t}\n}\n\nconst removeSubmission = () => {\n\tisDirty.value = true\n\tsubmissionFile.value = null\n}\n\nconst canGradeSubmission = computed(() => {\n\treturn (\n\t\t(user.data?.is_moderator ||\n\t\t\tuser.data?.is_evaluator ||\n\t\t\tuser.data?.is_instructor) &&\n\t\tprops.submissionName != 'new' &&\n\t\trouter.currentRoute.value.name == 'DiscussionActivitySubmission'\n\t)\n})\n\nconst canModifyDiscussion = computed(() => {\n\treturn (\n\t\t!submissionResource.doc ||\n\t\t(submissionResource.doc?.owner == user.data?.name &&\n\t\t\tsubmissionResource.doc?.status == 'Not Graded')\n\t)\n})\n\nconst submissionStatusOptions = computed(() => {\n\treturn [\n\t\t{ label: __('Not Graded'), value: 'Not Graded' },\n\t\t{ label: __('Graded'), value: 'Graded' },\n\t\t{ label: __('Pass'), value: 'Pass' },\n\t\t{ label: __('Fail'), value: 'Fail' },\n\t]\n})\n\nconst statusTheme = computed(() => {\n\tif (!submissionResource.doc) {\n\t\treturn 'orange'\n\t} else if (submissionResource.doc.status == 'Pass' || submissionResource.doc.status == 'Graded') {\n\t\treturn 'green'\n\t} else if (submissionResource.doc.status == 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n})\n\nconst fetchStudentGroups = () => {\n\tif (!router.currentRoute.value.params.courseName) {\n\t\tconsole.warn('Cannot fetch student groups: Missing course name.');\n\t\treturn;\n\t}\n\n\tcall('seminary.seminary.api.get_student_groups_simple', {\n\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t})\n\t\t.then((response) => {\n\t\t\tstudentGroups.value = response || [];\n\t\t\tconsole.log('Student groups fetched:', studentGroups.value);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error('Error fetching student groups:', error);\n\t\t});\n};\n\nconst studentGroup = computed(() => {\n\tif (StudentData.loading) {\n\t\treturn __('Loading...');\n\t}\n\treturn Student.value?.student_group || __('No group assigned');\n});\n\nwatch(\n\t() => StudentData.loading,\n\t(loading) => {\n\t\tif (!loading) {\n\t\t\tconsole.log('Student data loaded on watch:', StudentData.data);\n\t\t}\n\t}\n);\n\nwatch(\n\t() => selectedGroupFilter.value,\n\t(newGroup) => {\n\t\tconsole.log('Selected group changed to:', newGroup);\n\t\tfilteredDiscussions.value; // Trigger recomputation\n\t}\n);\n\n//watch for changes in all_discussions to recalculate filteredDiscussions\n// watch(\n//   () => all_discussions.data,\n//   (newData) => {\n// \tconsole.log('All discussions data changed:', newData);\n// \tfilteredDiscussions.value; // Trigger recomputation\n//   }\n// );\n\n</script>\n","<template>\n\t<DiscussionActivity\n\t\tv-if=\"user.data\"\n\t\t:discussionID=\"discussionID\"\n\n\t/>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the Discussion Activity.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button, createResource } from 'frappe-ui'\nimport DiscussionActivity from '@/components/DiscussionActivity.vue'\n\nconst user = inject('$user')\n\nconst props = defineProps({\n\tdiscussionID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconsole.log('Discussion ID in Block: ', props.discussionID)\n\n// const submission = createResource({\n// \turl: 'frappe.client.get_value',\n// \tmakeParams(values) {\n// \t\treturn {\n// \t\t\tdoctype: 'Discussion Submission',\n// \t\t\tfieldname: 'name',\n// \t\t\tfilters: {\n// \t\t\t\tdisc_activity: props.discussionID,\n// \t\t\t\tmember: user.data?.name,\n// \t\t\t},\n// \t\t}\n// \t},\n// \tauto: true,\n// })\n// console.log(submission)\n\n</script>\n","import { MessagesSquare } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport DiscussionActivityBlock from '@/components/DiscussionActivityBlock.vue'\nimport translationPlugin from '../translation'\nimport { usersStore } from '@/stores/user'\nimport router from '../router'\n\nexport class DiscussionActivity {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(MessagesSquare, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Discussion Activity'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tconst discussionId = this.data.discussion || this.data.discussionID\n\t\tif (discussionId) {\n\t\t\tthis.renderDiscussionActivity(discussionId)\n\t\t} else {\n\t\t\tthis.renderDiscussionActivityModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderDiscussionActivity(discussion) {\n\t\tif (!discussion) {\n\t\t\tconsole.warn('[DiscussionActivity] Missing discussion id; falling back to selector')\n\t\t\tthis.renderDiscussionActivityModal()\n\t\t\treturn\n\t\t}\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(DiscussionActivityBlock, {\n\t\t\t\tdiscussionID: discussion,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Discussion Activity: ${discussion}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderDiscussionActivityModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'discussionactivity',\n\t\t\tonAddition: (discussion) => {\n\t\t\t\tthis.data.discussion = discussion\n\t\t\t\tthis.data.discussionID = discussion\n\t\t\t\tthis.renderDiscussionActivity(discussion)\n\t\t\t},\n\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\tconst discussionId = this.data.discussion || this.data.discussionID\n\tif (!discussionId) {\n\t\treturn {}\n\t}\n\treturn {\n\t\tdiscussion: discussionId,\n\t\tdiscussionID: discussionId,\n\t}\n\t}\n}\n","<template>\n\t<div>\n\t\t<!-- <audio width=\"100%\" controls controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio> -->\n\t\t<audio @ended=\"handleAudioEnd\" controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio>\n\t\t<div class=\"flex items-center space-x-2 shadow rounded-lg p-1 w-1/2\">\n\t\t\t<Button variant=\"ghost\" @click=\"togglePlay\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play v-if=\"!isPlaying\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<Pause v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs text-ink-gray-9 font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!isMuted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch } from 'vue'\nimport { Play, Pause, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst isPlaying = ref(false)\nconst audio = ref(null)\nlet isMuted = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\taudio.value = document.querySelector('audio')\n\t\taudio.value.onloadedmetadata = () => {\n\t\t\tduration.value = audio.value.duration\n\t\t}\n\t\taudio.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = audio.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst togglePlay = () => {\n\tif (audio.value.paused) {\n\t\taudio.value.play()\n\t\tisPlaying.value = true\n\t} else {\n\t\taudio.value.pause()\n\t\tisPlaying.value = false\n\t}\n}\n\nconst toggleMute = () => {\n\taudio.value.muted = !audio.value.muted\n\tisMuted.value = audio.value.muted\n}\n\nconst changeCurrentTime = () => {\n\taudio.value.currentTime = currentTime.value\n}\n\nconst handleAudioEnd = () => {\n\tisPlaying.value = false\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nwatch(isPlaying, (newVal) => {\n\tif (newVal) {\n\t\taudio.value.play()\n\t} else {\n\t\taudio.value.pause()\n\t}\n})\n</script>\n<style>\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\tappearance: none;\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -150px 0 0 150px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<div ref=\"videoContainer\" class=\"video-block group relative\">\n\t\t<video\n\t\t\t@timeupdate=\"updateTime\"\n\t\t\t@ended=\"videoEnded\"\n\t\t\t@click=\"togglePlay\"\n\t\t\toncontextmenu=\"return false\"\n\t\t\tclass=\"rounded-lg border border-gray-100 group cursor-pointer\"\n\t\t\tref=\"videoRef\"\n\t\t>\n\t\t\t<source :src=\"fileURL\" :type=\"type\" />\n\t\t</video>\n\t\t<div\n\t\t\tclass=\"flex items-center space-x-2 bg-surface-gray-3 rounded-md p-0.5 absolute bottom-3 w-[98%] left-0 right-0 mx-auto invisible group-hover:visible\"\n\t\t>\n\t\t\t<Button variant=\"ghost\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play\n\t\t\t\t\t\tv-if=\"!playing\"\n\t\t\t\t\t\t@click=\"playVideo\"\n\t\t\t\t\t\tclass=\"w-4 h-4 text-ink-gray-9\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Pause v-else @click=\"pauseVideo\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!muted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleFullscreen\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Maximize class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { ref, onMounted, computed } from 'vue'\nimport { Play, Pause, Maximize, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst videoRef = ref(null)\nconst videoContainer = ref(null)\nlet playing = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\nlet muted = ref(false)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\ttype: {\n\t\ttype: String,\n\t\tdefault: 'video/mp4',\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\tvideoRef.value.onloadedmetadata = () => {\n\t\t\tduration.value = videoRef.value.duration\n\t\t}\n\t\tvideoRef.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = videoRef.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst fileURL = computed(() => {\n\tif (isYoutube) {\n\t\tlet url = props.file\n\t\tif (url.includes('watch?v=')) {\n\t\t\turl = url.replace('watch?v=', 'embed/')\n\t\t}\n\t\treturn `${url}?autoplay=0&controls=0&disablekb=1&playsinline=1&cc_load_policy=1&cc_lang_pref=auto`\n\t}\n\treturn props.file\n})\n\nconst isYoutube = computed(() => {\n\treturn props.type == 'video/youtube'\n})\n\nconst playVideo = () => {\n\tvideoRef.value.play()\n\tplaying.value = true\n}\n\nconst pauseVideo = () => {\n\tvideoRef.value.pause()\n\tplaying.value = false\n}\n\nconst togglePlay = () => {\n\tif (playing.value) {\n\t\tpauseVideo()\n\t} else {\n\t\tplayVideo()\n\t}\n}\n\nconst videoEnded = () => {\n\tplaying.value = false\n}\n\nconst toggleMute = () => {\n\tvideoRef.value.muted = !videoRef.value.muted\n\tmuted.value = videoRef.value.muted\n}\n\nconst changeCurrentTime = () => {\n\tvideoRef.value.currentTime = currentTime.value\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nconst toggleFullscreen = () => {\n\tif (document.fullscreenElement) {\n\t\tdocument.exitFullscreen()\n\t} else {\n\t\tvideoContainer.value.requestFullscreen()\n\t}\n}\n</script>\n\n<style scoped>\n.video-block {\n\twidth: 100%;\n\tmax-width: 900px;\n\tmargin: 0 auto;\n}\n\n.video-block video {\n\twidth: 100%;\n\theight: auto;\n}\n\niframe {\n\twidth: 100%;\n\tmin-height: 500px;\n}\n\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -500px 0 0 500px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<FileUploader\n\t\t:fileTypes=\"['image/*', 'video/*', 'audio/*', '.pdf']\"\n\t\t:validateFile=\"validateFile\"\n\t\t@success=\"(data) => addFile(data)\"\n\t\tref=\"fileUploader\"\n\t\tclass=\"hide\"\n\t/>\n</template>\n<script setup>\nimport { FileUploader } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\n\nconst fileUploader = ref(null)\nconst emit = defineEmits(['fileUploaded'])\n\nconst props = defineProps({\n\tonFileUploaded: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\nonMounted(async () => {\n\tawait nextTick()\n\tconst fileInput = fileUploader.value.$el.querySelector('input[type=\"file\"]')\n\tif (fileInput) {\n\t\tfileInput.click()\n\t}\n})\n\nconst addFile = (file) => {\n\tprops.onFileUploaded({\n\t\tfile_url: file.file_url,\n\t\tfile_type: file.file_type,\n\t})\n}\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'mp4', 'mov', 'mp3', 'pdf'].includes(extension)) {\n\t\treturn 'Only image and video files are allowed.'\n\t}\n}\n\nconst isVideo = (type) => {\n\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n}\n\nconst isAudio = (type) => {\n\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n}\n</script>\n","import AudioBlock from '@/components/AudioBlock.vue'\nimport VideoBlock from '@/components/VideoBlock.vue'\nimport UploadPlugin from '@/components/UploadPlugin.vue'\nimport { h, createApp } from 'vue'\nimport { Upload as UploadIcon } from 'lucide-vue-next'\nimport translationPlugin from '../translation'\n\nexport class Upload {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(UploadIcon, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: 'Upload',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\n\t\tif (this.data && this.data.file_url) {\n\t\t\tthis.renderFile(this.data)\n\t\t} else {\n\t\t\tthis.renderFileUploader()\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\trenderFile(file) {\n\t\tif (this.isVideo(file.file_type)) {\n\t\t\tconst app = createApp(VideoBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (this.isAudio(file.file_type)) {\n\t\t\tconst app = createApp(AudioBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (file.file_type == 'PDF') {\n\t\t\tthis.wrapper.innerHTML = `<iframe src=\"https://docs.google.com/viewer?url=${\n\t\t\t\twindow.location.origin\n\t\t\t}${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)}&embedded=true\" width='100%' height='700px' class=\"mb-4\" type=\"application/pdf\"></iframe>`\n\t\t\treturn\n\t\t} else {\n\t\t\tthis.wrapper.innerHTML = `<img class=\"mb-4\" src=${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)} width='100%'>`\n\t\t\treturn\n\t\t}\n\t}\n\n\trenderFileUploader() {\n\t\tconst app = createApp(UploadPlugin, {\n\t\t\tonFileUploaded: (file) => {\n\t\t\t\tthis.data.file_url = file.file_url\n\t\t\t\tthis.data.file_type = file.file_type\n\t\t\t\tthis.renderFile(file)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.file_url || !savedData.file_type) {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tfile_url: this.data.file_url,\n\t\t\tfile_type: this.data.file_type,\n\t\t}\n\t}\n\n\tisVideo(type) {\n\t\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n\t}\n\n\tisAudio(type) {\n\t\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n\t}\n}\n","import { CodeXml } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\n\nexport class Markdown {\n\tconstructor({ data, api, readOnly, config }) {\n\t\tthis.api = api\n\t\tthis.data = data || {}\n\t\tthis.config = config || {}\n\t\tthis.text = data.text || ''\n\t\tthis.readOnly = readOnly\n\t\tthis.placeholder = __(\"Type '/' for commands or select text to format\")\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get conversionConfig() {\n\t\treturn {\n\t\t\texport: 'text',\n\t\t\timport: 'text',\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CodeXml, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tonPaste(event) {\n\t\tconst data = {\n\t\t\ttext: event.detail.data.innerHTML,\n\t\t}\n\n\t\tthis.data = data\n\t\twindow.requestAnimationFrame(() => {\n\t\t\tif (!this.wrapper) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.wrapper.innerHTML = this.data.text || ''\n\t\t})\n\t}\n\n\tstatic get pasteConfig() {\n\t\treturn {\n\t\t\ttags: ['P'],\n\t\t}\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tthis.wrapper.classList.add('cdx-block', 'ce-paragraph')\n\t\tthis.wrapper.innerHTML = this.text\n\n\t\tif (!this.readOnly) {\n\t\t\tthis.wrapper.contentEditable = true\n\t\t\tthis.wrapper.innerHTML = this.text\n\n\t\t\tthis.wrapper.addEventListener('input', (event) => {\n\t\t\t\tlet value = event.target.textContent\n\t\t\t\tif (event.keyCode === 32 && value.startsWith('#')) {\n\t\t\t\t\tthis.convertToHeader(event, value)\n\t\t\t\t} else if (event.keyCode == 189) {\n\t\t\t\t\tthis.convertBlock('list', {\n\t\t\t\t\t\tstyle: 'unordered',\n\t\t\t\t\t})\n\t\t\t\t} else if (/^[a-zA-Z]/.test(event.key)) {\n\t\t\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t})\n\t\t\t\t} else if (event.keyCode === 13 || event.keyCode === 190) {\n\t\t\t\t\tthis.parseContent(event)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\t_togglePlaceholder() {\n\t\tconst blocks = document.querySelectorAll(\n\t\t\t'.cdx-block.ce-paragraph[data-placeholder]'\n\t\t)\n\t\tblocks.forEach((block) => {\n\t\t\tif (block !== this.wrapper) {\n\t\t\t\tdelete block.dataset.placeholder\n\t\t\t}\n\t\t})\n\t\tif (this.wrapper.innerHTML.trim() === '') {\n\t\t\tthis.wrapper.dataset.placeholder = this.placeholder\n\t\t} else {\n\t\t\tdelete this.wrapper.dataset.placeholder\n\t\t}\n\t}\n\n\tconvertToHeader(event, value) {\n\t\tevent.preventDefault()\n\t\tif (['#', '##', '###', '####', '#####', '######'].includes(value)) {\n\t\t\tlet level = value.length\n\t\t\tevent.target.textContent = ''\n\t\t\tthis.convertBlock('header', {\n\t\t\t\tlevel: level,\n\t\t\t})\n\t\t}\n\t}\n\n\tparseContent(event) {\n\t\tevent.preventDefault()\n\t\tlet previousLine = this.wrapper.textContent\n\t\tif (event.keyCode === 190) {\n\t\t\tpreviousLine = previousLine + '.'\n\t\t}\n\n\t\tif (previousLine && this.hasImage(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('image')\n\t\t} else if (previousLine && this.hasLink(previousLine)) {\n\t\t\tconst { text, url } = this.extractLink(previousLine)\n\t\t\tconst anchorTag = `<a href=\"${url}\" target=\"_blank\">${text}</a>`\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine.replace(/\\[.+?\\]\\(.+?\\)/, anchorTag),\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('- ')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'unordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('- ', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('1.')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'ordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('1.', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && this.canBeEmbed(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('embed', {\n\t\t\t\tsource: previousLine,\n\t\t\t})\n\t\t} else {\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine,\n\t\t\t})\n\t\t}\n\t}\n\n\tasync convertBlock(type, data, index = null) {\n\t\tconst currentIndex = this.api.blocks.getCurrentBlockIndex()\n\t\tconst currentBlock = this.api.blocks.getBlockByIndex(currentIndex)\n\t\tawait this.api.blocks.convert(currentBlock.id, type, data)\n\t\tthis.api.caret.focus(true)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\ttext: blockContent.innerHTML,\n\t\t}\n\t}\n\n\thasImage(line) {\n\t\treturn /!\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractImage(line) {\n\t\tconst match = line.match(/!\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { alt: match[1], url: match[2] }\n\t\t}\n\t\treturn { alt: '', url: '' }\n\t}\n\n\thasLink(line) {\n\t\treturn /\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractLink(line) {\n\t\tconst match = line.match(/\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { text: match[1], url: match[2] }\n\t\t}\n\t\treturn { text: '', url: '' }\n\t}\n\n\tcanBeEmbed(line) {\n\t\treturn /^https?:\\/\\/.+/.test(line.trim())\n\t}\n}\n\nexport default Markdown","import { Code } from \"lucide-vue-next\"\nimport { h, createApp } from \"vue\"\nimport hljs from 'highlight.js/lib/core';\n\n\nconst DEFAULT_THEMES = ['light', 'dark'];\nconst COMMON_LANGUAGES = {\n\tnone: 'Auto-detect', apache: 'Apache', bash: 'Bash', cs: 'C#', cpp: 'C++', css: 'CSS', coffeescript: 'CoffeeScript', diff: 'Diff',\n\tgo: 'Go', html: 'HTML, XML', http: 'HTTP', json: 'JSON', java: 'Java', javascript: 'JavaScript', kotlin: 'Kotlin',\n\tless: 'Less', lua: 'Lua', makefile: 'Makefile', markdown: 'Markdown', nginx: 'Nginx', objectivec: 'Objective-C',\n\tphp: 'PHP', perl: 'Perl', properties: 'Properties', python: 'Python', ruby: 'Ruby', rust: 'Rust', scss: 'SCSS',\n\tsql: 'SQL', shell: 'Shell Session', swift: 'Swift', toml: 'TOML, also INI', typescript: 'TypeScript', yaml: 'YAML',\n\tplaintext: 'Plaintext'\n};\n\nexport class CodeBox {\n\tapi: any;\n\tconfig: { themeName: any; themeURL: any; useDefaultTheme: any; };\n\treadOnly: boolean;\n\tdata: { code: any; language: any; theme: any; };\n\thighlightScriptID: string;\n\thighlightCSSID: string;\n\tcodeArea: HTMLDivElement;\n\tselectInput: HTMLInputElement;\n\tselectDropIcon: HTMLElement;\n\n\tconstructor({ data, api, config, readOnly }) {\n\t\tthis.api = api;\n\t\tthis.readOnly = readOnly;\n\t\tthis.config = {\n\t\t\tthemeName: config.themeName && typeof config.themeName === 'string' ? config.themeName : '',\n\t\t\tthemeURL: config.themeURL && typeof config.themeURL === 'string' ? config.themeURL : '',\n\t\t\tuseDefaultTheme: (config.useDefaultTheme && typeof config.useDefaultTheme === 'string'\n\t\t\t\t&& DEFAULT_THEMES.includes(config.useDefaultTheme.toLowerCase())) ? config.useDefaultTheme : 'dark',\n\t\t};\n\t\tthis.data = {\n\t\t\tcode: data.code && typeof data.code === 'string' ? data.code : '',\n\t\t\tlanguage: data.language && typeof data.language === 'string' ? data.language : 'Auto-detect',\n\t\t\ttheme: data.theme && typeof data.theme === 'string' ? data.theme : this._getThemeURLFromConfig(),\n\t\t};\n\t\tthis.highlightScriptID = 'highlightJSScriptElement';\n\t\tthis.highlightCSSID = 'highlightJSCSSElement';\n\t\tthis.codeArea = document.createElement('div');\n\t\tthis.selectInput = document.createElement('input');\n\t\tthis.selectDropIcon = document.createElement('i');\n\n\t\tthis._injectHighlightJSCSSElement();\n\n\t\tthis.api.listeners.on(window, 'click', this._closeAllLanguageSelects, true);\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get sanitize() {\n\t\treturn {\n\t\t\tcode: true,\n\t\t\tlanguage: false,\n\t\t\ttheme: false,\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () => h(Code, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t});\n\n\t\tconst div = document.createElement('div');\n\t\tapp.mount(div);\n\n\t\treturn {\n\t\t\ttitle: 'CodeBox',\n\t\t\ticon: div.innerHTML\n\t\t};\n\t}\n\n\tstatic get displayInToolbox() {\n\t\treturn true;\n\t}\n\n\tstatic get enableLineBreaks() {\n\t\treturn true;\n\t}\n\n\trender() {\n\t\tconst codeAreaHolder = document.createElement('pre');\n\t\tconst languageSelect = this._createLanguageSelectElement();\n\n\t\tcodeAreaHolder.setAttribute('class', 'codeBoxHolder');\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\t\tthis.codeArea.setAttribute('contenteditable', 'true');\n\t\tthis.codeArea.innerHTML = this.data.code;\n\t\tthis.api.listeners.on(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.on(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\n\t\tcodeAreaHolder.appendChild(this.codeArea);\n\t\t!this.readOnly && codeAreaHolder.appendChild(languageSelect);\n\n\t\treturn codeAreaHolder;\n\t}\n\n\tsave(blockContent) {\n\t\treturn Object.assign(this.data, { code: this.codeArea.innerHTML, theme: this._getThemeURLFromConfig() });\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.code.trim()) return false;\n\t\treturn true;\n\t}\n\n\tdestroy() {\n\t\tthis.api.listeners.off(window, 'click', this._closeAllLanguageSelects, true);\n\t\tthis.api.listeners.off(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.off(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\t\tthis.api.listeners.off(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\t}\n\n\t_createLanguageSelectElement() {\n\t\tconst selectHolder = document.createElement('div');\n\t\tconst selectPreview = document.createElement('div');\n\t\tconst languages = Object.entries(COMMON_LANGUAGES);\n\n\t\tselectHolder.setAttribute('class', 'codeBoxSelectDiv');\n\n\t\tthis.selectDropIcon.setAttribute('class', `codeBoxSelectDropIcon ${this.config.useDefaultTheme}`);\n\t\tthis.selectDropIcon.innerHTML = '&#8595;';\n\t\tthis.selectInput.setAttribute('class', `codeBoxSelectInput ${this.config.useDefaultTheme}`);\n\t\tthis.selectInput.setAttribute('type', 'text');\n\t\tthis.selectInput.setAttribute('readonly', 'true');\n\t\tthis.selectInput.value = this.data.language;\n\t\tthis.api.listeners.on(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\n\t\tselectPreview.setAttribute('class', 'codeBoxSelectPreview');\n\n\t\tlanguages.forEach(language => {\n\t\t\tconst selectItem = document.createElement('p');\n\t\t\tselectItem.setAttribute('class', `codeBoxSelectItem ${this.config.useDefaultTheme}`);\n\t\t\tselectItem.setAttribute('data-key', language[0]);\n\t\t\tselectItem.textContent = language[1];\n\t\t\tthis.api.listeners.on(selectItem, 'click', event => this._handleSelectItemClick(event, language), false);\n\n\t\t\tselectPreview.appendChild(selectItem);\n\t\t});\n\n\t\tselectHolder.appendChild(this.selectDropIcon);\n\t\tselectHolder.appendChild(this.selectInput);\n\t\tselectHolder.appendChild(selectPreview);\n\n\t\treturn selectHolder;\n\t}\n\n\t_highlightCodeArea(event) {\n\t\thljs.highlightBlock(this.codeArea);\n\t}\n\n\t_handleCodeAreaPaste(event) {\n\t\tevent.stopPropagation();\n\t}\n\n\t_handleSelectInputClick(event) {\n\t\tevent.target.nextSibling.classList.toggle('codeBoxShow');\n\t}\n\n\t_handleSelectItemClick(event, language) {\n\t\tevent.target.parentNode.parentNode.querySelector('.codeBoxSelectInput').value = language[1];\n\t\tevent.target.parentNode.classList.remove('codeBoxShow');\n\t\tthis.codeArea.removeAttribute('class');\n\t\tthis.data.language = language[0];\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\n\t\thljs.highlightElement(this.codeArea);\n\t}\n\n\t_closeAllLanguageSelects() {\n\t\tconst selectPreviews = document.querySelectorAll('.codeBoxSelectPreview');\n\t\tfor (let i = 0, len = selectPreviews.length; i < len; i++) selectPreviews[i].classList.remove('codeBoxShow');\n\t}\n\n\t_injectHighlightJSCSSElement() {\n\t\tconst highlightJSCSSElement = document.querySelector(`#${this.highlightCSSID}`);\n\t\tlet highlightJSCSSURL = this._getThemeURLFromConfig();\n\t\tif (!highlightJSCSSElement) {\n\t\t\tconst link = document.createElement('link');\n\t\t\tconst head = document.querySelector('head');\n\t\t\tlink.setAttribute('rel', 'stylesheet');\n\t\t\tlink.setAttribute('href', highlightJSCSSURL);\n\t\t\tlink.setAttribute('id', this.highlightCSSID);\n\n\t\t\tif (head) head.appendChild(link);\n\t\t}\n\t\telse highlightJSCSSElement.setAttribute('href', highlightJSCSSURL);\n\t}\n\n\t_getThemeURLFromConfig() {\n\t\tlet themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-${this.config.useDefaultTheme}.min.css`;\n\n\t\tif (this.config.themeName) themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/${this.config.themeName}.min.css`;\n\t\tif (this.config.themeURL) themeURL = this.config.themeURL;\n\n\t\treturn themeURL;\n\t}\n}\n\n\nexport default CodeBox;","<template>\n  <div class=\"Folder\">\n    <h3>{{ __('Manage Course Folders') }}</h3>\n    <div>\n      <label>\n        <input type=\"radio\" v-model=\"folderAction\" value=\"select\" />\n        {{ __('Select Existing Folder') }}\n      </label>\n      <label class=\"ml-4\">\n        <input type=\"radio\" v-model=\"folderAction\" value=\"create\" />\n        {{ __('Create New Folder') }}\n      </label>\n    </div>\n\n    <div v-if=\"folderAction === 'select'\" class=\"mt-4 mb-4\">\n      <Link v-model=\"selectedFolder\" doctype=\"Course Folder\" options=\"foldername\" :label=\"__('Select a folder')\" />\n    </div>\n\n    <div v-if=\"folderAction === 'create'\">\n      <input type=\"text\" v-model=\"newFolderName\" :placeholder=\"__('Enter folder name')\" />\n      <Link v-model=\"course\" doctype=\"Course\" :label=\"__('Select a course')\" />\n      <button @click=\"createFolder\">{{ __('Create Folder') }}</button>\n    </div>\n\n    <div v-if=\"selectedFolder\" class=\"block mt-6 space-y-6\">\n      <div>\n        <div class=\"text-sm font-medium text-ink-gray-9\">{{ __('Current Folder') }}</div>\n        <div class=\"mt-1 flex flex-wrap items-center gap-1 text-sm text-ink-gray-6\">\n          <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n            <button type=\"button\"\n              class=\"rounded px-1.5 py-0.5 text-ink-gray-7 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n              @click=\"navigateToBreadcrumb(index)\">\n              {{ crumb.label }}\n            </button>\n            <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-wrap items-center gap-2\">\n        <input type=\"text\" v-model=\"newSubfolderName\" :placeholder=\"__('New sub-folder name')\"\n          class=\"flex-1 rounded border border-outline-gray-3 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none\" />\n        <Button size=\"sm\" @click=\"createSubfolder\">\n          {{ __('Create Sub-folder') }}\n        </Button>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders yet.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li v-for=\"folder in subfolders\" :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\">\n            <button type=\"button\" class=\"flex-1 text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\">\n              {{ folder.file_name }}\n            </button>\n          </li>\n        </ul>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files found in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li v-for=\"file in files\" :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\">\n            <a :href=\"file.file_url\" download class=\"flex-1 truncate text-sm text-blue-600 hover:underline\">\n              {{ file.file_name }}\n            </a>\n            <Tooltip :text=\"__('Delete File')\" placement=\"bottom\">\n              <Trash2 @click.prevent=\"removeFile(file.file_url)\" class=\"h-4 w-4 cursor-pointer text-red-500\" />\n            </Tooltip>\n          </li>\n        </ul>\n      </div>\n\n      <div\n        class=\"rounded-md border-2 border-dashed border-outline-gray-3 p-6 text-center text-sm transition-colors duration-200 hover:border-outline-gray-4\"\n        :class=\"{ 'bg-blue-50 border-blue-500 text-blue-700': isDragActive }\" @dragenter.prevent.stop=\"onDragEnter\"\n        @dragover.prevent.stop=\"onDragOver\" @dragleave.prevent.stop=\"onDragLeave\" @drop.prevent.stop=\"onDrop\"\n        @click=\"triggerFileSelect\">\n        <p class=\"font-medium\">{{ __('Drop files here or click to upload') }}</p>\n        <p class=\"mt-1 text-ink-gray-6\">\n          {{ __('Files will be added to ') }} {{ currentFolderName }}\n        </p>\n        <input ref=\"fileInputRef\" type=\"file\" class=\"hidden\" multiple @change=\"uploadFiles\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { createResource, Button, Tooltip } from 'frappe-ui';\nimport { onMounted, ref, watch } from 'vue';\nimport Link from '@/components/Controls/Link.vue';\nimport { FolderTool } from '@/utils/foldertool'; // Corrected to named import\nimport { useRoute } from 'vue-router';\nimport { Trash2 } from 'lucide-vue-next';\n\nconst route = useRoute();\n\nconst folderAction = ref('select');\nconst selectedFolder = ref(null);\nconst foldername = ref(''); // Declare foldername globally\nconst newFolderName = ref('');\nconst files = ref([]);\nconst folders = ref([]);\nconst course = ref(null);\nconst currentFolderId = ref(null);\nconst currentFolderName = ref('');\nconst breadcrumbStack = ref([]);\nconst subfolders = ref([]);\nconst isDragActive = ref(false);\nconst newSubfolderName = ref('');\nconst fileInputRef = ref(null);\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  );\n};\n\nconst fetchCourse = async () => {\n  const courseName = route.params.courseName;\n  console.log(\"Course Name: \", courseName);\n  if (courseName) {\n    const resource = createResource({\n      url: 'frappe.client.get_value',\n      makeParams(values) {\n        return {\n          doctype: 'Course Schedule',\n          fieldname: 'course',\n          filters: {\n            name: courseName,\n          },\n        };\n      },\n    });\n    const result = await resource.fetch(); // Wait for the resource to fetch data\n    course.value = result.course; // Assign the fetched course value\n    console.log(\"Fetched Course: \", course.value);\n  } else {\n    console.error(\"Course name not found in route params\");\n    return null;\n  }\n};\n\nconst props = defineProps({\n  onAddition: {\n    type: Function,\n    required: false,\n  },\n  initialFolder: {\n    type: String,\n    default: null,\n  },\n})\n\nconst addFolder = () => {\n  if (!foldername.value) {\n    return;\n  }\n\n  const folder = foldername.value;\n  if (typeof props.onAddition === 'function') {\n    props.onAddition(folder);\n  }\n};\n\nconst initializeFromFolder = async (folderLabel, { refreshFolders = true } = {}) => {\n  const targetFolder = folderLabel?.trim();\n  if (!targetFolder) {\n    return;\n  }\n\n  if (refreshFolders || !folders.value.length) {\n    await fetchFolders();\n  }\n\n  const matchingFolder = folders.value.find(\n    (folder) => folder.foldername === targetFolder || folder.name === targetFolder\n  );\n\n  if (matchingFolder) {\n    if (selectedFolder.value !== matchingFolder.name) {\n      selectedFolder.value = matchingFolder.name;\n    }\n    return;\n  }\n\n  foldername.value = targetFolder;\n  currentFolderName.value = targetFolder;\n  breadcrumbStack.value = [\n    {\n      id: null,\n      label: targetFolder,\n      folderName: targetFolder,\n    },\n  ];\n  await fetchFiles({ folderLabel: targetFolder });\n  breadcrumbStack.value = [\n    {\n      id: currentFolderId.value,\n      label: currentFolderName.value || targetFolder,\n      folderName: foldername.value || targetFolder,\n    },\n  ];\n};\n\nconst fetchFolders = async () => {\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    return [];\n  }\n\n  const foldersResource = createResource({\n    url: 'frappe.client.get_list',\n    makeParams() {\n      return {\n        doctype: 'Course Folder',\n        filters: {\n          course: course.value,\n        },\n        fields: ['name', 'foldername', 'file_reference', 'parent_folder'],\n      };\n    },\n  });\n\n  const result = await foldersResource.fetch();\n  folders.value = result;\n  return folders.value;\n};\n\nconst createFolder = async () => {\n  if (!newFolderName.value) {\n    alert(__('Folder name is required'));\n    return;\n  }\n\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    alert(__('Please select a course before creating a folder.'));\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    const folder = await tool.createCourseFolder(course.value, newFolderName.value);\n\n    folders.value.push({\n      name: folder.name,\n      foldername: folder.foldername,\n      file_reference: folder.file_reference,\n      parent_folder: folder.parent_folder,\n    });\n    foldername.value = folder.foldername;\n    currentFolderId.value = folder.file_reference;\n    currentFolderName.value = folder.foldername;\n    selectedFolder.value = folder.name;\n    breadcrumbStack.value = [\n      {\n        id: currentFolderId.value,\n        label: currentFolderName.value,\n        folderName: folder.foldername,\n      },\n    ];\n    folderAction.value = 'select';\n    newFolderName.value = '';\n    await fetchFiles({ folderId: currentFolderId.value, folderLabel: currentFolderName.value });\n  } catch (error) {\n    console.error('Error creating folder:', error);\n    alert(error.message || __('Failed to create folder.'));\n  }\n};\n\nconst fetchFiles = async ({ folderId, folderLabel } = {}) => {\n  const targetFolderId = folderId ?? currentFolderId.value;\n  const targetFolderLabel = folderLabel ?? currentFolderName.value ?? foldername.value;\n\n  if (!targetFolderId && !targetFolderLabel) {\n    console.warn('No folder selected for fetching files.');\n    return;\n  }\n\n  try {\n    const FilesInFolder = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params: {\n        folder_id: targetFolderId,\n        foldername: targetFolderLabel,\n      },\n      auto: true,\n    });\n    const result = await FilesInFolder.fetch();\n    const entries = result?.entries || [];\n\n    subfolders.value = entries.filter((entry) => entry.is_folder);\n    files.value = entries.filter((entry) => !entry.is_folder);\n\n    currentFolderId.value = result?.folder_id || targetFolderId;\n    currentFolderName.value = result?.folder_name || targetFolderLabel;\n    foldername.value = currentFolderName.value;\n\n  } catch (error) {\n    console.error('Error fetching files:', error);\n    subfolders.value = [];\n    files.value = [];\n  }\n};\n\nconst uploadFiles = async (event, droppedFiles = null) => {\n  const fileList = droppedFiles || event?.target?.files;\n  if (!fileList || !fileList.length) {\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert(__('Please select a folder first.'));\n    return;\n  }\n\n  try {\n    const formData = new FormData();\n    for (const file of fileList) {\n      formData.append('files', file);\n    }\n    if (currentFolderId.value) {\n      formData.append('folder_id', currentFolderId.value);\n    }\n    if (currentFolderName.value) {\n      formData.append('foldername', currentFolderName.value);\n    }\n\n    const csrfToken = getCsrfToken();\n    if (!csrfToken) {\n      alert(__('Session expired. Refresh the page and try again.'));\n      return;\n    }\n\n    const response = await fetch('/api/method/seminary.api.folder_upload.upload_folder', {\n      method: 'POST',\n      body: formData,\n      headers: {\n        'X-Frappe-CSRF-Token': csrfToken,\n      },\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({}));\n      console.error('Error uploading files:', error);\n      alert(`Error: ${error.message || __('Failed to upload files.')}`);\n      return;\n    }\n\n    console.log('Files uploaded successfully.');\n    if (event?.target) {\n      event.target.value = '';\n    }\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error uploading files:', error);\n    alert(__('An error occurred while uploading files.'));\n  } finally {\n    isDragActive.value = false;\n  }\n};\n\nconst removeFile = async (fileUrl) => {\n  const csrfToken = getCsrfToken();\n  if (!csrfToken) {\n    alert(__('Session expired. Refresh the page and try again.'));\n    return;\n  }\n  await fetch('/api/method/seminary.api.folder_upload.delete_file', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-Frappe-CSRF-Token': csrfToken,\n    },\n    body: JSON.stringify({ file_url: fileUrl }),\n    credentials: 'include',\n  }).then((response) => response.json());\n\n  await fetchFiles();\n};\n\nconst onDragEnter = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  isDragActive.value = true;\n};\n\nconst onDragOver = (event) => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  event.preventDefault();\n  event.stopPropagation();\n  event.dataTransfer.dropEffect = 'copy';\n  isDragActive.value = true;\n};\n\nconst onDragLeave = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  isDragActive.value = false;\n};\n\nconst onDrop = async (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert(__('Please select a folder before uploading.'));\n    return;\n  }\n  const droppedFiles = event.dataTransfer?.files;\n  if (droppedFiles?.length) {\n    await uploadFiles(null, droppedFiles);\n  }\n  isDragActive.value = false;\n};\n\nconst triggerFileSelect = () => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert(__('Please select a folder first.'));\n    return;\n  }\n  fileInputRef.value?.click();\n};\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return;\n  }\n  breadcrumbStack.value = [\n    ...breadcrumbStack.value,\n    {\n      id: folder.name,\n      label: folder.file_name,\n      folderName: folder.file_name,\n    },\n  ];\n  currentFolderId.value = folder.name;\n  currentFolderName.value = folder.file_name;\n  await fetchFiles({ folderId: folder.name, folderLabel: folder.file_name });\n};\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return;\n  }\n  const target = breadcrumbStack.value[index];\n  breadcrumbStack.value = breadcrumbStack.value.slice(0, index + 1);\n  currentFolderId.value = target.id;\n  currentFolderName.value = target.label;\n  foldername.value = target.folderName || target.label;\n  await fetchFiles({ folderId: target.id, folderLabel: target.folderName || target.label });\n};\n\nconst createSubfolder = async () => {\n  if (!newSubfolderName.value) {\n    alert(__('Sub-folder name is required.'));\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert(__('Please select a folder first.'));\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    await tool.createSubfolder({\n      parentFolderId: currentFolderId.value,\n      parentFolderName: currentFolderName.value,\n      subfolderName: newSubfolderName.value,\n    });\n\n    newSubfolderName.value = '';\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error creating sub-folder:', error);\n    alert(error.message || __('Failed to create sub-folder.'));\n  }\n};\n\n// Watch selectedFolder and update folder state\nwatch(selectedFolder, async (newFolder) => {\n  if (newFolder) {\n    try {\n      const resource = createResource({\n        url: 'frappe.client.get_value',\n        makeParams() {\n          return {\n            doctype: 'Course Folder',\n            fieldname: ['foldername', 'file_reference', 'parent_folder'],\n            filters: {\n              name: newFolder,\n            },\n          };\n        },\n      });\n      const result = await resource.fetch();\n      foldername.value = result?.foldername || '';\n      currentFolderId.value = result?.file_reference || null;\n      currentFolderName.value = result?.foldername || '';\n      breadcrumbStack.value = [\n        {\n          id: currentFolderId.value,\n          label: currentFolderName.value,\n          folderName: foldername.value,\n        },\n      ];\n      addFolder();\n      await fetchFiles({\n        folderId: currentFolderId.value,\n        folderLabel: currentFolderName.value,\n      });\n    } catch (error) {\n      console.error('Error fetching foldername:', error);\n    }\n  } else {\n    foldername.value = '';\n    currentFolderId.value = null;\n    currentFolderName.value = '';\n    breadcrumbStack.value = [];\n    subfolders.value = [];\n    files.value = [];\n  }\n});\n\nlet hasMounted = false;\n\nonMounted(async () => {\n  hasMounted = true;\n  await fetchCourse();\n  await fetchFolders();\n  if (props.initialFolder) {\n    await initializeFromFolder(props.initialFolder, { refreshFolders: false });\n  }\n});\n\nwatch(\n  () => props.initialFolder,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return;\n    }\n    const trimmedValue = newValue?.trim();\n    const previous = oldValue?.trim();\n    if (!trimmedValue || trimmedValue === previous) {\n      return;\n    }\n    await initializeFromFolder(trimmedValue);\n  }\n);\n</script>\n\n<style scoped>\n.Folder {\n  margin: 20px;\n  border: 2px solid #ccc;\n  padding: 10px;\n  border-radius: 5px;\n}\n</style>\n","<template>\n  <div class=\"flex flex-col gap-4 rounded-lg border-2 border-gray-200 p-4 mb-4\">\n    <div class=\"flex flex-col gap-1\">\n      <h4 class=\"text-lg font-semibold text-ink-gray-9\">{{ currentFolderName || folderName }}</h4>\n      <div class=\"text-sm text-ink-gray-6 flex flex-wrap items-center gap-1\" v-if=\"breadcrumbStack.length\">\n        <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n          <button\n            type=\"button\"\n            class=\"rounded px-1.5 py-0.5 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n            :class=\"index === breadcrumbStack.length - 1 ? 'font-medium text-ink-gray-8 cursor-default' : 'text-ink-gray-7'\"\n            @click=\"index === breadcrumbStack.length - 1 ? null : navigateToBreadcrumb(index)\"\n          >\n            {{ crumb.label }}\n          </button>\n          <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n        </template>\n      </div>\n    </div>\n\n    <div v-if=\"errorMessage\" class=\"rounded border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700\">\n      {{ errorMessage }}\n    </div>\n    <div v-else-if=\"isLoading\" class=\"text-sm text-ink-gray-6\">\n      {{ __('Loading folder contents') }}\n    </div>\n    <template v-else>\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders in this location.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"folder in subfolders\"\n            :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <button\n              type=\"button\"\n              class=\"text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\"\n            >\n              {{ folder.file_name }}\n            </button>\n            <span class=\"text-xs text-ink-gray-5\">{{ __('Folder') }}</span>\n          </li>\n        </ul>\n      </section>\n\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files available in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"file in files\"\n            :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <a :href=\"file.file_url\" download class=\"flex-1 truncate text-sm text-blue-600 hover:underline\">\n              {{ file.file_name }}\n            </a>\n            <span class=\"text-xs text-ink-gray-5\">{{ humanFileSize(file.file_size) }}</span>\n          </li>\n        </ul>\n      </section>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { createResource } from 'frappe-ui'\n\nconst props = defineProps({\n  folder: {\n    type: [Object, String],\n    required: true,\n  },\n})\n\nconst folderName = computed(() => {\n  if (typeof props.folder === 'string') {\n    return props.folder\n  }\n  if (props.folder && typeof props.folder === 'object') {\n    return props.folder.folder || props.folder.foldername || ''\n  }\n  return ''\n})\n\nconst isLoading = ref(false)\nconst errorMessage = ref('')\nconst files = ref([])\nconst subfolders = ref([])\nconst currentFolderId = ref(null)\nconst currentFolderName = ref('')\nconst breadcrumbStack = ref([])\nlet hasMounted = false\n\nconst humanFileSize = (value) => {\n  if (!value && value !== 0) {\n    return ''\n  }\n  const size = Number(value)\n  if (Number.isNaN(size)) {\n    return ''\n  }\n  if (size >= 1048576) {\n    return `${(size / 1048576).toFixed(2)} MB`\n  }\n  if (size >= 1024) {\n    return `${(size / 1024).toFixed(2)} KB`\n  }\n  return `${size} B`\n}\n\nconst buildParams = ({ folderId = null, folderLabel = null }) => {\n  const params = {}\n  if (folderId) {\n    params.folder_id = folderId\n  }\n  const labelCandidate = folderLabel ?? folderName.value\n  if (!folderId && labelCandidate) {\n    params.foldername = labelCandidate\n  }\n  return params\n}\n\nconst loadFolder = async ({ folderId = null, folderLabel = null } = {}) => {\n  const params = buildParams({ folderId, folderLabel })\n  if (!params.folder_id && !params.foldername) {\n    return null\n  }\n  isLoading.value = true\n  errorMessage.value = ''\n\n  try {\n    const resource = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params,\n      auto: true,\n    })\n    const result = await resource.fetch()\n    const entries = result?.entries || []\n    subfolders.value = entries.filter((entry) => entry.is_folder)\n    files.value = entries.filter((entry) => !entry.is_folder)\n    currentFolderId.value = result?.folder_id || folderId || null\n    currentFolderName.value = result?.folder_name || folderLabel || folderName.value || ''\n    return {\n      id: currentFolderId.value,\n      label: currentFolderName.value,\n    }\n  } catch (error) {\n    console.error('Error fetching folder contents:', error)\n    errorMessage.value = error?.message || __('Unable to load folder contents.')\n    subfolders.value = []\n    files.value = []\n    return null\n  } finally {\n    isLoading.value = false\n  }\n}\n\nconst openRootFolder = async () => {\n  const root = await loadFolder({ folderLabel: folderName.value })\n  if (root) {\n    breadcrumbStack.value = [root]\n  }\n}\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return\n  }\n  const crumb = await loadFolder({ folderId: folder.name, folderLabel: folder.file_name })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value, crumb]\n  }\n}\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return\n  }\n  const target = breadcrumbStack.value[index]\n  const crumb = await loadFolder({ folderId: target.id, folderLabel: target.label })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value.slice(0, index), crumb]\n  }\n}\n\nonMounted(async () => {\n  hasMounted = true\n  await openRootFolder()\n})\n\nwatch(\n  () => folderName.value,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return\n    }\n    const trimmed = (newValue || '').trim()\n    const previous = (oldValue || '').trim()\n    if (!trimmed || trimmed === previous) {\n      return\n    }\n    await openRootFolder()\n  },\n)\n</script>\n","import { h, createApp } from 'vue';\nimport FolderPlugin from '@/components/FolderPlugin.vue';\nimport FolderBlock from '@/components/FolderBlock.vue';\nimport { FolderOpen } from 'lucide-vue-next';\nimport translationPlugin from '../translation'\nimport router from '@/router'\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  )\n}\n\nexport class FolderTool {\n  constructor({ data, api, readOnly }) {\n    this.data = data;\n    this.readOnly = readOnly\n    this.api = api;\n    this.wrapper = undefined;\n    this.vueApp = null;\n  }\n\n  static get toolbox() {\n    const app = createApp({\n      render: () =>\n        h(FolderOpen, { size: 18, strokeWidth: 1.5, color: 'black' }),\n    });\n\n    const div = document.createElement('div');\n    app.mount(div);\n\n    return {\n      title: 'Folder',\n      icon: div.innerHTML,\n    };\n  }\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n  render() {\n    this.wrapper = document.createElement('div')\n    if (this.data && this.data.folder) {\n      this.renderFolder(this.data.folder)\n    } else {\n      this.renderFolderModal()\n    }\n    return this.wrapper\n  }\n\n  destroyApp() {\n    if (this.vueApp) {\n      this.vueApp.unmount()\n      this.vueApp = null\n    }\n    if (this.wrapper) {\n      this.wrapper.innerHTML = ''\n    }\n  }\n\n  renderFolder(folderName) {\n    if (this.readOnly) {\n      this.destroyApp()\n      this.vueApp = createApp(FolderBlock, {\n        folder: folderName,\n      })\n      this.vueApp.use(translationPlugin)\n      this.vueApp.use(router)\n      this.vueApp.mount(this.wrapper)\n      return\n    }\n    this.renderFolderModal(folderName)\n  }\n\n  renderFolderModal(initialFolder = null) {\n    if (this.readOnly) {\n      return\n    }\n    this.destroyApp()\n    this.vueApp = createApp(FolderPlugin, {\n      initialFolder,\n      onAddition: (folder) => {\n        if (!this.data) {\n          this.data = {}\n        }\n        this.data.folder = folder\n      },\n    })\n    this.vueApp.use(translationPlugin)\n    this.vueApp.use(router)\n    this.vueApp.mount(this.wrapper)\n  }\n\n    save(blockContent) {\n      return {\n        folder: this.data?.folder,\n      }\n    }\n\n    destroy() {\n      this.destroyApp()\n    }\n\n    async createCourseFolder(courseName, folderName) {\n      const trimmedFolderName = folderName?.trim()\n      if (!trimmedFolderName) {\n        throw new Error('Folder name is required to create a course folder')\n      }\n      if (!courseName) {\n        throw new Error('Course is required to create a course folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/resource/Course Folder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          course: courseName,\n          foldername: trimmedFolderName,\n        }),\n      })\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create course folder')\n      }\n\n      const data = responseData?.data || responseData\n      if (!this.data) {\n        this.data = {}\n      }\n      this.data.folder = data?.foldername || trimmedFolderName\n      return data\n    }\n\n    async createSubfolder({ parentFolderId, parentFolderName, subfolderName }) {\n      const trimmedSubfolderName = subfolderName?.trim()\n      if (!trimmedSubfolderName) {\n        throw new Error('Sub-folder name is required')\n      }\n\n      if (!parentFolderId && !parentFolderName) {\n        throw new Error('Parent folder information is required to create a sub-folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/method/seminary.api.folder_upload.create_subfolder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          parent_folder_id: parentFolderId,\n          parent_foldername: parentFolderName,\n          subfoldername: trimmedSubfolderName,\n        }),\n      })\n\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create sub-folder')\n      }\n\n      return responseData?.message || responseData?.data || responseData\n    }\n  }","import { toast } from 'frappe-ui'\nimport { useTimeAgo } from '@vueuse/core'\nimport { Quiz } from '@/utils/quiz'\nimport { Assignment } from '@/utils/assignment'\nimport { Exam} from '@/utils/exam'\nimport { DiscussionActivity } from '@/utils/discussionactivity'\nimport { Upload } from '@/utils/upload'\nimport { Markdown } from '@/utils/markdownParser'\nimport Header from '@editorjs/header'\nimport Paragraph from '@editorjs/paragraph'\nimport { CodeBox } from '@/utils/code'\nimport NestedList from '@editorjs/nested-list'\nimport InlineCode from '@editorjs/inline-code'\nimport { watch } from 'vue'\nimport dayjs from '@/utils/dayjs'\nimport Embed from '@editorjs/embed'\nimport SimpleImage from '@editorjs/simple-image'\nimport Table from '@editorjs/table'\nimport { FolderTool } from '@/utils/foldertool'\n\nexport function createToast(options) {\n\ttoast({\n\t\tposition: 'bottom-right',\n\t\t...options,\n\t})\n}\n\nexport function timeAgo(date) {\n\treturn useTimeAgo(date).value\n}\n\nexport function formatTime(timeString) {\n\tif (!timeString) return ''\n\tconst [hour, minute] = timeString.split(':').map(Number)\n\n\t// Create a Date object with dummy values for day, month, and year\n\tconst dummyDate = new Date(0, 0, 0, hour, minute)\n\n\t// Use Intl.DateTimeFormat to format the time in 12-hour format\n\tconst formattedTime = new Intl.DateTimeFormat('en-US', {\n\t\thour: 'numeric',\n\t\tminute: 'numeric',\n\t\thour12: true,\n\t}).format(dummyDate)\n\n\treturn formattedTime\n}\n\nexport function formatNumber(number) {\n\treturn number.toLocaleString('en-IN', {\n\t\tmaximumFractionDigits: 0,\n\t})\n}\n\nexport function formatNumberIntoCurrency(number, currency) {\n\tif (number) {\n\t\treturn number.toLocaleString('en-IN', {\n\t\t\tmaximumFractionDigits: 0,\n\t\t\tstyle: 'currency',\n\t\t\tcurrency: currency,\n\t\t})\n\t}\n\treturn ''\n}\n\n// create a function that formats numbers in thousands to k\n\nexport function formatAmount(amount) {\n\tif (amount > 999) {\n\t\treturn (amount / 1000).toFixed(1) + 'k'\n\t}\n\treturn amount\n}\n\nexport function convertToTitleCase(str) {\n\tif (!str) {\n\t\treturn ''\n\t}\n\n\treturn str\n\t\t.toLowerCase()\n\t\t.split(' ')\n\t\t.map(function (word) {\n\t\t\treturn word.charAt(0).toUpperCase().concat(word.substr(1))\n\t\t})\n\t\t.join(' ')\n}\nexport function getFileSize(file_size) {\n\tlet value = parseInt(file_size)\n\tif (value > 1048576) {\n\t\treturn (value / 1048576).toFixed(2) + 'M'\n\t} else if (value > 1024) {\n\t\treturn (value / 1024).toFixed(2) + 'K'\n\t}\n\treturn value\n}\n\nexport function showToast(title, text, icon, iconClasses = null) {\n\tif (!iconClasses) {\n\t\tif (icon == 'check') {\n\t\t\ticonClasses = 'bg-surface-green-3 text-ink-white rounded-md p-px'\n\t\t} else if (icon == 'alert-circle') {\n\t\t\ticonClasses = 'bg-yellow-600 text-ink-white rounded-md p-px'\n\t\t} else {\n\t\t\ticonClasses = 'bg-surface-red-5 text-ink-white rounded-md p-px'\n\t\t}\n\t}\n\tcreateToast({\n\t\ttitle: title,\n\t\ttext: htmlToText(text),\n\t\ticon: icon,\n\t\ticonClasses: iconClasses,\n\t\tposition: icon == 'check' ? 'bottom-right' : 'top-center',\n\t\ttimeout: 5,\n\t})\n}\n\nexport function getImgDimensions(imgSrc) {\n\treturn new Promise((resolve) => {\n\t\tlet img = new Image()\n\t\timg.onload = function () {\n\t\t\tlet { width, height } = img\n\t\t\tresolve({ width, height, ratio: width / height })\n\t\t}\n\t\timg.src = imgSrc\n\t})\n}\n\nexport function updateDocumentTitle(meta) {\n\twatch(\n\t\t() => meta,\n\t\t(meta) => {\n\t\t\tif (!meta.value.title) return\n\t\t\tif (meta.value.title && meta.value.subtitle) {\n\t\t\t\tdocument.title = `${meta.value.title} | ${meta.value.subtitle}`\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (meta.value.title) {\n\t\t\t\tdocument.title = `${meta.value.title}`\n\t\t\t\treturn\n\t\t\t}\n\t\t},\n\t\t{ immediate: true, deep: true }\n\t)\n}\n\nexport function htmlToText(html) {\n\tconst div = document.createElement('div')\n\tdiv.innerHTML = html\n\treturn div.textContent || div.innerText || ''\n}\n\nexport function getEditorTools() {\n\treturn {\n\t\theader: {\n\t\t\tclass: Header,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Header',\n\t\t\t},\n\t\t},\n\t\tassignment: Assignment,\n\t\tquiz: Quiz,\n\t\texam: Exam,\n\t\tdiscussionActivity: DiscussionActivity,\n\t\tupload: Upload,\n\t\tmarkdown: {\n\t\t\tclass: Markdown,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\timage: SimpleImage,\n\t\ttable: {\n\t\t\tclass: Table,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\tparagraph: {\n\t\t\tclass: Paragraph,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tpreserveBlank: true,\n\t\t\t},\n\t\t},\n\t\tcodeBox: {\n\t\t\tclass: CodeBox,\n\t\t\tconfig: {\n\t\t\t\tthemeURL:\n\t\t\t\t\t'https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-dark.min.css',\n\t\t\t\tthemeName: 'atom-one-dark',\n\t\t\t\tuseDefaultTheme: 'dark',\n\t\t\t},\n\t\t},\n\t\tlist: {\n\t\t\tclass: NestedList,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tdefaultStyle: 'ordered',\n\t\t\t},\n\t\t},\n\t\tinlineCode: {\n\t\t\tclass: InlineCode,\n\t\t\tshortcut: 'CMD+SHIFT+M',\n\t\t},\n\t\tembed: {\n\t\t\tclass: Embed,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tservices: {\n\t\t\t\t\tyoutube: {\n\t\t\t\t\t\tregex: /(?:https?:\\/\\/)?(?:www\\.)?(?:(?:youtu\\.be\\/)|(?:youtube\\.com)\\/(?:v\\/|u\\/\\w\\/|embed\\/|watch))(?:(?:\\?v=)?([^#&?=]*))?((?:[?&]\\w*=\\w*)*)/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.youtube.com/embed/<%= remote_id %>',\n\t\t\t\t\t\thtml: '<iframe style=\"width:100%; height: 30rem;\" frameborder=\"0\" allowfullscreen></iframe>',\n\t\t\t\t\t\theight: 320,\n\t\t\t\t\t\twidth: 580,\n\t\t\t\t\t\tid: ([id, params]) => {\n\t\t\t\t\t\t\tif (!params && id) {\n\t\t\t\t\t\t\t\treturn id\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst paramsMap = {\n\t\t\t\t\t\t\t\tstart: 'start',\n\t\t\t\t\t\t\t\tend: 'end',\n\t\t\t\t\t\t\t\tt: 'start',\n\t\t\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\t\t\ttime_continue: 'start',\n\t\t\t\t\t\t\t\tlist: 'list',\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet newParams = params\n\t\t\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t\t\t.split('&')\n\t\t\t\t\t\t\t\t.map((param) => {\n\t\t\t\t\t\t\t\t\tconst [name, value] = param.split('=')\n\n\t\t\t\t\t\t\t\t\tif (!id && name === 'v') {\n\t\t\t\t\t\t\t\t\t\tid = value\n\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (!paramsMap[name]) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tvalue === 'LL' ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('RDMM') ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('FL')\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn `${paramsMap[name]}=${value}`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.filter((param) => !!param)\n\n\t\t\t\t\t\t\treturn id + '?' + newParams.join('&')\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tvimeo: true,\n\t\t\t\t\tcodepen: true,\n\t\t\t\t\taparat: {\n\t\t\t\t\t\tregex: /(?:http[s]?:\\/\\/)?(?:www.)?aparat\\.com\\/v\\/([^\\/\\?\\&]+)\\/?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame',\n\t\t\t\t\t\thtml: '<iframe style=\"margin: 0 auto; width: 100%; height: 25rem;\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe>',\n\t\t\t\t\t\theight: 300,\n\t\t\t\t\t\twidth: 600,\n\t\t\t\t\t},\n\t\t\t\t\tgithub: true,\n\t\t\t\t\tslides: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/pub/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdrive: {\n\t\t\t\t\t\tregex: /https:\\/\\/drive\\.google\\.com\\/file\\/d\\/([A-Za-z0-9_-]+)\\/view(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://drive.google.com/file/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 25rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdocsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/document\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/document/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tsheetsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/spreadsheets\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/spreadsheets/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tslidesPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tcodesandbox: {\n\t\t\t\t\t\tregex: /^https:\\/\\/codesandbox\\.io\\/(?:embed\\/)?([A-Za-z0-9_-]+)(?:\\?[^\\/]*)?$/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://codesandbox.io/embed/<%= remote_id %>?view=editor+%2B+preview&module=%2Findex.html',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;' sandbox='allow-mods allow-forms allow-popups allow-scripts allow-same-origin' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tfolder: {\n\t\t\tclass: FolderTool,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Add a folder with files',\n\t\t\t\tuploadEndpoint: '/api/upload-folder', // Example endpoint for folder uploads\n\t\t\t\trenderFiles: (files) => {\n\t\t\t\t\treturn files.map(file => `<a href=\"${file.url}\" download>${file.name}</a>`).join('<br>');\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t}\n}\n\nexport function getTimezones() {\n\treturn [\n\t\t'Pacific/Midway',\n\t\t'Pacific/Pago_Pago',\n\t\t'Pacific/Honolulu',\n\t\t'America/Anchorage',\n\t\t'America/Vancouver',\n\t\t'America/Los_Angeles',\n\t\t'America/Tijuana',\n\t\t'America/Edmonton',\n\t\t'America/Denver',\n\t\t'America/Phoenix',\n\t\t'America/Mazatlan',\n\t\t'America/Winnipeg',\n\t\t'America/Regina',\n\t\t'America/Chicago',\n\t\t'America/Mexico_City',\n\t\t'America/Guatemala',\n\t\t'America/El_Salvador',\n\t\t'America/Managua',\n\t\t'America/Costa_Rica',\n\t\t'America/Montreal',\n\t\t'America/New_York',\n\t\t'America/Indianapolis',\n\t\t'America/Panama',\n\t\t'America/Bogota',\n\t\t'America/Lima',\n\t\t'America/Halifax',\n\t\t'America/Puerto_Rico',\n\t\t'America/Caracas',\n\t\t'America/Santiago',\n\t\t'America/St_Johns',\n\t\t'America/Montevideo',\n\t\t'America/Araguaina',\n\t\t'America/Argentina/Buenos_Aires',\n\t\t'America/Godthab',\n\t\t'America/Sao_Paulo',\n\t\t'Atlantic/Azores',\n\t\t'Canada/Atlantic',\n\t\t'Atlantic/Cape_Verde',\n\t\t'UTC',\n\t\t'Etc/Greenwich',\n\t\t'Europe/Belgrade',\n\t\t'CET',\n\t\t'Atlantic/Reykjavik',\n\t\t'Europe/Dublin',\n\t\t'Europe/London',\n\t\t'Europe/Lisbon',\n\t\t'Africa/Casablanca',\n\t\t'Africa/Nouakchott',\n\t\t'Europe/Oslo',\n\t\t'Europe/Copenhagen',\n\t\t'Europe/Brussels',\n\t\t'Europe/Berlin',\n\t\t'Europe/Helsinki',\n\t\t'Europe/Amsterdam',\n\t\t'Europe/Rome',\n\t\t'Europe/Stockholm',\n\t\t'Europe/Vienna',\n\t\t'Europe/Luxembourg',\n\t\t'Europe/Paris',\n\t\t'Europe/Zurich',\n\t\t'Europe/Madrid',\n\t\t'Africa/Bangui',\n\t\t'Africa/Algiers',\n\t\t'Africa/Tunis',\n\t\t'Africa/Harare',\n\t\t'Africa/Nairobi',\n\t\t'Europe/Warsaw',\n\t\t'Europe/Prague',\n\t\t'Europe/Budapest',\n\t\t'Europe/Sofia',\n\t\t'Europe/Istanbul',\n\t\t'Europe/Athens',\n\t\t'Europe/Bucharest',\n\t\t'Asia/Nicosia',\n\t\t'Asia/Beirut',\n\t\t'Asia/Damascus',\n\t\t'Asia/Jerusalem',\n\t\t'Asia/Amman',\n\t\t'Africa/Tripoli',\n\t\t'Africa/Cairo',\n\t\t'Africa/Johannesburg',\n\t\t'Europe/Moscow',\n\t\t'Asia/Baghdad',\n\t\t'Asia/Kuwait',\n\t\t'Asia/Riyadh',\n\t\t'Asia/Bahrain',\n\t\t'Asia/Qatar',\n\t\t'Asia/Aden',\n\t\t'Asia/Tehran',\n\t\t'Africa/Khartoum',\n\t\t'Africa/Djibouti',\n\t\t'Africa/Mogadishu',\n\t\t'Asia/Dubai',\n\t\t'Asia/Muscat',\n\t\t'Asia/Baku',\n\t\t'Asia/Kabul',\n\t\t'Asia/Yekaterinburg',\n\t\t'Asia/Tashkent',\n\t\t'Asia/Calcutta',\n\t\t'Asia/Kathmandu',\n\t\t'Asia/Novosibirsk',\n\t\t'Asia/Almaty',\n\t\t'Asia/Dacca',\n\t\t'Asia/Krasnoyarsk',\n\t\t'Asia/Dhaka',\n\t\t'Asia/Bangkok',\n\t\t'Asia/Saigon',\n\t\t'Asia/Jakarta',\n\t\t'Asia/Irkutsk',\n\t\t'Asia/Shanghai',\n\t\t'Asia/Hong_Kong',\n\t\t'Asia/Taipei',\n\t\t'Asia/Kuala_Lumpur',\n\t\t'Asia/Singapore',\n\t\t'Australia/Perth',\n\t\t'Asia/Yakutsk',\n\t\t'Asia/Seoul',\n\t\t'Asia/Tokyo',\n\t\t'Australia/Darwin',\n\t\t'Australia/Adelaide',\n\t\t'Asia/Vladivostok',\n\t\t'Pacific/Port_Moresby',\n\t\t'Australia/Brisbane',\n\t\t'Australia/Sydney',\n\t\t'Australia/Hobart',\n\t\t'Asia/Magadan',\n\t\t'SST',\n\t\t'Pacific/Noumea',\n\t\t'Asia/Kamchatka',\n\t\t'Pacific/Fiji',\n\t\t'Pacific/Auckland',\n\t\t'Asia/Kolkata',\n\t\t'Europe/Kiev',\n\t\t'America/Tegucigalpa',\n\t\t'Pacific/Apia',\n\t]\n}\n\nexport function getUserTimezone() {\n\ttry {\n\t\tconst timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\t\tconst supportedTimezones = getTimezones()\n\n\t\tif (supportedTimezones.includes(timezone)) {\n\t\t\treturn timezone // e.g., 'Asia/Calcutta', 'America/New_York', etc.\n\t\t} else {\n\t\t\tthrow Error('unsupported timezone')\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('Error getting timezone:', error)\n\t\treturn null\n\t}\n}\n\nexport function getSidebarLinks() {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Courses',\n\t\t\ticon: 'BookOpen',\n\t\t\tto: 'Courses',\n\t\t\tactiveFor: [\n\t\t\t\t'Courses',\n\t\t\t\t'CourseDetail',\n\t\t\t\t'Lesson',\n\t\t\t\t'CourseForm',\n\t\t\t\t'LessonForm',\n\t\t\t],\n\t\t},\n\n\t\t{\n\t\t\tlabel: 'Statistics',\n\t\t\ticon: 'TrendingUp',\n\t\t\tto: 'Statistics',\n\t\t\tactiveFor: ['Statistics'],\n\t\t},\n\t]\n}\n\nexport function getFormattedDateRange(\n\tstartDate,\n\tendDate,\n\tformat = 'DD MMM YYYY'\n) {\n\tif (startDate === endDate) {\n\t\treturn dayjs(startDate).format(format)\n\t}\n\treturn `${dayjs(startDate).format(format)} - ${dayjs(endDate).format(\n\t\tformat\n\t)}`\n}\n\nexport function getLineStartPosition(string, position) {\n\tconst charLength = 1\n\tlet char = ''\n\n\twhile (char !== '\\n' && position > 0) {\n\t\tposition = position - charLength\n\t\tchar = string.substr(position, charLength)\n\t}\n\n\tif (char === '\\n') {\n\t\tposition += 1\n\t}\n\n\treturn position\n}\n\nexport function singularize(word) {\n\tconst endings = {\n\t\tves: 'fe',\n\t\ties: 'y',\n\t\ti: 'us',\n\t\tzes: 'ze',\n\t\tses: 's',\n\t\tes: 'e',\n\t\ts: '',\n\t}\n\treturn word.replace(\n\t\tnew RegExp(`(${Object.keys(endings).join('|')})$`),\n\t\t(r) => endings[r]\n\t)\n}\n\nexport const validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'webp'].includes(extension)) {\n\t\treturn __('Only image file is allowed.')\n\t}\n}\n\nexport const escapeHTML = (text) => {\n\tif (!text) return ''\n\tlet escape_html_mapping = {\n\t\t'&': '&amp;',\n\t\t'<': '&lt;',\n\t\t'>': '&gt;',\n\t\t'\"': '&quot;',\n\t\t\"'\": '&#39;',\n\t\t'`': '&#x60;',\n\t\t'=': '&#x3D;',\n\t}\n\n\treturn String(text).replace(\n\t\t/[&<>\"'`=]/g,\n\t\t(char) => escape_html_mapping[char] || char\n\t)\n}\n"],"names":["props","__props","progressBarWidth","computed","progressBarHeight","_createBlock","_unref","Tooltip","_createElementVNode","_hoisted_1","_normalizeClass","user","inject","fullQuizMode","ref","activeQuestion","currentQuestion","selectedOptions","reactive","showAnswers","questions","possibleAnswer","timer","timerInterval","router","useRouter","elapsedTime","answers","quiz","createResource","values","data","populateQuestions","setupTimer","err","isQuizLoaded","shuffledQuestions","shuffleArray","startTimer","submitQuiz","formatTimer","seconds","hrs","mins","secs","timerProgress","array","i","attempts","_a","_b","submission","index","timeAgo","watch","newData","resetQuiz","quizSubmission","timeTaken","all_questions_details","question","__spreadProps","__spreadValues","questionDetails","value","newName","q","startQuiz","startQuiz2","markAnswer","getAnswers","checkAnswer","createToast","option","addToLocalStorage","resetQuestion","quizData","questionData","answer","existingIndex","item","nextQuestion","createSubmission","submitQuizComplete","__async","results","detailedQuestions","response","call","is_correct","val","correctAnswers","correctAnswer","markLessonProgress","toast","getInstructions","recordAnswer","qtidx","toggleAnswer","quizResults","_createElementBlock","_hoisted_2","_hoisted_3","_toDisplayString","__","_hoisted_4","_hoisted_5","_hoisted_6","_openBlock","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_createVNode","ProgressBar","_hoisted_12","_hoisted_13","_hoisted_14","Button","_cache","_hoisted_16","_Fragment","_renderList","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_23","$event","idx","_hoisted_26","CheckCircle","MinusCircle","XCircle","_vShow","_hoisted_28","FormControl","_hoisted_29","Badge","_hoisted_30","TextEditor","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_39","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_53","_createTextVNode","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","redirectToLogin","Quiz","show","assignment","exam","discussionactivity","onMounted","nextTick","addAssessment","redirectToForm","Dialog","Link","close","api","readOnly","app","createApp","h","CircleHelp","div","QuizBlock","translationPlugin","userResource","usersStore","AssessmentPlugin","blockContent","submissionFile","comments","showTitle","isDirty","keyboardShortcut","e","submitAssignment","onBeforeUnmount","submissionResource","newSubmission","doc","showUploader","imageResource","createDocumentResource","newGrade","oldGrade","evaluator","_c","addNewSubmission","saveSubmission","file","courseName","chapterNumber","lessonNumber","getType","type","validateFile","extension","removeSubmission","canGradeSubmission","canModifyAssignment","submissionStatusOptions","statusTheme","_hoisted_15","FileText","X","FileUploader","uploading","progress","openFileSelector","_hoisted_22","_hoisted_24","_hoisted_25","_hoisted_27","Assignment","Pencil","AssignmentBlock","submisisonDetails","newDoc","formatTime","row","_mergeProps","$attrs","showTopics","_useModel","newReply","allUsers","mentionUsers","renderEditor","readOnlyMode","socketConnected","socket","initSocket","error","reason","replies","fetchMentionUsers","newReplyResource","postReply","editReplyResource","postEdited","reply","deleteReplyResource","deleteReply","onUnmounted","ChevronLeft","UserAvatar","Dropdown","_withCtx","open","MoreHorizontal","topics","topic","resetTopic","topicResource","replyResource","submitTopic","handleCancel","dialogOptions","singularize","getScrollContainer","currentTopic","showTopicModal","loading","isConnected","executeOnMountedLogic","singleTopicResource","scrollToEnd","scrollContainer","showReplies","openTopicModal","DiscussionModal","DiscussionReplies","MessageSquareText","fullExamMode","user_is_instructor","ensureAnswersInitialized","questionsList","existingAnswers","initialized","current","isExamLoaded","hasSubmittedExam","instructors","list","wasInstructor","instructor","is_instructor","timerStartTime","endTime","currentTime","remainingTime","submitExam","newAnswers","get_answers","rawAnswers","toRaw","questionName","updateAnswer","submittedAnswers","startExam","startExam2","submission_anystatus","Discussions","ExamGraded","_component_router_link","SquarePen","event","Exam","BookOpenCheck","ExamBlock","dayjs","dayjsModule","relativeTime","original_post","replyFiles","isStudent","studentGroups","selectedGroupFilter","Student","discussionID","owner","saveReplyAttachment","itemName","discussionReady","removeReplyAttachment","_removed","rest","__objRest","__restKey","canSubmitReply","reloadDiscussionLists","StudentData","savedsubmission","hasSavedSubmission","fetchStudentGroups","filteredDiscussions","submitDiscussion","discussion","post_before","formatDate","dateString","getFrappeDateTime","now","microseconds","handleReplySubmit","attachment","studentid","member_name","reply_dt","refreshDiscussionLists","all_discussions","hasData","filter_discussions","studentGroup","_d","_e","_f","hasFile","hasOriginalPost","allowedExtensions","canModifyDiscussion","newGroup","group","_vModelText","getFileSize","_hoisted_52","_hoisted_58","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_38","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_67","_hoisted_68","_hoisted_69","DiscussionActivity","MessagesSquare","discussionId","DiscussionActivityBlock","isPlaying","audio","isMuted","duration","togglePlay","toggleMute","changeCurrentTime","handleAudioEnd","time","minutes","newVal","Pause","Play","VolumeX","Volume2","videoRef","videoContainer","playing","muted","fileURL","isYoutube","url","playVideo","pauseVideo","videoEnded","toggleFullscreen","_ctx","args","Maximize","fileUploader","fileInput","addFile","Upload","UploadIcon","VideoBlock","AudioBlock","UploadPlugin","savedData","Markdown","config","CodeXml","block","level","previousLine","text","anchorTag","currentIndex","currentBlock","line","match","DEFAULT_THEMES","COMMON_LANGUAGES","CodeBox","__publicField","Code","codeAreaHolder","languageSelect","selectHolder","selectPreview","languages","language","selectItem","hljs","selectPreviews","len","highlightJSCSSElement","highlightJSCSSURL","link","head","themeURL","route","useRoute","folderAction","selectedFolder","foldername","newFolderName","files","folders","course","currentFolderId","currentFolderName","breadcrumbStack","subfolders","isDragActive","newSubfolderName","fileInputRef","getCsrfToken","fetchCourse","result","addFolder","folder","initializeFromFolder","_0","_1","folderLabel","refreshFolders","targetFolder","fetchFolders","matchingFolder","fetchFiles","createFolder","FolderTool","folderId","targetFolderId","targetFolderLabel","entries","entry","uploadFiles","droppedFiles","fileList","formData","csrfToken","removeFile","fileUrl","onDragEnter","onDragOver","onDragLeave","onDrop","triggerFileSelect","openSubfolder","navigateToBreadcrumb","target","createSubfolder","newFolder","hasMounted","newValue","oldValue","trimmedValue","previous","crumb","Trash2","_withModifiers","folderName","isLoading","errorMessage","humanFileSize","size","buildParams","params","labelCandidate","loadFolder","openRootFolder","root","trimmed","FolderOpen","FolderBlock","initialFolder","FolderPlugin","trimmedFolderName","responseData","serverMessage","parentFolderId","parentFolderName","subfolderName","trimmedSubfolderName","options","date","useTimeAgo","formatAmount","amount","file_size","updateDocumentTitle","meta","getEditorTools","Header","SimpleImage","Table","Paragraph","NestedList","InlineCode","Embed","id","paramsMap","newParams","param","name","word","endings","r"],"mappings":"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"}