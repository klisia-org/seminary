import{q as x,c as V,I as M,r as D,D as q,t as z,d as B,u as U}from"./frappe-ui-Qp90XKmJ.js";import{F as H,bk as E,c as C,a8 as I,t as b,b as c,z as w,g as e,a as $,e as d,w as p,u as s,D as i,bJ as R,bR as G,U as F,V as P,am as J,I as Y,C as K,H as L,O,r as Q,bS as W}from"./vendor-CrP-kEM1.js";import{_ as X}from"./CourseOutline-BAJ_RhIv.js";import{f as Z,t as ee,u as se}from"./index-C61emWxo.js";import{_ as te}from"./InstructorAvatar-DIGj8HgZ.js";import{C as ne}from"./CourseCardToDo-DRxSXkFQ.js";import"./index--sl_9lWu.js";import"./settings-dD7H0cID.js";import"./Link-B7v9_qE9.js";/* empty css                                                                     */const oe={class:"border-2 rounded-md min-w-80"},ae=["src"],re={class:"p-5"},le={key:0,class:"space-y-2"},ue={class:"space-y-4"},ie={class:"flex items-center text-ink-gray-9"},de={class:"ml-2"},ce={class:"flex items-center text-ink-gray-9"},me={class:"ml-2"},_e={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(u){const _=H(),r=E("$user"),a=u,t=C(()=>a.course.data.video_link?"https://www.youtube.com/embed/"+a.course.data.video_link:null);function g(){r.data?setTimeout(()=>{_.push({name:"Lesson",params:{courseName:a.course.data.name,chapterNumber:1,lessonNumber:1}})},2e3):(toast.success(__("You need to login to access this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},2e3))}const f=()=>{let y=!1;return a.course.data.instructors.forEach(l=>{var n;!y&&l.user==((n=r.data)==null?void 0:n.name)&&(y=!0)}),console.log(y),y};return(y,l)=>{var m,o,v,k,N,h,S,A,T,j;const n=I("router-link");return c(),b("div",oe,[u.course.data.video_link?(c(),b("iframe",{key:0,src:t.value,class:"rounded-t-md min-h-56 w-full"},null,8,ae)):w("",!0),e("div",re,[u.course.data.membership?(c(),b("div",le,[d(n,{to:{name:"Lesson",params:{courseName:u.course.name,chapterNumber:u.course.data.current_lesson?u.course.data.current_lesson.split("-")[0]:1,lessonNumber:u.course.data.current_lesson?u.course.data.current_lesson.split("-")[1]:1}}},{default:p(()=>[d(s(x),{variant:"solid",size:"md",class:"w-full"},{default:p(()=>[...l[1]||(l[1]=[e("span",null,i("Continue Learning"),-1)])]),_:1})]),_:1},8,["to"])])):(c(),$(s(x),{key:1,onClick:l[0]||(l[0]=We=>g()),variant:"solid",class:"w-full",size:"md"},{default:p(()=>[...l[2]||(l[2]=[e("span",null,i("Start Learning"),-1)])]),_:1})),(o=(m=s(r))==null?void 0:m.data)!=null&&o.is_moderator||f()?(c(),$(n,{key:2,to:{name:"CourseForm",params:{courseName:u.course.data.name}}},{default:p(()=>[d(s(x),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...l[3]||(l[3]=[e("span",null,i("Edit"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(k=(v=s(r))==null?void 0:v.data)!=null&&k.is_moderator||f()?(c(),$(n,{key:3,to:{name:"CourseAssessment",params:{courseName:u.course.data.name}}},{default:p(()=>[d(s(x),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...l[4]||(l[4]=[e("span",null,i("Configure Assessments"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(h=(N=s(r))==null?void 0:N.data)!=null&&h.is_moderator||f()?(c(),$(n,{key:4,to:{name:"StudentGroup",params:{courseName:u.course.data.name}}},{default:p(()=>[d(s(x),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...l[5]||(l[5]=[e("span",null,i("Configure Student Groups"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(A=(S=s(r))==null?void 0:S.data)!=null&&A.is_moderator||f()?(c(),$(n,{key:5,to:{name:"Gradebook",params:{courseName:u.course.data.name}}},{default:p(()=>[d(s(x),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...l[6]||(l[6]=[e("span",null,i("Gradebook"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),(j=(T=s(r))==null?void 0:T.data)!=null&&j.is_moderator||f()?(c(),$(n,{key:6,to:{name:"StudentAttendanceCS",params:{courseName:u.course.data.name}}},{default:p(()=>[d(s(x),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...l[7]||(l[7]=[e("span",null,i("Attendance"),-1)])]),_:1})]),_:1},8,["to"])):w("",!0),e("div",ue,[l[8]||(l[8]=e("div",{class:"mt-8 font-medium text-ink-gray-9"},i("This course has:"),-1)),e("div",ie,[d(s(R),{class:"h-4 w-4 stroke-1.5"}),e("span",de,i(u.course.data.lessons)+" "+i("Lessons"),1)]),e("div",ce,[d(s(G),{class:"h-4 w-4 stroke-1.5"}),e("span",me,i(s(Z)(u.course.data.enrollments))+" "+i("Enrolled Students"),1)])])])])}}},pe={class:"announcement-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto"},fe={class:""},ve={class:"mb-1.5 text-sm text-ink-gray-5"},be={class:""},ye={class:"mb-1.5 text-sm text-ink-gray-5"},he={class:"mb-4"},ge={class:"mb-1.5 text-sm text-ink-gray-5"},ke={__name:"AnnouncementModal",props:F({cs:{type:String,required:!0},students:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=P(u,"modelValue"),r=u,a=J({subject:"",replyTo:"",announcement:""}),t=()=>{a.subject="",a.replyTo="",a.announcement=""},g=V({url:"frappe.core.doctype.communication.email.make",makeParams(n){return{recipients:r.students.join(", "),cc:a.replyTo,subject:a.subject,content:a.announcement,doctype:"Course Schedule",name:r.cs,send_email:1}}}),f=n=>{g.submit({},{validate(){if(!r.students.length)return"No students in this course";if(!a.subject)return"Subject is required"},onSuccess(){_.value=!1,t(),n(),z.success(__("Announcement has been sent successfully"))},onError(m){var o;z.error(((o=m.messages)==null?void 0:o[0])||m)}})},y=n=>{_.value=!1,t(),n==null||n()};Y(_,n=>{n||t()});const l=C(()=>({title:__("Make an Announcement"),size:"xl",actions:[{label:__("Submit"),variant:"solid",onClick:n=>f(n)},{label:__("Cancel"),variant:"text",onClick:n=>y(n)}]}));return(n,m)=>(c(),$(s(q),{modelValue:_.value,"onUpdate:modelValue":m[3]||(m[3]=o=>_.value=o),options:l.value,disableOutsideClickToClose:!0},{"body-content":p(()=>[e("div",pe,[e("div",fe,[e("div",ve,[K(i(n.__("Subject"))+" ",1),m[4]||(m[4]=e("span",{class:"text-ink-red-3"},"*",-1))]),d(s(M),{type:"text",modelValue:a.subject,"onUpdate:modelValue":m[0]||(m[0]=o=>a.subject=o)},null,8,["modelValue"])]),e("div",be,[e("div",ye,i(n.__("Reply To")),1),d(s(M),{type:"text",modelValue:a.replyTo,"onUpdate:modelValue":m[1]||(m[1]=o=>a.replyTo=o)},null,8,["modelValue"])]),e("div",he,[e("div",ge,i(n.__("Announcement")),1),d(s(D),{content:a.announcement,fixedMenu:!0,onChange:m[2]||(m[2]=o=>a.announcement=o),editorClass:"prose-sm py-2 px-2 min-h-[200px] border-outline-gray-2 hover:border-outline-gray-3 rounded-b-md bg-surface-gray-3"},null,8,["content"])])])]),_:1},8,["modelValue","options"]))}},xe={class:"border-2 rounded-md min-w-80 p-5"},we={key:0},$e={class:"mb-8"},Ce={class:"flex items-center justify-between mb-2"},Ne={class:"flex items-center"},Ve={class:"ml-2 text-ink-gray-7"},Se={class:"text-sm"},Ae=["innerHTML"],Te={key:1,class:"text-sm italic text-ink-gray-5"},je={__name:"Announcements",props:{cs:{type:String,required:!0}},setup(u){const _=u,r=V({url:"seminary.seminary.api.get_announcements",makeParams(a){return{cs:_.cs}},auto:!0,cache:["announcement",_.cs]});return(a,t)=>{var g;return c(),b("div",xe,[(g=s(r).data)!=null&&g.length?(c(),b("div",we,[(c(!0),b(L,null,O(s(r).data,f=>(c(),b("div",null,[e("div",$e,[e("div",Ce,[e("div",Ne,[d(s(B),{label:f.sender_full_name,size:"lg"},null,8,["label"]),e("div",Ve,i(f.sender_full_name),1)]),e("div",Se,i(s(ee)(f.communication_date)),1)]),e("div",{class:"prose prose-sm bg-surface-menu-bar !min-w-full px-4 py-2 rounded-md",innerHTML:f.content},null,8,Ae)])]))),256))])):(c(),b("div",Te,i(a.__("No announcements")),1))])}}},Me={key:0},ze={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},Ee={class:"m-5"},Le={class:"flex justify-between w-full"},Oe={class:"md:w-2/3"},De={class:"text-3xl font-semibold text-ink-gray-9"},qe={class:"my-3 leading-6 text-ink-gray-7"},Be=["innerHTML"],Ue={class:"mt-10"},He={key:0,class:"text-lg font-semibold"},Ie={key:1,class:"text-lg font-semibold"},Re={class:"flex flex-wrap gap-4"},Ge={class:"text-center text-sm font-medium"},Fe={class:"mt-10"},Pe={class:"border-0 rounded-md min-w-80"},Je={class:"mt-5"},Ye={class:"mt-5"},Ke={key:0,class:"mt-5 flex justify-center"},Qe={class:"mt-5"},us={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(u){const _=E("$user"),r=u,a=Q(!1);console.log("CourseName prop:",r.courseName);const t=V({url:"seminary.seminary.utils.get_course_details",cache:["course",r.courseName],params:{course:r.courseName},auto:!0});console.log(t),console.log("Course props:",r.courseName);const g=V({url:"seminary.seminary.utils.get_roster",cache:["roster",r.courseName],params:{course:r.courseName},auto:!0}),f=C(()=>(g.data||[]).map(o=>o.stuemail_rc));console.log("Student Emails:",f.value);const y=()=>{a.value=!0},l=C(()=>{const o=(_==null?void 0:_.data)||{};return!!(o.is_moderator||o.is_instructor||o.is_evaluator)}),n=C(()=>{var v,k;let o=[{label:"Courses",route:{name:"Courses"}}];return o.push({label:(v=t==null?void 0:t.data)==null?void 0:v.course,route:{name:"CourseDetail",params:{courseName:(k=t==null?void 0:t.data)==null?void 0:k.name}}}),o}),m=C(()=>{var o,v;return{title:(o=t==null?void 0:t.data)==null?void 0:o.title,description:(v=t==null?void 0:t.data)==null?void 0:v.short_introduction}});return se(m),(o,v)=>{var k,N;return s(t).data?(c(),b("div",Me,[e("header",ze,[d(s(U),{class:"h-7",items:n.value},null,8,["items"])]),e("div",Ee,[e("div",Le,[e("div",Oe,[e("div",De,i(s(t).data.course),1),e("div",qe,i(s(t).data.short_introduction),1),e("div",{innerHTML:s(t).data.course_description_for_lms,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,Be),e("div",Ue,[s(t).data.instructors.length===1?(c(),b("div",He,"Instructor")):(c(),b("div",Ie,"Instructors")),v[2]||(v[2]=e("br",null,null,-1)),e("div",Re,[(c(!0),b(L,null,O(s(t).data.instructors,h=>(c(),b("div",{key:h.instructor_name,class:"flex flex-col items-center"},[d(te,{instructor:h,size:"xl",class:"mb-2 w-20 h-20"},null,8,["instructor"]),e("div",Ge,i(h.instructor_name),1)]))),128))])]),e("div",Fe,[d(X,{title:"Course Outline",courseName:s(t).data.name,showOutline:!0,allowEdit:l.value},null,8,["courseName","allowEdit"])])]),e("div",Pe,[d(_e,{course:s(t),class:"mb-4"},null,8,["course"]),e("div",Je,[d(ne,{course:r.courseName},null,8,["course"])]),e("div",Ye,[d(je,{cs:r.courseName},null,8,["cs"])]),(k=s(_).data)!=null&&k.is_moderator||(N=s(_).data)!=null&&N.is_instructor?(c(),b("div",Ke,[d(s(x),{onClick:v[0]||(v[0]=h=>y())},{suffix:p(()=>[d(s(W),{class:"h-4 stroke-1.5"})]),default:p(()=>[e("span",null,i(o.__("Make an Announcement")),1)]),_:1})])):w("",!0),e("div",Qe,[d(ke,{modelValue:a.value,"onUpdate:modelValue":v[1]||(v[1]=h=>a.value=h),cs:r.courseName,students:f.value},null,8,["modelValue","cs","students"])])])])])])):w("",!0)}}};export{us as default};
//# sourceMappingURL=CourseDetail-BLoAZh8a.js.map
