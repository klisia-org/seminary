import{s as K,r as N,az as Q,b4 as Z,l as k,n as U,M as ee,g as F,o,w as d,j as y,e as s,p as H,f as p,d as i,h as w,F as R,k as X,t as L,O as A,T as g,a1 as E,N as W,V as O,W as j,a2 as G,c as te,A as se,_ as J}from"./index-CVWiL_Ou.js";import{_ as ae,i as le,u as re,r as oe,l as ue}from"./FormControl.vue_vue_type_script_setup_true_lang-ClvexRF6.js";import{P as ne}from"./plus-C5d9m71e.js";/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=K("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=K("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),de={class:"w-full"},ce=["onClick"],fe={class:"flex items-center"},pe={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},me={key:1,class:"text-base leading-5 text-ink-gray-4"},ye={class:"mt-1 rounded-lg bg-surface-white py-1 text-base shadow-2xl"},ve={class:"relative px-1.5 pt-0.5"},he={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-ink-gray-4"},be={class:"flex flex-col space-y-1"},ge=["innerHTML"],xe={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-ink-gray-5"},ke={key:0,class:"border-t p-1.5 pb-0.5"},we={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup($,{expose:B,emit:v}){const l=$,n=v,c=N(""),x=N(!1),S=N(null),_=Q(),P=Z(),T=k(()=>"value"in _),C=k({get(){return T.value?_.value:l.modelValue},set(t){c.value="",t&&(x.value=!1),n(T.value?"change":"update:modelValue",t)}});function D(){x.value=!1}const e=k(()=>{var a;return!l.options||l.options.length==0?[]:((a=l.options[0])!=null&&a.group?l.options:[{group:"",items:l.options}]).map((r,u)=>({key:u,group:r.group,hideLabel:r.hideLabel||!1,items:l.filterable?h(r.items):r.items})).filter(r=>r.items.length>0)});function h(t){return c.value?t.filter(a=>[a.label,a.value].some(u=>(u||"").toString().toLowerCase().includes(c.value.toLowerCase()))):t}function f(t){if(typeof t=="string"){let r=e.value.flatMap(u=>u.items).find(u=>u.value===t);return(r==null?void 0:r.label)||t}return t==null?void 0:t.label}U(c,t=>{n("update:query",t)}),U(x,t=>{t&&ee(()=>{S.value.el.focus()})});const m=k(()=>l.disabled?"text-ink-gray-5":"text-ink-gray-8"),z=k(()=>{let t={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[l.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[l.size],r=l.disabled?"disabled":l.variant,u={subtle:"border border-gray-100 bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-menu-bar placeholder-ink-gray-3",l.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[r];return[t,a,u,m.value,"transition-colors w-full"]});return B({query:c}),(t,a)=>(o(),F(s(ue),{modelValue:C.value,"onUpdate:modelValue":a[3]||(a[3]=r=>C.value=r),nullable:""},{default:d(({open:r})=>[y(s(ae),{class:"w-full",show:x.value,"onUpdate:show":a[2]||(a[2]=u=>x.value=u)},{target:d(({open:u,togglePopover:q})=>[g(t.$slots,"target",O(j({open:u,togglePopover:q})),()=>[p("div",de,[p("button",{class:A(["flex w-full items-center justify-between focus:outline-none",z.value]),onClick:()=>q()},[p("div",fe,[g(t.$slots,"prefix"),C.value?(o(),i("span",pe,L(f(C.value)),1)):(o(),i("span",me,L($.placeholder||""),1))]),y(s(ie),{class:"h-4 w-4 stroke-1.5"})],10,ce)])])]),body:d(({isOpen:u})=>{var q;return[H(p("div",null,[p("div",ye,[p("div",ve,[y(s(le),{ref_key:"search",ref:S,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=b=>{c.value=b.target.value}),value:c.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),p("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=b=>C.value=null)},[y(s(Y),{class:"h-4 w-4 stroke-1.5"})])]),y(s(re),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:d(()=>[(o(!0),i(R,null,X(e.value,b=>H((o(),i("div",{class:"mt-1.5",key:b.key},[b.group&&!b.hideLabel?(o(),i("div",he,L(b.group),1)):w("",!0),(o(!0),i(R,null,X(b.items,V=>(o(),F(s(oe),{as:"template",key:V.value,value:V},{default:d(({active:M,selected:I})=>[p("li",{class:A(["flex items-center rounded px-2.5 py-2 text-base",{"bg-surface-gray-2":M}])},[g(t.$slots,"item-prefix",E({ref_for:!0},{active:M,selected:I,option:V})),g(t.$slots,"item-label",E({ref_for:!0},{active:M,selected:I,option:V}),()=>[p("div",be,[p("div",null,L(V.label),1),V.description?(o(),i("div",{key:0,class:"text-xs text-ink-gray-7",innerHTML:V.description},null,8,ge)):w("",!0)])])],2)]),_:2},1032,["value"]))),128))])),[[W,b.items.length>0]])),128)),e.value.length==0?(o(),i("li",xe," No results found ")):w("",!0)]),_:3}),s(P).footer?(o(),i("div",ke,[g(t.$slots,"footer",O(j({value:(q=S.value)==null?void 0:q.el._value,close:D})))])):w("",!0)])],512),[[W,u]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},_e={class:"space-y-1.5"},Ce={key:0,class:"text-ink-red-3"},Ve={key:0},$e={key:1,class:"text-sm text-ink-gray-5"},Pe={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},modelValue:{type:String,default:""},description:{type:String,default:""}},emits:["update:modelValue","change"],setup($,{emit:B}){const v=$,l=B,n=Q(),c=k(()=>"value"in n),x=k({get:()=>c.value?n.value:v.modelValue,set:e=>(e==null?void 0:e.value)&&l(c.value?"change":"update:modelValue",e==null?void 0:e.value)}),S=N(null),_=N("");G(()=>{var e;return(e=S.value)==null?void 0:e.query},e=>{e=e||"",_.value!==e&&(_.value=e,T(e))},{debounce:300,immediate:!0}),G(()=>v.doctype,()=>T(""),{debounce:300,immediate:!0});const P=te({url:"frappe.desk.search.search_link",cache:[v.doctype,_.value],method:"POST",auto:!0,params:{txt:_.value,doctype:v.doctype,filters:v.filters},transform:e=>e.map(h=>({label:h.label||h.value,value:h.value,description:h.description}))}),T=e=>{P.update({params:{txt:e,doctype:v.doctype,filters:v.filters}}),P.reload()},C=e=>{l(c.value?"change":"update:modelValue",""),e()},D=k(()=>[{sm:"text-xs",md:"text-base"}[n.size||"sm"],"text-ink-gray-5"]);return(e,h)=>(o(),i("div",_e,[s(n).label?(o(),i("label",{key:0,class:A(["block",D.value])},[se(L(s(n).label)+" ",1),s(n).required?(o(),i("span",Ce,"*")):w("",!0)],2)):w("",!0),y(we,{ref_key:"autocomplete",ref:S,options:s(P).data,modelValue:x.value,"onUpdate:modelValue":h[0]||(h[0]=f=>x.value=f),size:s(n).size||"sm",variant:s(n).variant,placeholder:s(n).placeholder,filterable:!1},{target:d(({open:f,togglePopover:m})=>[g(e.$slots,"target",O(j({open:f,togglePopover:m})))]),prefix:d(()=>[g(e.$slots,"prefix")]),"item-prefix":d(({active:f,selected:m,option:z})=>[g(e.$slots,"item-prefix",O(j({active:f,selected:m,option:z})))]),"item-label":d(({active:f,selected:m,option:z})=>[g(e.$slots,"item-label",O(j({active:f,selected:m,option:z})))]),footer:d(({value:f,close:m})=>[s(n).onCreate?(o(),i("div",Ve,[y(s(J),{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:z=>s(n).onCreate(f,m)},{prefix:d(()=>[y(s(ne),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])):w("",!0),p("div",null,[y(s(J),{variant:"ghost",class:"w-full !justify-start",label:e.__("Clear"),onClick:()=>C(m)},{prefix:d(()=>[y(s(Y),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder"]),$.description?(o(),i("p",$e,L($.description),1)):w("",!0)]))}};export{Y as X,Pe as _};
//# sourceMappingURL=Link-D0cze3Hl.js.map
