const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FontColor-Dk0aPPZD.js","assets/index-flDXq_bA.js","assets/index-0iRWWhrx.css","assets/InsertLink-mrQ3YKax.js","assets/plus-DlUOwXB2.js","assets/Checkbox.vue_vue_type_script_setup_true_lang-DT0r2lvZ.js","assets/InsertImage-DeiQiVcO.js","assets/InsertVideo-DrrZDJfJ.js","assets/Badge.vue_vue_type_script_setup_true_lang-DXoAtOCS.js","assets/Link-DjgbRK92.js","assets/pencil-3qaHjsB3.js","assets/FolderPlugin.vue_vue_type_style_index_0_scoped_84b7d54d_lang-BGvM5k8c.js","assets/FolderPlugin-CxD7fCLe.css","assets/book-open-check-CFVdhsmI.js"])))=>i.map(i=>d[i]);
var bs=Object.defineProperty,ws=Object.defineProperties;var xs=Object.getOwnPropertyDescriptors;var Tt=Object.getOwnPropertySymbols;var ks=Object.prototype.hasOwnProperty,$s=Object.prototype.propertyIsEnumerable;var Ht=(e,t,s)=>t in e?bs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,We=(e,t)=>{for(var s in t||(t={}))ks.call(t,s)&&Ht(e,s,t[s]);if(Tt)for(var s of Tt(t))$s.call(t,s)&&Ht(e,s,t[s]);return e},mt=(e,t)=>ws(e,xs(t));var ue=(e,t,s)=>new Promise((o,c)=>{var l=u=>{try{a(s.next(u))}catch(f){c(f)}},d=u=>{try{a(s.throw(u))}catch(f){c(f)}},a=u=>u.done?o(u.value):Promise.resolve(u.value).then(l,d);a((s=s.apply(e,t)).next())});import{E as j,o as i,c as p,a as n,am as rt,ao as Ms,ap as Cs,F as he,k as we,K as Te,t as h,g as S,aw as Es,ax as Ss,ay as As,P as Ts,j as Ce,h as A,w as N,f as R,aq as it,p as Se,S as _t,J as yt,az as st,aA as nt,aB as Hs,aC as Rs,aD as zs,aE as Ls,aF as Is,aG as Ns,aH as Os,aI as Bs,aJ as Ds,aK as Fs,aL as Ps,aM as Us,aN as Vs,aO as qs,aP as js,aQ as Gs,aR as Ws,aS as Qs,aT as Js,aU as Ks,aV as Xs,s as de,l as $e,q as Ys,e as r,M as bt,i as Oe,r as I,d as Qe,x as wt,b as ee,n as me,_ as ne,A as Me,m as He,T as qt,D as jt,aW as fe,a8 as Pe,aX as Ae,aY as Ne,u as xt,N as Zs,al as Gt,C as en,y as Wt,aZ as Qt,z as Jt,a_ as tn,ae as kt,a$ as lt,b0 as sn,au as nn,L as on,ak as Rt,R as rn,b1 as an,b2 as ln}from"./index-flDXq_bA.js";import{_ as qe}from"./Badge.vue_vue_type_script_setup_true_lang-DXoAtOCS.js";import{a as je}from"./plus-DlUOwXB2.js";import{_ as Je,X as cn}from"./Link-DjgbRK92.js";import{P as un}from"./pencil-3qaHjsB3.js";import{v as dn,h as pn,F as hn,n as mn,f as fn,s as gn,m as vn}from"./FolderPlugin.vue_vue_type_style_index_0_scoped_84b7d54d_lang-BGvM5k8c.js";import{B as _n}from"./book-open-check-CFVdhsmI.js";class yn{constructor(){this.listeners={},this.failed=!1}on(t,s){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(s)}trigger(t,s){(this.listeners[t]||[]).forEach(c=>{c.call(this,s)})}upload(t,s){return new Promise((o,c)=>{let l=new XMLHttpRequest;l.upload.addEventListener("loadstart",()=>{this.trigger("start")}),l.upload.addEventListener("progress",u=>{u.lengthComputable&&this.trigger("progress",{uploaded:u.loaded,total:u.total})}),l.upload.addEventListener("load",()=>{this.trigger("finish")}),l.addEventListener("error",()=>{this.trigger("error"),c()}),l.onreadystatechange=()=>{if(l.readyState==XMLHttpRequest.DONE){let u;if(l.status===200){let f=null;try{f=JSON.parse(l.responseText)}catch(V){f=l.responseText}let g=f.message||f;o(g)}else if(l.status===403)u=JSON.parse(l.responseText);else{this.failed=!0;try{u=JSON.parse(l.responseText)}catch(f){}}u&&u.exc&&console.error(JSON.parse(u.exc)[0]),c(u)}};const d=s.upload_endpoint||"/api/method/upload_file";l.open("POST",d,!0),l.setRequestHeader("Accept","application/json"),window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&l.setRequestHeader("X-Frappe-CSRF-Token",window.csrf_token);let a=new FormData;t&&a.append("file",t,t.name),a.append("is_private",s.private?"1":"0"),a.append("folder",s.folder||"Home"),s.file_url&&a.append("file_url",s.file_url),s.doctype&&a.append("doctype",s.doctype),s.docname&&a.append("docname",s.docname),s.fieldname&&a.append("fieldname",s.fieldname),s.method&&a.append("method",s.method),s.type&&a.append("type",s.type),l.send(a)})}}const bn={name:"FileUploader",props:{fileTypes:{type:[String,Array]},uploadArgs:{type:Object},validateFile:{type:Function,default:null}},data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let e=Math.floor(this.uploaded/this.total*100);return isNaN(e)?0:e},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},onFileAdd(e){return ue(this,null,function*(){if(this.error=null,this.file=e.target.files[0],this.file&&this.validateFile)try{let t=yield this.validateFile(this.file);t&&(this.error=t)}catch(t){this.error=t}this.error||this.uploadFile(this.file)})},uploadFile(e){return ue(this,null,function*(){this.error=null,this.uploaded=0,this.total=0,this.uploader=new yn,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",t=>{this.uploaded=t.uploaded,this.total=t.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(e,this.uploadArgs||{}).then(t=>{this.$emit("success",t)}).catch(t=>{this.uploading=!1;let s="Error Uploading File";t!=null&&t._server_messages?s=JSON.parse(JSON.parse(t._server_messages)[0]).message:t!=null&&t.exc&&(s=JSON.parse(t.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=s,this.$emit("failure",t)})})}},expose:["inputRef"]},wn=["accept"];function xn(e,t,s,o,c,l){return i(),p("div",null,[n("input",{ref:"input",type:"file",accept:s.fileTypes,class:"hidden",onChange:t[0]||(t[0]=(...d)=>l.onFileAdd&&l.onFileAdd(...d))},null,40,wn),rt(e.$slots,"default",Ms(Cs({file:c.file,uploading:c.uploading,progress:l.progress,uploaded:c.uploaded,message:c.message,error:c.error,total:c.total,success:l.success,openFileSelector:l.openFileSelector})))])}const Kt=j(bn,[["render",xn]]),kn={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:e}){return e.key==="ArrowUp"?(this.upHandler(),!0):e.key==="ArrowDown"?(this.downHandler(),!0):e.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(e){const t=this.items[e];t&&this.command({id:t.value,label:t.label})}}},$n={key:0,class:"min-w-40 rounded-lg border bg-white p-1 text-base shadow-lg"},Mn=["onClick","onMouseover"];function Cn(e,t,s,o,c,l){return i(),p("div",null,[s.items.length?(i(),p("div",$n,[(i(!0),p(he,null,we(s.items,(d,a)=>(i(),p("button",{class:Te([a===c.selectedIndex?"bg-gray-100":"text-gray-900","flex w-full items-center whitespace-nowrap rounded-md px-2 py-2 text-sm"]),key:a,onClick:u=>l.selectItem(a),onMouseover:u=>c.selectedIndex=a},h(d.label),43,Mn))),128))])):S("",!0)])}const En=j(kn,[["render",Cn]]);function Sn(e){return Es.configure({HTMLAttributes:{class:"mention"},suggestion:An(e)})}function An(e){return{items:({query:t})=>e.filter(s=>s.label.toLowerCase().startsWith(t.toLowerCase())).slice(0,10),render:()=>{let t,s;return{onStart:o=>{t=new Ss(En,{props:o,editor:o.editor}),o.clientRect&&(s=As("body",{getReferenceClientRect:o.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(o){t.updateProps(o),o.clientRect&&s[0].setProps({getReferenceClientRect:o.clientRect})},onKeyDown(o){var c;return o.event.key==="Escape"?(s[0].hide(),!0):(c=t.ref)==null?void 0:c.onKeyDown(o)},onExit(){s[0].destroy(),t.destroy()}}}}}const Tn={name:"TipTapMenu",props:["buttons"],inject:["editor"],components:{Popover:Ts},methods:{onButtonClick(e){e.action(this.editor)}}},Hn={class:"inline-flex bg-white px-1 py-1"},Rn={class:"inline-flex items-center gap-1"},zn={key:0,class:"h-4 w-[2px] border-l"},Ln={key:1,class:"shrink-0"},In=["onClick","set"],Nn={key:1},On={class:"rounded border bg-white p-1 shadow-md"},Bn={class:"w-full"},Dn=["onClick"],Fn=["onClick","title"],Pn={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function Un(e,t,s,o,c,l){const d=Ce("Popover");return i(),p("div",Hn,[n("div",Rn,[(i(!0),p(he,null,we(s.buttons,a=>(i(),p(he,{key:a.label},[a.type==="separator"?(i(),p("div",zn)):a.map?(i(),p("div",Ln,[A(d,null,{target:N(({togglePopover:u})=>[n("button",{class:"rounded px-2 py-1 text-base font-medium text-gray-800 transition-colors hover:bg-gray-100",onClick:u,set:e.activeBtn=a.find(f=>f.isActive(l.editor))||a[0]},[e.activeBtn.icon?(i(),R(it(e.activeBtn.icon),{key:0,class:"h-4 w-4"})):(i(),p("span",Nn,h(e.activeBtn.label),1))],8,In)]),body:N(({close:u})=>[n("ul",On,[(i(!0),p(he,null,we(a,f=>Se((i(),p("li",Bn,[n("button",{class:"w-full rounded px-2 py-1 text-left text-base hover:bg-gray-50",onClick:()=>{l.onButtonClick(f),u()}},h(f.label),9,Dn)],512)),[[_t,f.isDisabled?!f.isDisabled(l.editor):!0]])),256))])]),_:2},1024)])):(i(),R(it(a.component||"div"),yt({key:2,ref_for:!0},{editor:l.editor}),{default:N(u=>[n("button",{class:Te(["flex rounded p-1 text-gray-800 transition-colors",a.isActive(l.editor)||u!=null&&u.isActive?"bg-gray-100":"hover:bg-gray-100"]),onClick:f=>u!=null&&u.onClick?u.onClick(a):l.onButtonClick(a),title:a.label},[a.icon?(i(),R(it(a.icon),{key:0,class:"h-4 w-4"})):(i(),p("span",Pn,h(a.text),1))],10,Fn)]),_:2},1040))],64))),128))])])}const Xt=j(Tn,[["render",Un]]),Vn={},qn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function jn(e,t){return i(),p("svg",qn,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm8-12v12h-2v-9.796l-2 .536V8.67L19.5 8H21z",fill:"currentColor"},null,-1)]))}const Gn=j(Vn,[["render",jn]]),Wn={},Qn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Jn(e,t){return i(),p("svg",Qn,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 4c2.071 0 3.75 1.679 3.75 3.75 0 .857-.288 1.648-.772 2.28l-.148.18L18.034 18H22v2h-7v-1.556l4.82-5.546c.268-.307.43-.709.43-1.148 0-.966-.784-1.75-1.75-1.75-.918 0-1.671.707-1.744 1.606l-.006.144h-2C14.75 9.679 16.429 8 18.5 8z",fill:"currentColor"},null,-1)]))}const Kn=j(Wn,[["render",Jn]]),Xn={},Yn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Zn(e,t){return i(),p("svg",Yn,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M22 8l-.002 2-2.505 2.883c1.59.435 2.757 1.89 2.757 3.617 0 2.071-1.679 3.75-3.75 3.75-1.826 0-3.347-1.305-3.682-3.033l1.964-.382c.156.806.866 1.415 1.718 1.415.966 0 1.75-.784 1.75-1.75s-.784-1.75-1.75-1.75c-.286 0-.556.069-.794.19l-1.307-1.547L19.35 10H15V8h7zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1)]))}const eo=j(Xn,[["render",Zn]]),to={},so={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function no(e,t){return i(),p("svg",so,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm9-12v8h1.5v2H22v2h-2v-2h-5.5v-1.34l5-8.66H22zm-2 3.133L17.19 16H20v-4.867z",fill:"currentColor"},null,-1)]))}const oo=j(to,[["render",no]]),ro={},io={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function ao(e,t){return i(),p("svg",io,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M22 8v2h-4.323l-.464 2.636c.33-.089.678-.136 1.037-.136 2.21 0 4 1.79 4 4s-1.79 4-4 4c-1.827 0-3.367-1.224-3.846-2.897l1.923-.551c.24.836 1.01 1.448 1.923 1.448 1.105 0 2-.895 2-2s-.895-2-2-2c-.63 0-1.193.292-1.56.748l-1.81-.904L16 8h6zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1)]))}const lo=j(ro,[["render",ao]]),co={},uo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function po(e,t){return i(),p("svg",uo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M21.097 8l-2.598 4.5c2.21 0 4.001 1.79 4.001 4s-1.79 4-4 4-4-1.79-4-4c0-.736.199-1.426.546-2.019L18.788 8h2.309zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 10.5c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z",fill:"currentColor"},null,-1)]))}const ho=j(co,[["render",po]]),mo={},fo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function go(e,t){return i(),p("svg",fo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M13 6v15h-2V6H5V4h14v2z",fill:"currentColor"},null,-1)]))}const vo=j(mo,[["render",go]]),_o={},yo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function bo(e,t){return i(),p("svg",yo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z",fill:"currentColor"},null,-1)]))}const wo=j(_o,[["render",bo]]),xo={},ko={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function $o(e,t){return i(),p("svg",ko,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z",fill:"currentColor"},null,-1)]))}const Mo=j(xo,[["render",$o]]),Co={},Eo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function So(e,t){return i(),p("svg",Eo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M8 3v9a4 4 0 1 0 8 0V3h2v9a6 6 0 1 1-12 0V3h2zM4 20h16v2H4v-2z",fill:"currentColor"},null,-1)]))}const Ao=j(Co,[["render",So]]),To={},Ho={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Ro(e,t){return i(),p("svg",Ho,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M3 4h18v2H3V4zm2 15h14v2H5v-2zm-2-5h18v2H3v-2zm2-5h14v2H5V9z",fill:"currentColor"},null,-1)]))}const zo=j(To,[["render",Ro]]),Lo={},Io={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function No(e,t){return i(),p("svg",Io,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M3 4h18v2H3V4zm0 15h14v2H3v-2zm0-5h18v2H3v-2zm0-5h14v2H3V9z",fill:"currentColor"},null,-1)]))}const Oo=j(Lo,[["render",No]]),Bo={},Do={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Fo(e,t){return i(),p("svg",Do,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M3 4h18v2H3V4zm4 15h14v2H7v-2zm-4-5h18v2H3v-2zm4-5h14v2H7V9z",fill:"currentColor"},null,-1)]))}const Po=j(Bo,[["render",Fo]]),Uo={},Vo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function qo(e,t){return i(),p("svg",Vo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M15.246 14H8.754l-1.6 4H5l6-15h2l6 15h-2.154l-1.6-4zm-.8-2L12 5.885 9.554 12h4.892zM3 20h18v2H3v-2z",fill:"currentColor"},null,-1)]))}const jo=j(Uo,[["render",qo]]),Go={},Wo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Qo(e,t){return i(),p("svg",Wo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M8 4h13v2H8V4zM5 3v3h1v1H3V6h1V4H3V3h2zM3 14v-2.5h2V11H3v-1h3v2.5H4v.5h2v1H3zm2 5.5H3v-1h2V18H3v-1h3v4H3v-1h2v-.5zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1)]))}const Jo=j(Go,[["render",Qo]]),Ko={},Xo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Yo(e,t){return i(),p("svg",Xo,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M8 4h13v2H8V4zM4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 6.9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1)]))}const Zo=j(Ko,[["render",Yo]]),er={},tr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function sr(e,t){return i(),p("svg",tr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M19.417 6.679C20.447 7.773 21 9 21 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311-1.804-.167-3.226-1.648-3.226-3.489a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179zm-10 0C10.447 7.773 11 9 11 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311C4.591 12.322 3.17 10.841 3.17 9a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179z",fill:"currentColor"},null,-1)]))}const nr=j(er,[["render",sr]]),or={},rr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function ir(e,t){return i(),p("svg",rr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M16.95 8.464l1.414-1.414 4.95 4.95-4.95 4.95-1.414-1.414L20.485 12 16.95 8.464zm-9.9 0L3.515 12l3.535 3.536-1.414 1.414L.686 12l4.95-4.95L7.05 8.464z",fill:"currentColor"},null,-1)]))}const ar=j(or,[["render",ir]]),lr={},cr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function ur(e,t){return i(),p("svg",cr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z",fill:"currentColor"},null,-1)]))}const dr=j(lr,[["render",ur]]),pr={},hr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function mr(e,t){return i(),p("svg",hr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M21 15v3h3v2h-3v3h-2v-3h-3v-2h3v-3h2zm.008-12c.548 0 .992.445.992.993V13h-2V5H4v13.999L14 9l3 3v2.829l-3-3L6.827 19H14v2H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016zM8 7a2 2 0 1 1 0 4 2 2 0 0 1 0-4z",fill:"currentColor"},null,-1)]))}const fr=j(pr,[["render",mr]]),gr={},vr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function _r(e,t){return i(),p("svg",vr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),n("path",{d:"M16 4c.552 0 1 .448 1 1v4.2l5.213-3.65c.226-.158.538-.103.697.124.058.084.09.184.09.286v12.08c0 .276-.224.5-.5.5-.103 0-.203-.032-.287-.09L17 14.8V19c0 .552-.448 1-1 1H2c-.552 0-1-.448-1-1V5c0-.552.448-1 1-1h14zm-1 2H3v12h12V6zM8 8h2v3h3v2H9.999L10 16H8l-.001-3H5v-2h3V8zm13 .841l-4 2.8v.718l4 2.8V8.84z",fill:"currentColor"},null,-1)]))}const yr=j(gr,[["render",_r]]),br={},wr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function xr(e,t){return i(),p("svg",wr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M5.828 7l2.536 2.536L6.95 10.95 2 6l4.95-4.95 1.414 1.414L5.828 5H13a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H5.828z",fill:"currentColor"},null,-1)]))}const kr=j(br,[["render",xr]]),$r={},Mr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Cr(e,t){return i(),p("svg",Mr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M18.172 7H11a6 6 0 1 0 0 12h9v2h-9a8 8 0 1 1 0-16h7.172l-2.536-2.536L17.05 1.05 22 6l-4.95 4.95-1.414-1.414L18.172 7z",fill:"currentColor"},null,-1)]))}const Er=j($r,[["render",Cr]]),Sr={},Ar={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Tr(e,t){return i(),p("svg",Ar,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M2 11h2v2H2v-2zm4 0h12v2H6v-2zm14 0h2v2h-2v-2z",fill:"currentColor"},null,-1)]))}const Hr=j(Sr,[["render",Tr]]),Rr={},zr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Lr(e,t){return i(),p("svg",zr,t[0]||(t[0]=[n("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),n("path",{d:"M13 10v4h6v-4h-6zm-2 0H5v4h6v-4zm2 9h6v-3h-6v3zm-2 0v-3H5v3h6zm2-14v3h6V5h-6zm-2 0H5v3h6V5zM4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z",fill:"currentColor"},null,-1)]))}const Ir=j(Rr,[["render",Lr]]),Nr={Paragraph:{label:"Paragraph",icon:vo,action:e=>e.chain().focus().setParagraph().run(),isActive:e=>e.isActive("paragraph")},"Heading 1":{label:"Heading 1",text:"H1",icon:Gn,action:e=>e.chain().focus().toggleHeading({level:1}).run(),isActive:e=>e.isActive("heading",{level:1})},"Heading 2":{label:"Heading 2",text:"H2",icon:Kn,action:e=>e.chain().focus().toggleHeading({level:2}).run(),isActive:e=>e.isActive("heading",{level:2})},"Heading 3":{label:"Heading 3",text:"H3",icon:eo,action:e=>e.chain().focus().toggleHeading({level:3}).run(),isActive:e=>e.isActive("heading",{level:3})},"Heading 4":{label:"Heading 4",text:"H4",icon:oo,action:e=>e.chain().focus().toggleHeading({level:4}).run(),isActive:e=>e.isActive("heading",{level:4})},"Heading 5":{label:"Heading 5",text:"H5",icon:lo,action:e=>e.chain().focus().toggleHeading({level:5}).run(),isActive:e=>e.isActive("heading",{level:5})},"Heading 6":{label:"Heading 6",text:"H6",icon:ho,action:e=>e.chain().focus().toggleHeading({level:6}).run(),isActive:e=>e.isActive("heading",{level:6})},Bold:{label:"Bold",icon:wo,action:e=>e.chain().focus().toggleBold().run(),isActive:e=>e.isActive("bold")},Italic:{label:"Italic",icon:Mo,action:e=>e.chain().focus().toggleItalic().run(),isActive:e=>e.isActive("italic")},Underline:{label:"Underline",icon:Ao,action:e=>e.chain().focus().toggleUnderline().run(),isActive:e=>e.isActive("underline")},"Bullet List":{label:"Bullet List",icon:Zo,action:e=>e.chain().focus().toggleBulletList().run(),isActive:e=>e.isActive("bulletList")},"Numbered List":{label:"Numbered List",icon:Jo,action:e=>e.chain().focus().toggleOrderedList().run(),isActive:e=>e.isActive("orderedList")},"Align Center":{label:"Align Center",icon:zo,action:e=>e.chain().focus().setTextAlign("center").run(),isActive:e=>e.isActive({textAlign:"center"})},"Align Left":{label:"Align Left",icon:Oo,action:e=>e.chain().focus().setTextAlign("left").run(),isActive:e=>e.isActive({textAlign:"left"})},"Align Right":{label:"Align Right",icon:Po,action:e=>e.chain().focus().setTextAlign("right").run(),isActive:e=>e.isActive({textAlign:"right"})},FontColor:{label:"Font Color",icon:jo,isActive:e=>e.isActive("textStyle")||e.isActive("highlight"),component:st(()=>nt(()=>import("./FontColor-Dk0aPPZD.js"),__vite__mapDeps([0,1,2])))},Blockquote:{label:"Blockquote",icon:nr,action:e=>e.chain().focus().toggleBlockquote().run(),isActive:e=>e.isActive("blockquote")},Code:{label:"Code",icon:ar,action:e=>e.chain().focus().toggleCodeBlock().run(),isActive:e=>e.isActive("codeBlock")},"Horizontal Rule":{label:"Horizontal Rule",icon:Hr,action:e=>e.chain().focus().setHorizontalRule().run(),isActive:e=>!1},Link:{label:"Link",icon:dr,isActive:e=>e.isActive("link"),component:st(()=>nt(()=>import("./InsertLink-mrQ3YKax.js"),__vite__mapDeps([3,1,2,4,5])))},Image:{label:"Image",icon:fr,isActive:e=>!1,component:st(()=>nt(()=>import("./InsertImage-DeiQiVcO.js"),__vite__mapDeps([6,1,2])))},Video:{label:"Video",icon:yr,isActive:e=>!1,component:st(()=>nt(()=>import("./InsertVideo-DrrZDJfJ.js"),__vite__mapDeps([7,1,2,8,4,5,9,10,11,12,13])))},Undo:{label:"Undo",icon:kr,action:e=>e.chain().focus().undo().run(),isActive:e=>!1},Redo:{label:"Redo",icon:Er,action:e=>e.chain().focus().redo().run(),isActive:e=>!1},InsertTable:{label:"Insert Table",icon:Ir,action:e=>e.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),isActive:e=>!1},AddColumnBefore:{label:"Add Column Before",action:e=>e.chain().focus().addColumnBefore().run(),isActive:e=>!1,isDisabled:e=>!e.can().addColumnBefore()},AddColumnAfter:{label:"Add Column After",action:e=>e.chain().focus().addColumnAfter().run(),isActive:e=>!1,isDisabled:e=>!e.can().addColumnAfter()},DeleteColumn:{label:"Delete Column",action:e=>e.chain().focus().deleteColumn().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteColumn()},AddRowBefore:{label:"Add Row Before",action:e=>e.chain().focus().addRowBefore().run(),isActive:e=>!1,isDisabled:e=>!e.can().addRowBefore()},AddRowAfter:{label:"Add Row After",action:e=>e.chain().focus().addRowAfter().run(),isActive:e=>!1,isDisabled:e=>!e.can().addRowAfter()},DeleteRow:{label:"Delete Row",action:e=>e.chain().focus().deleteRow().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteRow()},DeleteTable:{label:"Delete Table",action:e=>e.chain().focus().deleteTable().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteTable()},MergeCells:{label:"Merge Cells",action:e=>e.chain().focus().mergeCells().run(),isActive:e=>!1,isDisabled:e=>!e.can().mergeCells()},SplitCell:{label:"Split Cell",action:e=>e.chain().focus().splitCell().run(),isActive:e=>!1,isDisabled:e=>!e.can().splitCell()},ToggleHeaderColumn:{label:"Toggle Header Column",action:e=>e.chain().focus().toggleHeaderColumn().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderColumn()},ToggleHeaderRow:{label:"Toggle Header Row",action:e=>e.chain().focus().toggleHeaderRow().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderRow()},ToggleHeaderCell:{label:"Toggle Header Cell",action:e=>e.chain().focus().toggleHeaderCell().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderCell()},Separator:{type:"separator"}};function ct(e){return e instanceof Array?e.map(ct):typeof e=="object"?e:Nr[e]}const Or={name:"TextEditorFixedMenu",props:["buttons"],components:{Menu:Xt},inject:["editor"],computed:{fixedMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=[["Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Paragraph","Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","FontColor","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"],e.map(ct)}}};function Br(e,t,s,o,c,l){const d=Ce("Menu");return l.fixedMenuButtons?(i(),R(d,{key:0,buttons:l.fixedMenuButtons},null,8,["buttons"])):S("",!0)}const Dr=j(Or,[["render",Br]]),Fr={name:"TextEditorBubbleMenu",props:["buttons","options"],components:{BubbleMenu:Hs,Menu:Xt},inject:["editor"],computed:{bubbleMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Separator","Bold","Italic","Link","Separator","Bullet List","Numbered List","Separator","Image","Video","Blockquote","Code",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"]],e.map(ct)}}};function Pr(e,t,s,o,c,l){const d=Ce("Menu"),a=Ce("BubbleMenu");return l.bubbleMenuButtons?(i(),R(a,yt({key:0,class:"bubble-menu rounded-md shadow-sm","tippy-options":{duration:100},editor:l.editor},s.options),{default:N(()=>[A(d,{class:"rounded-md border border-gray-100 shadow-lg",buttons:l.bubbleMenuButtons},null,8,["buttons"])]),_:1},16,["editor"])):S("",!0)}const Ur=j(Fr,[["render",Pr]]),Vr={name:"TextEditorFloatingMenu",props:["buttons"],components:{FloatingMenu:Rs},inject:["editor"],computed:{floatingMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Bullet List","Numbered List","Blockquote","Code","Horizontal Rule"],e.map(ct)}}},qr=["onClick","title"],jr={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function Gr(e,t,s,o,c,l){const d=Ce("FloatingMenu");return l.floatingMenuButtons?(i(),R(d,{key:0,"tippy-options":{duration:100},editor:l.editor,class:"flex"},{default:N(()=>[(i(!0),p(he,null,we(l.floatingMenuButtons,a=>(i(),p("button",{key:a.label,class:Te(["flex rounded p-1 text-gray-800 transition-colors",a.isActive(l.editor)?"bg-gray-100":"hover:bg-gray-100"]),onClick:()=>a.action(l.editor),title:a.label},[a.icon?(i(),R(it(a.icon),{key:0,class:"h-4 w-4"})):(i(),p("span",jr,h(a.text),1))],10,qr))),128))]),_:1},8,["editor"])):S("",!0)}const Wr=j(Vr,[["render",Gr]]);function Qr(e){return new zs.Converter().makeHtml(e)}function Jr(e){return e.split(`
`).filter(o=>o.startsWith("![")||o.startsWith("#")||o.startsWith("> ")||o.startsWith("*")||o.startsWith("- ")||o.startsWith("1. ")||o.startsWith("```")||o.startsWith("`")||o.startsWith("[")||o.startsWith("---")).length>0}const Kr={name:"TextEditor",inheritAttrs:!1,components:{EditorContent:Ls,TextEditorFixedMenu:Dr,TextEditorBubbleMenu:Ur,TextEditorFloatingMenu:Wr},props:{content:{type:String,default:null},placeholder:{type:[String,Function],default:""},editorClass:{type:[String,Array,Object],default:""},editable:{type:Boolean,default:!0},bubbleMenu:{type:[Boolean,Array],default:!1},bubbleMenuOptions:{type:Object,default:()=>({})},fixedMenu:{type:[Boolean,Array],default:!1},floatingMenu:{type:[Boolean,Array],default:!1},extensions:{type:Array,default:()=>[]},starterkitOptions:{type:Object,default:()=>({})},mentions:{type:Array,default:()=>[]}},emits:["change","focus","blur"],expose:["editor"],provide(){return{editor:Is(()=>this.editor)}},data(){return{editor:null}},watch:{content(e){this.editor.getHTML()!==e&&this.editor.commands.setContent(e)},editable(e){this.editor.setEditable(e)},editorProps:{deep:!0,handler(e){this.editor&&this.editor.setOptions({editorProps:e})}}},mounted(){this.editor=new Ns({content:this.content||null,editorProps:this.editorProps,editable:this.editable,extensions:[Os.configure(We({},this.starterkitOptions)),Bs.configure({resizable:!0}),Ds,Fs,Ps,Us,Vs.configure({types:["heading","paragraph"]}),qs,js,Gs.configure({multicolor:!0}),Ws,Qs,Js.configure({openOnClick:!1}),Ks.configure({showOnlyWhenEditable:!1,placeholder:typeof this.placeholder=="function"?this.placeholder:()=>this.placeholder}),Sn(this.mentions),...this.extensions||[]],onUpdate:({editor:e})=>{this.$emit("change",e.getHTML())},onFocus:({editor:e,event:t})=>{this.$emit("focus",t)},onBlur:({editor:e,event:t})=>{this.$emit("blur",t)}})},beforeUnmount(){this.editor.destroy(),this.editor=null},computed:{editorProps(){return{attributes:{class:Te(["prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100",this.editorClass])},clipboardTextParser:(e,t)=>{if(!Jr(e)||!confirm("Do you want to convert markdown content to HTML before pasting?"))return;let s=document.createElement("div");return s.innerHTML=Qr(e),(this.editor.view.someProp("clipboardParser")||this.editor.view.someProp("domParser")||Xs.fromSchema(this.editor.schema)).parseSlice(s,{preserveWhitespace:!0,context:t})}}}}};function Xr(e,t,s,o,c,l){const d=Ce("TextEditorBubbleMenu"),a=Ce("TextEditorFixedMenu"),u=Ce("TextEditorFloatingMenu"),f=Ce("editor-content");return c.editor?(i(),p("div",{key:0,class:Te(["relative w-full",e.$attrs.class])},[A(d,{buttons:s.bubbleMenu,options:s.bubbleMenuOptions},null,8,["buttons","options"]),A(a,{class:"w-full overflow-x-auto rounded-t-lg border border-gray-200",buttons:s.fixedMenu},null,8,["buttons"]),A(u,{buttons:s.floatingMenu},null,8,["buttons"]),rt(e.$slots,"top"),rt(e.$slots,"editor",{editor:c.editor},()=>[A(f,{editor:c.editor},null,8,["editor"])]),rt(e.$slots,"bottom")],2)):S("",!0)}const Xe=j(Kr,[["render",Xr]]);function Ke(o,c){return ue(this,arguments,function*(e,t,s={}){t||(t={});let l=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname},s.headers||{});window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(l["X-Frappe-CSRF-Token"]=window.csrf_token);let d=e.startsWith("/")?e:`/api/method/${e}`;const a=yield fetch(d,{method:"POST",headers:l,body:JSON.stringify(t)});if(a.ok){const u=yield a.json();if(u.docs||e==="login")return u;if(u.exc)try{console.groupCollapsed(e),console.log(`method: ${e}`),console.log("params:",t);let f=JSON.parse(u.exc);for(let g of f)console.log(g);console.groupEnd()}catch(f){console.warn("Error printing debug messages",f)}return u.message}else{let u=yield a.text(),f,g;try{f=JSON.parse(u)}catch(w){}let V=[[e,f.exc_type,f._error_message].filter(Boolean).join(" ")];if(f.exc){g=f.exc;try{g=JSON.parse(g)[0],console.log(g)}catch(w){}}let z=new Error(V.join(`
`));throw z.exc_type=f.exc_type,z.exc=g,z.status=a.status,z.messages=f._server_messages?JSON.parse(f._server_messages):[],z.messages=z.messages.concat(f.message),z.messages=z.messages.map(w=>{try{return JSON.parse(w).message}catch(re){return w}}),z.messages=z.messages.filter(Boolean),z.messages.length||(z.messages=f._error_message?[f._error_message]:["Internal Server Error"]),s.onError&&s.onError({response:a,status:a.status,error:z}),z}})}/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=de("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=de("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=de("CircleHelpIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=de("CircleMinusIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=de("CircleXIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=de("CodeXmlIcon",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=de("CodeIcon",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=de("EllipsisIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=de("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=de("FolderOpenIcon",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=de("MaximizeIcon",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=de("MessageSquareTextIcon",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=de("PauseIcon",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=de("PlayIcon",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=de("SquarePenIcon",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=de("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=de("UploadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=de("Volume2Icon",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=de("VolumeXIcon",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),ui={class:"w-full bg-surface-gray-3 rounded-full h-1"},ss={__name:"ProgressBar",props:{progress:{type:Number,default:0},size:{type:String,default:"sm"}},setup(e){const t=e,s=$e(()=>`${Math.min(Math.ceil(t.progress),100)}%`),o=$e(()=>{if(t.size==="sm")return"h-1";if(t.size==="md")return"h-2";if(t.size==="lg")return"h-3"});return(c,l)=>(i(),R(r(bt),{text:`${t.progress}%`},{default:N(()=>[n("div",ui,[n("div",{class:Te(["bg-surface-gray-7 rounded-full",o.value]),style:Ys({width:s.value})},null,6)])]),_:1},8,["text"]))}},di={key:0},pi={class:"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900"},hi={class:"leading-5"},mi={key:0,class:"leading-5"},fi={key:1,class:"leading-5"},gi={key:2,class:"leading-relaxed"},vi={key:3,class:"leading-relaxed"},_i={key:0,class:"flex flex-col space-x-1 my-4"},yi={class:"mb-2"},bi={class:"font-semibold"},wi={key:1},xi={class:"border text-center p-20 rounded-md"},ki={class:"font-semibold text-lg"},$i={key:2},Mi={key:2},Ci={key:0,class:"border rounded-md p-5"},Ei={class:"flex justify-between"},Si={class:"text-sm text-ink-gray-5"},Ai={class:"mr-2"},Ti={class:"text-ink-gray-9 text-sm font-semibold item-left"},Hi=["innerHTML"],Ri={key:0,class:"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600"},zi=["name","onChange"],Li=["name","onChange"],Ii={key:0},Ni=["innerHTML"],Oi={key:1},Bi={key:0},Di={key:2},Fi={class:"flex items-center justify-between mt-4"},Pi={class:"text-sm text-ink-gray-5"},Ui={key:3},Vi={class:"flex justify-between"},qi={class:"text-sm text-ink-gray-5"},ji={class:"mr-2"},Gi={class:"text-ink-gray-9 text-sm font-semibold item-left"},Wi=["innerHTML"],Qi={key:0,class:"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600"},Ji=["name","onChange"],Ki=["name","onChange"],Xi=["innerHTML"],Yi={key:1},Zi={class:"text-center mt-4"},ea={key:4,class:"border rounded-md p-20 text-center space-y-4"},ta={class:"text-ink-gray-9"},sa={class:"mt-6"},na={class:"flex justify-between"},oa={class:"text-lg text-ink-gray-5"},ra={class:"mr-2"},ia=["innerHTML"],aa={class:"bg-surface-gray-3 rounded-md p-3 mt-4"},la={class:"bg-surface-gray-3 rounded-md p-3 mt-4"},ca={key:0,class:"bg-surface-gray-3 rounded-md p-3 mt-4"},ua={class:"mt-4"},da={key:1},pa={__name:"Quiz",props:{quizName:{type:String,required:!0}},setup(e){const t=Oe("$user"),s=I(!1),o=I(0),c=I(""),l=Qe([0,0,0,0]),d=Qe([]);let a=Qe([]);const u=I(null),f=I(0);let g=null;const V=wt(),z=I(0),w=Qe({}),re=e,y=ee({url:"frappe.client.get",makeParams(_){return{doctype:"Quiz",name:re.quizName}},cache:["quiz",re.quizName],auto:!0,transform(_){return _?(_.duration=parseInt(_.duration)||0,_):(console.error("Quiz data is null or undefined."),null)},onSuccess(_){_?(U(),M()):console.error("Failed to load quiz data.")},onError(_){console.error("Error loading quiz data:",_)}}),W=$e(()=>!!y.data),U=()=>{let _=y.data;if(_.shuffle_questions){const m=xe([..._.questions]);a=_.limit_questions_to?m.slice(0,_.limit_questions_to):m}else a=_.questions},M=()=>{y.data.duration&&(f.value=y.data.duration*60)},b=()=>{g=setInterval(()=>{y.data.duration&&(f.value--,f.value==0&&(clearInterval(g),q())),z.value++},1e3)},D=_=>{const m=Math.floor(_/3600).toString().padStart(2,"0"),Y=Math.floor(_%3600/60).toString().padStart(2,"0"),G=(_%60).toString().padStart(2,"0");return m!="00"?`${m}:${Y}:${G}`:`${Y}:${G}`},F=$e(()=>f.value/(y.data.duration*60)*100),xe=_=>{for(let m=_.length-1;m>0;m--){const Y=Math.floor(Math.random()*(m+1));[_[m],_[Y]]=[_[Y],_[m]]}return _},ke=ee({url:"frappe.client.get_list",makeParams(_){var m,Y;return{doctype:"Quiz Submission",filters:{member:(m=t.data)==null?void 0:m.name,quiz:(Y=y.data)==null?void 0:Y.name},fields:["name","creation","score","score_out_of","percentage","passing_percentage"],order_by:"creation desc"}},transform(_){_.forEach((m,Y)=>{m.creation=dt(m.creation),m.idx=Y+1})}});me(()=>y.data,_=>{_&&U(),_&&y.data.max_attempts&&(ke.reload(),ge())});const J=ee({url:"seminary.seminary.doctype.quiz.quiz.quiz_summary",makeParams(_){if(!y.data)return{};const m=y.data.duration?y.data.duration*60-(f.value||0):z.value||0;return{quiz:y.data.name,course:V.currentRoute.value.params.courseName,results:(_==null?void 0:_.results)||localStorage.getItem(`${y.data.name}_results`),time_taken:m}},onSuccess(_){_.corrected_answers&&(ce.data=_.corrected_answers.map(m=>mt(We({},m),{user_answer:m.user_answer||null,correct_answer:m.correct_answer||null})))},onError(_){console.error("Error loading quiz summary:",_)},auto:!0}),Q=ee({url:"seminary.seminary.utils.get_question_details",makeParams(_){return{question:c.value}}});me(o,_=>{_>0&&(c.value=y.data.questions[_-1].question,Q.reload())}),me(()=>re.quizName,_=>{_&&y.reload()});const ce=ee({url:"seminary.seminary.utils.get_all_questions_details",makeParams(_){return{questions:a.map(m=>m.name)}}}),k=()=>{o.value=1,localStorage.removeItem(y.data.title),b()},T=()=>{localStorage.removeItem(y.data.title),s.value=!0,b(),ce.reload()},x=_=>{Q.data.multiple||l.splice(0,l.length,0,0,0,0),l[_-1]=l[_-1]?0:1},L=()=>{let _=[];return Q.data.type=="Choices"?l.forEach((Y,G)=>{l[G]&&_.push(Q.data[`option_${G+1}`])}):_.push(u.value),_},ie=()=>{let _=L();if(!_.length){At({title:"Please select an option",icon:"alert-circle",iconClasses:"text-yellow-600 bg-yellow-100 rounded-full",position:"top-center"});return}ee({url:"seminary.seminary.doctype.quiz.quiz.check_answer",params:{question:c.value,type:Q.data.type,answers:JSON.stringify(_)},auto:!0,onSuccess(m){Q.data.type==="Choices"?l.forEach((G,oe)=>{G?d[oe]=G&&m[oe]:m[oe]===2?d[oe]=2:d[oe]=void 0}):d.push(m),v(),y.data.show_answers||O()}})},v=()=>{let _=JSON.parse(localStorage.getItem(y.data.title))||[],m={question_name:c.value,answer:L().join(),is_correct:d.filter(G=>G!=null)};const Y=_.findIndex(G=>G.question_name===m.question_name);Y!==-1?_[Y]=m:_?_.push(m):_=[m],localStorage.setItem(y.data.title,JSON.stringify(_)),localStorage.setItem(`${y.data.name}_results`,JSON.stringify(_))},C=()=>{y.data.show_answers?(v(),O()):ie()},O=()=>{o.value!=y.data.questions.length&&(o.value=o.value+1,l.splice(0,l.length,0,0,0,0),d.length=0,u.value=null)},q=()=>{if(!y.data.show_answers){ie(),setTimeout(()=>{ae()},500);return}ae(),console.log("Quiz submitted with Submit Quiz button and asnwers shown")},te=()=>ue(this,null,function*(){var Y;const _=[],m=[];for(let G=0;G<ce.data.length;G++){const oe=ce.data[G],ye=((Y=w[G])==null?void 0:Y[0])||"",B=yield Ke("seminary.seminary.doctype.quiz.quiz.check_answer",{question:oe.question,type:oe.type,answers:JSON.stringify([ye])}),pe=Array.isArray(B)?[B.find(X=>X===1)||0]:[B];_.push({question_name:oe.question,answer:ye,is_correct:pe}),m.push({question_name:oe.question,question_detail:oe.question_detail,user_answer:ye,correct_answer:null,explanation:oe.explanation||null})}J.submit({results:JSON.stringify(_)},{onSuccess:G=>ue(this,null,function*(){const oe=yield Ke("seminary.seminary.doctype.quiz.quiz.get_all_question_results",{questions:a.map(ye=>ye.question)});m.forEach(ye=>{const B=oe.find(pe=>pe.name===ye.question_name);B&&(ye.correct_answer=B.correct_option,ye.explanation=B.correct_explanation||ye.explanation)}),localStorage.setItem(`${y.data.name}_questions`,JSON.stringify(m)),localStorage.setItem(`${y.data.name}_results`,JSON.stringify(_)),localStorage.setItem(`${y.data.name}_summary`,JSON.stringify(G)),J.reload(),s.value=!1}),onError(G){console.error("Error submitting quiz:",G)}})}),ae=()=>{const _=localStorage.getItem(`${y.data.name}_results`);if(!_){console.error("No results found to submit.");return}J.submit({results:_},{onSuccess(m){le(),y.data&&y.data.max_attempts&&ke.reload(),y.data.duration&&clearInterval(g)},onError(m){var G;if(((m==null?void 0:m.message)||"").includes("MaximumAttemptsExceededError")){const oe=((G=m.messages)==null?void 0:G[0])||m;Ie("Error",oe,"x"),setTimeout(()=>{window.location.reload()},3e3)}}})},ge=()=>{o.value=0,l.splice(0,l.length,0,0,0,0),d.length=0,J.reset(),U(),M(),z.value=0},K=_=>_.type=="Choices"?_.multiple?"Choose all answers that apply":"Choose one answer":"Type your answer",le=()=>{V.currentRoute.value.name==="Lesson"&&Ke("seminary.seminary.api.mark_lesson_progress",{course:V.currentRoute.value.params.courseName,chapter_number:V.currentRoute.value.params.chapterNumber,lesson_number:V.currentRoute.value.params.lessonNumber}).then(()=>{s.value&&J.reload()})},ve=(_,m)=>{w[_]=[m]},Be=(_,m)=>{w[_]||(w[_]=[]);const Y=w[_].indexOf(m);Y===-1?w[_].push(m):w[_].splice(Y,1)};me(()=>ce.data,_=>{_?console.log("All questions details updated"):console.warn("No data available in all_questions_details.")});const Re=I([]),ze=I([]);return me(()=>J.data,()=>{if(J.data){const _=localStorage.getItem(`${y.data.name}_questions`),m=localStorage.getItem(`${y.data.name}_results`);Re.value=_?JSON.parse(_):[],ze.value=m?JSON.parse(m):[]}}),(_,m)=>{var Y,G,oe,ye;return W.value?(i(),p("div",di,[n("div",pi,[n("div",hi,h(`This quiz consists of ${r(a).length} questions.`),1),(Y=r(y).data)!=null&&Y.duration?(i(),p("div",mi,h(`Please ensure that you complete all the questions in ${r(y).data.duration} minutes.`),1)):S("",!0),(G=r(y).data)!=null&&G.duration?(i(),p("div",fi,h("If you fail to do so, the quiz will be automatically submitted when the timer ends."))):S("",!0),r(y).data.passing_percentage?(i(),p("div",gi,h(`You will have to get ${r(y).data.passing_percentage}% correct answers in order to pass the quiz.`),1)):S("",!0),r(y).data.max_attempts?(i(),p("div",vi,h(`You can attempt this quiz ${r(y).data.max_attempts===1?"1 time":`${r(y).data.max_attempts} times`}.`),1)):S("",!0)]),r(y).data.duration?(i(),p("div",_i,[n("div",yi,[m[7]||(m[7]=n("span",{class:""},h("Time")+": ",-1)),n("span",bi,h(D(f.value)),1)]),A(ss,{progress:F.value},null,8,["progress"])])):S("",!0),s.value?S("",!0):(i(),p("div",wi,[n("div",xi,[n("div",ki,h(r(y).data.title),1),(!r(y).data.max_attempts||((oe=r(ke).data)==null?void 0:oe.length)<r(y).data.max_attempts)&&r(y).data.qbyquestion?(i(),R(r(ne),{key:0,onClick:k,class:"mt-2"},{default:N(()=>m[8]||(m[8]=[n("span",null,h("Start"),-1)])),_:1})):!r(y).data.max_attempts||((ye=r(ke).data)==null?void 0:ye.length)<r(y).data.max_attempts?(i(),R(r(ne),{key:1,onClick:T,class:"mt-2"},{default:N(()=>m[9]||(m[9]=[n("span",null,h("Start full quiz"),-1)])),_:1})):(i(),p("div",$i,h("You have already exceeded the maximum number of attempts allowed for this quiz.")))])])),s.value===!1&&o.value!==0&&!r(J).data&&r(y).data.qbyquestion?(i(),p("div",Mi,[(i(!0),p(he,null,we(r(a),(B,pe)=>(i(),p("div",null,[pe==o.value-1&&r(Q).data?(i(),p("div",Ci,[n("div",Ei,[n("div",Si,[n("span",Ai,h(`Question ${o.value}`)+": ",1),n("span",null,h(K(r(Q).data)),1)]),n("div",Ti,h(B.points)+" "+h(B.points==1?"Point":"Points"),1)]),n("div",{class:"text-ink-gray-9 font-semibold mt-2 leading-5",innerHTML:r(Q).data.question},null,8,Hi),r(Q).data.type=="Choices"?(i(),p(he,{key:0},we(4,X=>n("div",null,[r(Q).data[`option_${X}`]?(i(),p("label",Ri,[!d.length&&!r(Q).data.multiple?(i(),p("input",{key:0,type:"radio",name:encodeURIComponent(r(Q).data.question),class:"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals",onChange:H=>x(X)},null,40,zi)):!d.length&&r(Q).data.multiple?(i(),p("input",{key:1,type:"checkbox",name:encodeURIComponent(r(Q).data.question),class:"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals",onChange:H=>x(X)},null,40,Li)):r(y).data.show_answers?(i(!0),p(he,{key:2},we(d,(H,et)=>(i(),p("div",null,[X-1==et?(i(),p("div",Ii,[H==1?(i(),R(r(ft),{key:0,class:"w-4 h-4 text-green-800"})):H==2?(i(),R(r(zt),{key:1,class:"w-4 h-4 text-ink-green-2"})):H==0?(i(),R(r(gt),{key:2,class:"w-4 h-4 text-red-600"})):(i(),R(r(zt),{key:3,class:"w-4 h-4"}))])):S("",!0)]))),256)):S("",!0),n("span",{class:"ml-2",innerHTML:r(Q).data[`option_${X}`]},null,8,Ni)])):S("",!0),r(Q).data[`explanation_${X}`]?Se((i(),p("div",{key:1,class:"mt-2 text-xs"},h(r(Q).data[`explanation_${X}`]),513)),[[_t,d.length]]):S("",!0)])),64)):r(Q).data.type=="User Input"?(i(),p("div",Oi,[A(r(je),{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=X=>u.value=X),type:"textarea",disabled:!!d.length,class:"my-2"},null,8,["modelValue","disabled"]),d.length?(i(),p("div",Bi,[d[0]?(i(),R(r(qe),{key:0,label:"Correct",theme:"green"},{prefix:N(()=>[A(r(ft),{class:"w-4 h-4 text-ink-green-2 mr-1"})]),_:1})):(i(),R(r(qe),{key:1,theme:"red",label:"Incorrect"},{prefix:N(()=>[A(r(gt),{class:"w-4 h-4 text-ink-red-3 mr-1"})]),_:1}))])):S("",!0)])):(i(),p("div",Di,[A(r(Xe),{class:"mt-4",content:u.value,onChange:m[1]||(m[1]=X=>u.value=X),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])),n("div",Fi,[n("div",Pi,h(`Question ${o.value} of ${r(a).length}`),1),r(y).data.show_answers&&!d.length?(i(),R(r(ne),{key:0,onClick:m[2]||(m[2]=X=>ie())},{default:N(()=>m[10]||(m[10]=[n("span",null,h("Check"),-1)])),_:1})):o.value!=r(a).length?(i(),R(r(ne),{key:1,onClick:m[3]||(m[3]=X=>C())},{default:N(()=>m[11]||(m[11]=[n("span",null,h("Next"),-1)])),_:1})):(i(),R(r(ne),{key:2,onClick:m[4]||(m[4]=X=>q())},{default:N(()=>m[12]||(m[12]=[n("span",null,h("Submit"),-1)])),_:1}))])])):S("",!0)]))),256))])):S("",!0),s.value&&r(ce).data&&r(ce).data.length>0?(i(),p("div",Ui,[(i(!0),p(he,null,we(r(ce).data,(B,pe)=>(i(),p("div",{key:B.name,class:"border rounded-md p-5 mb-4"},[n("div",Vi,[n("div",qi,[n("span",ji,h(`Question ${pe+1}`)+":",1),n("span",null,h(K(B)),1)]),n("div",Gi,h(B.points||0)+" "+h(B.points==1?"Point":"Points"),1)]),n("div",{class:"text-ink-gray-9 font-semibold mt-2 leading-5",innerHTML:B.question_detail},null,8,Wi),B.type=="Choices"?(i(),p(he,{key:0},we(4,X=>n("div",null,[B[`option_${X}`]?(i(),p("label",Qi,[B.multiple?B.multiple?(i(),p("input",{key:1,type:"checkbox",name:`question_${pe}`,class:"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals",onChange:H=>Be(pe,B[`option_${X}`])},null,40,Ki)):S("",!0):(i(),p("input",{key:0,type:"radio",name:`question_${pe}`,class:"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals",onChange:H=>ve(pe,B[`option_${X}`])},null,40,Ji)),n("span",{class:"ml-2",innerHTML:B[`option_${X}`]},null,8,Xi)])):S("",!0)])),64)):B.type=="User Input"?(i(),p("div",Yi,[A(r(je),{modelValue:w[pe],"onUpdate:modelValue":X=>w[pe]=X,type:"textarea",class:"my-2"},null,8,["modelValue","onUpdate:modelValue"])])):S("",!0)]))),128)),n("div",Zi,[A(r(ne),{onClick:m[5]||(m[5]=B=>te())},{default:N(()=>m[13]||(m[13]=[n("span",null,h("Submit Your Quiz"),-1)])),_:1})])])):r(J).data?(i(),p("div",ea,[m[18]||(m[18]=n("div",{class:"text-lg font-semibold"},h("Quiz Summary"),-1)),n("div",ta,h(`You got ${Math.ceil(r(J).data.percentage)}% correct answers with a score of ${r(J).data.score} out of ${r(J).data.score_out_of}`),1),n("div",sa,[(i(!0),p(he,null,we(Re.value,(B,pe)=>{var X,H;return i(),p("div",{key:B.question_name,class:"border rounded-md p-5 mb-4"},[n("div",na,[n("div",oa,[n("span",ra,h(`Question ${pe+1}`)+":",1),n("span",{innerHTML:B.question_detail},null,8,ia)])]),n("div",aa,[m[14]||(m[14]=n("strong",null,h("Your Answer:"),-1)),Me(" "+h(B.user_answer||"No Answer"),1)]),n("div",la,[m[15]||(m[15]=n("strong",null,h("Correct Answer:"),-1)),Me(" "+h(B.correct_answer||"No Correct Answer"),1)]),B.explanation?(i(),p("div",ca,[m[16]||(m[16]=n("strong",null,h("Explanation:"),-1)),Me(" "+h(B.explanation),1)])):S("",!0),n("div",ua,[((H=(X=ze.value[pe])==null?void 0:X.is_correct)==null?void 0:H[0])===1?(i(),R(r(qe),{key:0,label:"Correct",theme:"green"},{prefix:N(()=>[A(r(ft),{class:"w-4 h-4 text-ink-green-2 mr-1"})]),_:1})):(i(),R(r(qe),{key:1,label:"Incorrect",theme:"red"},{prefix:N(()=>[A(r(gt),{class:"w-4 h-4 text-ink-red-3 mr-1"})]),_:1}))])])}),128))]),A(r(ne),{onClick:m[6]||(m[6]=B=>ge()),class:"mt-4"},{default:N(()=>m[17]||(m[17]=[n("span",null,h("Try Again"),-1)])),_:1})])):S("",!0)])):(i(),p("div",da,m[19]||(m[19]=[n("p",null,"Loading quiz data...",-1)])))}}},ha={key:1,class:"border rounded-md text-center py-20"},ma={__name:"QuizBlock",props:{quiz:{type:String,required:!0}},setup(e){const t=Oe("$user"),s=()=>{window.location.href="/login"};return(o,c)=>r(t).data?(i(),R(pa,{key:0,quizName:e.quiz},null,8,["quizName"])):(i(),p("div",ha,[n("div",null,h(o.__("Please login to access the quiz.")),1),A(r(ne),{onClick:c[0]||(c[0]=l=>s()),class:"mt-2"},{default:N(()=>[n("span",null,h(o.__("Login")),1)]),_:1})]))}},fa={class:"p-5 space-y-4"},ga={key:0,class:"text-lg font-semibold"},va={key:1,class:"text-lg font-semibold"},_a={key:2,class:"text-lg font-semibold"},ya={class:"flex justify-end space-x-2"},$t={__name:"AssessmentPlugin",props:{type:{type:String,required:!0},onAddition:{type:Function,required:!0}},setup(e){const t=I(!1),s=I(null),o=I(null),c=I(null),l=e;He(()=>ue(this,null,function*(){yield qt(),t.value=!0}));const d=()=>{l.type=="quiz"?l.onAddition(s.value):l.type=="exam"?l.onAddition(c.value):l.onAddition(o.value),t.value=!1},a=()=>{l.type=="quiz"?window.open("/seminary/quizzes/new","_blank"):l.type=="exam"?window.open("/seminary/exams/new","_blank"):window.open("/seminary/assignments/new","_blank")};return(u,f)=>(i(),R(r(jt),{modelValue:t.value,"onUpdate:modelValue":f[4]||(f[4]=g=>t.value=g),options:{size:"xl"}},{body:N(()=>[f[5]||(f[5]=n("button",{style:{opacity:"0",position:"absolute"}},"Fallback Focus",-1)),n("div",fa,[e.type=="quiz"?(i(),p("div",ga,h(u.__("Add a quiz to your lesson")),1)):e.type=="exam"?(i(),p("div",va,h(u.__("Add an exam to your lesson")),1)):(i(),p("div",_a,h(u.__("Add an assignment to your lesson")),1)),n("div",null,[e.type=="quiz"?(i(),R(Je,{key:0,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),doctype:"Quiz",label:u.__("Select a quiz"),onCreate:(g,V)=>a()},null,8,["modelValue","label","onCreate"])):e.type=="exam"?(i(),R(Je,{key:1,modelValue:c.value,"onUpdate:modelValue":f[1]||(f[1]=g=>c.value=g),doctype:"Exam Activity",label:u.__("Select an exam"),onCreate:(g,V)=>a()},null,8,["modelValue","label","onCreate"])):(i(),R(Je,{key:2,modelValue:o.value,"onUpdate:modelValue":f[2]||(f[2]=g=>o.value=g),doctype:"Assignment Activity",label:u.__("Select an assignment"),onCreate:(g,V)=>a()},null,8,["modelValue","label","onCreate"]))]),n("div",ya,[A(r(ne),{variant:"solid",onClick:f[3]||(f[3]=g=>d())},{default:N(()=>[Me(h(u.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"]))}};class ba{constructor({data:t,api:s,readOnly:o}){this.data=t,this.readOnly=o}static get toolbox(){const t=fe({render:()=>Pe(Zr,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:__("Quiz"),icon:s.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderQuiz(this.data.quiz):this.renderQuizModal(),this.wrapper}renderQuiz(t){if(this.readOnly){const s=fe(ma,{quiz:t});s.use(Ae),s.use(Ne);const{userResource:o}=xt();s.provide("$user",o),s.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Quiz: ${t}
            </span>
        </div>`}renderQuizModal(){if(this.readOnly)return;const t=fe($t,{type:"quiz",onAddition:s=>{this.data.quiz=s,this.renderQuiz(s)}});t.use(Ae),t.use(Ne),t.mount(this.wrapper)}save(t){return{quiz:this.data.quiz}}}const wa={class:"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]"},xa={key:0,class:"text-lg font-semibold mb-5 text-ink-gray-9"},ka={key:0},$a={key:1},Ma={class:"text-sm text-ink-gray-7 font-medium mb-2"},Ca=["innerHTML"],Ea={class:"flex flex-col"},Sa={class:"p-5"},Aa={class:"flex items-center justify-between mb-4"},Ta={class:"font-semibold text-ink-gray-9"},Ha={class:"flex items-center space-x-2"},Ra={key:0,class:"bg-blue-200 p-3 rounded-md leading-5 text-sm mb-4"},za={key:1},La={class:"text-xs text-ink-gray-5 mt-1 mb-2"},Ia={key:1},Na={class:"flex text-ink-gray-7"},Oa={class:"border self-start rounded-md p-2 mr-2"},Ba=["href"],Da={class:"text-sm leading-5"},Fa={class:"text-sm text-ink-gray-5 mt-1"},Pa={key:2},Ua={class:"text-xs text-ink-gray-5 mb-1"},Va={key:3},qa={class:"text-sm mb-4"},ja={key:4,class:"mt-8 p-3 bg-blue-200 rounded-md"},Ga={class:"text-sm text-ink-gray-5 font-medium mb-2"},Wa={class:"leading-5"},Qa=["innerHTML"],Ja={key:5,class:"mt-8 space-y-4"},Ka={class:"font-semibold mb-2 text-ink-gray-9"},Xa={class:"text-sm text-ink-gray-5 mb-1"},Ya={__name:"Assignment",props:{assignmentID:{type:String,required:!0},submissionName:{type:String,default:"new"}},setup(e){var ce;const t=I(null),s=I(null),o=I(null),c=wt(),l=Oe("$user"),d=c.currentRoute.value.name=="AssignmentSubmission",a=I(!1),u=e;He(()=>{window.addEventListener("keydown",f),console.log("User: ",l.data)});const f=k=>{k.key==="s"&&(k.ctrlKey||k.metaKey)&&(re(),k.preventDefault())};Zs(()=>{window.removeEventListener("keydown",f)});const g=ee({url:"frappe.client.get",params:{doctype:"Assignment Activity",name:u.assignmentID},auto:!0,onSuccess(k){u.submissionName!="new"&&w.reload()}}),V=ee({url:"frappe.client.insert",makeParams(k){var x;let T={doctype:"Assignment Submission",assignment:u.assignmentID,member:(x=l.data)==null?void 0:x.name,course:c.currentRoute.value.params.courseName};return Q()?T.assignment_attachment=t.value.file_url:T.answer=s.value,{doc:T}}}),z=ee({url:"seminary.seminary.api.get_file_info",makeParams(k){return{file_url:k.image}},auto:!1,onSuccess(k){t.value=k}}),w=Gt({doctype:"Assignment Submission",name:u.submissionName,onError(k){var T;Ie(__("Error"),__(((T=k.messages)==null?void 0:T[0])||k),"x")},auto:!1,cache:[(ce=l.data)==null?void 0:ce.name,u.assignmentID]});me(w,()=>{w.doc&&(w.doc.assignment_attachment&&z.reload({image:w.doc.assignment_attachment}),w.doc.answer&&(s.value=w.doc.answer),w.doc.comments&&(o.value=w.doc.comments),w.isDirty||Q()&&!t.value||!Q()&&!s.value?a.value=!0:a.value=!1)}),me(t,()=>{u.submissionName=="new"&&t.value&&(a.value=!0)}),me(()=>{var k;return(k=w.doc)==null?void 0:k.grade},(k,T)=>{k!==T&&w.doc&&(w.doc.status="Graded",a.value=!0)});const re=()=>{var k,T,x;if(u.submissionName!="new"){let L=w.doc&&w.doc.owner!=((k=l.data)==null?void 0:k.name)?(T=l.data)==null?void 0:T.name:null;w.setValue.submit(mt(We({},w.doc),{assignment_attachment:(x=t.value)==null?void 0:x.file_url,evaluator:L,comments:o.value,answer:s.value}),{onSuccess(ie){Ie(__("Success"),__("Changes saved successfully"),"check"),a.value=!1}})}else y()},y=()=>{V.submit({},{onSuccess(k){Ie("Success","Assignment submitted successfully.","check"),c.currentRoute.value.name=="AssignmentSubmission"?c.push({name:"AssignmentSubmission",params:{assignmentID:u.assignmentID,submissionName:k.name}}):(U(),c.go()),w.name=k.name,a.value=!1,w.reload()},onError(k){var T;Ie("Error",((T=k.messages)==null?void 0:T[0])||k,"x")}})},W=k=>{a.value=!0,t.value=k},U=()=>{if(c.currentRoute.value.name=="Lesson"){let k=c.currentRoute.value.params.courseName,T=c.currentRoute.value.params.chapterNumber,x=c.currentRoute.value.params.lessonNumber;console.log("Chapter Number: ",T),console.log("Lesson Number: ",x),Ke("seminary.seminary.api.mark_lesson_progress",{course:k,chapter_number:T,lesson_number:x})}},M=()=>{var T;const k=(T=g.data)==null?void 0:T.type;if(k=="Image")return["image/*"];if(k=="Document")return[".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];if(k=="PDF")return[".pdf"]},b=k=>{var L;let T=(L=g.data)==null?void 0:L.type,x=k.name.split(".").pop().toLowerCase();if(T=="Image"&&!["jpg","jpeg","png"].includes(x))return"Only image file is allowed.";if(T=="Document"&&!["doc","docx","xml"].includes(x))return"Only document file is allowed.";if(T=="PDF"&&!["pdf"].includes(x))return"Only PDF file is allowed."},D=()=>{a.value=!0,t.value=null},F=$e(()=>{var k,T,x;return(((k=l.data)==null?void 0:k.is_moderator)||((T=l.data)==null?void 0:T.is_evaluator)||((x=l.data)==null?void 0:x.is_instructor))&&u.submissionName!="new"&&c.currentRoute.value.name=="AssignmentSubmission"}),xe=$e(()=>{var k,T,x;return!w.doc||((k=w.doc)==null?void 0:k.owner)==((T=l.data)==null?void 0:T.name)&&((x=w.doc)==null?void 0:x.status)=="Not Graded"}),ke=$e(()=>[{label:"Not Graded",value:"Not Graded"},{label:"Graded",value:"Graded"},{label:"Pass",value:"Pass"},{label:"Fail",value:"Fail"}]),J=$e(()=>w.doc?w.doc.status=="Pass"||w.doc.status=="Graded"?"green":w.doc.status=="Not Graded"?"blue":"red":"orange"),Q=()=>{var k;return["PDF","Image","Document"].includes((k=g.data)==null?void 0:k.type)};return(k,T)=>{var x,L,ie,v,C,O,q,te,ae,ge;return r(g).data?(i(),p("div",{key:0,class:Te(["grid grid-cols-[65%,35%] h-full",{"border rounded-lg":!d}])},[n("div",wa,[d?(i(),p("div",xa,[e.submissionName==="new"?(i(),p("div",ka,h(k.__("Submission by"))+" "+h((x=r(l).data)==null?void 0:x.full_name),1)):(i(),p("div",$a,h(k.__("Submission by"))+" "+h((L=r(w).doc)==null?void 0:L.member_name),1))])):S("",!0),n("div",Ma,h(k.__("Question"))+": ",1),n("div",{innerHTML:r(g).data.question,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,Ca)]),n("div",Ea,[n("div",Sa,[n("div",Aa,[n("div",Ta,h(k.__("Submission")),1),n("div",Ha,[a.value?(i(),R(r(qe),{key:0,theme:"orange"},{default:N(()=>[Me(h(k.__("Not Saved")),1)]),_:1})):(ie=r(w).doc)!=null&&ie.status?(i(),R(r(qe),{key:1,theme:J.value,size:"lg"},{default:N(()=>{var K;return[Me(h((K=r(w).doc)==null?void 0:K.status),1)]}),_:1},8,["theme"])):S("",!0),A(r(ne),{variant:"solid",onClick:T[0]||(T[0]=K=>re())},{default:N(()=>[Me(h(k.__("Save")),1)]),_:1})])]),e.submissionName!="new"&&!["Pass","Fail","Graded"].includes((v=r(w).doc)==null?void 0:v.status)&&((C=r(w).doc)==null?void 0:C.owner)==((O=r(l).data)==null?void 0:O.name)?(i(),p("div",Ra,h(k.__("You've successfully submitted the assignment."))+" "+h(k.__("Once the moderator grades your submission, you'll find the details here."))+" "+h(k.__("Feel free to make edits to your submission if needed, until it is graded.")),1)):S("",!0),Q()?(i(),p("div",za,[n("div",La,h(k.__("Add your assignment as {0}").format(r(g).data.type)),1),t.value?(i(),p("div",Ia,[n("div",Na,[n("div",Oa,[A(r(ni),{class:"h-5 w-5 stroke-1.5"})]),n("a",{href:t.value.file_url,target:"_blank",class:"flex flex-col cursor-pointer !no-underline"},[n("span",Da,h(t.value.file_name),1),n("span",Fa,h(r(Yu)(t.value.file_size)),1)],8,Ba),xe.value?(i(),R(r(cn),{key:0,onClick:T[2]||(T[2]=K=>D()),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})):S("",!0)])])):(i(),R(r(Kt),{key:0,fileTypes:M(),validateFile:b,onSuccess:T[1]||(T[1]=K=>W(K))},{default:N(({uploading:K,progress:le,openFileSelector:ve})=>[A(r(ne),{onClick:ve,loading:K},{default:N(()=>[Me(h(K?k.__("Uploading {0}%").format(le):k.__("Upload File")),1)]),_:2},1032,["onClick","loading"])]),_:1},8,["fileTypes"]))])):r(g).data.type=="URL"?(i(),p("div",Pa,[n("div",Ua,h(k.__("Enter a URL")),1),A(r(je),{modelValue:s.value,"onUpdate:modelValue":T[3]||(T[3]=K=>s.value=K),type:"text",readonly:!xe.value},null,8,["modelValue","readonly"])])):(i(),p("div",Va,[n("div",qa,h(k.__("Write your answer here")),1),A(r(Xe),{content:s.value,onChange:T[4]||(T[4]=K=>s.value=K),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])),((q=r(l).data)==null?void 0:q.name)==((te=r(w).doc)==null?void 0:te.owner)&&((ae=r(w).doc)!=null&&ae.comments)?(i(),p("div",ja,[n("div",Ga,h(k.__("Comments by"))+": "+h(((ge=r(w).doc)==null?void 0:ge.evaluator)||k.__("Evaluator")),1),n("div",Wa,[n("div",{innerHTML:r(w).doc.comments},null,8,Qa)])])):S("",!0),F.value?(i(),p("div",Ja,[n("div",Ka,h(k.__("Grading")),1),r(w).doc?(i(),R(r(je),{key:0,modelValue:r(w).doc.status,"onUpdate:modelValue":T[5]||(T[5]=K=>r(w).doc.status=K),label:k.__("Grading Status"),type:"select",options:ke.value},null,8,["modelValue","label","options"])):S("",!0),r(w).doc?(i(),R(r(je),{key:1,modelValue:r(w).doc.grade,"onUpdate:modelValue":T[6]||(T[6]=K=>r(w).doc.grade=K),label:k.__("Score"),type:"number"},null,8,["modelValue","label"])):S("",!0),n("div",null,[n("div",Xa,h(k.__("Comments")),1),A(r(Xe),{content:o.value,onChange:T[7]||(T[7]=K=>{o.value=K,a.value=!0}),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])])):S("",!0)])])],2)):S("",!0)}}},Za={key:1,class:"border rounded-md text-center py-20"},el={__name:"AssignmentBlock",props:{assignmentID:{type:String,required:!0}},setup(e){const t=Oe("$user"),s=e,o=ee({url:"frappe.client.get_value",makeParams(c){var l;return{doctype:"Assignment Submission",fieldname:"name",filters:{assignment:s.assignmentID,member:(l=t.data)==null?void 0:l.name}}},auto:!0});return(c,l)=>{var d;return r(t).data&&r(o).data?(i(),R(Ya,{key:0,assignmentID:e.assignmentID,submissionName:((d=r(o).data)==null?void 0:d.name)||"new"},null,8,["assignmentID","submissionName"])):(i(),p("div",Za,[n("div",null,h(c.__("Please login to access the assignment.")),1),A(r(ne),{onClick:l[0]||(l[0]=a=>c.redirectToLogin()),class:"mt-2"},{default:N(()=>[n("span",null,h(c.__("Login")),1)]),_:1})]))}}};class tl{constructor({data:t,api:s,readOnly:o}){this.data=t,this.readOnly=o}static get toolbox(){const t=fe({render:()=>Pe(un,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:__("Assignment"),icon:s.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderAssignment(this.data.assignment):this.renderAssignmentModal(),this.wrapper}renderAssignment(t){if(this.readOnly){const s=fe(el,{assignmentID:t});s.use(Ae),s.use(Ne);const{userResource:o}=xt();s.provide("$user",o),s.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Assignment: ${t}
            </span>
        </div>`}renderAssignmentModal(){if(this.readOnly)return;const t=fe($t,{type:"assignment",onAddition:s=>{this.data.assignment=s,this.renderAssignment(s)}});t.use(Ae),t.use(Ne),t.mount(this.wrapper)}save(t){return{assignment:this.data.assignment}}}const sl={key:0,class:"text-center py-5"},nl={key:1,class:"space-y-5"},ol={class:"grid grid-cols-3 gap-3"},rl={class:"col-span-3 space-y-4"},il={class:"space-y-4 border p-2 rounded-md"},al={class:"flex items-center justify-between py-4"},ll={class:"text-center ml-5"},cl={class:"text-3xl font-bold text-ink-gray-9"},ul={class:"text-center"},dl={class:"text-3xl font-semibold text-ink-gray-9"},pl={class:"text-sm text-ink-gray-5"},hl={class:"text-center mr-5"},ml={class:"text-3xl font-semibold text-ink-gray-9 mt-2"},fl={class:"space-y-1"},gl={class:"font-semibold text-ink-gray-9 text-left"},vl=["innerHTML"],_l={class:"leading-5 text-ink-gray-7 space-x-1 text-left"},yl=["innerHTML"],bl={class:"flex justify-end items-center space-x-2"},wl={class:"text-sm text-ink-gray-7 text-xl"},xl={key:0,class:"leading-5 text-ink-gray-7 text-xl space-x-1 text-left"},kl=["innerHTML"],$l={key:2},Ml={__name:"ExamGraded",props:{submission:{type:Object,required:!0}},setup(e){const t=e;console.log("ExamGraded received submission:",t.submission);const s=Gt({doctype:"Exam Submission",name:t.submission,auto:!0});console.log("ExamGraded submisisonDetails:",s),me(()=>s.doc,c=>{s.loading=!1,console.log("ExamGraded updated with new submission details:",c)});const o=c=>{if(!c)return"00:00:00";const l=Math.floor(c/3600).toString().padStart(2,"0"),d=Math.floor(c%3600/60).toString().padStart(2,"0"),a=(c%60).toString().padStart(2,"0");return`${l}:${d}:${a}`};return(c,l)=>r(s).loading?(i(),p("div",sl,l[0]||(l[0]=[n("p",null,"Loading submission details...",-1)]))):r(s).doc?(i(),p("div",nl,[n("div",ol,[n("div",rl,[n("div",il,[n("div",al,[n("div",ll,[n("div",cl,h(r(s).doc.percentage||0)+"% ",1),l[1]||(l[1]=n("div",{class:"text-sm text-ink-gray-5"},"Score",-1))]),n("div",ul,[n("div",dl,h(r(s).doc.score),1),n("div",pl," Out of "+h(r(s).doc.score_out_of)+" Points ",1)]),n("div",hl,[n("div",ml,h(o(r(s).doc.time_taken)),1),l[2]||(l[2]=n("div",{class:"text-sm text-ink-gray-5"},"Time taken",-1))])])]),(i(!0),p(he,null,we(r(s).doc.result,(d,a)=>(i(),p("div",{key:a,class:"border p-5 rounded-md space-y-4"},[n("div",fl,[n("div",gl,h(c.__("Question"))+" "+h(a+1)+": ",1),n("div",{class:"leading-5 text-ink-gray-9 text-left",innerHTML:d.question_name},null,8,vl)]),n("div",_l,[n("span",null,h(c.__("Your Answer"))+": ",1),n("span",{innerHTML:d.answer},null,8,yl)]),n("div",bl,[n("span",wl,h(d.points)+" / "+h(parseInt(d.points_out_of,10))+" "+h(c.__("Points")),1)]),d.comments?(i(),p("div",xl,[n("span",null,h(c.__("Comments"))+": ",1),n("span",{innerHTML:d.comments},null,8,kl)])):S("",!0)]))),128))])])])):(i(),p("div",$l,l[3]||(l[3]=[n("p",null,"Debug: No submission details found.",-1)])))}},ns={__name:"UserAvatar",props:{user:{type:Object,default:null},size:{type:String}},setup(e){return(t,s)=>(i(),R(r(bt),{text:e.user.full_name},{default:N(()=>[e.user?(i(),R(r(en),yt({key:0,class:"avatar border border-outline-gray-2 cursor-auto",label:e.user.full_name,image:e.user.user_image,size:e.size},t.$attrs),null,16,["label","image","size"])):S("",!0)]),_:1},8,["text"]))}},Cl={class:"mt-6"},El={key:0,class:"flex items-center mb-5"},Sl={class:"text-lg font-semibold ml-2 text-ink-gray-9"},Al={class:"flex items-center justify-between mb-2"},Tl={class:"flex items-center text-ink-gray-5"},Hl={class:"text-sm ml-2"},Rl={key:1},zl={key:0},Ll={key:1,class:"formatted-reply"},Il=["innerHTML"],Nl=["value"],Ol={class:"flex justify-between mt-2"},Lt={__name:"DiscussionReplies",props:Wt({topic:{type:Object,required:!0},singleThread:{type:Boolean,default:!1}},{showTopics:{},showTopicsModifiers:{}}),emits:["update:showTopics"],setup(e){const t=Qt(),s=I(!1),o=Jt(e,"showTopics"),c=I(""),l=Oe("$user");console.log("User data:",l.data.is_student);const d=I([]),a=I(!1),u=e,f=`editor-${u.topic.name}`;He(()=>{console.log("DiscussionReplies mounted. Registering socket listeners."),console.log("Topic received:",u.topic.name),z(),g.reload({},{onSuccess(b){console.log("Replies fetched successfully:",b)},onError(b){console.error("Error fetching replies:",b)}}),t.on("publish_message",b=>{g.reload()}),t.on("update_message",b=>{g.reload()}),t.on("delete_message",b=>{g.reload()}),a.value=!0,console.log("TextEditor renderEditor set to true."),console.log("Editor key:",f)}),me(u.topic,(b,D)=>{b.name!==D.name&&(f.value=`editor-${b.name}`,console.log("Editor key updated:",f.value))}),me(c,b=>{console.log("New reply value:",b),b||console.warn("Reply is empty. Ensure the input is being updated correctly.")}),me(a,b=>{b&&console.log("TextEditor is now visible and ready for initialization.")});const g=ee({url:"seminary.seminary.utils.get_discussion_replies",auto:!1,makeParams(){return{topic:u.topic.name}},onSuccess(b){console.log("Replies fetched successfully:",b)},onError(b){console.error("Error fetching replies:",b)}}),V=ee({url:"seminary.seminary.utils.insert_discussion_reply",makeParams(b){return{reply:c.value,topic:u.topic.name}},onSuccess(b){console.log("Discussion saved successfully:",b)},onError(b){console.error("Error inserting replies:",b)}}),z=()=>{var b;console.log("User data in fetchMentionUsers:",l.data),(b=l.data)!=null&&b.is_student?a.value=!0:(s.value=!0,M.reload({},{onSuccess(D){d.value=Object.values(D).map(F=>({value:F.name,label:F.full_name})),a.value=!0,s.value=!1},onError(D){console.error("Error fetching mention users:",D),s.value=!1}}))},w=()=>{V.submit({},{onSuccess(){c.value="",g.reload()},onError(b){var D;At({title:"Error",text:((D=b.messages)==null?void 0:D[0])||b,icon:"x",iconClasses:"bg-surface-red-5 text-ink-white rounded-md p-px",position:"top-center",timeout:10})}})},re=ee({url:"frappe.client.set_value",makeParams(b){return{doctype:"Discussion Reply",name:b.name,fieldname:"reply",value:b.reply}}}),y=b=>{re.submit({name:b.name,reply:b.reply},{validate(){if(!b.reply)return"Reply cannot be empty"},onSuccess(){b.editable=!1,g.reload()}})},W=ee({url:"frappe.client.delete",makeParams(b){return{doctype:"Discussion Reply",name:b.name}}}),U=b=>{W.submit({name:b.name},{onSuccess(){g.reload()}})},M=ee({url:"seminary.seminary.utils.get_all_users"});return console.log("All Users:",M),(b,D)=>(i(),p("div",Cl,[e.singleThread?S("",!0):(i(),p("div",El,[A(r(ne),{variant:"outline",onClick:D[0]||(D[0]=F=>o.value=!0)},{icon:N(()=>[A(r(Yr),{class:"w-5 h-5 stroke-1.5 text-ink-gray-7"})]),_:1}),n("span",Sl,h(e.topic.title),1)])),(i(!0),p(he,null,we(r(g).data,(F,xe)=>{var ke;return i(),p("div",{key:F.name},[n("div",{class:Te(["py-3",{"border-b":xe+1!=r(g).data.length}])},[n("div",Al,[n("div",Tl,[A(ns,{user:F.user,class:"mr-2"},null,8,["user"]),n("span",null,h(((ke=F.user)==null?void 0:ke.full_name)||F.owner),1),n("span",Hl,h(r(dt)(F.creation)),1)]),r(l).data.name==F.owner&&!F.editable?(i(),R(r(tn),{key:0,options:[{label:"Edit",onClick(){F.editable=!0}},{label:"Delete",onClick(){U(F)}}]},{default:N(({open:J})=>[A(r(si),{class:"w-4 h-4 stroke-1.5 cursor-pointer"})]),_:2},1032,["options"])):S("",!0),F.editable?(i(),p("div",Rl,[A(r(ne),{variant:"ghost",onClick:J=>y(F)},{default:N(()=>[Me(h(b.__("Post")),1)]),_:2},1032,["onClick"]),A(r(ne),{variant:"ghost",onClick:J=>F.editable=!1},{default:N(()=>[Me(h(b.__("Discard")),1)]),_:2},1032,["onClick"])])):S("",!0)]),F.editable?(i(),p("div",zl,[A(r(Xe),{content:F.reply,onChange:J=>F.reply=J,editable:!0,fixedMenu:!0,editorClass:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none"},null,8,["content","onChange"])])):(i(),p("div",Ll,[n("div",{innerHTML:F.reply,class:"p-2"},null,8,Il)]))],2)])}),128)),Se(n("textarea",{class:"mt-5",value:c.value,onInput:D[1]||(D[1]=F=>c.value=F),placeholder:"Type your reply here...",fixedMenu:!0},null,40,Nl),[[_t,a.value]]),n("div",Ol,[D[3]||(D[3]=n("span",null,null,-1)),A(r(ne),{onClick:D[2]||(D[2]=F=>w())},{default:N(()=>[n("span",null,h(b.__("Post")),1)]),_:1})])]))}},Bl={class:"flex flex-col gap-4"},Dl={class:"mb-1.5 text-sm text-ink-gray-5"},It={__name:"DiscussionModal",props:Wt({title:{type:String,required:!0},doctype:{type:String,required:!0},docname:{type:String,required:!0}},{reloadTopics:{},reloadTopicsModifiers:{}}),emits:["update:reloadTopics"],setup(e){const t=Jt(e,"reloadTopics"),s=e,o=Qe({title:"",reply:""}),c=ee({url:"frappe.client.insert",makeParams(a){return{doc:{doctype:"Discussion Topic",reference_doctype:s.doctype,reference_docname:s.docname,title:o.title}}}}),l=ee({url:"frappe.client.insert",makeParams(a){return{doc:{doctype:"Discussion Reply",topic:a.topic,reply:o.reply}}}}),d=a=>{c.submit({},{validate(){if(!o.title)return"Title cannot be empty.";if(!o.reply)return"Reply cannot be empty."},onSuccess(u){l.submit({topic:u.name},{onSuccess(){o.title="",o.reply="",t.value.reload(),a()}})},onError(u){Ie("Error",u.message,"x")}})};return(a,u)=>(i(),R(r(jt),{options:{title:r(vs)(s.title),size:"2xl",actions:[{label:"Post",variant:"solid",onClick:f=>d(f)}]}},{"body-content":N(()=>[n("div",Bl,[n("div",null,[A(r(je),{modelValue:o.title,"onUpdate:modelValue":u[0]||(u[0]=f=>o.title=f),label:a.__("Title"),type:"text"},null,8,["modelValue","label"])]),n("div",null,[n("div",Dl,h(a.__("Details")),1),A(r(Xe),{content:o.reply,onChange:u[1]||(u[1]=f=>o.reply=f),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])])]),_:1},8,["options"]))}};function Fl(){return window.scrollContainer}const Pl={class:"text-xl font-semibold text-ink-gray-9"},Ul={key:0},Vl={key:1},ql={key:2},jl=["onClick"],Gl={class:"text-lg font-semibold mb-1 text-ink-gray-7"},Wl={class:"flex items-center text-ink-gray-5"},Ql={class:"text-sm ml-3"},Jl={key:1},Kl={key:3,class:"flex flex-col items-center justify-center border-2 border-dashed mt-5 py-8 rounded-md"},Xl={class:""},Yl={key:0,class:"font-medium mb-2"},Zl={class:"text-ink-gray-5"},ec={__name:"Discussions",props:{title:{type:String,required:!0},doctype:{type:String,required:!0},docname:{type:String,required:!0},emptyStateTitle:{type:String,default:""},emptyStateText:{type:String,default:"Start a discussion"},singleThread:{type:Boolean,default:!1},scrollToBottom:{type:Boolean,default:!1},type:{type:String,default:"multi"}},setup(e){console.log("Discussions.vue script setup executed");const t=I(!0),s=I(null),o=Oe("$user"),c=I(!1),l=I(!0),d=I(!1),a=Qt();a?(console.log("Socket connection initialized in Discussions.vue:",a),a.on("connect",()=>{console.log("Socket connected:",a.id),d.value=!0}),a.on("connect_error",y=>{console.error("Socket connection error:",y)}),a.on("disconnect",y=>{console.warn("Socket disconnected:",y),d.value=!1})):console.error("Socket connection not initialized in Discussions.vue.");const u=e;me(d,y=>{y&&(console.log("Socket is connected, proceeding with onMounted logic."),f())});const f=()=>{console.log("onMounted logic executed"),console.log("Props:",u),o.data&&(u.type==="single"?(console.log("Single-topic mode detected"),V.reload(),console.log("Topic",s.value)):l.value=!1,z.reload()),a.on("new_discussion_topic",y=>{z.refresh()}),u.scrollToBottom&&setTimeout(()=>{g()},100)},g=()=>{let y=Fl();y.scrollTop=y.scrollHeight},V=ee({url:"seminary.seminary.utils.ensure_single_topic",cache:!1,makeParams(){return{doctype:u.doctype,docname:u.docname,title:u.title}},onSuccess(y){console.log("Ensure single topic response:",y),y&&(s.value=y,console.log("Current topic set:",s.value),t.value=!1,l.value=!1),console.log("Changed loading to:",l.value)},onError(y){console.error("Error ensuring single topic:",y),l.value=!1}}),z=ee({url:"seminary.seminary.utils.get_discussion_topics",cache:["topics",u.doctype,u.docname],makeParams(){return{doctype:u.doctype,docname:u.docname,single_thread:u.singleThread}}}),w=y=>{t.value=!1,s.value=y},re=()=>{c.value=!0};return(y,W)=>{var U;return i(),p(he,null,[n("div",null,[!e.singleThread&&u.type==="multi"?(i(),R(r(ne),{key:0,class:"float-right",onClick:W[0]||(W[0]=M=>re())},{default:N(()=>[Me(h(y.__("New {0}").format(r(vs)(e.title))),1)]),_:1})):S("",!0),n("div",Pl,h(y.__(e.title)),1)]),l.value&&u.type==="single"?(i(),p("div",Ul,W[6]||(W[6]=[n("div",{class:"text-center py-10"},[n("span",null,"Loading discussion...")],-1)]))):S("",!0),u.type==="single"&&!l.value?(i(),p("div",Vl,[W[7]||(W[7]=n("div",{class:"flex flex-col items-center justify-center"},null,-1)),A(It,{modelValue:c.value,"onUpdate:modelValue":W[1]||(W[1]=M=>c.value=M),title:e.title,doctype:u.doctype,docname:u.docname},null,8,["modelValue","title","doctype","docname"]),s.value.value?(i(),R(Lt,{key:0,topic:s.value.value,singleThread:!0,showTopics:t.value,"onUpdate:showTopics":W[2]||(W[2]=M=>t.value=M)},null,8,["topic","showTopics"])):S("",!0)])):S("",!0),(U=r(z).data)!=null&&U.length&&!e.singleThread?(i(),p("div",ql,[t.value?(i(!0),p(he,{key:0},we(r(z).data,(M,b)=>(i(),p("div",{key:b},[n("div",{onClick:D=>w(M),class:Te(["flex items-center cursor-pointer py-5 w-full",{"border-b":b+1!=r(z).data.length}])},[A(ns,{user:M.user,size:"2xl",class:"mr-4"},null,8,["user"]),n("div",null,[n("div",Gl,h(M.title),1),n("div",Wl,[n("span",null,h(M.user.full_name),1),n("span",Ql,h(r(dt)(M.creation)),1)])])],10,jl)]))),128)):(i(),p("div",Jl,[A(Lt,{topic:s.value,showTopics:t.value,"onUpdate:showTopics":W[3]||(W[3]=M=>t.value=M)},null,8,["topic","showTopics"])]))])):(i(),p("div",Kl,[A(r(ii),{class:"w-7 h-7 text-ink-gray-4 stroke-1.5 mr-2"}),n("div",Xl,[e.emptyStateTitle?(i(),p("div",Yl,h(y.__(e.emptyStateTitle)),1)):S("",!0),n("div",Zl,h(y.__(e.emptyStateText)),1)])])),A(It,{modelValue:c.value,"onUpdate:modelValue":W[4]||(W[4]=M=>c.value=M),title:y.__("New {0}").format(e.title),doctype:u.doctype,docname:u.docname,reloadTopics:r(z),"onUpdate:reloadTopics":W[5]||(W[5]=M=>kt(z)?z.value=M:null)},null,8,["modelValue","title","doctype","docname","reloadTopics"])],64)}}},tc={key:0},sc={key:0,class:"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900"},nc={class:"leading-5"},oc={key:0,class:"leading-5"},rc={key:1,class:"leading-5"},ic={key:1,class:"space-y-4 border p-5 rounded-md"},ac={key:2,class:"flex flex-col space-x-1 my-4"},lc={class:"mb-2"},cc={class:"font-semibold"},uc={key:3},dc={class:"border text-center p-20 rounded-md"},pc={class:"font-semibold text-lg"},hc={key:2,class:"w-full max-w-4xl mx-auto py-5"},mc={key:3},fc={key:4},gc={class:"border text-center p-20 rounded-md"},vc={class:"font-semibold text-lg text-ink-gray-9 mt-3 mb-3"},_c={class:"absolute -top-3 -left-3 bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm"},yc={class:"text-ink-gray-9 text-sm font-semibold text-right"},bc={class:"text-ink-gray-9 text-left font-semibold mt-2 leading-5"},wc=["innerHTML"],xc={class:"mt-4"},kc=["onUpdate:modelValue","onChange"],$c={class:"text-center mt-4"},Mc={__name:"Exam",props:{examName:{type:String,required:!0}},setup(e){var k,T;const t=Oe("$user"),s=I(0);let o=null;const c=I(0);I("");const l=I({});I([]);const d=I(!1),a=wt();let u=!1;const f=e;console.log("Exam Name (PROPS):",f.examName);const g=ee({url:"frappe.client.get",makeParams(x){return{doctype:"Exam Activity",name:f.examName}},cache:["exam",f.examName],auto:!0,transform(x){return x?(x.duration=parseInt(x.duration)||0,x):(console.error("Exam data is null or undefined."),null)},onSuccess(x){x?x.questions=x.questions||[]:console.error("Failed to load exam data.")},onError(x){console.error("Error loading exam data:",x)}}),V=$e(()=>!!g.data),z=$e(()=>{var x;return((x=F.data)==null?void 0:x.length)>0}),w=ee({url:"seminary.seminary.utils.get_instructors",makeParams(x){const L=a.currentRoute.value.params.courseName;return L?{course:L}:(console.error("Course name is undefined in route parameters."),{})},auto:!0}),re=()=>(w.data&&w.data.forEach(x=>{var L;x.user===((L=t.data)==null?void 0:L.name)&&(u=!0)}),u);let y=null;const W=()=>{if(g.data.duration){s.value=g.data.duration*60,y=Date.now();const x=y+s.value*1e3;o=setInterval(()=>{const L=Date.now(),ie=Math.max(0,Math.floor((x-L)/1e3));s.value=ie,c.value=g.data.duration*60-ie,ie<=0&&(clearInterval(o),xe())},1e3)}else y=Date.now(),o=setInterval(()=>{const x=Date.now();c.value=Math.floor((x-y)/1e3)},1e3)},U=x=>{const L=Math.floor(x/60).toString().padStart(2,"0"),ie=(x%60).toString().padStart(2,"0");return`${L}:${ie}`},M=$e(()=>s.value/(g.data.duration*60)*100);me(l,x=>{},{deep:!0});const b=()=>{const x=sn(l.value);return Object.entries(x).map(([L,ie])=>({question:L,answer:ie}))},D=(x,L)=>{l[x]=L},F=ee({url:"frappe.client.get_list",makeParams(x){var L;return{doctype:"Exam Submission",filters:{member:(L=t.data)==null?void 0:L.name,exam:f.examName},fields:["name","creation"],order_by:"creation desc"}},auto:!0,transform(x){x.forEach((L,ie)=>{L.creation=dt(L.creation),L.idx=ie+1})}});me(()=>F.data,x=>{console.log("Attempts data updated:",x)});const xe=()=>ue(this,null,function*(){var x;try{const L=b(),ie=g.data.duration?g.data.duration*60-(s.value||0):c.value||0;yield Ke("seminary.seminary.doctype.exam_submission.exam_submission.create_exam_submission",{exam:f.examName,course:a.currentRoute.value.params.courseName,member:(x=t.data)==null?void 0:x.name,answers:L,time_taken:ie}),Ie("Success","Your exam was submitted successfully.","check"),clearInterval(o)}catch(L){console.error("Error during exam submission:",L),Ie("Error","Failed to submit the exam.","x")}}),ke=()=>{activeQuestion.value=1,localStorage.removeItem(g.data.title),W()},J=()=>{localStorage.removeItem(g.data.title),d.value=!0,W()},Q=ee({url:"frappe.client.get_value",params:{doctype:"Exam Submission",fieldname:"name",filters:{exam:f.examName,member:(k=t.data)==null?void 0:k.name,status:"Graded"}},auto:!1,transform(x){return console.log("Fetched submission data:",x),x},onError(x){console.error("Error fetching submission:",x)}}),ce=ee({url:"frappe.client.get_value",params:{doctype:"Exam Submission",fieldname:"name",filters:{exam:f.examName,member:(T=t.data)==null?void 0:T.name}},auto:!1,transform(x){return console.log("Fetched submission AnyStatus:",x.name),x},onError(x){console.error("Error fetching submission:",x)}});return He(()=>{Q.reload(),ce.reload()}),(x,L)=>{var v,C,O,q,te,ae,ge,K,le,ve,Be,Re,ze,_;const ie=Ce("router-link");return V.value?(i(),p("div",tc,[z.value?S("",!0):(i(),p("div",sc,[n("div",nc,h(`This exam consists of ${r(g).data.questions.length}`)+" "+h(r(g).data.questions.length===1?"question":"questions")+". ",1),(v=r(g).data)!=null&&v.duration?(i(),p("div",oc,h(`Please ensure that you complete all the questions in ${r(g).data.duration} minutes.`),1)):S("",!0),(C=r(g).data)!=null&&C.duration?(i(),p("div",rc,h("If you fail to do so, the exam will be automatically submitted when the timer ends."))):S("",!0)])),z.value&&((O=r(ce))!=null&&O.data||(q=r(F).data)!=null&&q[0])?(i(),p("div",ic,[(i(),R(ec,{title:"Exam Comments",doctype:"Exam Submission",docname:((ae=(te=r(ce))==null?void 0:te.data)==null?void 0:ae.name)||((K=(ge=r(F).data)==null?void 0:ge[0])==null?void 0:K.name),key:((ve=(le=r(ce))==null?void 0:le.data)==null?void 0:ve.name)||((Re=(Be=r(F).data)==null?void 0:Be[0])==null?void 0:Re.name),type:"single"},null,8,["docname"]))])):S("",!0),r(g).data.duration&&!z.value?(i(),p("div",ac,[n("div",lc,[L[0]||(L[0]=n("span",{class:""},h("Time")+": ",-1)),n("span",cc,h(U(s.value)),1)]),A(ss,{progress:M.value},null,8,["progress"])])):S("",!0),!d.value&&!re()?(i(),p("div",uc,[n("div",dc,[n("div",pc,h(r(g).data.title),1),r(g).data.qbyquestion&&!z.value?(i(),R(r(ne),{key:0,onClick:ke,class:"mt-2"},{default:N(()=>L[1]||(L[1]=[n("span",null,h("Start"),-1)])),_:1})):z.value?z.value&&((_=(ze=r(Q))==null?void 0:ze.data)!=null&&_.name)?(i(),p("div",hc,[A(Ml,{submission:r(Q).data.name},null,8,["submission"])])):(i(),p("div",mc,h("You have already submitted this exam. As soon as it is graded, you will see the feedback here."))):(i(),R(r(ne),{key:1,onClick:J,class:"mt-2"},{default:N(()=>L[2]||(L[2]=[n("span",null,h("Start Exam"),-1)])),_:1}))])])):S("",!0),d.value||re()?(i(),p("div",fc,[n("div",gc,[n("div",vc,h(r(g).data.title),1),re()?(i(),R(ie,{key:0,to:{name:"ExamForm",params:{examID:r(g).data.name}},class:"flex items-center text-gray-400 mb-3 mr-4 hover:text-gray-600"},{default:N(()=>[A(r(ai),{class:"w-5 h-5 mr-2"}),L[3]||(L[3]=n("span",{class:"tooltip","data-tooltip":"Edit this exam"},"Edit",-1))]),_:1},8,["to"])):S("",!0),(i(!0),p(he,null,we(r(g).data.questions,(m,Y)=>(i(),p("div",{key:m.name,class:"relative border rounded-md p-5 mb-4"},[n("div",_c,h(Y+1),1),n("div",yc,h(m.points)+" "+h(m.points===1?"Point":"Points"),1),n("div",bc,[n("div",{innerHTML:m.question_detail||"No question detail provided."},null,8,wc)]),n("div",xc,[Se(n("textarea",{"onUpdate:modelValue":G=>l.value[m.name]=G,class:"border rounded-md p-2 w-full",placeholder:"Type your answer here",onChange:G=>D(m.name,G)},null,40,kc),[[lt,l.value[m.name]]])])]))),128)),n("div",$c,[A(r(ne),{onClick:xe},{default:N(()=>L[4]||(L[4]=[n("span",null,h("Submit Your Exam"),-1)])),_:1})])])])):S("",!0)])):S("",!0)}}},Cc={key:1,class:"border rounded-md text-center py-20"},Ec={__name:"ExamBlock",props:{exam:{type:String,required:!0}},setup(e){const t=Oe("$user"),s=()=>{window.location.href="/login"};return(o,c)=>r(t).data?(i(),R(Mc,{key:0,examName:e.exam},null,8,["examName"])):(i(),p("div",Cc,[n("div",null,h(o.__("Please login to access the exam.")),1),A(r(ne),{onClick:c[0]||(c[0]=l=>s()),class:"mt-2"},{default:N(()=>[n("span",null,h(o.__("Login")),1)]),_:1})]))}};class Sc{constructor({data:t,api:s,readOnly:o}){this.data=t,this.readOnly=o}static get toolbox(){const t=fe({render:()=>Pe(_n,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:__("Exam"),icon:s.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderExam(this.data.exam):this.renderExamModal(),this.wrapper}renderExam(t){if(this.readOnly){const s=fe(Ec,{exam:t});s.use(Ae),s.use(Ne);const{userResource:o}=xt();s.provide("$user",o),s.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Exam: ${t}
            </span>
        </div>`}renderExamModal(){if(this.readOnly)return;const t=fe($t,{type:"exam",onAddition:s=>{this.data.exam=s,this.renderExam(s)}});t.use(Ae),t.use(Ne),t.mount(this.wrapper)}save(t){return{exam:this.data.exam}}}const Ac=["src"],Tc={class:"flex items-center space-x-2 shadow rounded-lg p-1 w-1/2"},Hc=["max"],Rc={class:"text-xs text-ink-gray-9 font-medium"},zc={__name:"AudioBlock",props:{file:{type:String,required:!0}},setup(e){const t=I(!1),s=I(null);let o=I(!1),c=I(0),l=I(0);He(()=>{setTimeout(()=>{s.value=document.querySelector("audio"),s.value.onloadedmetadata=()=>{l.value=s.value.duration},s.value.ontimeupdate=()=>{c.value=s.value.currentTime}},0)});const d=()=>{s.value.paused?(s.value.play(),t.value=!0):(s.value.pause(),t.value=!1)},a=()=>{s.value.muted=!s.value.muted,o.value=s.value.muted},u=()=>{s.value.currentTime=c.value},f=()=>{t.value=!1},g=V=>{const z=Math.floor(V/60),w=Math.floor(V%60);return`${z}:${w<10?"0":""}${w}`};return me(t,V=>{V?s.value.play():s.value.pause()}),(V,z)=>(i(),p("div",null,[n("audio",{onEnded:f,controlsList:"nodownload",class:"mb-4"},[n("source",{src:encodeURI(e.file),type:"audio/mp3"},null,8,Ac)],32),n("div",Tc,[A(r(ne),{variant:"ghost",onClick:d},{icon:N(()=>[t.value?(i(),R(r(Yt),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(i(),R(r(Zt),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),Se(n("input",{type:"range",min:"0",max:r(l),step:"0.1","onUpdate:modelValue":z[0]||(z[0]=w=>kt(c)?c.value=w:c=w),onInput:u,class:"duration-slider w-full h-1"},null,40,Hc),[[lt,r(c)]]),n("span",Rc,h(g(r(c)))+" / "+h(g(r(l))),1),A(r(ne),{variant:"ghost",onClick:a},{icon:N(()=>[r(o)?(i(),R(r(ts),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(i(),R(r(es),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1})])]))}},Lc=["src","type"],Ic={class:"flex items-center space-x-2 bg-surface-gray-3 rounded-md p-0.5 absolute bottom-3 w-[98%] left-0 right-0 mx-auto invisible group-hover:visible"},Nc=["max"],Oc={class:"text-xs font-medium"},Bc={__name:"VideoBlock",props:{file:{type:String,required:!0},type:{type:String,default:"video/mp4"}},setup(e){const t=I(null),s=I(null);let o=I(!1),c=I(0),l=I(0),d=I(!1);const a=e;He(()=>{setTimeout(()=>{t.value.onloadedmetadata=()=>{l.value=t.value.duration},t.value.ontimeupdate=()=>{c.value=t.value.currentTime}},0)});const u=$e(()=>{if(f){let M=a.file;return M.includes("watch?v=")&&(M=M.replace("watch?v=","embed/")),`${M}?autoplay=0&controls=0&disablekb=1&playsinline=1&cc_load_policy=1&cc_lang_pref=auto`}return a.file}),f=$e(()=>a.type=="video/youtube"),g=()=>{t.value.play(),o.value=!0},V=()=>{t.value.pause(),o.value=!1},z=()=>{o.value?V():g()},w=()=>{o.value=!1},re=()=>{t.value.muted=!t.value.muted,d.value=t.value.muted},y=()=>{t.value.currentTime=c.value},W=M=>{const b=Math.floor(M/60),D=Math.floor(M%60);return`${b}:${D<10?"0":""}${D}`},U=()=>{document.fullscreenElement?document.exitFullscreen():s.value.requestFullscreen()};return(M,b)=>(i(),p("div",{ref_key:"videoContainer",ref:s,class:"video-block group relative"},[n("video",{onTimeupdate:b[0]||(b[0]=(...D)=>M.updateTime&&M.updateTime(...D)),onEnded:w,onClick:z,oncontextmenu:"return false",class:"rounded-lg border border-gray-100 group cursor-pointer",ref_key:"videoRef",ref:t},[n("source",{src:u.value,type:e.type},null,8,Lc)],544),n("div",Ic,[A(r(ne),{variant:"ghost"},{icon:N(()=>[r(o)?(i(),R(r(Yt),{key:1,onClick:V,class:"w-4 h-4 text-ink-gray-9"})):(i(),R(r(Zt),{key:0,onClick:g,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),A(r(ne),{variant:"ghost",onClick:re},{icon:N(()=>[r(d)?(i(),R(r(ts),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(i(),R(r(es),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),Se(n("input",{type:"range",min:"0",max:r(l),step:"0.1","onUpdate:modelValue":b[1]||(b[1]=D=>kt(c)?c.value=D:c=D),onInput:y,class:"duration-slider w-full h-1"},null,40,Nc),[[lt,r(c)]]),n("span",Oc,h(W(r(c)))+" / "+h(W(r(l))),1),A(r(ne),{variant:"ghost",onClick:U},{icon:N(()=>[A(r(ri),{class:"w-4 h-4 text-ink-gray-9"})]),_:1})])],512))}},Dc=j(Bc,[["__scopeId","data-v-edd7c5f4"]]),Fc={__name:"UploadPlugin",props:{onFileUploaded:{type:Function,required:!0}},emits:["fileUploaded"],setup(e,{emit:t}){const s=I(null),o=e;He(()=>ue(this,null,function*(){yield qt();const d=s.value.$el.querySelector('input[type="file"]');d&&d.click()}));const c=d=>{o.onFileUploaded({file_url:d.file_url,file_type:d.file_type})},l=d=>{let a=d.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png","mp4","mov","mp3","pdf"].includes(a))return"Only image and video files are allowed."};return(d,a)=>(i(),R(r(Kt),{fileTypes:["image/*","video/*","audio/*",".pdf"],validateFile:l,onSuccess:a[0]||(a[0]=u=>c(u)),ref_key:"fileUploader",ref:s,class:"hide"},null,512))}};class Pc{constructor({data:t,api:s,readOnly:o}){this.data=t,this.readOnly=o}static get toolbox(){const t=fe({render:()=>Pe(ci,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:"Upload",icon:s.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),this.data&&this.data.file_url?this.renderFile(this.data):this.renderFileUploader(),this.wrapper}renderFile(t){if(this.isVideo(t.file_type)){fe(Dc,{file:t.file_url}).mount(this.wrapper);return}else if(this.isAudio(t.file_type)){fe(zc,{file:t.file_url}).mount(this.wrapper);return}else if(t.file_type=="PDF"){this.wrapper.innerHTML=`<iframe src="https://docs.google.com/viewer?url=${window.location.origin}${encodeURI(t.file_url)}&embedded=true" width='100%' height='700px' class="mb-4" type="application/pdf"></iframe>`;return}else{this.wrapper.innerHTML=`<img class="mb-4" src=${encodeURI(t.file_url)} width='100%'>`;return}}renderFileUploader(){const t=fe(Fc,{onFileUploaded:s=>{this.data.file_url=s.file_url,this.data.file_type=s.file_type,this.renderFile(s)}});t.use(Ae),t.mount(this.wrapper)}validate(t){return!(!t.file_url||!t.file_type)}save(t){return{file_url:this.data.file_url,file_type:this.data.file_type}}isVideo(t){return["mov","mp4","avi","mkv","webm"].includes(t.toLowerCase())}isAudio(t){return["mp3","wav","ogg"].includes(t.toLowerCase())}}class Uc{constructor({data:t,api:s,readOnly:o,config:c}){this.api=s,this.data=t||{},this.config=c||{},this.text=t.text||"",this.readOnly=o}static get isReadOnlySupported(){return!0}static get conversionConfig(){return{export:"text",import:"text"}}static get toolbox(){const t=fe({render:()=>Pe(ei,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:"",icon:s.innerHTML}}onPaste(t){const s={text:t.detail.data.innerHTML};this.data=s,window.requestAnimationFrame(()=>{this.wrapper&&(this.wrapper.innerHTML=this.data.text||"")})}static get pasteConfig(){return{tags:["P"]}}render(){return this.wrapper=document.createElement("div"),this.wrapper.classList.add("cdx-block","ce-paragraph"),this.wrapper.innerHTML=this.text,this.readOnly||(this.wrapper.contentEditable=!0,this.wrapper.innerHTML=this.text,this.wrapper.addEventListener("input",t=>{let s=t.target.textContent;t.keyCode===32&&s.startsWith("#")?this.convertToHeader(t,s):t.keyCode==189?this.convertBlock("list",{style:"unordered"}):/^[a-zA-Z]/.test(t.key)?this.convertBlock("paragraph",{text:s}):(t.keyCode===13||t.keyCode===190)&&this.parseContent(t)})),this.wrapper}convertToHeader(t,s){if(t.preventDefault(),["#","##","###","####","#####","######"].includes(s)){let o=s.length;t.target.textContent="",this.convertBlock("header",{level:o})}}parseContent(t){t.preventDefault();let s=this.wrapper.textContent;if(t.keyCode===190&&(s=s+"."),s&&this.hasImage(s))this.wrapper.textContent="",this.convertBlock("image");else if(s&&this.hasLink(s)){const{text:o,url:c}=this.extractLink(s),l=`<a href="${c}" target="_blank">${o}</a>`;this.convertBlock("paragraph",{text:s.replace(/\[.+?\]\(.+?\)/,l)})}else s&&s.startsWith("- ")?this.convertBlock("list",{style:"unordered",items:[{content:s.replace("- ","")}]}):s&&s.startsWith("1.")?this.convertBlock("list",{style:"ordered",items:[{content:s.replace("1.","")}]}):s&&this.canBeEmbed(s)?(this.wrapper.textContent="",this.convertBlock("embed",{source:s})):this.convertBlock("paragraph",{text:s})}convertBlock(t,s,o=null){return ue(this,null,function*(){const c=this.api.blocks.getCurrentBlockIndex(),l=this.api.blocks.getBlockByIndex(c);yield this.api.blocks.convert(l.id,t,s),this.api.caret.focus(!0)})}save(t){return{text:t.innerHTML}}hasImage(t){return/!\[.+?\]\(.+?\)/.test(t)}extractImage(t){const s=t.match(/!\[(.+?)\]\((.+?)\)/);return s?{alt:s[1],url:s[2]}:{alt:"",url:""}}hasLink(t){return/\[.+?\]\(.+?\)/.test(t)}extractLink(t){const s=t.match(/\[(.+?)\]\((.+?)\)/);return s?{text:s[1],url:s[2]}:{text:"",url:""}}canBeEmbed(t){return/^https?:\/\/.+/.test(t.trim())}}function os(e){return e instanceof Map?e.clear=e.delete=e.set=function(){throw new Error("map is read-only")}:e instanceof Set&&(e.add=e.clear=e.delete=function(){throw new Error("set is read-only")}),Object.freeze(e),Object.getOwnPropertyNames(e).forEach(t=>{const s=e[t],o=typeof s;(o==="object"||o==="function")&&!Object.isFrozen(s)&&os(s)}),e}class Nt{constructor(t){t.data===void 0&&(t.data={}),this.data=t.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function rs(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function Le(e,...t){const s=Object.create(null);for(const o in e)s[o]=e[o];return t.forEach(function(o){for(const c in o)s[c]=o[c]}),s}const Vc="</span>",Ot=e=>!!e.scope,qc=(e,{prefix:t})=>{if(e.startsWith("language:"))return e.replace("language:","language-");if(e.includes(".")){const s=e.split(".");return[`${t}${s.shift()}`,...s.map((o,c)=>`${o}${"_".repeat(c+1)}`)].join(" ")}return`${t}${e}`};class jc{constructor(t,s){this.buffer="",this.classPrefix=s.classPrefix,t.walk(this)}addText(t){this.buffer+=rs(t)}openNode(t){if(!Ot(t))return;const s=qc(t.scope,{prefix:this.classPrefix});this.span(s)}closeNode(t){Ot(t)&&(this.buffer+=Vc)}value(){return this.buffer}span(t){this.buffer+=`<span class="${t}">`}}const Bt=(e={})=>{const t={children:[]};return Object.assign(t,e),t};class Mt{constructor(){this.rootNode=Bt(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(t){this.top.children.push(t)}openNode(t){const s=Bt({scope:t});this.add(s),this.stack.push(s)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(t){return this.constructor._walk(t,this.rootNode)}static _walk(t,s){return typeof s=="string"?t.addText(s):s.children&&(t.openNode(s),s.children.forEach(o=>this._walk(t,o)),t.closeNode(s)),t}static _collapse(t){typeof t!="string"&&t.children&&(t.children.every(s=>typeof s=="string")?t.children=[t.children.join("")]:t.children.forEach(s=>{Mt._collapse(s)}))}}class Gc extends Mt{constructor(t){super(),this.options=t}addText(t){t!==""&&this.add(t)}startScope(t){this.openNode(t)}endScope(){this.closeNode()}__addSublanguage(t,s){const o=t.root;s&&(o.scope=`language:${s}`),this.add(o)}toHTML(){return new jc(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function Ye(e){return e?typeof e=="string"?e:e.source:null}function is(e){return Ue("(?=",e,")")}function Wc(e){return Ue("(?:",e,")*")}function Qc(e){return Ue("(?:",e,")?")}function Ue(...e){return e.map(s=>Ye(s)).join("")}function Jc(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function Ct(...e){return"("+(Jc(e).capture?"":"?:")+e.map(o=>Ye(o)).join("|")+")"}function as(e){return new RegExp(e.toString()+"|").exec("").length-1}function Kc(e,t){const s=e&&e.exec(t);return s&&s.index===0}const Xc=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function Et(e,{joinWith:t}){let s=0;return e.map(o=>{s+=1;const c=s;let l=Ye(o),d="";for(;l.length>0;){const a=Xc.exec(l);if(!a){d+=l;break}d+=l.substring(0,a.index),l=l.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?d+="\\"+String(Number(a[1])+c):(d+=a[0],a[0]==="("&&s++)}return d}).map(o=>`(${o})`).join(t)}const Yc=/\b\B/,ls="[a-zA-Z]\\w*",St="[a-zA-Z_]\\w*",cs="\\b\\d+(\\.\\d+)?",us="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",ds="\\b(0b[01]+)",Zc="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",eu=(e={})=>{const t=/^#![ ]*\//;return e.binary&&(e.begin=Ue(t,/.*\b/,e.binary,/\b.*/)),Le({scope:"meta",begin:t,end:/$/,relevance:0,"on:begin":(s,o)=>{s.index!==0&&o.ignoreMatch()}},e)},Ze={begin:"\\\\[\\s\\S]",relevance:0},tu={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Ze]},su={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Ze]},nu={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},ut=function(e,t,s={}){const o=Le({scope:"comment",begin:e,end:t,contains:[]},s);o.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const c=Ct("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return o.contains.push({begin:Ue(/[ ]+/,"(",c,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),o},ou=ut("//","$"),ru=ut("/\\*","\\*/"),iu=ut("#","$"),au={scope:"number",begin:cs,relevance:0},lu={scope:"number",begin:us,relevance:0},cu={scope:"number",begin:ds,relevance:0},uu={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Ze,{begin:/\[/,end:/\]/,relevance:0,contains:[Ze]}]},du={scope:"title",begin:ls,relevance:0},pu={scope:"title",begin:St,relevance:0},hu={begin:"\\.\\s*"+St,relevance:0},mu=function(e){return Object.assign(e,{"on:begin":(t,s)=>{s.data._beginMatch=t[1]},"on:end":(t,s)=>{s.data._beginMatch!==t[1]&&s.ignoreMatch()}})};var ot=Object.freeze({__proto__:null,APOS_STRING_MODE:tu,BACKSLASH_ESCAPE:Ze,BINARY_NUMBER_MODE:cu,BINARY_NUMBER_RE:ds,COMMENT:ut,C_BLOCK_COMMENT_MODE:ru,C_LINE_COMMENT_MODE:ou,C_NUMBER_MODE:lu,C_NUMBER_RE:us,END_SAME_AS_BEGIN:mu,HASH_COMMENT_MODE:iu,IDENT_RE:ls,MATCH_NOTHING_RE:Yc,METHOD_GUARD:hu,NUMBER_MODE:au,NUMBER_RE:cs,PHRASAL_WORDS_MODE:nu,QUOTE_STRING_MODE:su,REGEXP_MODE:uu,RE_STARTERS_RE:Zc,SHEBANG:eu,TITLE_MODE:du,UNDERSCORE_IDENT_RE:St,UNDERSCORE_TITLE_MODE:pu});function fu(e,t){e.input[e.index-1]==="."&&t.ignoreMatch()}function gu(e,t){e.className!==void 0&&(e.scope=e.className,delete e.className)}function vu(e,t){t&&e.beginKeywords&&(e.begin="\\b("+e.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",e.__beforeBegin=fu,e.keywords=e.keywords||e.beginKeywords,delete e.beginKeywords,e.relevance===void 0&&(e.relevance=0))}function _u(e,t){Array.isArray(e.illegal)&&(e.illegal=Ct(...e.illegal))}function yu(e,t){if(e.match){if(e.begin||e.end)throw new Error("begin & end are not supported with match");e.begin=e.match,delete e.match}}function bu(e,t){e.relevance===void 0&&(e.relevance=1)}const wu=(e,t)=>{if(!e.beforeMatch)return;if(e.starts)throw new Error("beforeMatch cannot be used with starts");const s=Object.assign({},e);Object.keys(e).forEach(o=>{delete e[o]}),e.keywords=s.keywords,e.begin=Ue(s.beforeMatch,is(s.begin)),e.starts={relevance:0,contains:[Object.assign(s,{endsParent:!0})]},e.relevance=0,delete s.beforeMatch},xu=["of","and","for","in","not","or","if","then","parent","list","value"],ku="keyword";function ps(e,t,s=ku){const o=Object.create(null);return typeof e=="string"?c(s,e.split(" ")):Array.isArray(e)?c(s,e):Object.keys(e).forEach(function(l){Object.assign(o,ps(e[l],t,l))}),o;function c(l,d){t&&(d=d.map(a=>a.toLowerCase())),d.forEach(function(a){const u=a.split("|");o[u[0]]=[l,$u(u[0],u[1])]})}}function $u(e,t){return t?Number(t):Mu(e)?0:1}function Mu(e){return xu.includes(e.toLowerCase())}const Dt={},Fe=e=>{console.error(e)},Ft=(e,...t)=>{console.log(`WARN: ${e}`,...t)},Ve=(e,t)=>{Dt[`${e}/${t}`]||(console.log(`Deprecated as of ${e}. ${t}`),Dt[`${e}/${t}`]=!0)},at=new Error;function hs(e,t,{key:s}){let o=0;const c=e[s],l={},d={};for(let a=1;a<=t.length;a++)d[a+o]=c[a],l[a+o]=!0,o+=as(t[a-1]);e[s]=d,e[s]._emit=l,e[s]._multi=!0}function Cu(e){if(Array.isArray(e.begin)){if(e.skip||e.excludeBegin||e.returnBegin)throw Fe("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),at;if(typeof e.beginScope!="object"||e.beginScope===null)throw Fe("beginScope must be object"),at;hs(e,e.begin,{key:"beginScope"}),e.begin=Et(e.begin,{joinWith:""})}}function Eu(e){if(Array.isArray(e.end)){if(e.skip||e.excludeEnd||e.returnEnd)throw Fe("skip, excludeEnd, returnEnd not compatible with endScope: {}"),at;if(typeof e.endScope!="object"||e.endScope===null)throw Fe("endScope must be object"),at;hs(e,e.end,{key:"endScope"}),e.end=Et(e.end,{joinWith:""})}}function Su(e){e.scope&&typeof e.scope=="object"&&e.scope!==null&&(e.beginScope=e.scope,delete e.scope)}function Au(e){Su(e),typeof e.beginScope=="string"&&(e.beginScope={_wrap:e.beginScope}),typeof e.endScope=="string"&&(e.endScope={_wrap:e.endScope}),Cu(e),Eu(e)}function Tu(e){function t(d,a){return new RegExp(Ye(d),"m"+(e.case_insensitive?"i":"")+(e.unicodeRegex?"u":"")+(a?"g":""))}class s{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,u){u.position=this.position++,this.matchIndexes[this.matchAt]=u,this.regexes.push([u,a]),this.matchAt+=as(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(u=>u[1]);this.matcherRe=t(Et(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const u=this.matcherRe.exec(a);if(!u)return null;const f=u.findIndex((V,z)=>z>0&&V!==void 0),g=this.matchIndexes[f];return u.splice(0,f),Object.assign(u,g)}}class o{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const u=new s;return this.rules.slice(a).forEach(([f,g])=>u.addRule(f,g)),u.compile(),this.multiRegexes[a]=u,u}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,u){this.rules.push([a,u]),u.type==="begin"&&this.count++}exec(a){const u=this.getMatcher(this.regexIndex);u.lastIndex=this.lastIndex;let f=u.exec(a);if(this.resumingScanAtSamePosition()&&!(f&&f.index===this.lastIndex)){const g=this.getMatcher(0);g.lastIndex=this.lastIndex+1,f=g.exec(a)}return f&&(this.regexIndex+=f.position+1,this.regexIndex===this.count&&this.considerAll()),f}}function c(d){const a=new o;return d.contains.forEach(u=>a.addRule(u.begin,{rule:u,type:"begin"})),d.terminatorEnd&&a.addRule(d.terminatorEnd,{type:"end"}),d.illegal&&a.addRule(d.illegal,{type:"illegal"}),a}function l(d,a){const u=d;if(d.isCompiled)return u;[gu,yu,Au,wu].forEach(g=>g(d,a)),e.compilerExtensions.forEach(g=>g(d,a)),d.__beforeBegin=null,[vu,_u,bu].forEach(g=>g(d,a)),d.isCompiled=!0;let f=null;return typeof d.keywords=="object"&&d.keywords.$pattern&&(d.keywords=Object.assign({},d.keywords),f=d.keywords.$pattern,delete d.keywords.$pattern),f=f||/\w+/,d.keywords&&(d.keywords=ps(d.keywords,e.case_insensitive)),u.keywordPatternRe=t(f,!0),a&&(d.begin||(d.begin=/\B|\b/),u.beginRe=t(u.begin),!d.end&&!d.endsWithParent&&(d.end=/\B|\b/),d.end&&(u.endRe=t(u.end)),u.terminatorEnd=Ye(u.end)||"",d.endsWithParent&&a.terminatorEnd&&(u.terminatorEnd+=(d.end?"|":"")+a.terminatorEnd)),d.illegal&&(u.illegalRe=t(d.illegal)),d.contains||(d.contains=[]),d.contains=[].concat(...d.contains.map(function(g){return Hu(g==="self"?d:g)})),d.contains.forEach(function(g){l(g,u)}),d.starts&&l(d.starts,a),u.matcher=c(u),u}if(e.compilerExtensions||(e.compilerExtensions=[]),e.contains&&e.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return e.classNameAliases=Le(e.classNameAliases||{}),l(e)}function ms(e){return e?e.endsWithParent||ms(e.starts):!1}function Hu(e){return e.variants&&!e.cachedVariants&&(e.cachedVariants=e.variants.map(function(t){return Le(e,{variants:null},t)})),e.cachedVariants?e.cachedVariants:ms(e)?Le(e,{starts:e.starts?Le(e.starts):null}):Object.isFrozen(e)?Le(e):e}var Ru="11.11.1";class zu extends Error{constructor(t,s){super(t),this.name="HTMLInjectionError",this.html=s}}const vt=rs,Pt=Le,Ut=Symbol("nomatch"),Lu=7,fs=function(e){const t=Object.create(null),s=Object.create(null),o=[];let c=!0;const l="Could not find the language '{}', did you forget to load/include a language module?",d={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:Gc};function u(v){return a.noHighlightRe.test(v)}function f(v){let C=v.className+" ";C+=v.parentNode?v.parentNode.className:"";const O=a.languageDetectRe.exec(C);if(O){const q=J(O[1]);return q||(Ft(l.replace("{}",O[1])),Ft("Falling back to no-highlight mode for this block.",v)),q?O[1]:"no-highlight"}return C.split(/\s+/).find(q=>u(q)||J(q))}function g(v,C,O){let q="",te="";typeof C=="object"?(q=v,O=C.ignoreIllegals,te=C.language):(Ve("10.7.0","highlight(lang, code, ...args) has been deprecated."),Ve("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),te=v,q=C),O===void 0&&(O=!0);const ae={code:q,language:te};L("before:highlight",ae);const ge=ae.result?ae.result:V(ae.language,ae.code,O);return ge.code=ae.code,L("after:highlight",ge),ge}function V(v,C,O,q){const te=Object.create(null);function ae($,E){return $.keywords[E]}function ge(){if(!H.keywords){_e.addText(se);return}let $=0;H.keywordPatternRe.lastIndex=0;let E=H.keywordPatternRe.exec(se),P="";for(;E;){P+=se.substring($,E.index);const Z=B.case_insensitive?E[0].toLowerCase():E[0],be=ae(H,Z);if(be){const[Ee,_s]=be;if(_e.addText(P),P="",te[Z]=(te[Z]||0)+1,te[Z]<=Lu&&(tt+=_s),Ee.startsWith("_"))P+=E[0];else{const ys=B.classNameAliases[Ee]||Ee;ve(E[0],ys)}}else P+=E[0];$=H.keywordPatternRe.lastIndex,E=H.keywordPatternRe.exec(se)}P+=se.substring($),_e.addText(P)}function K(){if(se==="")return;let $=null;if(typeof H.subLanguage=="string"){if(!t[H.subLanguage]){_e.addText(se);return}$=V(H.subLanguage,se,!0,et[H.subLanguage]),et[H.subLanguage]=$._top}else $=w(se,H.subLanguage.length?H.subLanguage:null);H.relevance>0&&(tt+=$.relevance),_e.__addSublanguage($._emitter,$.language)}function le(){H.subLanguage!=null?K():ge(),se=""}function ve($,E){$!==""&&(_e.startScope(E),_e.addText($),_e.endScope())}function Be($,E){let P=1;const Z=E.length-1;for(;P<=Z;){if(!$._emit[P]){P++;continue}const be=B.classNameAliases[$[P]]||$[P],Ee=E[P];be?ve(Ee,be):(se=Ee,ge(),se=""),P++}}function Re($,E){return $.scope&&typeof $.scope=="string"&&_e.openNode(B.classNameAliases[$.scope]||$.scope),$.beginScope&&($.beginScope._wrap?(ve(se,B.classNameAliases[$.beginScope._wrap]||$.beginScope._wrap),se=""):$.beginScope._multi&&(Be($.beginScope,E),se="")),H=Object.create($,{parent:{value:H}}),H}function ze($,E,P){let Z=Kc($.endRe,P);if(Z){if($["on:end"]){const be=new Nt($);$["on:end"](E,be),be.isMatchIgnored&&(Z=!1)}if(Z){for(;$.endsParent&&$.parent;)$=$.parent;return $}}if($.endsWithParent)return ze($.parent,E,P)}function _($){return H.matcher.regexIndex===0?(se+=$[0],1):(ht=!0,0)}function m($){const E=$[0],P=$.rule,Z=new Nt(P),be=[P.__beforeBegin,P["on:begin"]];for(const Ee of be)if(Ee&&(Ee($,Z),Z.isMatchIgnored))return _(E);return P.skip?se+=E:(P.excludeBegin&&(se+=E),le(),!P.returnBegin&&!P.excludeBegin&&(se=E)),Re(P,$),P.returnBegin?0:E.length}function Y($){const E=$[0],P=C.substring($.index),Z=ze(H,$,P);if(!Z)return Ut;const be=H;H.endScope&&H.endScope._wrap?(le(),ve(E,H.endScope._wrap)):H.endScope&&H.endScope._multi?(le(),Be(H.endScope,$)):be.skip?se+=E:(be.returnEnd||be.excludeEnd||(se+=E),le(),be.excludeEnd&&(se=E));do H.scope&&_e.closeNode(),!H.skip&&!H.subLanguage&&(tt+=H.relevance),H=H.parent;while(H!==Z.parent);return Z.starts&&Re(Z.starts,$),be.returnEnd?0:E.length}function G(){const $=[];for(let E=H;E!==B;E=E.parent)E.scope&&$.unshift(E.scope);$.forEach(E=>_e.openNode(E))}let oe={};function ye($,E){const P=E&&E[0];if(se+=$,P==null)return le(),0;if(oe.type==="begin"&&E.type==="end"&&oe.index===E.index&&P===""){if(se+=C.slice(E.index,E.index+1),!c){const Z=new Error(`0 width match regex (${v})`);throw Z.languageName=v,Z.badRule=oe.rule,Z}return 1}if(oe=E,E.type==="begin")return m(E);if(E.type==="illegal"&&!O){const Z=new Error('Illegal lexeme "'+P+'" for mode "'+(H.scope||"<unnamed>")+'"');throw Z.mode=H,Z}else if(E.type==="end"){const Z=Y(E);if(Z!==Ut)return Z}if(E.type==="illegal"&&P==="")return se+=`
`,1;if(pt>1e5&&pt>E.index*3)throw new Error("potential infinite loop, way more iterations than matches");return se+=P,P.length}const B=J(v);if(!B)throw Fe(l.replace("{}",v)),new Error('Unknown language: "'+v+'"');const pe=Tu(B);let X="",H=q||pe;const et={},_e=new a.__emitter(a);G();let se="",tt=0,De=0,pt=0,ht=!1;try{if(B.__emitTokens)B.__emitTokens(C,_e);else{for(H.matcher.considerAll();;){pt++,ht?ht=!1:H.matcher.considerAll(),H.matcher.lastIndex=De;const $=H.matcher.exec(C);if(!$)break;const E=C.substring(De,$.index),P=ye(E,$);De=$.index+P}ye(C.substring(De))}return _e.finalize(),X=_e.toHTML(),{language:v,value:X,relevance:tt,illegal:!1,_emitter:_e,_top:H}}catch($){if($.message&&$.message.includes("Illegal"))return{language:v,value:vt(C),illegal:!0,relevance:0,_illegalBy:{message:$.message,index:De,context:C.slice(De-100,De+100),mode:$.mode,resultSoFar:X},_emitter:_e};if(c)return{language:v,value:vt(C),illegal:!1,relevance:0,errorRaised:$,_emitter:_e,_top:H};throw $}}function z(v){const C={value:vt(v),illegal:!1,relevance:0,_top:d,_emitter:new a.__emitter(a)};return C._emitter.addText(v),C}function w(v,C){C=C||a.languages||Object.keys(t);const O=z(v),q=C.filter(J).filter(ce).map(le=>V(le,v,!1));q.unshift(O);const te=q.sort((le,ve)=>{if(le.relevance!==ve.relevance)return ve.relevance-le.relevance;if(le.language&&ve.language){if(J(le.language).supersetOf===ve.language)return 1;if(J(ve.language).supersetOf===le.language)return-1}return 0}),[ae,ge]=te,K=ae;return K.secondBest=ge,K}function re(v,C,O){const q=C&&s[C]||O;v.classList.add("hljs"),v.classList.add(`language-${q}`)}function y(v){let C=null;const O=f(v);if(u(O))return;if(L("before:highlightElement",{el:v,language:O}),v.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",v);return}if(v.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(v)),a.throwUnescapedHTML))throw new zu("One of your code blocks includes unescaped HTML.",v.innerHTML);C=v;const q=C.textContent,te=O?g(q,{language:O,ignoreIllegals:!0}):w(q);v.innerHTML=te.value,v.dataset.highlighted="yes",re(v,O,te.language),v.result={language:te.language,re:te.relevance,relevance:te.relevance},te.secondBest&&(v.secondBest={language:te.secondBest.language,relevance:te.secondBest.relevance}),L("after:highlightElement",{el:v,result:te,text:q})}function W(v){a=Pt(a,v)}const U=()=>{D(),Ve("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function M(){D(),Ve("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let b=!1;function D(){function v(){D()}if(document.readyState==="loading"){b||window.addEventListener("DOMContentLoaded",v,!1),b=!0;return}document.querySelectorAll(a.cssSelector).forEach(y)}function F(v,C){let O=null;try{O=C(e)}catch(q){if(Fe("Language definition for '{}' could not be registered.".replace("{}",v)),c)Fe(q);else throw q;O=d}O.name||(O.name=v),t[v]=O,O.rawDefinition=C.bind(null,e),O.aliases&&Q(O.aliases,{languageName:v})}function xe(v){delete t[v];for(const C of Object.keys(s))s[C]===v&&delete s[C]}function ke(){return Object.keys(t)}function J(v){return v=(v||"").toLowerCase(),t[v]||t[s[v]]}function Q(v,{languageName:C}){typeof v=="string"&&(v=[v]),v.forEach(O=>{s[O.toLowerCase()]=C})}function ce(v){const C=J(v);return C&&!C.disableAutodetect}function k(v){v["before:highlightBlock"]&&!v["before:highlightElement"]&&(v["before:highlightElement"]=C=>{v["before:highlightBlock"](Object.assign({block:C.el},C))}),v["after:highlightBlock"]&&!v["after:highlightElement"]&&(v["after:highlightElement"]=C=>{v["after:highlightBlock"](Object.assign({block:C.el},C))})}function T(v){k(v),o.push(v)}function x(v){const C=o.indexOf(v);C!==-1&&o.splice(C,1)}function L(v,C){const O=v;o.forEach(function(q){q[O]&&q[O](C)})}function ie(v){return Ve("10.7.0","highlightBlock will be removed entirely in v12.0"),Ve("10.7.0","Please use highlightElement now."),y(v)}Object.assign(e,{highlight:g,highlightAuto:w,highlightAll:D,highlightElement:y,highlightBlock:ie,configure:W,initHighlighting:U,initHighlightingOnLoad:M,registerLanguage:F,unregisterLanguage:xe,listLanguages:ke,getLanguage:J,registerAliases:Q,autoDetection:ce,inherit:Pt,addPlugin:T,removePlugin:x}),e.debugMode=function(){c=!1},e.safeMode=function(){c=!0},e.versionString=Ru,e.regex={concat:Ue,lookahead:is,either:Ct,optional:Qc,anyNumberOfTimes:Wc};for(const v in ot)typeof ot[v]=="object"&&os(ot[v]);return Object.assign(e,ot),e},Ge=fs({});Ge.newInstance=()=>fs({});var Iu=Ge;Ge.HighlightJS=Ge;Ge.default=Ge;const Vt=nn(Iu),Nu=["light","dark"],Ou={none:"Auto-detect",apache:"Apache",bash:"Bash",cs:"C#",cpp:"C++",css:"CSS",coffeescript:"CoffeeScript",diff:"Diff",go:"Go",html:"HTML, XML",http:"HTTP",json:"JSON",java:"Java",javascript:"JavaScript",kotlin:"Kotlin",less:"Less",lua:"Lua",makefile:"Makefile",markdown:"Markdown",nginx:"Nginx",objectivec:"Objective-C",php:"PHP",perl:"Perl",properties:"Properties",python:"Python",ruby:"Ruby",rust:"Rust",scss:"SCSS",sql:"SQL",shell:"Shell Session",swift:"Swift",toml:"TOML, also INI",typescript:"TypeScript",yaml:"YAML",plaintext:"Plaintext"};class Bu{constructor({data:t,api:s,config:o,readOnly:c}){this.api=s,this.readOnly=c,this.config={themeName:o.themeName&&typeof o.themeName=="string"?o.themeName:"",themeURL:o.themeURL&&typeof o.themeURL=="string"?o.themeURL:"",useDefaultTheme:o.useDefaultTheme&&typeof o.useDefaultTheme=="string"&&Nu.includes(o.useDefaultTheme.toLowerCase())?o.useDefaultTheme:"dark"},this.data={code:t.code&&typeof t.code=="string"?t.code:"",language:t.language&&typeof t.language=="string"?t.language:"Auto-detect",theme:t.theme&&typeof t.theme=="string"?t.theme:this._getThemeURLFromConfig()},this.highlightScriptID="highlightJSScriptElement",this.highlightCSSID="highlightJSCSSElement",this.codeArea=document.createElement("div"),this.selectInput=document.createElement("input"),this.selectDropIcon=document.createElement("i"),this._injectHighlightJSCSSElement(),this.api.listeners.on(window,"click",this._closeAllLanguageSelects,!0)}static get isReadOnlySupported(){return!0}static get sanitize(){return{code:!0,language:!1,theme:!1}}static get toolbox(){const t=fe({render:()=>Pe(ti,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:"CodeBox",icon:s.innerHTML}}static get displayInToolbox(){return!0}static get enableLineBreaks(){return!0}render(){const t=document.createElement("pre"),s=this._createLanguageSelectElement();return t.setAttribute("class","codeBoxHolder"),this.codeArea.setAttribute("class",`codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`),this.codeArea.setAttribute("contenteditable","true"),this.codeArea.innerHTML=this.data.code,this.api.listeners.on(this.codeArea,"blur",o=>this._highlightCodeArea(o),!1),this.api.listeners.on(this.codeArea,"paste",o=>this._handleCodeAreaPaste(o),!1),t.appendChild(this.codeArea),!this.readOnly&&t.appendChild(s),t}save(t){return Object.assign(this.data,{code:this.codeArea.innerHTML,theme:this._getThemeURLFromConfig()})}validate(t){return!!t.code.trim()}destroy(){this.api.listeners.off(window,"click",this._closeAllLanguageSelects,!0),this.api.listeners.off(this.codeArea,"blur",t=>this._highlightCodeArea(t),!1),this.api.listeners.off(this.codeArea,"paste",t=>this._handleCodeAreaPaste(t),!1),this.api.listeners.off(this.selectInput,"click",t=>this._handleSelectInputClick(t),!1)}_createLanguageSelectElement(){const t=document.createElement("div"),s=document.createElement("div"),o=Object.entries(Ou);return t.setAttribute("class","codeBoxSelectDiv"),this.selectDropIcon.setAttribute("class",`codeBoxSelectDropIcon ${this.config.useDefaultTheme}`),this.selectDropIcon.innerHTML="&#8595;",this.selectInput.setAttribute("class",`codeBoxSelectInput ${this.config.useDefaultTheme}`),this.selectInput.setAttribute("type","text"),this.selectInput.setAttribute("readonly","true"),this.selectInput.value=this.data.language,this.api.listeners.on(this.selectInput,"click",c=>this._handleSelectInputClick(c),!1),s.setAttribute("class","codeBoxSelectPreview"),o.forEach(c=>{const l=document.createElement("p");l.setAttribute("class",`codeBoxSelectItem ${this.config.useDefaultTheme}`),l.setAttribute("data-key",c[0]),l.textContent=c[1],this.api.listeners.on(l,"click",d=>this._handleSelectItemClick(d,c),!1),s.appendChild(l)}),t.appendChild(this.selectDropIcon),t.appendChild(this.selectInput),t.appendChild(s),t}_highlightCodeArea(t){Vt.highlightBlock(this.codeArea)}_handleCodeAreaPaste(t){t.stopPropagation()}_handleSelectInputClick(t){t.target.nextSibling.classList.toggle("codeBoxShow")}_handleSelectItemClick(t,s){t.target.parentNode.parentNode.querySelector(".codeBoxSelectInput").value=s[1],t.target.parentNode.classList.remove("codeBoxShow"),this.codeArea.removeAttribute("class"),this.data.language=s[0],this.codeArea.setAttribute("class",`codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`),Vt.highlightElement(this.codeArea)}_closeAllLanguageSelects(){const t=document.querySelectorAll(".codeBoxSelectPreview");for(let s=0,o=t.length;s<o;s++)t[s].classList.remove("codeBoxShow")}_injectHighlightJSCSSElement(){const t=document.querySelector(`#${this.highlightCSSID}`);let s=this._getThemeURLFromConfig();if(t)t.setAttribute("href",s);else{const o=document.createElement("link"),c=document.querySelector("head");o.setAttribute("rel","stylesheet"),o.setAttribute("href",s),o.setAttribute("id",this.highlightCSSID),c&&c.appendChild(o)}}_getThemeURLFromConfig(){let t=`https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-${this.config.useDefaultTheme}.min.css`;return this.config.themeName&&(t=`https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/${this.config.themeName}.min.css`),this.config.themeURL&&(t=this.config.themeURL),t}}const Du={class:"Folder"},Fu={class:"ml-4"},Pu={key:0,class:"mt-4 mb-4"},Uu={key:1},Vu={key:2,class:"block mt-4"},qu={key:0,class:"mb-4"},ju=["href"],Gu={__name:"FolderPlugin",props:{onAddition:{type:Function,required:!1}},setup(e){const t=on(),s=I("select"),o=I(null),c=I(""),l=I(""),d=I([]),a=I([]),u=I(null),f=()=>ue(this,null,function*(){const U=t.params.courseName;if(console.log("Course Name: ",U),U){const b=yield ee({url:"frappe.client.get_value",makeParams(D){return{doctype:"Course Schedule",fieldname:"course",filters:{name:U}}}}).fetch();u.value=b.course,console.log("Fetched Course: ",u.value)}else return console.error("Course name not found in route params"),null}),g=e,V=()=>{if(c.value){const U=c.value;g.onAddition(U),console.log("Updating props",g.onAddition)}},z=()=>ue(this,null,function*(){if(u.value||f(),u.value){const M=yield ee({url:"frappe.client.get_list",makeParams(b){return{doctype:"Course Folder",filters:{course:u.value},fields:["name","foldername"]}}}).fetch();return a.value=M,console.log("Fetched Folders: ",a.value),a.value}}),w=()=>ue(this,null,function*(){if(!l.value)return alert("Folder name is required");const M=yield new gs({}).createCourseFolder(u.value,l.value);a.value.push(M),o.value=M.foldername,l.value=""}),re=()=>ue(this,null,function*(){if(c.value)try{console.log("Selected Folder (foldername): ",c.value);const M=yield ee({url:"seminary.api.folder_upload.get_files_in_folder",params:{foldername:c.value},auto:!0}).fetch();d.value=M,console.log("Fetched Files: ",d.value)}catch(U){console.error("Error fetching files:",U)}}),y=U=>ue(this,null,function*(){const M=U.target.files;if(console.log("Uploaded Files: ",M),!c.value)return alert("Please select a folder first.");try{console.log("Selected Folder (foldername): ",c.value);const b=new FormData;for(const F of M)b.append("files",F);b.append("foldername",c.value),console.log("Form Data:");for(const[F,xe]of b.entries())console.log(`${F}:`,xe);const D=yield fetch("/api/method/seminary.api.folder_upload.upload_folder",{method:"POST",body:b});if(!D.ok){const F=yield D.json();console.error("Error uploading files:",F),alert(`Error: ${F.message||"Failed to upload files."}`);return}console.log("Files uploaded successfully."),yield re()}catch(b){console.error("Error uploading files:",b),alert("An error occurred while uploading files.")}}),W=U=>ue(this,null,function*(){yield fetch("seminary.api.folder_upload.delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_url:U})}).then(M=>M.json()),yield re()});return me(o,U=>ue(this,null,function*(){if(U)try{const b=yield ee({url:"frappe.client.get_value",makeParams(D){return{doctype:"Course Folder",fieldname:"foldername",filters:{name:U}}}}).fetch();c.value=b.foldername,console.log("Updated foldername: ",c.value),yield V(),yield re()}catch(M){console.error("Error fetching foldername:",M)}else c.value=""})),He(()=>ue(this,null,function*(){yield f(),yield z()})),(U,M)=>(i(),p("div",Du,[M[7]||(M[7]=n("h3",null,"Manage Course Folders",-1)),n("div",null,[n("label",null,[Se(n("input",{type:"radio","onUpdate:modelValue":M[0]||(M[0]=b=>s.value=b),value:"select"},null,512),[[Rt,s.value]]),M[5]||(M[5]=Me(" Select Existing Folder "))]),n("label",Fu,[Se(n("input",{type:"radio","onUpdate:modelValue":M[1]||(M[1]=b=>s.value=b),value:"create"},null,512),[[Rt,s.value]]),M[6]||(M[6]=Me(" Create New Folder "))])]),s.value==="select"?(i(),p("div",Pu,[A(Je,{modelValue:o.value,"onUpdate:modelValue":M[2]||(M[2]=b=>o.value=b),doctype:"Course Folder",options:"foldername",label:U.__("Select a folder")},null,8,["modelValue","label"])])):S("",!0),s.value==="create"?(i(),p("div",Uu,[Se(n("input",{type:"text","onUpdate:modelValue":M[3]||(M[3]=b=>l.value=b),placeholder:"Enter folder name"},null,512),[[lt,l.value]]),A(Je,{modelValue:u.value,"onUpdate:modelValue":M[4]||(M[4]=b=>u.value=b),doctype:"Course",label:U.__("Select a course")},null,8,["modelValue","label"]),n("button",{onClick:w},"Create Folder")])):S("",!0),o.value?(i(),p("div",Vu,[n("h4",null,"Files in "+h(o.value),1),n("ul",null,[d.value?S("",!0):(i(),p("div",qu,"No files found in this folder.")),(i(!0),p(he,null,we(d.value,b=>(i(),p("li",{key:b.file_url,class:"flex items-center mb-4"},[n("a",{href:b.file_url,download:"",class:"flex-1"},h(b.file_name),9,ju),A(r(bt),{text:U.__("Delete File"),placement:"bottom"},{default:N(()=>[A(r(li),{onClick:rn(D=>W(b.file_url),["prevent"]),class:"ml-4 h-4 w-4 text-red-500"},null,8,["onClick"])]),_:2},1032,["text"])]))),128))]),n("input",{type:"file",multiple:"",onChange:y},null,32)])):S("",!0)]))}},Wu=j(Gu,[["__scopeId","data-v-84b7d54d"]]),Qu={class:"flex flex-col border-2 border-gray-200 rounded-lg p-4 mb-4"},Ju={key:0,class:"mb-4"},Ku=["href"],Xu={__name:"FolderBlock",props:{folder:{type:Object,required:!0}},setup(e){const t=I([]),s=e;console.log("folder",s.folder.folder),He(()=>{o()});const o=()=>ue(this,null,function*(){try{const l=yield ee({url:"seminary.api.folder_upload.get_files_in_folder",params:{foldername:s.folder.folder},auto:!0}).fetch();t.value=l,console.log("Fetched Files: ",t.value)}catch(c){console.error("Error fetching files:",c)}});return(c,l)=>(i(),p("div",Qu,[n("h4",null,"Files in "+h(s.folder.folder),1),n("ul",null,[t.value?S("",!0):(i(),p("div",Ju,"No files found in this folder.")),(i(!0),p(he,null,we(t.value,d=>(i(),p("li",{key:d.file_url,class:"flex items-center mb-4"},[n("a",{href:d.file_url,download:"",class:"flex-1"},h(d.file_name),9,Ku)]))),128))])]))}};class gs{constructor({data:t,api:s,readOnly:o}){this.data=t,this.readOnly=o,this.api=s,this.wrapper=void 0}static get toolbox(){const t=fe({render:()=>Pe(oi,{size:18,strokeWidth:1.5,color:"black"})}),s=document.createElement("div");return t.mount(s),{title:"Folder",icon:s.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),this.data&&this.data.folder?this.renderFolder(this.data):this.renderFolderModal(),this.wrapper}renderFolder(t){if(this.readOnly){const s=fe(Xu,{folder:t});s.use(Ae),s.use(Ne),s.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
              <span class="font-medium">
                  Folder: ${t}
              </span>
          </div>`}renderFolderModal(){if(this.readOnly)return;const t=fe(Wu,{onAddition:s=>{this.data.folder=s,this.renderFolder(s)}});t.use(Ae),t.use(Ne),t.mount(this.wrapper)}save(t){return{folder:this.data.folder}}}function At(e){an(We({position:"bottom-right"},e))}function dt(e){return ln(e).value}function ld(e){return e>999?(e/1e3).toFixed(1)+"k":e}function Yu(e){let t=parseInt(e);return t>1048576?(t/1048576).toFixed(2)+"M":t>1024?(t/1024).toFixed(2)+"K":t}function Ie(e,t,s,o=null){o||(s=="check"?o="bg-surface-green-3 text-ink-white rounded-md p-px":s=="alert-circle"?o="bg-yellow-600 text-ink-white rounded-md p-px":o="bg-surface-red-5 text-ink-white rounded-md p-px"),At({title:e,text:Zu(t),icon:s,iconClasses:o,position:s=="check"?"bottom-right":"top-center",timeout:5})}function cd(e){me(()=>e,t=>{if(t.value.title){if(t.value.title&&t.value.subtitle){document.title=`${t.value.title} | ${t.value.subtitle}`;return}if(t.value.title){document.title=`${t.value.title}`;return}}},{immediate:!0,deep:!0})}function Zu(e){const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function ud(){return{header:{class:dn,config:{placeholder:"Header"}},assignment:tl,quiz:ba,exam:Sc,upload:Pc,markdown:{class:Uc,inlineToolbar:!0},image:pn,table:{class:hn,inlineToolbar:!0},paragraph:{class:mn,inlineToolbar:!0,config:{preserveBlank:!0}},codeBox:{class:Bu,config:{themeURL:"https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-dark.min.css",themeName:"atom-one-dark",useDefaultTheme:"dark"}},list:{class:fn,inlineToolbar:!0,config:{defaultStyle:"ordered"}},inlineCode:{class:gn,shortcut:"CMD+SHIFT+M"},embed:{class:vn,inlineToolbar:!0,config:{services:{youtube:{regex:/(?:https?:\/\/)?(?:www\.)?(?:(?:youtu\.be\/)|(?:youtube\.com)\/(?:v\/|u\/\w\/|embed\/|watch))(?:(?:\?v=)?([^#&?=]*))?((?:[?&]\w*=\w*)*)/,embedUrl:"https://www.youtube.com/embed/<%= remote_id %>",html:'<iframe style="width:100%; height: 30rem;" frameborder="0" allowfullscreen></iframe>',height:320,width:580,id:([e,t])=>{if(!t&&e)return e;const s={start:"start",end:"end",t:"start",time_continue:"start",list:"list"};let o=t.slice(1).split("&").map(c=>{const[l,d]=c.split("=");return!e&&l==="v"?(e=d,null):!s[l]||d==="LL"||d.startsWith("RDMM")||d.startsWith("FL")?null:`${s[l]}=${d}`}).filter(c=>!!c);return e+"?"+o.join("&")}},vimeo:!0,codepen:!0,aparat:{regex:/(?:http[s]?:\/\/)?(?:www.)?aparat\.com\/v\/([^\/\?\&]+)\/?/,embedUrl:"https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame",html:'<iframe style="margin: 0 auto; width: 100%; height: 25rem;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:300,width:600},github:!0,slides:{regex:/https:\/\/docs\.google\.com\/presentation\/d\/([A-Za-z0-9_-]+)\/pub/,embedUrl:"https://docs.google.com/presentation/d/<%= remote_id %>/embed",html:"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0' frameborder='0' allowfullscreen='true'></iframe>"},drive:{regex:/https:\/\/drive\.google\.com\/file\/d\/([A-Za-z0-9_-]+)\/view(\?.+)?/,embedUrl:"https://drive.google.com/file/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 25rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},docsPublic:{regex:/https:\/\/docs\.google\.com\/document\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/document/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},sheetsPublic:{regex:/https:\/\/docs\.google\.com\/spreadsheets\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/spreadsheets/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},slidesPublic:{regex:/https:\/\/docs\.google\.com\/presentation\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/presentation/d/<%= remote_id %>/embed",html:"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0;' frameborder='0' allowfullscreen='true'></iframe>"},codesandbox:{regex:/^https:\/\/codesandbox\.io\/(?:embed\/)?([A-Za-z0-9_-]+)(?:\?[^\/]*)?$/,embedUrl:"https://codesandbox.io/embed/<%= remote_id %>?view=editor+%2B+preview&module=%2Findex.html",html:"<iframe style='width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;' sandbox='allow-mods allow-forms allow-popups allow-scripts allow-same-origin' frameborder='0' allowfullscreen='true'></iframe>"}}}},folder:{class:gs,config:{placeholder:"Add a folder with files",uploadEndpoint:"/api/upload-folder",renderFiles:e=>e.map(t=>`<a href="${t.url}" download>${t.name}</a>`).join("<br>")}}}}function vs(e){const t={ves:"fe",ies:"y",i:"us",zes:"ze",ses:"s",es:"e",s:""};return e.replace(new RegExp(`(${Object.keys(t).join("|")})$`),s=>t[s])}export{Yr as C,Kt as F,Xe as T,ma as _,li as a,Ec as b,Xu as c,ec as d,ss as e,ld as f,ud as g,ni as h,Yu as i,Zr as j,At as k,pa as l,Ya as m,Mc as n,Ke as o,Ie as s,dt as t,cd as u};
