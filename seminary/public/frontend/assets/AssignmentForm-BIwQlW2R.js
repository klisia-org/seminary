var E=Object.defineProperty;var k=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var A=(i,n,a)=>n in i?E(i,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[n]=a,c=(i,n)=>{for(var a in n||(n={}))L.call(n,a)&&A(i,a,n[a]);if(k)for(var a of k(n))U.call(n,a)&&A(i,a,n[a]);return i};import{J as B,c as N,v as p,w as R,j as I,y as V,u as T}from"./frappe-ui-BzEkZ7NZ.js";import{bk as j,F as P,am as z,av as K,bg as M,I as O,c as x,a8 as H,t as J,b as _,g as r,e as d,u as m,a as h,z as C,w as b,C as y,D as g,H as Q}from"./vendor-IWZbD1HA.js";import{e as f}from"./exam-CeEjLNyB.js";import{_ as Y}from"./Link-DmVUQNbJ.js";const G={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},W={class:"space-x-2"},X={class:"w-3/4 mx-auto py-5"},Z={class:"font-semibold mb-4"},ee={class:"grid grid-cols-2 gap-5 mt-4 mb-8"},se={class:"mb-8"},te={class:"text-xs text-ink-gray-5 mb-2"},le={__name:"AssignmentForm",props:{assignmentID:{type:String,required:!1}},setup(i){const n=j("$user"),a=P(),u=i,t=z({title:"",course:"",type:"PDF",question:""});K(()=>{var e,s;u.assignmentID=="new"&&!((e=n.data)!=null&&e.is_moderator)&&!((s=n.data)!=null&&s.is_instructor)&&a.push({name:"Courses"}),u.assignmentID==="new"&&(f.prefillData.title&&(t.title=f.prefillData.title),f.prefillData.course&&(t.course=f.prefillData.course)),u.assignmentID!=="new"&&o.reload(),window.addEventListener("keydown",v)});const v=e=>{e.key==="s"&&(e.ctrlKey||e.metaKey)&&(D(),e.preventDefault())};M(()=>{window.removeEventListener("keydown",v)});const o=B({doctype:"Assignment Activity",name:u.assignmentID,auto:!1}),q=N({url:"frappe.client.insert",makeParams(e){return{doc:c({doctype:"Assignment Activity"},e)}},onSuccess(e){p.success(__("Assignment saved successfully")),a.push({name:"AssignmentForm",params:{assignmentID:e.name}})},onError(e){var s;p.error(((s=e.messages)==null?void 0:s[0])||e)}}),D=()=>{u.assignmentID=="new"?q.submit(c({},t)):o.setValue.submit(c({},t),{onSuccess(e){p.success(__("Assignment saved successfully")),o.reload()},onError(e){var s;p.error(((s=e.messages)==null?void 0:s[0])||e)}})};O(o,()=>{o.doc&&Object.keys(o.doc).forEach(e=>{t[e]=o.doc[e]})});const F=x(()=>{var s;const e=[{label:__("Assignments"),route:{name:"Assignments"}}];return(s=o.doc)!=null&&s.name?e.push({label:o.doc.title,route:{name:"AssignmentForm",params:{assignmentID:o.doc.name}}}):e.push({label:__("New Assignment"),route:{name:"AssignmentForm",params:{assignmentID:u.assignmentID||"new"}}}),e}),S=x(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(e,s)=>{var w;const $=H("router-link");return _(),J(Q,null,[r("header",G,[d(m(R),{items:F.value},null,8,["items"]),r("div",W,[(w=m(o).doc)!=null&&w.name?(_(),h($,{key:0,to:{name:"AssignmentSubmissionList",query:{assignmentID:m(o).doc.name}}},{default:b(()=>[d(m(I),null,{default:b(()=>[y(g(e.__("Submission List")),1)]),_:1})]),_:1},8,["to"])):C("",!0),d(m(I),{variant:"solid",onClick:s[0]||(s[0]=l=>D())},{default:b(()=>[y(g(e.__("Save")),1)]),_:1})])]),r("div",X,[r("div",Z,g(e.__("Assignment Details")),1),r("div",ee,[d(m(V),{modelValue:t.title,"onUpdate:modelValue":s[1]||(s[1]=l=>t.title=l),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),d(m(V),{modelValue:t.type,"onUpdate:modelValue":s[2]||(s[2]=l=>t.type=l),type:"select",options:S.value,label:e.__("Type"),required:!0},null,8,["modelValue","options","label"])]),r("div",se,[d(Y,{modelValue:t.course,"onUpdate:modelValue":s[3]||(s[3]=l=>t.course=l),doctype:"Course",label:e.__("Course where this assignment will be used. You may reuse this assignment in other course offerings"),required:!0},null,8,["modelValue","label"])]),r("div",null,[r("div",te,[y(g(e.__("Question"))+" ",1),s[5]||(s[5]=r("span",{class:"text-ink-red-3"},"*",-1))]),t.question!==void 0?(_(),h(m(T),{key:0,content:t.question||"",onChange:s[4]||(s[4]=l=>t.question=l),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])):C("",!0)])])],64)}}};export{le as default};
//# sourceMappingURL=AssignmentForm-BIwQlW2R.js.map
