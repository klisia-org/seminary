{"version":3,"file":"DiscussionActivitySubmissionCS-Dx2P5RDz.js","sources":["../../../../frontend/src/pages/DiscussionActivitySubmissionCS.vue"],"sourcesContent":["<template>\n\t<header class=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\">\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t</header>\n\t<div class=\"md:w-3/4 md:mx-auto py-5 mx-5\">\n\t\t<div class=\"grid grid-cols-3 gap-5 mb-5\">\n\t\t\t<Link doctype=\"Discussion Activity\" v-model=\"discussionID\" :placeholder=\"__('Discussion Activity')\" />\n\t\t\t<Link doctype=\"User\" v-model=\"member\" :placeholder=\"__('Student')\" />\n\t\t\t<FormControl v-model=\"status\" type=\"select\" :options=\"statusOptions\" :placeholder=\"__('Status')\" />\n\t\t</div>\n\t\t<ListView v-if=\"submissions.loading || submissions.data?.length\" :columns=\"discussionColumns\"\n\t\t\t:rows=\"submissions.data\" rowKey=\"name\">\n\t\t\t<ListHeader class=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\">\n\t\t\t\t<ListHeaderItem :item=\"item\" v-for=\"item in discussionColumns\" />\n\t\t\t</ListHeader>\n\t\t\t<ListRows>\n\t\t\t\t<router-link v-for=\"row in submissions.data\" :to=\"{\n\t\t\t\t\tname: 'DiscussionActivitySubmission',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tdiscussionID: row.disc_activity,\n\t\t\t\t\t\tsubmissionName: row.name,\n\t\t\t\t\t\tcourseName: props.courseName,\n\t\t\t\t\t},\n\t\t\t\t}\">\n\t\t\t\t\t<ListRow :row=\"row\">\n\t\t\t\t\t\t<template #default=\"{ column, item }\">\n\t\t\t\t\t\t\t<ListRowItem :item=\"row[column.key]\" :align=\"column.align\">\n\t\t\t\t\t\t\t\t<div v-if=\"column.key == 'status'\">\n\t\t\t\t\t\t\t\t\t<Badge :theme=\"getStatusTheme(row[column.key])\">\n\t\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</ListRowItem>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</ListRow>\n\t\t\t\t</router-link>\n\t\t\t</ListRows>\n\t\t</ListView>\n\t\t<div v-else class=\"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2\">\n\t\t\t<Pencil class=\"size-8 mx-auto stroke-1 text-ink-gray-4\" />\n\t\t\t<div class=\"text-xl font-medium\">\n\t\t\t\t{{ __('No submissions') }}\n\t\t\t</div>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{ __('There are no submissions for this course.') }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tBreadcrumbs,\n\tcreateListResource,\n\tFormControl,\n\tListView,\n\tListHeader,\n\tListHeaderItem,\n\tListRows,\n\tListRow,\n\tListRowItem,\n\tcreateResource\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Pencil } from 'lucide-vue-next'\nimport Link from '@/components/Controls/Link.vue'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst router = useRouter()\nconst discussionID = ref('')\nconst member = ref('')\nconst status = ref('')\n\nonMounted(() => {\n\tif (!user.data?.is_instructor && !user.data?.is_moderator) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\tdiscussionID.value = props.discussionID || router.currentRoute.value.query.discussionID\n\tmember.value = router.currentRoute.value.query.member\n\tstatus.value = router.currentRoute.value.query.status\n\treloadSubmissions()\n})\n\nconst props = defineProps({\n\tdiscussionID: {\n\t\ttype: String,\n\t\trequired: false,\n\t},\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst course = createResource({\n\turl: 'seminary.seminary.utils.get_course_details',\n\tcache: ['course', props.courseName],\n\tparams: {\n\t\tcourse: props.courseName,\n\t},\n\tauto: true,\n}) //Needed for the breadcrumbs\n\nconst getDiscussionFilters = () => {\n\tlet filters = {\n\t\tcoursesc: props.courseName, // Add filter for course_schedule\n\t};\n\tif (discussionID.value) {\n\t\tfilters.disc_activity = discussionID.value\n\t}\n\tif (member.value) {\n\t\tfilters.member = member.value\n\t}\n\tif (status.value) {\n\t\tfilters.status = status.value\n\t}\n\treturn filters\n}\n\nconst submissions = createListResource({\n\tdoctype: 'Discussion Submission',\n\tfields: ['name', 'disc_activity', 'member', 'student_name', 'grade', 'percentage', 'disc_title', 'status', 'extra_credit', 'fudge_points', 'late'],\n\torderBy: 'creation desc',\n\ttransform(data) {\n\t\treturn data.map((row) => {\n\t\t\treturn {\n\t\t\t\t...row,\n\t\t\t\tcreation: dayjs(row.creation).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\n// watch changes in discussionID, member, and status and if changes in any then reload submissions. Also update the url query params for the same\nwatch([discussionID, member, status], () => {\n\trouter.push({\n\t\tquery: {\n\t\t\tdiscussionID: discussionID.value,\n\t\t\tmember: member.value,\n\t\t\tstatus: status.value,\n\t\t},\n\t})\n\treloadSubmissions()\n})\n\nconst reloadSubmissions = () => {\n\tsubmissions.update({\n\t\tfilters: getDiscussionFilters(),\n\t})\n\tsubmissions.reload()\n}\n\nconst discussionColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Student'),\n\t\t\tkey: 'student_name',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Discussion Title'),\n\t\t\tkey: 'disc_title',\n\t\t\twidth: 2,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Submitted'),\n\t\t\tkey: 'creation',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Score'),\n\t\t\tkey: 'grade',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Status'),\n\t\t\tkey: 'status',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t},\n\t]\n})\n\n\nconst statusOptions = computed(() => {\n\treturn [\n\t\t{ label: '', value: '' },\n\t\t{ label: __('Pass'), value: 'Pass' },\n\t\t{ label: __('Fail'), value: 'Fail' },\n\t\t{ label: __('Not Graded'), value: 'Not Graded' },\n\t\t{ label: __('Graded'), value: 'Graded' },\n\t]\n})\n\nconst getStatusTheme = (status) => {\n\tif (status === 'Pass' || status === 'Graded') {\n\t\treturn 'green'\n\t} else if (status === 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n}\n\nconst breadcrumbs = computed(() => {\n\tlet items = [{ label: __('Courses'), route: { name: 'Courses' } }]\n\titems.push({\n\t\tlabel: course?.data?.course,\n\t\troute: { name: 'CourseDetail', params: { courseName: props.courseName } },\n\t})\n\titems.push({\n\t\tlabel: __('Gradebook'),\n\t\troute: { name: 'Gradebook', params: { courseName: props.courseName } },\n\t})\n\titems.push({\n\t\tlabel: __('Discussion Submissions'),\n\t})\n\treturn items\n})\n</script>\n"],"names":["user","inject","dayjs","router","useRouter","discussionID","ref","member","status","onMounted","_a","_b","props","reloadSubmissions","__props","course","createResource","getDiscussionFilters","filters","submissions","createListResource","data","row","__spreadProps","__spreadValues","watch","discussionColumns","computed","statusOptions","getStatusTheme","breadcrumbs","items","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_hoisted_2","_hoisted_3","Link","$event","__","FormControl","_createBlock","ListView","ListHeader","_createElementBlock","_Fragment","_renderList","item","ListHeaderItem","ListRows","_openBlock","_component_router_link","ListRow","_withCtx","column","ListRowItem","_hoisted_4","Badge","_hoisted_5","_toDisplayString","_hoisted_6","Pencil","_hoisted_7","_hoisted_8"],"mappings":"8uCAuEA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAAQD,EAAO,QAAQ,EACvBE,EAASC,GAAS,EAClBC,EAAeC,EAAI,EAAE,EACrBC,EAASD,EAAI,EAAE,EACfE,EAASF,EAAI,EAAE,EAErBG,GAAU,IAAM,SACX,GAACC,EAAAV,EAAK,OAAL,MAAAU,EAAW,gBAAiB,GAACC,EAAAX,EAAK,OAAL,MAAAW,EAAW,eAC5CR,EAAO,KAAK,CAAE,KAAM,SAAS,CAAE,EAEhCE,EAAa,MAAQO,EAAM,cAAgBT,EAAO,aAAa,MAAM,MAAM,aAC3EI,EAAO,MAAQJ,EAAO,aAAa,MAAM,MAAM,OAC/CK,EAAO,MAAQL,EAAO,aAAa,MAAM,MAAM,OAC/CU,EAAiB,CAClB,CAAC,EAED,MAAMD,EAAQE,EAWRC,EAASC,EAAe,CAC7B,IAAK,6CACL,MAAO,CAAC,SAAUJ,EAAM,UAAU,EAClC,OAAQ,CACP,OAAQA,EAAM,UAChB,EACC,KAAM,EACP,CAAC,EAEKK,EAAuB,IAAM,CAClC,IAAIC,EAAU,CACb,SAAUN,EAAM,UAClB,EACC,OAAIP,EAAa,QAChBa,EAAQ,cAAgBb,EAAa,OAElCE,EAAO,QACVW,EAAQ,OAASX,EAAO,OAErBC,EAAO,QACVU,EAAQ,OAASV,EAAO,OAElBU,CACR,EAEMC,EAAcC,EAAmB,CACtC,QAAS,wBACT,OAAQ,CAAC,OAAQ,gBAAiB,SAAU,eAAgB,QAAS,aAAc,aAAc,SAAU,eAAgB,eAAgB,MAAM,EACjJ,QAAS,gBACT,UAAUC,EAAM,CACf,OAAOA,EAAK,IAAKC,GACTC,EAAAC,EAAA,GACHF,GADG,CAEN,SAAUpB,EAAMoB,EAAI,QAAQ,EAAE,QAAO,CACzC,EACG,CACF,CACD,CAAC,EAGDG,GAAM,CAACpB,EAAcE,EAAQC,CAAM,EAAG,IAAM,CAC3CL,EAAO,KAAK,CACX,MAAO,CACN,aAAcE,EAAa,MAC3B,OAAQE,EAAO,MACf,OAAQC,EAAO,KAClB,CACA,CAAE,EACDK,EAAiB,CAClB,CAAC,EAED,MAAMA,EAAoB,IAAM,CAC/BM,EAAY,OAAO,CAClB,QAASF,EAAoB,CAC/B,CAAE,EACDE,EAAY,OAAM,CACnB,EAEMO,EAAoBC,EAAS,IAC3B,CACN,CACC,MAAO,GAAG,SAAS,EACnB,IAAK,eACL,MAAO,CACV,EACE,CACC,MAAO,GAAG,kBAAkB,EAC5B,IAAK,aACL,MAAO,CACV,EACE,CACC,MAAO,GAAG,WAAW,EACrB,IAAK,WACL,MAAO,EACP,MAAO,MACV,EACE,CACC,MAAO,GAAG,OAAO,EACjB,IAAK,QACL,MAAO,EACP,MAAO,QACV,EACE,CACC,MAAO,GAAG,QAAQ,EAClB,IAAK,SACL,MAAO,EACP,MAAO,QACV,CACA,CACC,EAGKC,EAAgBD,EAAS,IACvB,CACN,CAAE,MAAO,GAAI,MAAO,EAAE,EACtB,CAAE,MAAO,GAAG,MAAM,EAAG,MAAO,MAAM,EAClC,CAAE,MAAO,GAAG,MAAM,EAAG,MAAO,MAAM,EAClC,CAAE,MAAO,GAAG,YAAY,EAAG,MAAO,YAAY,EAC9C,CAAE,MAAO,GAAG,QAAQ,EAAG,MAAO,QAAQ,CACxC,CACC,EAEKE,EAAkBrB,GACnBA,IAAW,QAAUA,IAAW,SAC5B,QACGA,IAAW,aACd,OAEA,MAIHsB,EAAcH,EAAS,IAAM,OAClC,IAAII,EAAQ,CAAC,CAAE,MAAO,GAAG,SAAS,EAAG,MAAO,CAAE,KAAM,UAAW,CAAE,EACjE,OAAAA,EAAM,KAAK,CACV,OAAOrB,EAAAK,GAAA,YAAAA,EAAQ,OAAR,YAAAL,EAAc,OACrB,MAAO,CAAE,KAAM,eAAgB,OAAQ,CAAE,WAAYE,EAAM,WAAY,CACzE,CAAE,EACDmB,EAAM,KAAK,CACV,MAAO,GAAG,WAAW,EACrB,MAAO,CAAE,KAAM,YAAa,OAAQ,CAAE,WAAYnB,EAAM,WAAY,CACtE,CAAE,EACDmB,EAAM,KAAK,CACV,MAAO,GAAG,wBAAwB,CACpC,CAAE,EACMA,CACR,CAAC,qEAhOAC,EAES,SAFTC,GAES,CADRC,EAAoCC,EAAAC,CAAA,EAAA,CAAtB,MAAON,EAAA,OAAW,KAAA,EAAA,CAAA,OAAA,CAAA,IAEjCE,EA8CM,MA9CNK,GA8CM,CA7CLL,EAIM,MAJNM,GAIM,CAHLJ,EAAsGK,EAAA,CAAhG,QAAQ,iCAA+BlC,EAAA,2CAAAA,EAAY,MAAAmC,GAAG,YAAaC,EAAAA,GAAE,qBAAA,wCAC3EP,EAAqEK,EAAA,CAA/D,QAAQ,kBAAgBhC,EAAA,2CAAAA,EAAM,MAAAiC,GAAG,YAAaC,EAAAA,GAAE,SAAA,wCACtDP,EAAmGC,EAAAO,CAAA,EAAA,YAA7ElC,EAAA,2CAAAA,EAAM,MAAAgC,GAAE,KAAK,SAAU,QAASZ,EAAA,MAAgB,YAAaa,EAAAA,GAAE,QAAA,oDAEtEN,EAAAhB,CAAA,EAAY,UAAWgB,EAAAA,KAAY,OAAZA,MAAAA,EAAkB,YAAzDQ,EA8BWR,EAAAS,EAAA,EAAA,OA9BuD,QAASlB,EAAA,MACzE,KAAMS,EAAAhB,CAAA,EAAY,KAAM,OAAO,mBAChC,IAEa,CAFbe,EAEaC,EAAAU,CAAA,EAAA,CAFD,MAAM,gEAAgE,EAAA,WACpD,IAAiC,QAA9DC,EAAiEC,EAAA,KAAAC,EAArBtB,EAAA,MAARuB,QAApCN,EAAiER,EAAAe,CAAA,EAAA,CAAhD,KAAMD,CAAI,EAAA,KAAA,EAAA,CAAA,MAAA,CAAA,kBAE5Bf,EAwBWC,EAAAgB,CAAA,EAAA,KAAA,WAvBG,IAA+B,EAA5CC,EAAA,EAAA,EAAAN,EAsBcC,EAAA,KAAAC,EAtBab,EAAAhB,CAAA,EAAY,KAAnBG,QAApBqB,EAsBcU,EAAA,CAtBgC,GAAE,6CAAkF,aAAA/B,EAAI,cAAqC,eAAAA,EAAI,KAAwB,WAAAV,EAAM,yBAQ5M,IAaU,CAbVsB,EAaUC,EAAAmB,CAAA,EAAA,CAbA,IAAKhC,CAAG,EAAA,CACN,QAAOiC,EACjB,CASc,CAVO,OAAAC,EAAQ,KAAAP,EAAI,IAAA,CACjCf,EAScC,EAAAsB,CAAA,EAAA,CATA,KAAMnC,EAAIkC,EAAO,GAAG,EAAI,MAAOA,EAAO,kBACnD,IAIM,CAJKA,EAAO,KAAG,cAArBV,EAIM,MAAAY,GAAA,CAHLxB,EAEQC,EAAAwB,EAAA,EAAA,CAFA,MAAO9B,EAAeP,EAAIkC,EAAO,GAAG,CAAA,cAC3C,IAAqB,MAAlBlC,EAAIkC,EAAO,GAAG,CAAA,EAAA,CAAA,6BAGnBJ,IAAAN,EAEM,MAAAc,GAAAC,EADFvC,EAAIkC,EAAO,GAAG,CAAA,EAAA,CAAA,yHAQxBJ,IAAAN,EAQM,MARNgB,GAQM,CAPL5B,EAA0DC,EAAA4B,EAAA,EAAA,CAAlD,MAAM,yCAAyC,CAAA,EACvD/B,EAEM,MAFNgC,GAEMH,EADFpB,EAAAA,GAAE,gBAAA,CAAA,EAAA,CAAA,EAENT,EAEM,MAFNiC,GAEMJ,EADFpB,EAAAA,GAAE,2CAAA,CAAA,EAAA,CAAA"}