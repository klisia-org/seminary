{"version":3,"file":"QuizForm-62255030.js","sources":["../../../../frontend/src/components/Modals/Question.vue","../../../../frontend/src/pages/QuizForm.vue"],"sourcesContent":["<template>\n\t<Dialog v-model=\"show\" :options=\"dialogOptions\">\n\t\t<template #body-content>\n\t\t\t<div class=\"space-y-4\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!editMode\"\n\t\t\t\t\tclass=\"flex items-center text-xs text-ink-gray-7 space-x-5\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\tid=\"existing\"\n\t\t\t\t\t\t\tvalue=\"existing\"\n\t\t\t\t\t\t\tv-model=\"questionType\"\n\t\t\t\t\t\t\tclass=\"w-3 h-3 cursor-pointer\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label for=\"existing\" class=\"cursor-pointer\">\n\t\t\t\t\t\t\t{{ __('Add an existing question') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\tid=\"new\"\n\t\t\t\t\t\t\tvalue=\"new\"\n\t\t\t\t\t\t\tv-model=\"questionType\"\n\t\t\t\t\t\t\tclass=\"w-3 h-3 cursor-pointer\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label for=\"new\" class=\"cursor-pointer\">\n\t\t\t\t\t\t\t{{ __('Create a new question') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"questionType == 'new' || editMode\" class=\"space-y-2\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label class=\"block text-xs text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t{{ __('Question') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t\t:content=\"question.question\"\n\t\t\t\t\t\t\t@change=\"(val) => (question.question = val)\"\n\t\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"question.points\"\n\t\t\t\t\t\t:label=\"__('Points')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\t:label=\"__('Type')\"\n\t\t\t\t\t\tv-model=\"question.type\"\n\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t:options=\"['Choices', 'User Input']\"\n\t\t\t\t\t\tclass=\"pb-2\"\n\t\t\t\t\t\t:required=\"true\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div v-if=\"question.type == 'Choices'\" class=\"divide-y border-t\">\n\t\t\t\t\t\t<div v-for=\"n in 4\" class=\"space-y-4 py-2\">\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t:label=\"__('Option') + ' ' + n\"\n\t\t\t\t\t\t\t\tv-model=\"question[`option_${n}`]\"\n\t\t\t\t\t\t\t\t:required=\"n <= 2 ? true : false\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t:label=\"__('Explanation')\"\n\t\t\t\t\t\t\t\tv-model=\"question[`explanation_${n}`]\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t:label=\"__('Correct Answer')\"\n\t\t\t\t\t\t\t\tv-model=\"question[`is_correct_${n}`]\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else-if=\"question.type == 'User Input'\"\n\t\t\t\t\t\tv-for=\"n in 4\"\n\t\t\t\t\t\tclass=\"space-y-2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t:label=\"__('Possibility') + ' ' + n\"\n\t\t\t\t\t\t\tv-model=\"question[`possibility_${n}`]\"\n\t\t\t\t\t\t\t:required=\"n == 1 ? true : false\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"questionType == 'existing'\" class=\"space-y-2\">\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-model=\"existingQuestion.question\"\n\t\t\t\t\t\t:label=\"__('Select a question')\"\n\t\t\t\t\t\tdoctype=\"Question\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"existingQuestion.points\"\n\t\t\t\t\t\t:label=\"__('Points')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FormControl, TextEditor, createResource } from 'frappe-ui'\nimport { computed, watch, reactive, ref } from 'vue'\nimport Link from '@/components/Controls/Link.vue'\nimport { showToast } from '@/utils'\n\nconst show = defineModel()\nconst quiz = defineModel('quiz')\nconst questionType = ref(null)\nconst editMode = ref(false)\n\nconst existingQuestion = reactive({\n\tquestion: '',\n\tpoints: 0,\n})\nconst question = reactive({\n\tquestion: '',\n\ttype: 'Choices',\n\tpoints: 0,\n})\n\nconst populateFields = () => {\n\tlet fields = ['option', 'is_correct', 'explanation', 'possibility']\n\tlet counter = 1\n\tfields.forEach((field) => {\n\t\twhile (counter <= 4) {\n\t\t\tquestion[`${field}_${counter}`] = field === 'is_correct' ? false : null\n\t\t\tcounter++\n\t\t}\n\t})\n}\n\npopulateFields()\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\tdefault: __('Add a new question'),\n\t},\n\tquestionDetail: {\n\t\ttype: [Object, null],\n\t\trequired: true,\n\t},\n})\n\nconst questionData = createResource({\n\turl: 'frappe.client.get',\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: 'Question',\n\t\t\tname: props.questionDetail.question,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tlet counter = 1\n\t\teditMode.value = true\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (Object.hasOwn(question, key)) question[key] = data[key]\n\t\t})\n\t\twhile (counter <= 4) {\n\t\t\tquestion[`is_correct_${counter}`] = data[`is_correct_${counter}`]\n\t\t\t\t? true\n\t\t\t\t: false\n\t\t\tcounter++\n\t\t}\n\t\tquestion.points = props.questionDetail.points\n\t},\n})\n\nwatch(show, () => {\n\tif (show.value) {\n\t\teditMode.value = false\n\t\tif (props.questionDetail.question) questionData.fetch()\n\t\telse {\n\t\t\t;(question.question = ''), (question.points = 0)\n\t\t\tquestion.type = 'Choices'\n\t\t\texistingQuestion.question = ''\n\t\t\texistingQuestion.points = 0\n\t\t\tquestionType.value = null\n\t\t\tpopulateFields()\n\t\t}\n\n\t\tif (props.questionDetail.points) question.points = props.questionDetail.points\n\t}\n})\n\nconst questionRow = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Quiz Question',\n\t\t\t\tparent: quiz.value.data.name,\n\t\t\t\tparentfield: 'questions',\n\t\t\t\tparenttype: 'Quiz',\n\t\t\t\t...values,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst questionCreation = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Question',\n\t\t\t\t...question,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitQuestion = (close) => {\n\tif (props.questionDetail?.question) updateQuestion(close)\n\telse addQuestion(close)\n}\n\nconst addQuestion = (close) => {\n\tif (questionType.value == 'existing') {\n\t\taddQuestionRow(\n\t\t\t{\n\t\t\t\tquestion: existingQuestion.question,\n\t\t\t\tpoints: existingQuestion.points,\n\t\t\t},\n\t\t\tclose\n\t\t)\n\t} else {\n\t\tquestionCreation.submit(\n\t\t\t{},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\taddQuestionRow(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tquestion: data.name,\n\t\t\t\t\t\t\tpoints: question.points,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclose\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tonError(err) {\n\t\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t}\n}\n\nconst addQuestionRow = (question, close) => {\n\tquestionRow.submit(\n\t\t{\n\t\t\t...question,\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\tshow.value = false\n\t\t\t\tshowToast(__('Success'), __('Question added successfully'), 'check')\n\t\t\t\tquiz.value.reload()\n\t\t\t\tclose()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t\tclose()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst questionUpdate = createResource({\n\turl: 'frappe.client.set_value',\n\tauto: false,\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Question',\n\t\t\tname: questionData.data?.name,\n\t\t\tfieldname: {\n\t\t\t\t...question,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst pointsUpdate = createResource({\n\turl: 'frappe.client.set_value',\n\tauto: false,\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz Question',\n\t\t\tname: props.questionDetail.name,\n\t\t\tfieldname: {\n\t\t\t\tpoints: question.points,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst updateQuestion = (close) => {\n\tquestionUpdate.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\tpointsUpdate.submit(\n\t\t\t\t\t{},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\tshow.value = false\n\t\t\t\t\t\t\tshowToast(\n\t\t\t\t\t\t\t\t__('Success'),\n\t\t\t\t\t\t\t\t__('Question updated successfully'),\n\t\t\t\t\t\t\t\t'check'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\tquiz.value.reload()\n\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst dialogOptions = computed(() => {\n\treturn {\n\t\ttitle: __(props.title),\n\t\tsize: 'xl',\n\t\tactions: [\n\t\t\t{\n\t\t\t\tlabel: __('Submit'),\n\t\t\t\tvariant: 'solid',\n\t\t\t\tonClick: (close) => {\n\t\t\t\t\tsubmitQuestion(close)\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t}\n})\n</script>\n<style>\ninput[type='radio']:checked {\n\tbackground-color: theme('colors.gray.900') !important;\n\tborder-color: theme('colors.gray.900') !important;\n\t--tw-ring-color: theme('colors.gray.900') !important;\n}\n</style>\n","<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<div class=\"space-x-2\">\n\t\t\t<router-link\n\t\t\t\tv-if=\"quizDetails.data?.name\"\n\t\t\t\t:to=\"{\n\t\t\t\t\tname: 'QuizPage',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tquizID: quizDetails.data.name,\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<Button>\n\t\t\t\t\t{{ __('Open') }}\n\t\t\t\t</Button>\n\t\t\t</router-link>\n\t\t\t<router-link\n\t\t\t\tv-if=\"quizDetails.data?.name\"\n\t\t\t\t:to=\"{\n\t\t\t\t\tname: 'QuizSubmissionList',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tquizID: quizDetails.data.name,\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<Button>\n\t\t\t\t\t{{ __('Submission List') }}\n\t\t\t\t</Button>\n\t\t\t</router-link>\n\t\t\t<Button variant=\"solid\" @click=\"submitQuiz()\">\n\t\t\t\t{{ __('Save') }}\n\t\t\t</Button>\n\t\t</div>\n\t</header>\n\t<div class=\"w-3/4 mx-auto py-5\">\n\t\t<!-- Details -->\n\t\t<div class=\"mb-8\">\n\t\t\t<div class=\"font-semibold mb-4\">\n\t\t\t\t{{ __('Details') }}\n\t\t\t</div>\n\t\t\t<FormControl\n\t\t\t\tv-model=\"quiz.title\"\n\t\t\t\t:label=\"\n\t\t\t\t\tquizDetails.data?.name\n\t\t\t\t\t\t? __('Title')\n\t\t\t\t\t\t: __('Enter a title and save the quiz to proceed')\n\t\t\t\t\"\n\t\t\t\t:required=\"true\"\n\t\t\t/>\n\t\t\t<Link\n\t\t\t\tv-model=\"quiz.course\"\n\t\t\t\tdoctype=\"Course\"\n\t\t\t\t:label=\"__('Course where this quiz will be used - you may reuse this quiz in other schedules')\"\n\t\t\t\t:required=\"true\"\n\t\t\t/>\n\t\t\t<div v-if=\"quizDetails.data?.name\">\n\t\t\t\t<div class=\"grid grid-cols-2 gap-5 mt-4 mb-8\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tv-model=\"quiz.max_attempts\"\n\t\t\t\t\t\t:label=\"__('Maximum Attempts')\"\n\t\t\t\t\t\t:default=\"1\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tv-model=\"quiz.duration\"\n\t\t\t\t\t\t:label=\"__('Duration (in minutes)')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"quiz.total_points\"\n\t\t\t\t\t\t:label=\"__('Total Points')\"\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"quiz.passing_percentage\"\n\t\t\t\t\t\t:label=\"__('Passing Percentage. Use this to force students to retake the quiz until they pass')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Settings -->\n\t\t\t\t<div class=\"mb-8\">\n\t\t\t\t\t<div class=\"font-semibold mb-4\">\n\t\t\t\t\t\t{{ __('Settings') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"grid grid-cols-3 gap-5 my-4\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"quiz.show_answers\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:label=\"__('Show Answers')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"quiz.show_submission_history\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:label=\"__('Show Submission History')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"quiz.qbyquestion\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:label=\"__('Force student to answer a question before moving on? Each question will have its own page and a next button')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"mb-8\">\n\t\t\t\t\t<div class=\"font-semibold mb-4\">\n\t\t\t\t\t\t{{ __('Shuffle Settings') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"grid grid-cols-3\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"quiz.shuffle_questions\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t:label=\"__('Shuffle Questions')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-if=\"quiz.shuffle_questions\"\n\t\t\t\t\t\t\tv-model=\"quiz.limit_questions_to\"\n\t\t\t\t\t\t\t:label=\"__('Limit Questions To (on shuffle). Leave as zero to shuffle all questions')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Questions -->\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t\t<div class=\"font-semibold\">\n\t\t\t\t\t\t\t{{ __('Questions') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button @click=\"openQuestionModal()\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<Plus class=\"w-4 h-4\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ __('New Question') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ListView\n\t\t\t\t\t\t:columns=\"questionColumns\"\n\t\t\t\t\t\t:rows=\"quiz.questions\"\n\t\t\t\t\t\trow-key=\"name\"\n\t\t\t\t\t\t:options=\"{\n\t\t\t\t\t\t\tshowTooltip: false,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ListHeader\n\t\t\t\t\t\t\tclass=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ListHeaderItem :item=\"item\" v-for=\"item in questionColumns\" />\n\t\t\t\t\t\t</ListHeader>\n\t\t\t\t\t\t<ListRows>\n\t\t\t\t\t\t\t<ListRow\n\t\t\t\t\t\t\t\t:row=\"row\"\n\t\t\t\t\t\t\t\tv-slot=\"{ idx, column, item }\"\n\t\t\t\t\t\t\t\tv-for=\"row in quiz.questions\"\n\t\t\t\t\t\t\t\t@click=\"openQuestionModal(row)\"\n\t\t\t\t\t\t\t\tclass=\"cursor-pointer\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ListRowItem :item=\"item\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tv-if=\"column.key == 'question_detail'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"text-xs truncate h-4\"\n\t\t\t\t\t\t\t\t\t\tv-html=\"item\"\n\t\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t\t\t<div v-else class=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t{{ item }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</ListRowItem>\n\t\t\t\t\t\t\t</ListRow>\n\t\t\t\t\t\t</ListRows>\n\t\t\t\t\t\t<ListSelectBanner>\n\t\t\t\t\t\t\t<template #actions=\"{ unselectAll, selections }\">\n\t\t\t\t\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t@click=\"deleteQuestions(selections, unselectAll)\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Trash2 class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</ListSelectBanner>\n\t\t\t\t\t</ListView>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<Question\n\t\tv-model=\"showQuestionModal\"\n\t\t:questionDetail=\"currentQuestion\"\n\t\tv-model:quiz=\"quizDetails\"\n\t\t:title=\"\n\t\t\tcurrentQuestion.question\n\t\t\t\t? __('Edit the question')\n\t\t\t\t: __('Add a new question')\n\t\t\"\n\t/>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tcreateResource,\n\tFormControl,\n\tListView,\n\tListHeader,\n\tListHeaderItem,\n\tListRows,\n\tListRow,\n\tListRowItem,\n\tListSelectBanner,\n\tButton,\n} from 'frappe-ui'\nimport {\n\tcomputed,\n\treactive,\n\tref,\n\tonMounted,\n\tinject,\n\tonBeforeUnmount,\n\twatch,\n} from 'vue'\nimport { Plus, Trash2 } from 'lucide-vue-next'\nimport Question from '@/components/Modals/Question.vue'\nimport { showToast, updateDocumentTitle } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport Link from '@/components/Controls/Link.vue'\nimport { examStore } from '@/stores/exam'\n\nconst showQuestionModal = ref(false)\nconst currentQuestion = reactive({\n\tquestion: '',\n\tpoints: 0,\n\tname: '',\n})\nconst user = inject('$user')\nconst router = useRouter()\n\nconst props = defineProps({\n\tquizID: {\n\t\ttype: String,\n\t\trequired: false,\n\t},\n})\n\nconst quiz = reactive({\n\ttitle: '',\n\tcourse: '',\n\ttotal_points: 0,\n\tpassing_percentage: 0,\n\tmax_attempts: 0,\n\tduration: 0,\n\tqbyquestion: false,\n\tlimit_questions_to: 0,\n\tshow_answers: true,\n\tshow_submission_history: false,\n\tshuffle_questions: false,\n\tquestions: [],\n})\n\nonMounted(() => {\n\tif (\n\t\tprops.quizID == 'new' &&\n\t\t!user.data?.is_moderator &&\n\t\t!user.data?.is_instructor\n\t) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\tif (props.quizID === 'new') {\n\t\n\t\tif (examStore.prefillData.title) {\n       \t quiz.title = examStore.prefillData.title; // Pre-fill the title if provided\n    \t}\n\t\tif (examStore.prefillData.course) {\n        quiz.course = examStore.prefillData.course; // Pre-fill the course if provided\n    }\n}\n\tif (props.quizID !== 'new') {\n\t\tquizDetails.reload()\n\t}\n\twindow.addEventListener('keydown', keyboardShortcut)\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitQuiz()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nwatch(\n\t() => props.quizID !== 'new',\n\t(newVal) => {\n\t\tif (newVal) {\n\t\t\tquizDetails.reload()\n\t\t\texamStore.clearPrefillData()\n\t\t}\n\t}\n)\n\nconst quizDetails = createResource({\n\turl: 'frappe.client.get',\n\tmakeParams(values) {\n\t\treturn { doctype: 'Quiz', name: props.quizID }\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (Object.hasOwn(quiz, key)) quiz[key] = data[key]\n\t\t})\n\n\t\tlet checkboxes = [\n\t\t\t'show_answers',\n\t\t\t'show_submission_history',\n\t\t\t'shuffle_questions',\n\t\t]\n\t\tfor (let idx in checkboxes) {\n\t\t\tlet key = checkboxes[idx]\n\t\t\tquiz[key] = quiz[key] ? true : false\n\t\t}\n\t},\n})\n\nconst quizCreate = createResource({\n\turl: 'frappe.client.insert',\n\tauto: false,\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Quiz',\n\t\t\t\t...quiz,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst quizUpdate = createResource({\n\turl: 'frappe.client.set_value',\n\tauto: false,\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz',\n\t\t\tname: values.quizID,\n\t\t\tfieldname: {\n\t\t\t\ttotal_points: calculateTotalpoints(),\n\t\t\t\t...quiz,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitQuiz = () => {\n\tif (quizDetails.data?.name) updateQuiz()\n\telse createQuiz()\n}\n\nconst createQuiz = () => {\n\tquizCreate.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tshowToast(__('Success'), __('Quiz created successfully'), 'check')\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'QuizForm',\n\t\t\t\t\tparams: { quizID: data.name },\n\t\t\t\t})\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst updateQuiz = () => {\n\tquizUpdate.submit(\n\t\t{ quizID: quizDetails.data?.name },\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tquiz.total_points = data.total_points\n\t\t\t\tshowToast(__('Success'), __('Quiz updated successfully'), 'check')\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast(__('Error'), __(err.messages?.[0] || err), 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst calculateTotalpoints = () => {\n\tlet totalpoints = 0\n\tif (quiz.limit_questions_to && quiz.questions.length > 0)\n\t\treturn quiz.questions[0].points * quiz.limit_questions_to\n\tquiz.questions.forEach((question) => {\n\t\ttotalpoints += question.points\n\t})\n\treturn totalpoints\n}\n\nconst questionColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('ID'),\n\t\t\tkey: 'question',\n\t\t\twidth: '10rem',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Question'),\n\t\t\tkey: __('question_detail'),\n\t\t\twidth: '40rem',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Points'),\n\t\t\tkey: 'points',\n\t\t\twidth: '5rem',\n\t\t},\n\t]\n})\n\nconst openQuestionModal = (question = null) => {\n\tif (question) {\n\t\tcurrentQuestion.question = question.question\n\t\tcurrentQuestion.points = question.points\n\t\tcurrentQuestion.name = question.name\n\t} else {\n\t\tcurrentQuestion.question = ''\n\t\tcurrentQuestion.points = 0\n\t\tcurrentQuestion.name = ''\n\t}\n\tshowQuestionModal.value = true\n}\n\nconst deleteQuestionResource = createResource({\n\turl: 'seminary.seminary.api.delete_documents',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz Question',\n\t\t\tdocuments: values.questions,\n\t\t}\n\t},\n})\n\nconst deleteQuestions = (selections, unselectAll) => {\n\tdeleteQuestionResource.submit(\n\t\t{\n\t\t\tquestions: Array.from(selections),\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\tshowToast(__('Success'), __('Questions deleted successfully'), 'check')\n\t\t\t\tquizDetails.reload()\n\t\t\t\tunselectAll()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst breadcrumbs = computed(() => {\n\tlet crumbs = [\n\t\t{\n\t\t\tlabel: __('Quizzes'),\n\t\t\troute: {\n\t\t\t\tname: 'Quizzes',\n\t\t\t},\n\t\t},\n\t]\n\t/* if (quizDetails.data) {\n\t\tcrumbs.push({\n\t\t\tlabel: quiz.title,\n\t\t})\n\t} */\n\tcrumbs.push({\n\t\tlabel: props.quizID == 'new' ? __('New Quiz') : quizDetails.data?.title,\n\t\troute: { name: 'QuizForm', params: { quizID: props.quizID } },\n\t})\n\treturn crumbs\n})\n\nconst pageMeta = computed(() => {\n\treturn {\n\t\ttitle: props.quizID == 'new' ? __('New Quiz') : quizDetails.data?.title,\n\t\tdescription: __('Form to create and edit quizzes'),\n\t}\n})\n\nupdateDocumentTitle(pageMeta)\n</script>\n"],"names":["show","_useModel","__props","quiz","questionType","ref","editMode","existingQuestion","reactive","question","populateFields","fields","counter","field","props","questionData","createResource","data","key","watch","questionRow","values","__spreadValues","questionCreation","submitQuestion","close","_a","updateQuestion","addQuestion","addQuestionRow","err","showToast","questionUpdate","pointsUpdate","dialogOptions","computed","_createBlock","_unref","Dialog","$event","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","__","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_createVNode","TextEditor","val","FormControl","_cache","_hoisted_9","_Fragment","_renderList","n","_hoisted_10","_hoisted_11","_hoisted_12","Link","showQuestionModal","currentQuestion","user","inject","router","useRouter","onMounted","_b","examStore","quizDetails","keyboardShortcut","submitQuiz","onBeforeUnmount","newVal","checkboxes","idx","quizCreate","quizUpdate","calculateTotalpoints","updateQuiz","createQuiz","totalpoints","questionColumns","openQuestionModal","deleteQuestionResource","deleteQuestions","selections","unselectAll","breadcrumbs","crumbs","pageMeta","updateDocumentTitle","Breadcrumbs","_component_router_link","Button","_hoisted_13","_hoisted_14","_hoisted_15","Plus","_createTextVNode","ListView","ListHeader","item","ListHeaderItem","ListRows","row","ListRow","_withCtx","column","ListRowItem","_hoisted_17","ListSelectBanner","_hoisted_18","Trash2","Question"],"mappings":"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"}