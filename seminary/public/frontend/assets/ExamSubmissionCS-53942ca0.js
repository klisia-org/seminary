var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var R=(u,n,o)=>n in u?J(u,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[n]=o,T=(u,n)=>{for(var o in n||(n={}))W.call(n,o)&&R(u,o,n[o]);if(I)for(var o of I(n))X.call(n,o)&&R(u,o,n[o]);return u},q=(u,n)=>K(u,Q(n));var M=(u,n,o)=>new Promise((S,d)=>{var f=c=>{try{m(o.next(c))}catch(y){d(y)}},b=c=>{try{m(o.throw(c))}catch(y){d(y)}},m=c=>c.done?S(c.value):Promise.resolve(c.value).then(f,b);m((o=o.apply(u,n)).next())});import{i as P,x as Y,r as w,m as Z,c as U,l as N,n as ee,aa as te,d as _,e as s,h as p,b as l,t as r,p as se,v as ae,F as k,k as $,w as g,f as D,g as oe,j as re,o as i,A as L,_ as le}from"./index-99ce2d99.js";import{_ as ne}from"./Badge.vue_vue_type_script_setup_true_lang-cc7b8027.js";import{_ as ie}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-d765e83c.js";import{a as ue}from"./plus-5e4fea15.js";import{a as me,_ as de,e as ce,b as _e,c as pe,d as fe}from"./ListView-f45a89e6.js";import{_ as be}from"./Link-ea839e37.js";import"./FolderPlugin.vue_vue_type_style_index_0_scoped_84b7d54d_lang-09f2e4ee.js";import{B as he}from"./book-open-check-a8ea3893.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-89c1576a.js";const ge={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ye={class:"md:w-3/4 md:mx-auto py-5 mx-5"},ve={class:"grid grid-cols-3 gap-5 mb-5"},xe={for:"examDropdown",class:"block text-sm font-medium text-gray-700"},ke={value:""},Se=["value"],we={for:"studentDropdown",class:"block text-sm font-medium text-gray-700"},Ne={for:"statusDropdown",class:"block text-sm font-medium text-gray-700"},$e={key:0,class:"w-full"},Ee={key:0},De={key:1},Ce={class:"flex justify-center my-5"},Ve={key:1,class:"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2"},Ge={class:"text-xl font-medium"},je={class:"leading-5"},Be={class:"mt-10"},Fe={class:"text-lg font-semibold mb-4"},Ie={class:"table-auto border-collapse w-full"},Re={class:"bg-gray-100"},Te={class:"border px-4 py-2"},qe={class:"border px-4 py-2"},Me={class:"border px-4 py-2"},Pe={class:"border px-4 py-2"},Ue={class:"border px-4 py-2"},Le={class:"border px-4 py-2"},ze={class:"border px-4 py-2"},Ae=["href"],Oe={class:"border px-4 py-2"},at={__name:"ExamSubmissionCS",props:{examID:{type:String,required:!1},courseName:{type:String,required:!0}},setup(u){const n=P("$dayjs"),o=Y(),S=P("$user"),d=w(""),f=w(""),b=w(""),m=u;Z(()=>{var e,t;!((e=S.data)!=null&&e.is_instructor)&&!((t=S.data)!=null&&t.is_moderator)&&o.push({name:"Courses"}),d.value=m.examID||o.currentRoute.value.params.examID,f.value=o.currentRoute.value.query.member,b.value=o.currentRoute.value.query.status,j(),y()});const c=w([]),y=()=>M(this,null,function*(){try{const t=yield(yield fetch(`/api/method/seminary.seminary.utils.missing_exams?course=${m.courseName}`)).json();if(console.log("Fetched data:",t),d.value)c.value=t.message.filter(x=>x.exam===d.value);else{c.value=t.message;return}}catch(e){console.error("Error fetching not submitted students:",e)}}),C=U({url:"/api/method/seminary.seminary.utils.get_course_exams",params:{course:m.courseName},auto:!0,onSuccess(e){console.log("Examlist fetched successfully:",e)},onError(e){console.error("Error fetching examlist:",e)}}),V=N(()=>{var e;return console.log("Exam list:",C.data),((e=C.data)==null?void 0:e.map(t=>({label:t.title,value:t.exam})))||[]});console.log("Filtered exams:",V);const G=()=>{let e={course:m.courseName};return d.value&&(e.exam=d.value),f.value&&(e.member=f.value),b.value&&(e.status=b.value),e};ee([d,f,b],()=>{o.push({query:{examID:d.value,member:f.value,status:b.value}}),j(),y()});const j=()=>{h.update({filters:G()}),h.reload()},h=te({doctype:"Exam Submission",filters:{exam:m.examID},fields:["name","member_name","score","percentage","exam_title","creation","fudge_points","status","time_taken"],filters:G(),orderBy:"creation desc",transform(e){return e.map(t=>q(T({},t),{creation:n(t.creation).fromNow(),score:String(t.score),percentage:String(t.percentage),time_taken:z(t.time_taken),fudge_points:String(t.fudge_points)}))}}),z=e=>{const t=Math.floor(e/60).toString().padStart(2,"0"),x=(e%60).toString().padStart(2,"0");return`${t}:${x}`},E=U({url:"seminary.seminary.utils.get_course_details",cache:["course",m.courseName],params:{course:m.courseName},auto:!0}),B=N(()=>[{label:__("Student"),key:"member_name",width:1},{label:__("Exam"),key:"exam_title",width:1},{label:__("Status"),key:"status",width:1,align:"center"},{label:__("Score"),key:"score",width:1,align:"center"},{label:__("Fudge Points"),key:"fudge_points",width:1,align:"center"},{label:__("Time Taken"),key:"time_taken",width:1,align:"center"},{label:__("Submitted"),key:"creation",width:1,align:"center"},{label:__("Percentage"),key:"percentage",width:1,align:"center"}]),A=N(()=>[{label:"",value:""},{label:"Not Graded",value:"Not Graded"},{label:"Graded",value:"Graded"}]),O=e=>e==="Graded"?"green":e==="Not Graded"?"orange":"red",H=N(()=>{var t;let e=[{label:"Courses",route:{name:"Courses"}}];return e.push({label:(t=E==null?void 0:E.data)==null?void 0:t.course,route:{name:"CourseDetail",params:{courseName:m.courseName}}}),e.push({label:"Gradebook",route:{name:"Gradebook",params:{courseName:m.courseName}}}),e.push({label:"Exam Submissions"}),e});return(e,t)=>{var F;const x=re("router-link");return i(),_(k,null,[s("header",ge,[p(l(ie),{items:H.value},null,8,["items"])]),s("div",ye,[s("div",ve,[s("div",null,[s("label",xe,r(e.__("Exam")),1),se(s("select",{id:"examDropdown","onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[s("option",ke,r(e.__("All Exams")),1),(i(!0),_(k,null,$(V.value,a=>(i(),_("option",{key:a.value,value:a.value},r(a.label),9,Se))),128))],512),[[ae,d.value]])]),s("div",null,[s("label",we,r(e.__("Student")),1),p(be,{id:"studentDropdown",doctype:"User",modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=a=>f.value=a),placeholder:e.__("Student")},null,8,["modelValue","placeholder"])]),s("div",null,[s("label",Ne,r(e.__("Status")),1),p(l(ue),{id:"statusDropdown",modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=a=>b.value=a),type:"select",options:A.value,placeholder:e.__("Status")},null,8,["modelValue","options","placeholder"])])])]),l(h).loading||(F=l(h).data)!=null&&F.length?(i(),_("div",$e,[p(l(fe),{columns:B.value,rows:l(h).data,options:{selectable:!1},"row-key":"name"},{default:g(()=>[p(l(me),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:g(()=>[(i(!0),_(k,null,$(B.value,a=>(i(),D(l(de),{item:a},null,8,["item"]))),256))]),_:1}),p(l(ce),null,{default:g(()=>[(i(!0),_(k,null,$(l(h).data,a=>(i(),D(x,{to:{name:"ExamSubmission",params:{submission:a.name}}},{default:g(()=>[p(l(_e),{row:a},{default:g(({column:v,item:He})=>[p(l(pe),{item:a[v.key],align:v.align},{default:g(()=>[v.key=="status"?(i(),_("div",Ee,[p(l(ne),{theme:O(a[v.key])},{default:g(()=>[L(r(a[v.key]),1)]),_:2},1032,["theme"])])):(i(),_("div",De,r(a[v.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1})]),_:1},8,["columns","rows"]),s("div",Ce,[l(h).hasNextPage?(i(),D(l(le),{key:0,onClick:t[3]||(t[3]=a=>l(h).next())},{default:g(()=>[L(r(e.__("Load More")),1)]),_:1})):oe("",!0)])])):(i(),_("div",Ve,[p(l(he),{class:"size-8 mx-auto stroke-1 text-ink-gray-4"}),s("div",Ge,r(e.__("No submissions")),1),s("div",je,r(e.__("There are no submissions for this course.")),1)])),s("div",Be,[s("h2",Fe,r(e.__("Students with No Submissions")),1),s("table",Ie,[s("thead",null,[s("tr",Re,[s("th",Te,r(e.__("Student Name")),1),s("th",qe,r(e.__("Program")),1),s("th",Me,r(e.__("Email")),1),s("th",Pe,r(e.__("Exam")),1)])]),s("tbody",null,[(i(!0),_(k,null,$(c.value,a=>(i(),_("tr",{key:a.stuemail_rc,class:"hover:bg-gray-50"},[s("td",Ue,r(a.stuname_roster),1),s("td",Le,r(a.program_std_scr),1),s("td",ze,[s("a",{href:`mailto:${a.email}`,class:"text-blue-500 underline"},r(a.stuemail_rc),9,Ae)]),s("td",Oe,r(a.exam),1)]))),128))])])])],64)}}};export{at as default};
//# sourceMappingURL=ExamSubmissionCS-53942ca0.js.map
