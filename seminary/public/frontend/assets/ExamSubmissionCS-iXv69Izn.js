var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var q=(u,n,o)=>n in u?J(u,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[n]=o,B=(u,n)=>{for(var o in n||(n={}))W.call(n,o)&&q(u,o,n[o]);if(T)for(var o of T(n))X.call(n,o)&&q(u,o,n[o]);return u},F=(u,n)=>K(u,Q(n));var L=(u,n,o)=>new Promise((S,d)=>{var b=c=>{try{m(o.next(c))}catch(y){d(y)}},f=c=>{try{m(o.throw(c))}catch(y){d(y)}},m=c=>c.done?S(c.value):Promise.resolve(c.value).then(b,f);m((o=o.apply(u,n)).next())});import{bk as M,F as Y,r as w,av as Z,c as N,I as ee,a8 as te,t as _,b as i,g as s,e as p,u as l,L as se,D as r,aR as ae,H as k,O as E,w as g,a as D,C as P,z as oe,bT as re}from"./vendor-IWZbD1HA.js";import{c as U,E as le,w as ne,y as ie,l as ue,m as me,G as de,n as ce,o as _e,q as pe,t as be,j as fe}from"./frappe-ui-BzEkZ7NZ.js";import{_ as he}from"./Link-DmVUQNbJ.js";import"./index-B0k3CMx6.js";/* empty css                                                                     */const ge={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ye={class:"md:w-3/4 md:mx-auto py-5 mx-5"},ve={class:"grid grid-cols-3 gap-5 mb-5"},xe={for:"examDropdown",class:"block text-sm font-medium text-gray-700"},ke={value:""},Se=["value"],we={for:"studentDropdown",class:"block text-sm font-medium text-gray-700"},Ne={for:"statusDropdown",class:"block text-sm font-medium text-gray-700"},Ee={key:0,class:"w-full"},$e={key:0},De={key:1},Ce={class:"flex justify-center my-5"},Ve={key:1,class:"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2"},Ge={class:"text-xl font-medium"},je={class:"leading-5"},Ie={class:"mt-10"},Re={class:"text-lg font-semibold mb-4"},Te={class:"table-auto border-collapse w-full"},qe={class:"bg-gray-100"},Be={class:"border px-4 py-2"},Fe={class:"border px-4 py-2"},Le={class:"border px-4 py-2"},Me={class:"border px-4 py-2"},Pe={class:"border px-4 py-2"},Ue={class:"border px-4 py-2"},ze={class:"border px-4 py-2"},Oe=["href"],Ae={class:"border px-4 py-2"},Ze={__name:"ExamSubmissionCS",props:{examID:{type:String,required:!1},courseName:{type:String,required:!0}},setup(u){const n=M("$dayjs"),o=Y(),S=M("$user"),d=w(""),b=w(""),f=w(""),m=u;Z(()=>{var e,t;!((e=S.data)!=null&&e.is_instructor)&&!((t=S.data)!=null&&t.is_moderator)&&o.push({name:"Courses"}),d.value=m.examID||o.currentRoute.value.params.examID,b.value=o.currentRoute.value.query.member,f.value=o.currentRoute.value.query.status,j(),y()});const c=w([]),y=()=>L(this,null,function*(){try{const t=yield(yield fetch(`/api/method/seminary.seminary.utils.missing_exams?course=${m.courseName}`)).json();if(console.log("Fetched data:",t),d.value)c.value=t.message.filter(x=>x.exam===d.value);else{c.value=t.message;return}}catch(e){console.error("Error fetching not submitted students:",e)}}),C=U({url:"/api/method/seminary.seminary.utils.get_course_exams",params:{course:m.courseName},auto:!0,onSuccess(e){console.log("Examlist fetched successfully:",e)},onError(e){console.error("Error fetching examlist:",e)}}),V=N(()=>{var e;return console.log("Exam list:",C.data),((e=C.data)==null?void 0:e.map(t=>({label:t.title,value:t.exam})))||[]});console.log("Filtered exams:",V);const G=()=>{let e={course:m.courseName};return d.value&&(e.exam=d.value),b.value&&(e.member=b.value),f.value&&(e.status=f.value),e};ee([d,b,f],()=>{o.push({query:{examID:d.value,member:b.value,status:f.value}}),j(),y()});const j=()=>{h.update({filters:G()}),h.reload()},h=le({doctype:"Exam Submission",filters:{exam:m.examID},fields:["name","member_name","score","percentage","exam_title","creation","fudge_points","status","time_taken"],filters:G(),orderBy:"creation desc",transform(e){return e.map(t=>F(B({},t),{creation:n(t.creation).fromNow(),score:String(t.score),percentage:String(t.percentage),time_taken:z(t.time_taken),fudge_points:String(t.fudge_points)}))}}),z=e=>{const t=Math.floor(e/60).toString().padStart(2,"0"),x=(e%60).toString().padStart(2,"0");return`${t}:${x}`},$=U({url:"seminary.seminary.utils.get_course_details",cache:["course",m.courseName],params:{course:m.courseName},auto:!0}),I=N(()=>[{label:__("Student"),key:"member_name",width:1},{label:__("Exam"),key:"exam_title",width:1},{label:__("Status"),key:"status",width:1,align:"center"},{label:__("Score"),key:"score",width:1,align:"center"},{label:__("Fudge Points"),key:"fudge_points",width:1,align:"center"},{label:__("Time Taken"),key:"time_taken",width:1,align:"center"},{label:__("Submitted"),key:"creation",width:1,align:"center"},{label:__("Percentage"),key:"percentage",width:1,align:"center"}]),O=N(()=>[{label:"",value:""},{label:"Not Graded",value:"Not Graded"},{label:"Graded",value:"Graded"}]),A=e=>e==="Graded"?"green":e==="Not Graded"?"orange":"red",H=N(()=>{var t;let e=[{label:"Courses",route:{name:"Courses"}}];return e.push({label:(t=$==null?void 0:$.data)==null?void 0:t.course,route:{name:"CourseDetail",params:{courseName:m.courseName}}}),e.push({label:"Gradebook",route:{name:"Gradebook",params:{courseName:m.courseName}}}),e.push({label:"Exam Submissions"}),e});return(e,t)=>{var R;const x=te("router-link");return i(),_(k,null,[s("header",ge,[p(l(ne),{items:H.value},null,8,["items"])]),s("div",ye,[s("div",ve,[s("div",null,[s("label",xe,r(e.__("Exam")),1),se(s("select",{id:"examDropdown","onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[s("option",ke,r(e.__("All Exams")),1),(i(!0),_(k,null,E(V.value,a=>(i(),_("option",{key:a.value,value:a.value},r(a.label),9,Se))),128))],512),[[ae,d.value]])]),s("div",null,[s("label",we,r(e.__("Student")),1),p(he,{id:"studentDropdown",doctype:"User",modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=a=>b.value=a),placeholder:e.__("Student")},null,8,["modelValue","placeholder"])]),s("div",null,[s("label",Ne,r(e.__("Status")),1),p(l(ie),{id:"statusDropdown",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=a=>f.value=a),type:"select",options:O.value,placeholder:e.__("Status")},null,8,["modelValue","options","placeholder"])])])]),l(h).loading||(R=l(h).data)!=null&&R.length?(i(),_("div",Ee,[p(l(be),{columns:I.value,rows:l(h).data,options:{selectable:!1},"row-key":"name"},{default:g(()=>[p(l(ue),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:g(()=>[(i(!0),_(k,null,E(I.value,a=>(i(),D(l(me),{item:a},null,8,["item"]))),256))]),_:1}),p(l(de),null,{default:g(()=>[(i(!0),_(k,null,E(l(h).data,a=>(i(),D(x,{to:{name:"ExamSubmission",params:{submission:a.name}}},{default:g(()=>[p(l(ce),{row:a},{default:g(({column:v,item:He})=>[p(l(_e),{item:a[v.key],align:v.align},{default:g(()=>[v.key=="status"?(i(),_("div",$e,[p(l(pe),{theme:A(a[v.key])},{default:g(()=>[P(r(a[v.key]),1)]),_:2},1032,["theme"])])):(i(),_("div",De,r(a[v.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1})]),_:1},8,["columns","rows"]),s("div",Ce,[l(h).hasNextPage?(i(),D(l(fe),{key:0,onClick:t[3]||(t[3]=a=>l(h).next())},{default:g(()=>[P(r(e.__("Load More")),1)]),_:1})):oe("",!0)])])):(i(),_("div",Ve,[p(l(re),{class:"size-8 mx-auto stroke-1 text-ink-gray-4"}),s("div",Ge,r(e.__("No submissions")),1),s("div",je,r(e.__("There are no submissions for this course.")),1)])),s("div",Ie,[s("h2",Re,r(e.__("Students with No Submissions")),1),s("table",Te,[s("thead",null,[s("tr",qe,[s("th",Be,r(e.__("Student Name")),1),s("th",Fe,r(e.__("Program")),1),s("th",Le,r(e.__("Email")),1),s("th",Me,r(e.__("Exam")),1)])]),s("tbody",null,[(i(!0),_(k,null,E(c.value,a=>(i(),_("tr",{key:a.stuemail_rc,class:"hover:bg-gray-50"},[s("td",Pe,r(a.stuname_roster),1),s("td",Ue,r(a.program_std_scr),1),s("td",ze,[s("a",{href:`mailto:${a.email}`,class:"text-blue-500 underline"},r(a.stuemail_rc),9,Oe)]),s("td",Ae,r(a.exam),1)]))),128))])])])],64)}}};export{Ze as default};
//# sourceMappingURL=ExamSubmissionCS-iXv69Izn.js.map
