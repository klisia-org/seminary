import{s as B,x as D,i as T,l as C,b as z,d as v,o as d,h as g,f as e,g as x,j as c,w as p,e as t,_ as $,t as u,B as q,y as I,z as O,a as U,c as M,A as H,I as S,D as R,C as j,F as E,k as L,E as F,r as P}from"./index-CVWiL_Ou.js";import{_ as G}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-4m6SQeM8.js";import{_ as Y}from"./CourseOutline-C5dbG8Fg.js";import{f as J,t as K,u as Q}from"./index-BTqjjO0a.js";import{_ as W}from"./InstructorAvatar-Bcvq6Ly9.js";import{C as X}from"./CourseCardToDo-CYMHGz2T.js";import{_ as Z}from"./TextEditor.vue_vue_type_script_setup_true_lang-DxuhnEcI.js";import{S as ee}from"./send-C2BpWnyu.js";import"./FormControl.vue_vue_type_script_setup_true_lang-ClvexRF6.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-9SPyKoxA.js";import"./settings-CEgcVaKi.js";import"./Link-D0cze3Hl.js";import"./plus-C5d9m71e.js";import"./chevron-right-BsOdfCj-.js";import"./book-open-check-yBkpgSvd.js";import"./file-up-BWU3Xov9.js";import"./check-B_liISYN.js";import"./Badge.vue_vue_type_script_setup_true_lang-DMvSTLfT.js";import"./call-DjkLykxt.js";import"./pencil-W75E9_mf.js";import"./FolderPlugin.vue_vue_type_style_index_0_scoped_b4e3a9b2_lang-_2hGWfCr.js";/**
 * @license lucide-vue-next v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=B("UsersIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),te={class:"border-2 rounded-md min-w-80"},oe=["src"],ne={class:"p-5"},ae={key:0,class:"space-y-2"},re={class:"space-y-4"},le={class:"flex items-center text-ink-gray-9"},ue={class:"ml-2"},ie={class:"flex items-center text-ink-gray-9"},de={class:"ml-2"},ce={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(a){const f=D(),n=T("$user"),r=a,o=C(()=>r.course.data.video_link?"https://www.youtube.com/embed/"+r.course.data.video_link:null);function h(){n.data?setTimeout(()=>{f.push({name:"Lesson",params:{courseName:r.course.data.name,chapterNumber:1,lessonNumber:1}})},2e3):(toast.success(__("You need to login to access this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},2e3))}const i=()=>{let l=!1;return r.course.data.instructors.forEach(s=>{var y;!l&&s.user==((y=n.data)==null?void 0:y.name)&&(l=!0)}),console.log(l),l};return(l,s)=>{var V,m,_,k,w,N,b,A;const y=z("router-link");return d(),v("div",te,[a.course.data.video_link?(d(),v("iframe",{key:0,src:o.value,class:"rounded-t-md min-h-56 w-full"},null,8,oe)):g("",!0),e("div",ne,[a.course.data.membership?(d(),v("div",ae,[c(y,{to:{name:"Lesson",params:{courseName:a.course.name,chapterNumber:a.course.data.current_lesson?a.course.data.current_lesson.split("-")[0]:1,lessonNumber:a.course.data.current_lesson?a.course.data.current_lesson.split("-")[1]:1}}},{default:p(()=>[c(t($),{variant:"solid",size:"md",class:"w-full"},{default:p(()=>[...s[1]||(s[1]=[e("span",null,u("Continue Learning"),-1)])]),_:1})]),_:1},8,["to"])])):(d(),x(t($),{key:1,onClick:s[0]||(s[0]=Je=>h()),variant:"solid",class:"w-full",size:"md"},{default:p(()=>[...s[2]||(s[2]=[e("span",null,u("Start Learning"),-1)])]),_:1})),(m=(V=t(n))==null?void 0:V.data)!=null&&m.is_moderator||i()?(d(),x(y,{key:2,to:{name:"CourseForm",params:{courseName:a.course.data.name}}},{default:p(()=>[c(t($),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...s[3]||(s[3]=[e("span",null,u("Edit"),-1)])]),_:1})]),_:1},8,["to"])):g("",!0),(k=(_=t(n))==null?void 0:_.data)!=null&&k.is_moderator||i()?(d(),x(y,{key:3,to:{name:"CourseAssessment",params:{courseName:a.course.data.name}}},{default:p(()=>[c(t($),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...s[4]||(s[4]=[e("span",null,u("Configure Assessments"),-1)])]),_:1})]),_:1},8,["to"])):g("",!0),(N=(w=t(n))==null?void 0:w.data)!=null&&N.is_moderator||i()?(d(),x(y,{key:4,to:{name:"Gradebook",params:{courseName:a.course.data.name}}},{default:p(()=>[c(t($),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...s[5]||(s[5]=[e("span",null,u("Gradebook"),-1)])]),_:1})]),_:1},8,["to"])):g("",!0),(A=(b=t(n))==null?void 0:b.data)!=null&&A.is_moderator||i()?(d(),x(y,{key:5,to:{name:"StudentAttendanceCS",params:{courseName:a.course.data.name}}},{default:p(()=>[c(t($),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:p(()=>[...s[6]||(s[6]=[e("span",null,u("Attendance"),-1)])]),_:1})]),_:1},8,["to"])):g("",!0),e("div",re,[s[7]||(s[7]=e("div",{class:"mt-8 font-medium text-ink-gray-9"},u("This course has:"),-1)),e("div",le,[c(t(q),{class:"h-4 w-4 stroke-1.5"}),e("span",ue,u(a.course.data.lessons)+" "+u("Lessons"),1)]),e("div",ie,[c(t(se),{class:"h-4 w-4 stroke-1.5"}),e("span",de,u(t(J)(a.course.data.enrollments))+" "+u("Enrolled Students"),1)])])])])}}},me={class:"flex flex-col gap-4"},_e={class:""},pe={class:"mb-1.5 text-sm text-ink-gray-5"},fe={class:""},ve={class:"mb-1.5 text-sm text-ink-gray-5"},ye={class:"mb-4"},be={class:"mb-1.5 text-sm text-ink-gray-5"},he={__name:"AnnouncementModal",props:I({cs:{type:String,required:!0},students:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const f=O(a,"modelValue"),n=a,r=U({subject:"",replyTo:"",announcement:""}),o=M({url:"frappe.core.doctype.communication.email.make",makeParams(i){return{recipients:n.students.join(", "),cc:r.replyTo,subject:r.subject,content:r.announcement,doctype:"Course Schedule",name:n.cs,send_email:1}}}),h=i=>{o.submit({},{validate(){if(!n.students.length)return"No students in this course";if(!r.subject)return"Subject is required"},onSuccess(){i(),j.success(__("Announcement has been sent successfully"))},onError(l){var s;j.error(((s=l.messages)==null?void 0:s[0])||l)}})};return(i,l)=>(d(),x(t(R),{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=s=>f.value=s),options:{title:i.__("Make an Announcement"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:s=>h(s)}]}},{"body-content":p(()=>[e("div",me,[e("div",_e,[e("div",pe,[H(u(i.__("Subject"))+" ",1),l[4]||(l[4]=e("span",{class:"text-ink-red-3"},"*",-1))]),c(t(S),{type:"text",modelValue:r.subject,"onUpdate:modelValue":l[0]||(l[0]=s=>r.subject=s)},null,8,["modelValue"])]),e("div",fe,[e("div",ve,u(i.__("Reply To")),1),c(t(S),{type:"text",modelValue:r.replyTo,"onUpdate:modelValue":l[1]||(l[1]=s=>r.replyTo=s)},null,8,["modelValue"])]),e("div",ye,[e("div",be,u(i.__("Announcement")),1),c(t(Z),{fixedMenu:!0,onChange:l[2]||(l[2]=s=>r.announcement=s),editorClass:"prose-sm py-2 px-2 min-h-[200px] border-outline-gray-2 hover:border-outline-gray-3 rounded-b-md bg-surface-gray-3"})])])]),_:1},8,["modelValue","options"]))}},ke={class:"border-2 rounded-md min-w-80 p-5"},ge={key:0},xe={class:"mb-8"},$e={class:"flex items-center justify-between mb-2"},we={class:"flex items-center"},Ne={class:"ml-2 text-ink-gray-7"},Ce={class:"text-sm"},Ve=["innerHTML"],Me={key:1,class:"text-sm italic text-ink-gray-5"},Ae={__name:"Announcements",props:{cs:{type:String,required:!0}},setup(a){const f=a,n=M({url:"seminary.seminary.api.get_announcements",makeParams(r){return{cs:f.cs}},auto:!0,cache:["announcement",f.cs]});return(r,o)=>{var h;return d(),v("div",ke,[(h=t(n).data)!=null&&h.length?(d(),v("div",ge,[(d(!0),v(E,null,L(t(n).data,i=>(d(),v("div",null,[e("div",xe,[e("div",$e,[e("div",we,[c(t(F),{label:i.sender_full_name,size:"lg"},null,8,["label"]),e("div",Ne,u(i.sender_full_name),1)]),e("div",Ce,u(t(K)(i.communication_date)),1)]),e("div",{class:"prose prose-sm bg-surface-menu-bar !min-w-full px-4 py-2 rounded-md",innerHTML:i.content},null,8,Ve)])]))),256))])):(d(),v("div",Me,u(r.__("No announcements")),1))])}}},Se={key:0},je={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},Te={class:"m-5"},ze={class:"flex justify-between w-full"},Ee={class:"md:w-2/3"},Le={class:"text-3xl font-semibold text-ink-gray-9"},Be={class:"my-3 leading-6 text-ink-gray-7"},De=["innerHTML"],qe={class:"mt-10"},Ie={key:0,class:"text-lg font-semibold"},Oe={key:1,class:"text-lg font-semibold"},Ue={class:"flex flex-wrap gap-4"},He={class:"text-center text-sm font-medium"},Re={class:"mt-10"},Fe={class:"border-0 rounded-md min-w-80"},Pe={class:"mt-5"},Ge={class:"mt-5"},Ye={class:"mt-5"},vs={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(a){const f=T("$user"),n=a,r=P(!1);console.log("CourseName prop:",n.courseName);const o=M({url:"seminary.seminary.utils.get_course_details",cache:["course",n.courseName],params:{course:n.courseName},auto:!0});console.log(o),console.log("Course props:",n.courseName);const h=M({url:"seminary.seminary.utils.get_roster",cache:["roster",n.courseName],params:{course:n.courseName},auto:!0}),i=C(()=>(h.data||[]).map(m=>m.stuemail_rc));console.log("Student Emails:",i.value);const l=()=>{r.value=!0},s=C(()=>{const m=(f==null?void 0:f.data)||{};return!!(m.is_moderator||m.is_instructor||m.is_evaluator)}),y=C(()=>{var _,k;let m=[{label:"Courses",route:{name:"Courses"}}];return m.push({label:(_=o==null?void 0:o.data)==null?void 0:_.course,route:{name:"CourseDetail",params:{courseName:(k=o==null?void 0:o.data)==null?void 0:k.name}}}),m}),V=C(()=>{var m,_;return{title:(m=o==null?void 0:o.data)==null?void 0:m.title,description:(_=o==null?void 0:o.data)==null?void 0:_.short_introduction}});return Q(V),(m,_)=>{var w,N;const k=z("Button");return t(o).data?(d(),v("div",Se,[e("header",je,[c(t(G),{class:"h-7",items:y.value},null,8,["items"])]),e("div",Te,[e("div",ze,[e("div",Ee,[e("div",Le,u(t(o).data.course),1),e("div",Be,u(t(o).data.short_introduction),1),e("div",{innerHTML:t(o).data.course_description_for_lms,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,De),e("div",qe,[t(o).data.instructors.length===1?(d(),v("div",Ie,"Instructor")):(d(),v("div",Oe,"Instructors")),_[2]||(_[2]=e("br",null,null,-1)),e("div",Ue,[(d(!0),v(E,null,L(t(o).data.instructors,b=>(d(),v("div",{key:b.instructor_name,class:"flex flex-col items-center"},[c(W,{instructor:b,size:"xl",class:"mb-2 w-20 h-20"},null,8,["instructor"]),e("div",He,u(b.instructor_name),1)]))),128))])]),e("div",Re,[c(Y,{title:"Course Outline",courseName:t(o).data.name,showOutline:!0,allowEdit:s.value},null,8,["courseName","allowEdit"])])]),e("div",Fe,[c(ce,{course:t(o),class:"mb-4"},null,8,["course"]),e("div",Pe,[c(X,{course:n.courseName},null,8,["course"])]),e("div",Ge,[c(Ae,{cs:n.courseName},null,8,["cs"])]),(w=t(f).data)!=null&&w.is_moderator||(N=t(f).data)!=null&&N.is_instructor?(d(),x(k,{key:0,onClick:_[0]||(_[0]=b=>l())},{suffix:p(()=>[c(t(ee),{class:"h-4 stroke-1.5"})]),default:p(()=>[e("span",null,u(m.__("Make an Announcement")),1)]),_:1})):g("",!0),e("div",Ye,[c(he,{modelValue:r.value,"onUpdate:modelValue":_[1]||(_[1]=b=>r.value=b),cs:n.courseName,students:i.value},null,8,["modelValue","cs","students"])])])])])])):g("",!0)}}};export{vs as default};
//# sourceMappingURL=CourseDetail-CdCkZCao.js.map
