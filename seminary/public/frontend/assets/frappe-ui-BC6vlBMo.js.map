{"version":3,"mappings":"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","names":["props","__props","emit","__emit","__expose","open","close","_isOpen","ref","pointerOverTargetOrPopup","hoverTimer","leaveTimer","anchorRef","isOpen","computed","isShowPropPassed","value","placementSide","side","placementAlign","align","togglePopover","flag","updatePosition","onUpdateOpen","onMouseover","onMouseleave","onInteractOutside","event","target","hasTransition","onUnmounted","_createBlock","_unref","PopoverRoot","$event","_createVNode","PopoverAnchor","_createElementVNode","_normalizeClass","$attrs","_renderSlot","_ctx","_normalizeProps","_guardReactiveProps","PopoverPortal","PopoverContent","_normalizeStyle","_cache","_hoisted_1","validIcons","feather","_sfc_main","valid","icon","h","mergeProps","_createElementBlock","delayDuration","TooltipProvider","TooltipRoot","TooltipTrigger","TooltipPortal","$slots","TooltipContent","_createTextVNode","_toDisplayString","TooltipArrow","slots","useSlots","router","useRouter","buttonClasses","solidClasses","subtleClasses","outlineClasses","ghostClasses","focusClasses","variantClasses","themeVariant","disabledClasses","sizeClasses","isIconButton","isDisabled","slotClasses","ariaLabel","hasLucideIconInDefaultSlot","slotContent","firstVNode","_a","_c","_b","handleClick","rootRef","Tooltip","_mergeProps","LoadingIndicator","FeatherIcon","_openBlock","_resolveDynamicComponent","_Fragment","searchInput","showOptions","query","groups","isOptionGroup","sanitizeOptions","group","i","filterOptions","allOptions","options","option","isOption","selectedValue","findOption","makeOption","values","v","val","o","getLabel","displayValue","isOptionSelected","areAllOptionsSelected","selectAll","clearAll","watch","nextTick","Combobox","_withCtx","isComboboxOpen","Popover","openPopover","closePopover","_hoisted_2","_hoisted_4","_hoisted_5","_hoisted_6","ComboboxOptions","_hoisted_7","_hoisted_8","ComboboxInput","_hoisted_9","_renderList","_hoisted_10","idx","ComboboxOption","active","selected","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","Button","_hoisted_20","imgFetchError","shapeClasses","labelClasses","indicatorContainerClasses","indicatorClasses","iconClasses","handleImageError","err","classes","id","generateId","useId","model","_useModel","switchClasses","switchCircleClasses","switchLabelClasses","switchGroupClasses","_hoisted_3","SwitchRoot","_withKeys","_withModifiers","SwitchThumb","toggleState","attrs","useAttrs","handleItemClick","item","normalizeDropdownItem","__spreadProps","__spreadValues","getIconColor","getTextColor","getBackgroundColor","getSubmenuBackgroundColor","processOptionsIntoGroups","currentGroup","groupOption","getSubmenuGroups","submenuOptions","groupHasIcons","cssClasses","DropdownMenuRoot","DropdownMenuTrigger","DropdownMenuPortal","DropdownMenuContent","DropdownMenuLabel","Switch","DropdownMenuItem","DropdownMenuSub","DropdownMenuSubTrigger","DropdownMenuSubContent","submenuGroup","subItem","width","useWindowSize","items","dropdownItems","onClick","crumbs","Dropdown","_component_router_link","htmlId","inputClasses","baseClasses","interactionClasses","e","$emit","debounce","func","wait","immediate","timeout","context","args","later","attrsWithoutClassStyle","key","inputRef","textColor","paddingClasses","variant","prefixClasses","suffixClasses","emitChange","handleChange","config","setConfig","getConfig","_dayjs","updateLocale","relativeTime","localizedFormat","isToday","duration","utc","timezone","advancedFormat","customParseFormat","getBrowserTimezone","dayjsLocal","dateTimeString","systemTimezone","localTimezone","dayjsSystem","dayjs","months","monthStart","year","monthIndex","generateWeeks","start","end","days","d","inMonth","sel","chunked","getDateValue","date","panelRef","isFocused","highlightIndex","hasSelectedOnFirstClick","isTyping","navUpdating","invalidState","initial","internalValue","formatDisplay","uid","activeDescendantId","optionId","minutesFromHHMM","str","m","n","minMinutes","maxMinutes","displayedOptions","normalize24","out","hh","mm","nv","raw","parsed","parseFlexibleTime","val24","segs","s","base24","am","input","re","hhStr","mmStr","ssStr","ap","ss","findNearestIndex","targetMinutes","list","minutesArr","lo","hi","mid","candidates","a","b","isOutOfRange","totalMinutes","applyValue","commit","prev","setInvalid","commitInput","normalized","base","nearestIdx","nearestVal","committed","select","forceChange","selectedAndNearest","parsedTyped","candidate","candidateCompare","opt","nearest","scheduleScroll","targetEl","initHighlight","moveHighlight","delta","onArrowDown","onArrowUp","onEnter","blurInput","exists","onClickInput","onFocus","onBlur","el","onEscape","TextInput","DATE_FORMAT","DATE_TIME_FORMAT","autoClose","toRefs","view","currentYear","currentMonth","selectedDate","timeValue","initialValue","coerceDateTime","dStrict","dLoose","dNorm","syncFromValue","now","initFromValue","combinedValue","local","displayLabel","inputValue","maybeClose","condition","clearSelection","selectDate","popoverContentRef","next","activateInput","minDT","maxDT","dateDisabled","weeks","week","obj","computedMinTime","computedMaxTime","cur","selectMonth","selectYear","handleDateCellClick","onTimeChange","localDateTime","systemDateTime","handleNowClick","handleTomorrowClick","tomorrow","handleClearClick","cycleView","handleClose","yearRangeStart","yearRange","_","wi","dateObj","y","TimePicker","actions","action","_action","reactive","__async","backwardsCompatibleContext","handleOpenChange","dialogPositionClasses","position","dialogIconBgClasses","appearance","dialogIconClasses","DialogRoot","DialogPortal","DialogOverlay","DialogContent","DialogTitle","DialogClose","LucideX","DialogDescription","Dialog","DialogMain","errorMessage","FileUploadHandler","handler","data","file","resolve","reject","xhr","error","r","uploadEndpoint","form_data","message","$props","$options","$data","selectOptions","fontSizeClasses","selectClasses","textareaRef","__default__","controlAttrs","_attrs","descriptionClasses","FormLabel","_createSlots","itemPrefixProps","isValid","$input","onInput","_component_FeatherIcon","imageRef","containerRef","isResizing","startDragX","startWidth","originalAspectRatio","selectImage","caption","isEditable","onMounted","initialWidth","initialHeight","updateCaption","newCaption","handleKeydown","createParagraphAfterImage","setCursorAfterImage","setCursorBeforeImage","setCursorAt","pos","startResize","height","handleResize","stopResize","editorWidth","deltaX","newWidth","newHeight","finalWidth","finalHeight","setAlignment","NodeViewWrapper","node","LucideAlignLeft","LucideAlignCenter","LucideAlignRight","LucideMoveDiagonal2","ErrorMessage","inputRegex","ImageExtension","NodeExtension","element","attributes","HTMLAttributes","mergeAttributes","VueNodeViewRenderer","ImageNodeView","commands","editor","result","findImageNodeBySource","updateNodeWithDimensions","uploadImage","nodeInputRule","match","alt","src","title","extensionThis","Plugin","images","coordinates","transaction","Selection","processMultipleImages","clipboardItems","transactions","oldState","newState","newImageNodes","tr","findInsertPosition","lastNodeId","insertPos","uploadImageBase","insertMode","onComplete","moveCursor","uploadId","fileToBase64","base64Result","nodeSize","nodePos","p","posAfter","uploadedImage","getImageDimensions","dimensions","uploadImageWithTracking","callback","currentAttrs","img","imageQueue","lastInsertedNodeId","processNextImage","currentPos","newNodeId","useTouchHandler","targetRef","zoomLevel","onSwipeLeft","onSwipeRight","onDoubleTap","onTap","onPanStart","onPanMove","onPanAnimate","onPanEnd","onPinchStart","onPinchMove","onPinchEnd","doubleTapDelay","minSwipeDistance","maxVerticalSwipeDistance","maxTapDuration","maxTapMovement","panThreshold","inertiaDamping","inertiaVelocityThreshold","isPanning","isPinching","isAnimatingPan","startPanCoords","lastTapTime","touchStartTime","touchStartDistance","initialTouchPoints","lastMoveTime","lastMoveCoords","panVelocity","animationFrameId","cancelInertiaAnimation","handleTouchStart","currentTime","timeSinceLastTap","touch","touch1","touch2","handleTouchMove","deltaTime","currentDistance","scale","currentX","currentY","rawDeltaX","rawDeltaY","deltaXFromStart","deltaYFromStart","zoomFactor","panDeltaX","panDeltaY","handleTouchEnd","touchesLeft","touchEndTime","wasPanning","wasPinching","finalVelocity","lastFrameTime","animVelocity","animate","frameDeltaTime","moveX","moveY","dampingFactor","endCoords","deltaY","newTarget","oldTarget","readonly","useImageNavigation","initialIndex","imageCount","onNavigate","currentIndex","newVal","nextImage","previousImage","useZoomPan","isEnabled","panPosition","isMousePanning","startMousePanCoords","initialPanPositionOnGestureStart","snapThresholdLower","snapThresholdUpper","newZoom","oldZoom","zoomIn","zoomOut","resetZoom","handlePanStart","handlePanMove","moveEvent","handlePanEnd","handleWheel","zoomChange","currentZoom","clampedZoom","container","INACTIVITY_TIMEOUT","imageContainer","useTemplateRef","backdropElement","controlsBar","controlsBarHeight","isFullscreen","touchStartZoom","isControlsVisible","inactivityTimer","toRef","currentImage","isTouchPanning","finalZoom","showControlsAndResetTimer","handleActivity","downloadImage","imageToDownload","link","filename","toggleFullscreen","handleFullscreenChange","handleKeyDown","newValue","updateHeight","resizeObserver","_Teleport","_Transition","LucideChevronLeft","LucideChevronRight","LucideMinus","LucidePlus","LucideDownload","LucideMinimize","LucideMaximize","ImageViewerExtension","Extension","style","image","openImageViewerModal","extension","PluginKey","state","clickedNode","foundImageNode","domNode","app","createApp","ImageViewerModal","VideoExtension","Node","uploadVideoInternal","div","video","videoPill","uploadedVideo","schema","ALLOWED_DOMAINS","PLATFORM_CONFIGS","detectPlatform","url","domain","pattern","calculateAspectRatio","platform","getOptimalDimensions","containerWidth","aspectInfo","maxWidth","validateURL","blocked","allowed","processURL","convertToYouTubeEmbed","convertToVimeoEmbed","convertToCodePenEmbed","convertToFigmaEmbed","urlObj","videoId","iframeRef","selectIframe","iframeStyles","createParagraphAfterIframe","setCursorAfterIframe","setCursorBeforeIframe","IframeExtension","IframeNodeView","processedSrc","editorElement","optimalDimensions","processedUrl","slice","text","html","iframeData","parseIframeFromHTML","createIframeNode","iframe","iframeMatch","widthMatch","heightMatch","titleMatch","isValidUrl","_href","submitLink","LucideCheck","linkPasteHandler","selection","empty","textContent","LinkExtension","Link","from","to","doc","range","mark","shouldDelayPopover","$pos","markRange","getMarkRange","existingHref","selectionFrom","selectionTo","showPopover","openLinkEditor","href","chain","posAfterLink","charAfter","plugins","clearLinkOnBoundaryPlugin","anchor","virtualReference","rect","isCollapsed","tippyInstance","isDestroyed","promiseSettled","settlePromise","destroy","EditLink","newHref","tippy","storedMarks","$from","linkMarkType","textColorHexMap","highlightColorHexMap","legacyTextColorMap","legacyHighlightColorMap","getClosestNamedColor","color","allowedColors","colorMap","legacyMap","g","hex","rgbMatch","closestColor","minDistance","colorName","namedHex","namedHexClean","nr","ng","nb","distance","extractColorFromStyle","property","allColorsInMap","hexColorMatch","closestOverallColor","rgbColorMatch","extractTextColorFromStyle","extractHighlightColorFromStyle","NamedColorExtension","colorMatch","extractedColor","commandChain","NamedHighlightExtension","Mark","highlightMatch","legacyColorAttr","highlightAttributes","isCurrentlyActive","NodeViewContent","nodeViewProps","language","_component_node_view_wrapper","index","_component_node_view_content","createSuggestionExtension","customOptions","component","popup","VueRenderer","defaultTippyOptions","Suggestion","selectedIndex","itemRefs","onBeforeUpdate","scrollIntoView","selectedElement","selectItem","onKeyDown","upHandler","downHandler","enterHandler","createMentionNode","dom","MentionSuggestionExtension","SuggestionList","_mentions","ext","toValue","mention","MentionExtension","button","_component_Popover","_vShow","componentSlotProps","Text","H1","H2","H3","H4","H5","H6","Bold","Italic","Underline","Strikethrough","ListUnordered","ListOrdered","ListTask","AlignCenter","AlignLeft","AlignRight","FontColor","defineAsyncComponent","__vitePreload","FontColor$1","DoubleQuotes","CodeView","Separator","InsertLink","Image","InsertImage","Video","InsertVideo","GalleryVertical","InsertIframe","ArrowGoBack","ArrowGoForward","Table","createEditorButton","Menu","buttons","_component_Menu","BubbleMenu","_component_BubbleMenu","FloatingMenu","_component_FloatingMenu","suggestionList","onItemSelect","EMOJIS","_EMOJIS","EmojiExtension","aName","bName","queryLower","EmojiList","SlashCommandSuggestionKey","getCommands","Heading2","Heading3","List","Code","Quote","Minus","SlashCommands","SlashCommandsList","markdownToHTML","marked","detectMarkdown","line","ContentPasteExtension","files","htmlContent","tempDiv","parsedSlice","DOMParser","TagNode","TagExtension","_tags","tags","filteredTags","tag","Heading","TiptapHeading","level","regexp","textblockTypeInputRule","modelValue","isFileDragging","draggedIndex","overIndex","columnsInitialized","editingCaption","captionEditValue","captionInputRef","uploading","columns","uploadProgress","uploadedCount","totalCount","uploadErrors","uploadResults","existingItems","createExistingImageItem","fileItems","createImageItem","getDefaultColumns","newExistingImages","newFiles","onDragOverWindow","onDrop","onDragLeaveWindow","handleSave","uploadFiles","fileToUploadMap","finalImages","handleUpload","uploadedImages","handleCancel","removeImage","triggerFileInput","fileInput","addFiles","newImageItems","existingFileSignatures","uniqueNewItems","droppedFiles","moved","existing","count","getUploadFunction","imageGroupExtension","filePreview","isImageSupported","unsupportedTypes","unsupportedExtensions","hasUnsupportedType","hasUnsupportedExtension","onDragOver","onDragStart","onDragEnd","onDragLeave","isDropTarget","gridStyle","internalColumns","startEditingCaption","itemId","currentAlt","saveCaption","itemIndex","type","indexStr","cancelEditingCaption","handleCaptionBlur","uploadFunction","uploadPromises","LucideImagePlus","Select","_d","_hoisted_21","_hoisted_22","_hoisted_23","showViewer","viewerIndex","viewerImages","showEditModal","editFiles","existingImages","updateEditable","edit","handleEditModalClose","handleEditSave","newContent","newAttrs","newNode","openViewer","newImages","LucideEdit","ImageGroupUploadDialog","ImageGroup","ImageGroupNodeView","useFileUpload","reset","isUploading","progress","upload","_0","exception","errorParts","messages","formData","k","lowlight","createLowlight","common","defaultUploadFunction","attrsClass","normalizeClass","attrsStyle","normalizeStyle","editorProps","Editor","StarterKit","TaskList","TaskItem","TableRow","TableHeader","TableCell","Typography","TextAlign","TextStyle","CodeBlockLowlight","CodeBlockComponent","Placeholder","onBeforeUnmount","provide","TextEditorBubbleMenu","TextEditorFixedMenu","TextEditorFloatingMenu","EditorContent","inject","getGridTemplateColumns","withCheckbox","checkBoxWidth","columnsWidth","col","alignmentMap","resizer","columnRef","widthInPx","parsedWidth","startResizing","initialX","onMouseMove","updateWidth","onMouseUp","useDebounceFn","Checkbox","column","ListHeaderItem","label","getValue","tooltip","isLastRow","isSelected","isActive","isHoverable","rowHeight","roundedClass","selections","rows","atBottom","atTop","onRowClick","row","ListRowItem","ListRow","toggleGroup","DownSolid","ListGroupHeader","ListGroupRows","selectedText","activeRow","_options","defaultTrue","defaultFalse","allRowsSelected","showGroupedRows","acc","selectable","toggleRow","toggleAllRows","ListHeader","ListGroups","ListRows","ListEmptyState","ListSelectBanner","modelOpen","handleAction","ToastRoot","CircleCheck","LucideAlertTriangle","LucideInfo","ToastDescription","ToastAction","ToastClose","toastsState","toastIdCounter","updateToastInState","updates","t","toast","durationInMs","sanitizedMessage","DOMPurify","toastItem","promiseToResolve","loadingDurationInSeconds","toastId","successMessage","successToastDurationInSeconds","errorToastDurationInSeconds","_e","Toasts","defineComponent","handleUpdateOpen","handleActionForItem","ToastComponent","ToastProvider","ToastViewport","call","_1","method","headers","path","res","warning","response","reader","faviconRef","defaultFavIcon","initializeFavicon","usePageMeta","fn","stopWatcher","pageMeta","getCurrentInstance","pageMetaPlugin","createMixin","request","body","params","saveLocal","set","deleteLocal","del","getLocal","get","cached","createResource","vm","cacheKey","getCacheKey","cachedResource","fetchFunction","fetch","update","setData","tempOptions","resourceFetcher","beforeSubmitFunctions","validateFunction","errorFunctions","successFunctions","dataFunctions","invalidMessage","handleError","transform","auto","errorHandler","returnValue","getCachedResource","onDocUpdate","socket","doctype","subscribe","subscribed","listCache","resourcesByDocType","createListResource","defaultListUrl","defaultDocInsertUrl","defaultDocUpdateUrl","defaultDocDeleteUrl","defaultRunDocMethodUrl","previous","pagedData","name","updateRowInListResource","__objRest","_f","_g","reload","getRow","updatedOptions","_start","_pageLength","getCachedListResource","resources","resource","previousRowData","deleteRowInListResource","docname","revertRowInListResource","documentCache","createDocumentResource","defaultDocGetUrl","setValueOptions","autoPropIsPassed","setDoc","methodKey","methodOptions","onSuccess","makeParams","_transform","otherOptions","getCachedDocumentResource","mixinOptions","oldOptions","createResourceForOptions","cache","resourcesPlugin","resourceMixin","frappeRequest","onMessageHandler","errorResponse","initSocket","host","siteName","socketio_port","port","io","IDBStore","entries","setMany","keys","operation","idbStore","DocStore","minutes","docRef","nameStr","isFirstLoad","idbDoc","docs","docMap","fetchTime","docKeys","docStore","ListStore","docType","listStore","FrappeResponseError","createFetch","setHeaders","ctx","responseData","errorDescription","frappeError","csrfToken","defaultHeaders","defaultOptions","FrappeUI","callFunction","_component_Tooltip","showModal","selectedFiles","openFileSelector","onImageSelect","selectAndUploadVideo","showDialog","embedUrl","urlError","alignment","customWidth","customHeight","urlInput","srcMatch","platformInfo","validateUrl","openIframeDialog","insertIframe","handleSlashCommandInsert","Textarea"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139],"sources":["../../../../frontend/node_modules/frappe-ui/src/components/Popover/Popover.vue","../../../../frontend/node_modules/frappe-ui/src/components/FeatherIcon.vue","../../../../frontend/node_modules/frappe-ui/src/components/LoadingIndicator.vue","../../../../frontend/node_modules/frappe-ui/src/components/Tooltip/Tooltip.vue","../../../../frontend/node_modules/frappe-ui/src/components/Button/Button.vue","../../../../frontend/node_modules/frappe-ui/src/components/Autocomplete/Autocomplete.vue","../../../../frontend/node_modules/frappe-ui/src/components/Avatar/Avatar.vue","../../../../frontend/node_modules/frappe-ui/src/components/Badge/Badge.vue","../../../../frontend/node_modules/frappe-ui/src/utils/useId.ts","../../../../frontend/node_modules/frappe-ui/src/components/Switch/Switch.vue","../../../../frontend/node_modules/frappe-ui/src/components/Dropdown/Dropdown.vue","../../../../frontend/node_modules/frappe-ui/src/components/Breadcrumbs/Breadcrumbs.vue","../../../../frontend/node_modules/frappe-ui/src/components/Checkbox/Checkbox.vue","../../../../frontend/node_modules/frappe-ui/src/utils/debounce.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextInput/TextInput.vue","../../../../frontend/node_modules/frappe-ui/src/utils/config.ts","../../../../frontend/node_modules/frappe-ui/src/utils/dayjs.ts","../../../../frontend/node_modules/frappe-ui/src/components/DatePicker/utils.ts","../../../../frontend/node_modules/frappe-ui/src/components/TimePicker/TimePicker.vue","../../../../frontend/node_modules/frappe-ui/src/components/DatePicker/DateTimePicker.vue","../../../../frontend/node_modules/frappe-ui/src/components/Dialog/Dialog.vue","../../../../frontend/node_modules/frappe-ui/src/components/Dialog/index.ts","../../../../frontend/node_modules/frappe-ui/src/utils/confirmDialog.js","../../../../frontend/node_modules/frappe-ui/src/components/ErrorMessage/ErrorMessage.vue","../../../../frontend/node_modules/frappe-ui/src/utils/fileUploadHandler.ts","../../../../frontend/node_modules/frappe-ui/src/components/FileUploader/FileUploader.vue","../../../../frontend/node_modules/frappe-ui/src/components/Select/Select.vue","../../../../frontend/node_modules/frappe-ui/src/components/Textarea/Textarea.vue","../../../../frontend/node_modules/frappe-ui/src/components/FormLabel.vue","../../../../frontend/node_modules/frappe-ui/src/components/FormControl/FormControl.vue","../../../../frontend/node_modules/frappe-ui/src/components/Input.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/image/ImageNodeView.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/image/image-extension.ts","../../../../frontend/node_modules/frappe-ui/src/composables/useTouchHandler.ts","../../../../frontend/node_modules/frappe-ui/src/composables/useImageNavigation.ts","../../../../frontend/node_modules/frappe-ui/src/composables/useZoomPan.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/ImageViewerModal.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/image-viewer-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/video-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/iframe/utils.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/iframe/IframeNodeView.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/iframe/iframe-extension.ts","../../../../frontend/node_modules/frappe-ui/src/utils/url-validation.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/EditLink.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/linkPasteHandler.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/link-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/shared/color-utils.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/color/color-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/highlight/highlight-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/CodeBlockComponent.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/suggestion/createSuggestionExtension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/suggestion/SuggestionList.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/mention/mention-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/Menu.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-1.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-2.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-3.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-4.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-5.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/h-6.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/text.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/bold.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/italic.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/underline.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/strikethrough.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/align-center.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/align-left.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/align-right.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/font-color.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/list-ordered.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/list-unordered.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/list-task.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/double-quotes-r.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/code-view.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/link.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/image-add-line.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/video-add-line.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/arrow-go-back-line.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/arrow-go-forward-line.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/separator.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/icons/table-2.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/commands.js","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/utils.js","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/TextEditorFixedMenu.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/TextEditorBubbleMenu.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/TextEditorFloatingMenu.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/emoji/EmojiList.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/emoji/emoji-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/slash-commands/SlashCommandsList.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/slash-commands/slash-commands-extension.ts","../../../../frontend/node_modules/frappe-ui/src/utils/markdown.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/content-paste-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/tag/tag-extension.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/heading/heading.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/image-group/ImageGroupUploadDialog.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/image-group/ImageGroupNodeView.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/image-group/image-group-extension.ts","../../../../frontend/node_modules/frappe-ui/src/utils/useFileUpload.ts","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/TextEditor.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListEmptyState.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/utils.js","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListHeaderItem.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListHeader.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListRowItem.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListRow.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListRows.vue","../../../../frontend/node_modules/frappe-ui/src/icons/DownSolid.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListGroupHeader.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListGroupRows.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListGroups.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListSelectBanner.vue","../../../../frontend/node_modules/frappe-ui/src/components/ListView/ListView.vue","../../../../frontend/node_modules/frappe-ui/src/icons/CircleCheck.vue","../../../../frontend/node_modules/frappe-ui/src/components/Toast/Toast.vue","../../../../frontend/node_modules/frappe-ui/src/components/Toast/index.ts","../../../../frontend/node_modules/frappe-ui/src/components/Calendar/composables/useCalendarData.js","../../../../frontend/node_modules/frappe-ui/src/components/Toast/ToastProvider.vue","../../../../frontend/node_modules/frappe-ui/src/components/Provider/FrappeUIProvider.vue","../../../../frontend/node_modules/frappe-ui/src/utils/call.js","../../../../frontend/node_modules/frappe-ui/src/utils/file-to-base64.ts","../../../../frontend/node_modules/frappe-ui/src/utils/pageMeta.ts","../../../../frontend/node_modules/frappe-ui/src/utils/request.js","../../../../frontend/node_modules/frappe-ui/src/resources/local.js","../../../../frontend/node_modules/frappe-ui/src/resources/resources.js","../../../../frontend/node_modules/frappe-ui/src/resources/realtime.js","../../../../frontend/node_modules/frappe-ui/src/resources/listResource.js","../../../../frontend/node_modules/frappe-ui/src/resources/documentResource.js","../../../../frontend/node_modules/frappe-ui/src/resources/plugin.js","../../../../frontend/node_modules/frappe-ui/src/utils/frappeRequest.js","../../../../frontend/node_modules/frappe-ui/src/utils/socketio.js","../../../../frontend/node_modules/frappe-ui/src/data-fetching/idbStore.ts","../../../../frontend/node_modules/frappe-ui/src/data-fetching/docStore.ts","../../../../frontend/node_modules/frappe-ui/src/data-fetching/useList/listStore.ts","../../../../frontend/node_modules/frappe-ui/src/data-fetching/useFrappeFetch.ts","../../../../frontend/node_modules/frappe-ui/src/utils/plugin.js","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/FontColor.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/InsertLink.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/InsertImage.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/InsertVideo.vue","../../../../frontend/node_modules/frappe-ui/src/components/TextEditor/extensions/iframe/InsertIframe.vue"],"sourcesContent":["<template>\n  <PopoverRoot v-model:open=\"isOpen\" @update:open=\"onUpdateOpen\">\n    <PopoverAnchor asChild>\n      <div\n        ref=\"anchorRef\"\n        :class=\"['flex', $attrs.class]\"\n        @mouseover=\"onMouseover\"\n        @mouseleave=\"onMouseleave\"\n      >\n        <slot\n          name=\"target\"\n          v-bind=\"{\n            togglePopover,\n            updatePosition,\n            open,\n            close,\n            isOpen,\n          }\"\n        />\n      </div>\n    </PopoverAnchor>\n    <PopoverPortal>\n      <PopoverContent\n        :side=\"placementSide\"\n        :align=\"placementAlign\"\n        :style=\"{\n          minWidth: matchTargetWidth\n            ? 'var(--reka-popover-trigger-width)'\n            : undefined,\n        }\"\n        :class=\"['PopoverContent', { 'has-transition': hasTransition }]\"\n        @mouseover=\"\n          () => {\n            pointerOverTargetOrPopup = true\n          }\n        \"\n        @mouseleave=\"onMouseleave\"\n        @interact-outside=\"onInteractOutside\"\n      >\n        <div class=\"relative\" :class=\"['body-container', popoverClass]\">\n          <slot\n            name=\"body\"\n            v-bind=\"{ togglePopover, updatePosition, open, close, isOpen }\"\n          >\n            <div class=\"rounded-lg border bg-surface-modal shadow-xl\">\n              <slot\n                name=\"body-main\"\n                v-bind=\"{\n                  togglePopover,\n                  updatePosition,\n                  open,\n                  close,\n                  isOpen,\n                }\"\n              />\n            </div>\n          </slot>\n        </div>\n      </PopoverContent>\n    </PopoverPortal>\n  </PopoverRoot>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, onUnmounted } from 'vue'\nimport {\n  PopoverAnchor,\n  PopoverContent,\n  PopoverPortal,\n  PopoverRoot,\n} from 'reka-ui'\nimport { PopoverProps } from './types'\n\nconst props = withDefaults(defineProps<PopoverProps>(), {\n  show: undefined,\n  trigger: 'click',\n  hoverDelay: 0,\n  leaveDelay: 0.5,\n  placement: 'bottom-start',\n  popoverClass: '',\n  transition: null,\n  hideOnBlur: true,\n})\n\nconst emit = defineEmits<{\n  (event: 'open'): void\n  (event: 'close'): void\n  (event: 'update:show', value: boolean): void\n}>()\n\ndefineExpose({ open, close })\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst _isOpen = ref(false)\nconst pointerOverTargetOrPopup = ref(false)\nconst hoverTimer = ref<number | null>(null)\nconst leaveTimer = ref<number | null>(null)\nconst anchorRef = ref<HTMLElement | null>(null)\n\nconst isOpen = computed({\n  get: () => (isShowPropPassed.value ? props.show : _isOpen.value),\n  set: (value: boolean) => {\n    if (!isShowPropPassed.value) {\n      _isOpen.value = value\n    }\n    emit('update:show', value)\n  },\n})\n\nconst isShowPropPassed = computed(() => {\n  return props.show !== undefined\n})\n\nconst placementSide = computed(() => {\n  const [side] = props.placement.split('-')\n  return side as 'top' | 'right' | 'bottom' | 'left'\n})\n\nconst placementAlign = computed(() => {\n  const [, align] = props.placement.split('-')\n  if (!align) return 'center'\n  return align as 'start' | 'center' | 'end'\n})\n\nfunction togglePopover(flag?: boolean | Event) {\n  if (flag instanceof Event) {\n    flag = undefined\n  }\n  if (flag == null) {\n    flag = !isOpen.value\n  }\n  flag = Boolean(flag)\n  if (flag) {\n    open()\n  } else {\n    close()\n  }\n}\n\nfunction updatePosition() {\n  // not needed\n}\n\nfunction open() {\n  isOpen.value = true\n}\n\nfunction close() {\n  isOpen.value = false\n}\n\nfunction onUpdateOpen(value: boolean) {\n  emit('update:show', value)\n  if (value) {\n    emit('open')\n  } else {\n    emit('close')\n  }\n}\n\nfunction onMouseover() {\n  pointerOverTargetOrPopup.value = true\n  if (leaveTimer.value) {\n    clearTimeout(leaveTimer.value)\n    leaveTimer.value = null\n  }\n  if (props.trigger === 'hover') {\n    if (props.hoverDelay) {\n      hoverTimer.value = setTimeout(\n        () => {\n          if (pointerOverTargetOrPopup.value) {\n            open()\n          }\n        },\n        Number(props.hoverDelay) * 1000,\n      ) as unknown as number\n    } else {\n      open()\n    }\n  }\n}\n\nfunction onMouseleave() {\n  pointerOverTargetOrPopup.value = false\n  if (hoverTimer.value) {\n    clearTimeout(hoverTimer.value)\n    hoverTimer.value = null\n  }\n  if (props.trigger === 'hover') {\n    if (leaveTimer.value) {\n      clearTimeout(leaveTimer.value)\n    }\n    if (props.leaveDelay) {\n      leaveTimer.value = setTimeout(\n        () => {\n          if (!pointerOverTargetOrPopup.value) {\n            close()\n          }\n        },\n        Number(props.leaveDelay) * 1000,\n      ) as unknown as number\n    } else {\n      if (!pointerOverTargetOrPopup.value) {\n        close()\n      }\n    }\n  }\n}\n\nfunction onInteractOutside(event: Event) {\n  if (!props.hideOnBlur) {\n    event.preventDefault()\n    return\n  }\n\n  // Check if the click is on the trigger/anchor element\n  const target = event.target as Element\n  if (\n    anchorRef.value &&\n    (anchorRef.value.contains(target) || anchorRef.value === target)\n  ) {\n    event.preventDefault()\n    return\n  }\n}\n\nconst hasTransition = computed(() => {\n  return props.transition === 'default'\n})\n\n// Cleanup timers on unmount\nonUnmounted(() => {\n  if (hoverTimer.value) {\n    clearTimeout(hoverTimer.value)\n  }\n  if (leaveTimer.value) {\n    clearTimeout(leaveTimer.value)\n  }\n})\n</script>\n\n<style>\n/* Default transition animations */\n@keyframes popover-enter {\n  from {\n    opacity: 0;\n    transform: translateY(4px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes popover-exit {\n  from {\n    opacity: 1;\n    transform: translateY(0);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(4px);\n  }\n}\n\n/* Default transition */\n.PopoverContent.has-transition[data-state='open'] {\n  animation: popover-enter 150ms ease-out;\n}\n\n.PopoverContent.has-transition[data-state='closed'] {\n  animation: popover-exit 150ms ease-in;\n}\n</style>\n","<script>\nimport { h, mergeProps } from 'vue'\nimport feather from 'feather-icons'\n\nconst validIcons = Object.keys(feather.icons)\n\nexport default {\n  props: {\n    name: {\n      type: String,\n      required: true,\n      validator(value) {\n        const valid = validIcons.includes(value)\n        if (!valid) {\n          console.groupCollapsed(\n            '[frappe-ui] name property for feather-icon must be one of ',\n          )\n          console.dir(validIcons)\n          console.groupEnd()\n        }\n        return valid\n      },\n    },\n    color: {\n      type: String,\n      default: null,\n    },\n    strokeWidth: {\n      type: Number,\n      default: 1.5,\n    },\n  },\n  render() {\n    let icon = feather.icons[this.name]\n    if (!icon) {\n      icon = feather.icons['circle']\n    }\n    return h(\n      'svg',\n      mergeProps(\n        icon.attrs,\n        {\n          fill: 'none',\n          stroke: 'currentColor',\n          color: this.color,\n          'stroke-linecap': 'round',\n          'stroke-linejoin': 'round',\n          'stroke-width': this.strokeWidth,\n          width: null,\n          height: null,\n          class: [icon.attrs.class, 'shrink-0'],\n          innerHTML: icon.contents,\n        },\n        this.$attrs,\n      ),\n    )\n  },\n}\n</script>\n","<template>\n  <svg\n    class=\"max-w-xs animate-spin\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    :style=\"`scale: ${scale}%;`\"\n    viewBox=\"0 0 24 24\"\n  >\n    <circle\n      class=\"opacity-25\"\n      cx=\"12\"\n      cy=\"12\"\n      r=\"10\"\n      stroke=\"currentColor\"\n      stroke-width=\"4\"\n    ></circle>\n    <path\n      class=\"opacity-75\"\n      fill=\"currentColor\"\n      d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n    ></path>\n  </svg>\n</template>\n<script setup lang=\"ts\">\ndefineProps({ scale: { required: false, default: 100 } })\n</script>\n","<script setup lang=\"ts\">\nimport {\n  TooltipProvider,\n  TooltipRoot,\n  TooltipPortal,\n  TooltipTrigger,\n  TooltipContent,\n  TooltipArrow,\n} from 'reka-ui'\nimport { computed } from 'vue'\nimport type { TooltipProps } from './types'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst props = withDefaults(defineProps<TooltipProps>(), {\n  text: '',\n  placement: 'top',\n  hoverDelay: 0.5,\n  arrowClass: 'fill-surface-gray-7',\n  disabled: false,\n})\n\nconst delayDuration = computed(() => props.hoverDelay * 1000)\n</script>\n\n<template>\n  <slot v-if=\"disabled\" />\n  <TooltipProvider v-else :delayDuration=\"delayDuration\">\n    <TooltipRoot>\n      <TooltipTrigger as-child>\n        <slot />\n      </TooltipTrigger>\n      <TooltipPortal>\n        <TooltipContent\n          v-if=\"props.text || $slots.body || $slots.content\"\n          :side=\"props.placement\"\n          :side-offset=\"4\"\n          class=\"z-[100]\"\n        >\n          <slot name=\"body\">\n            <div\n              class=\"rounded bg-surface-gray-7 px-2 py-1 text-xs text-ink-white shadow-xl\"\n            >\n              <slot name=\"content\">{{ props.text }}</slot>\n            </div>\n          </slot>\n          <TooltipArrow :class=\"props.arrowClass\" :width=\"8\" :height=\"4\" />\n        </TooltipContent>\n      </TooltipPortal>\n    </TooltipRoot>\n  </TooltipProvider>\n</template>\n","<template>\n  <Tooltip :text=\"tooltip\" :disabled=\"!tooltip?.length\">\n    <button\n      v-bind=\"$attrs\"\n      :class=\"buttonClasses\"\n      @click=\"handleClick\"\n      :disabled=\"isDisabled\"\n      :ariaLabel=\"ariaLabel\"\n      ref=\"rootRef\"\n    >\n      <LoadingIndicator\n        v-if=\"loading\"\n        :class=\"{\n          'h-3 w-3': size == 'sm',\n          'h-[13.5px] w-[13.5px]': size == 'md',\n          'h-[15px] w-[15px]': size == 'lg',\n          'h-4.5 w-4.5': size == 'xl' || size == '2xl',\n        }\"\n      />\n      <slot name=\"prefix\" v-else-if=\"$slots['prefix'] || iconLeft\">\n        <FeatherIcon\n          v-if=\"iconLeft && typeof iconLeft === 'string'\"\n          :name=\"iconLeft\"\n          :class=\"slotClasses\"\n          aria-hidden=\"true\"\n        />\n        <component v-else-if=\"iconLeft\" :is=\"iconLeft\" :class=\"slotClasses\" />\n      </slot>\n\n      <template v-if=\"loading && loadingText\">{{ loadingText }}</template>\n      <template v-else-if=\"isIconButton && !loading\">\n        <FeatherIcon\n          v-if=\"icon && typeof icon === 'string'\"\n          :name=\"icon\"\n          :class=\"slotClasses\"\n          :aria-label=\"label\"\n        />\n        <component v-else-if=\"icon\" :is=\"icon\" :class=\"slotClasses\" />\n        <slot name=\"icon\" v-else-if=\"$slots.icon\" />\n        <div v-else-if=\"hasLucideIconInDefaultSlot\" :class=\"slotClasses\">\n          <slot>{{ label }}</slot>\n        </div>\n      </template>\n      <span v-else :class=\"{ 'sr-only': isIconButton }\" class=\"truncate\">\n        <slot>{{ label }}</slot>\n      </span>\n\n      <slot name=\"suffix\">\n        <FeatherIcon\n          v-if=\"iconRight && typeof iconRight === 'string'\"\n          :name=\"iconRight\"\n          :class=\"slotClasses\"\n          aria-hidden=\"true\"\n        />\n          <component\n            v-else-if=\"iconRight\"\n            :is=\"iconRight\"\n            :class=\"slotClasses\"\n          />\n      </slot>\n    </button>\n  </Tooltip>\n</template>\n<script lang=\"ts\" setup>\nimport { computed, useSlots, ref } from 'vue'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport LoadingIndicator from '../LoadingIndicator.vue'\nimport { useRouter } from 'vue-router'\nimport type { ButtonProps, ThemeVariant } from './types'\nimport Tooltip from '../Tooltip/Tooltip.vue'\n\ndefineOptions({ inheritAttrs: false })\n\nconst props = withDefaults(defineProps<ButtonProps>(), {\n  theme: 'gray',\n  size: 'sm',\n  variant: 'subtle',\n  loading: false,\n  disabled: false,\n})\n\nconst slots = useSlots()\nconst router = useRouter()\n\nconst buttonClasses = computed(() => {\n  let solidClasses = {\n    gray: 'text-ink-white bg-surface-gray-7 hover:bg-surface-gray-6 active:bg-surface-gray-5',\n    blue: 'text-ink-white bg-blue-500 hover:bg-surface-blue-3 active:bg-blue-700',\n    green:\n      'text-ink-white bg-surface-green-3 hover:bg-green-700 active:bg-green-800',\n    red: 'text-ink-white bg-surface-red-5 hover:bg-surface-red-6 active:bg-surface-red-7',\n  }[props.theme]\n\n  let subtleClasses = {\n    gray: 'text-ink-gray-8 bg-surface-gray-2 hover:bg-surface-gray-3 active:bg-surface-gray-4',\n    blue: 'text-ink-blue-3 bg-surface-blue-2 hover:bg-blue-200 active:bg-blue-300',\n    green:\n      'text-green-800 bg-surface-green-2 hover:bg-green-200 active:bg-green-300',\n    red: 'text-red-700 bg-surface-red-2 hover:bg-surface-red-3 active:bg-surface-red-4',\n  }[props.theme]\n\n  let outlineClasses = {\n    gray: 'text-ink-gray-8 bg-surface-white bg-surface-white border border-outline-gray-2 hover:border-outline-gray-3 active:border-outline-gray-3 active:bg-surface-gray-4',\n    blue: 'text-ink-blue-3 bg-surface-white border border-outline-blue-1 hover:border-blue-400 active:border-blue-400 active:bg-blue-300',\n    green:\n      'text-green-800 bg-surface-white border border-outline-green-2 hover:border-green-500 active:border-green-500 active:bg-green-300',\n    red: 'text-red-700 bg-surface-white border border-outline-red-1 hover:border-outline-red-2 active:border-outline-red-2 active:bg-surface-red-3',\n  }[props.theme]\n\n  let ghostClasses = {\n    gray: 'text-ink-gray-8 bg-transparent hover:bg-surface-gray-3 active:bg-surface-gray-4',\n    blue: 'text-ink-blue-3 bg-transparent hover:bg-blue-200 active:bg-blue-300',\n    green:\n      'text-green-800 bg-transparent hover:bg-green-200 active:bg-green-300',\n    red: 'text-red-700 bg-transparent hover:bg-surface-red-3 active:bg-surface-red-4',\n  }[props.theme]\n\n  let focusClasses = {\n    gray: 'focus-visible:ring focus-visible:ring-outline-gray-3',\n    blue: 'focus-visible:ring focus-visible:ring-blue-400',\n    green: 'focus-visible:ring focus-visible:ring-outline-green-2',\n    red: 'focus-visible:ring focus-visible:ring-outline-red-2',\n  }[props.theme]\n\n  let variantClasses = {\n    subtle: subtleClasses,\n    solid: solidClasses,\n    outline: outlineClasses,\n    ghost: ghostClasses,\n  }[props.variant]\n\n  let themeVariant: ThemeVariant = `${props.theme}-${props.variant}`\n\n  let disabledClassesMap: Record<ThemeVariant, string> = {\n    'gray-solid': 'bg-surface-gray-2 text-ink-gray-4',\n    'gray-subtle': 'bg-surface-gray-2 text-ink-gray-4',\n    'gray-outline':\n      'bg-surface-gray-2 text-ink-gray-4 border border-outline-gray-2',\n    'gray-ghost': 'text-ink-gray-4',\n\n    'blue-solid': 'bg-blue-300 text-ink-white',\n    'blue-subtle': 'bg-surface-blue-2 text-ink-blue-link',\n    'blue-outline':\n      'bg-surface-blue-2 text-ink-blue-link border border-outline-blue-1',\n    'blue-ghost': 'text-ink-blue-link',\n\n    'green-solid': 'bg-surface-green-2 text-ink-green-2',\n    'green-subtle': 'bg-surface-green-2 text-ink-green-2',\n    'green-outline':\n      'bg-surface-green-2 text-ink-green-2 border border-outline-green-2',\n    'green-ghost': 'text-ink-green-2',\n\n    'red-solid': 'bg-surface-red-2 text-ink-red-2',\n    'red-subtle': 'bg-surface-red-2 text-ink-red-2',\n    'red-outline':\n      'bg-surface-red-2 text-ink-red-2 border border-outline-red-1',\n    'red-ghost': 'text-ink-red-2',\n  }\n  let disabledClasses = disabledClassesMap[themeVariant]\n\n  let sizeClasses = {\n    sm: 'h-7 text-base px-2 rounded',\n    md: 'h-8 text-base font-medium px-2.5 rounded',\n    lg: 'h-10 text-lg font-medium px-3 rounded-md',\n    xl: 'h-11.5 text-xl font-medium px-3.5 rounded-lg',\n    '2xl': 'h-13 text-2xl font-medium px-3.5 rounded-xl',\n  }[props.size]\n\n  if (isIconButton.value) {\n    sizeClasses = {\n      sm: 'h-7 w-7 rounded',\n      md: 'h-8 w-8 rounded',\n      lg: 'h-10 w-10 rounded-md',\n      xl: 'h-11.5 w-11.5 rounded-lg',\n      '2xl': 'h-13 w-13 rounded-xl',\n    }[props.size]\n  }\n\n  return [\n    'inline-flex items-center justify-center gap-2 transition-colors focus:outline-none shrink-0',\n    isDisabled.value ? disabledClasses : variantClasses,\n    focusClasses,\n    sizeClasses,\n  ]\n})\n\nconst slotClasses = computed(() => {\n  let classes = {\n    sm: 'h-4',\n    md: 'h-4.5',\n    lg: 'h-5',\n    xl: 'h-6',\n    '2xl': 'h-6',\n  }[props.size]\n\n  return classes\n})\n\nconst isDisabled = computed(() => {\n  return props.disabled || props.loading\n})\n\nconst ariaLabel = computed(() => {\n  return isIconButton.value ? props.label : null\n})\n\nconst isIconButton = computed(() => {\n  return props.icon || slots.icon || hasLucideIconInDefaultSlot.value\n})\n\nconst hasLucideIconInDefaultSlot = computed(() => {\n  if (!slots.default) return false\n\n  const slotContent = slots.default()\n  if (!Array.isArray(slotContent)) return false\n  // if the slot contains only one element and it's a lucide icon\n  // render it as an icon button\n  let firstVNode = slotContent[0]\n  if (\n    typeof firstVNode.type?.name == 'string' &&\n    firstVNode.type?.name?.startsWith('lucide-')\n  ) {\n    return true\n  }\n  return false\n})\n\nconst handleClick = () => {\n  if (props.route) {\n    return router.push(props.route)\n  } else if (props.link) {\n    return window.open(props.link, '_blank')\n  }\n}\n\nconst rootRef = ref()\ndefineExpose({ rootRef })\n</script>\n","<template>\n  <Combobox\n    v-model=\"selectedValue\"\n    :multiple=\"multiple\"\n    nullable\n    :by=\"compareFn\"\n    v-slot=\"{ open: isComboboxOpen }\"\n  >\n    <Popover\n      class=\"w-full\"\n      v-model:show=\"showOptions\"\n      ref=\"rootRef\"\n      :placement=\"placement\"\n      :match-target-width=\"true\"\n    >\n      <template\n        #target=\"{ open: openPopover, togglePopover, close: closePopover }\"\n      >\n        <slot\n          name=\"target\"\n          v-bind=\"{\n            open: openPopover,\n            close: closePopover,\n            togglePopover,\n            isOpen: isComboboxOpen,\n          }\"\n        >\n          <div class=\"w-full space-y-1.5\">\n            <label v-if=\"props.label\" class=\"block text-xs text-ink-gray-5\">\n              {{ props.label }}\n            </label>\n            <button\n              class=\"flex h-7 w-full items-center justify-between gap-2 rounded bg-surface-gray-2 px-2 py-1 transition-colors hover:bg-surface-gray-3 border border-transparent focus:border-outline-gray-4 focus:outline-none focus:ring-2 focus:ring-outline-gray-3\"\n              :class=\"{ 'bg-surface-gray-3': isComboboxOpen }\"\n              @click=\"() => togglePopover()\"\n            >\n              <div class=\"flex items-center overflow-hidden\">\n                <slot name=\"prefix\" />\n                <span\n                  class=\"truncate text-base leading-5 text-ink-gray-8\"\n                  v-if=\"displayValue\"\n                >\n                  {{ displayValue }}\n                </span>\n                <span class=\"text-base leading-5 text-ink-gray-4\" v-else>\n                  {{ placeholder || '' }}\n                </span>\n                <slot name=\"suffix\" />\n              </div>\n              <FeatherIcon\n                name=\"chevron-down\"\n                class=\"h-4 w-4 text-ink-gray-5\"\n                aria-hidden=\"true\"\n              />\n            </button>\n          </div>\n        </slot>\n      </template>\n      <template #body=\"{ isOpen, togglePopover }\">\n        <div v-show=\"isOpen\">\n          <div\n            class=\"relative mt-1 rounded-lg bg-surface-modal text-base shadow-2xl\"\n            :class=\"bodyClasses\"\n          >\n            <ComboboxOptions\n              class=\"max-h-[15rem] overflow-y-auto px-1.5 pb-1.5\"\n              :class=\"{ 'pt-1.5': hideSearch }\"\n              static\n            >\n              <div\n                v-if=\"!hideSearch\"\n                class=\"sticky top-0 z-10 flex items-stretch space-x-1.5 bg-surface-modal py-1.5\"\n              >\n                <div class=\"relative w-full\">\n                  <ComboboxInput\n                    ref=\"searchInput\"\n                    class=\"form-input w-full focus:bg-surface-gray-3 hover:bg-surface-gray-4 text-ink-gray-8\"\n                    type=\"text\"\n                    :value=\"query\"\n                    @change=\"query = $event.target.value\"\n                    autocomplete=\"off\"\n                    placeholder=\"Search\"\n                  />\n                  <div\n                    class=\"absolute right-0 inline-flex h-7 w-7 items-center justify-center\"\n                  >\n                    <LoadingIndicator\n                      v-if=\"props.loading\"\n                      class=\"h-4 w-4 text-ink-gray-5\"\n                    />\n                    <button v-else @click=\"clearAll\">\n                      <FeatherIcon name=\"x\" class=\"w-4 text-ink-gray-8\" />\n                    </button>\n                  </div>\n                </div>\n              </div>\n              <div\n                v-for=\"group in groups\"\n                :key=\"group.key\"\n                v-show=\"group.items.length > 0\"\n              >\n                <div\n                  v-if=\"group.group && !group.hideLabel\"\n                  class=\"sticky top-10 truncate bg-surface-modal px-2.5 py-1.5 text-sm font-medium text-ink-gray-5\"\n                >\n                  {{ group.group }}\n                </div>\n                <ComboboxOption\n                  as=\"template\"\n                  v-for=\"(option, idx) in group.items.slice(\n                    0,\n                    props.maxOptions,\n                  )\"\n                  :key=\"idx\"\n                  :value=\"option\"\n                  :disabled=\"option.disabled\"\n                  v-slot=\"{ active, selected }\"\n                >\n                  <li\n                    :class=\"[\n                      'flex cursor-pointer items-center justify-between rounded px-2.5 py-1.5 text-base',\n                      {\n                        'bg-surface-gray-3': active,\n                        'opacity-50': option.disabled,\n                      },\n                    ]\"\n                  >\n                    <div class=\"flex flex-1 gap-2 overflow-hidden items-center\">\n                      <div\n                        v-if=\"$slots['item-prefix'] || props.multiple\"\n                        class=\"flex flex-shrink-0\"\n                      >\n                        <slot\n                          name=\"item-prefix\"\n                          v-bind=\"{ active, selected, option }\"\n                        >\n                          <FeatherIcon\n                            name=\"check\"\n                            v-if=\"isOptionSelected(option)\"\n                            class=\"h-4 w-4 text-ink-gray-7\"\n                          />\n                          <div v-else class=\"h-4 w-4\" />\n                        </slot>\n                      </div>\n                      <span class=\"flex-1 truncate text-ink-gray-7\">\n                        {{ getLabel(option) }}\n                      </span>\n                    </div>\n\n                    <div\n                      v-if=\"$slots['item-suffix'] || option?.description\"\n                      class=\"ml-2 flex-shrink-0\"\n                    >\n                      <slot\n                        name=\"item-suffix\"\n                        v-bind=\"{ active, selected, option }\"\n                      >\n                        <div\n                          v-if=\"option?.description\"\n                          class=\"text-sm text-ink-gray-5\"\n                        >\n                          {{ option.description }}\n                        </div>\n                      </slot>\n                    </div>\n                  </li>\n                </ComboboxOption>\n              </div>\n              <li\n                v-if=\"groups.length == 0\"\n                class=\"rounded-md px-2.5 py-1.5 text-base text-ink-gray-5\"\n              >\n                No results found\n              </li>\n            </ComboboxOptions>\n\n            <div\n              v-if=\"$slots.footer || props.showFooter || multiple\"\n              class=\"border-t p-1\"\n            >\n              <slot name=\"footer\" v-bind=\"{ togglePopover }\">\n                <div v-if=\"multiple\" class=\"flex items-center justify-end\">\n                  <Button\n                    v-if=\"!areAllOptionsSelected\"\n                    label=\"Select All\"\n                    @click.stop=\"selectAll\"\n                  />\n                  <Button\n                    v-if=\"areAllOptionsSelected\"\n                    label=\"Clear All\"\n                    @click.stop=\"clearAll\"\n                  />\n                </div>\n                <div v-else class=\"flex items-center justify-end\">\n                  <Button label=\"Clear\" @click.stop=\"clearAll\" />\n                </div>\n              </slot>\n            </div>\n          </div>\n        </div>\n      </template>\n    </Popover>\n  </Combobox>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  Combobox,\n  ComboboxInput,\n  ComboboxOption,\n  ComboboxOptions,\n} from '@headlessui/vue'\nimport { computed, nextTick, ref, watch } from 'vue'\nimport { Popover } from '../Popover'\nimport { Button } from '../Button'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport LoadingIndicator from '../LoadingIndicator.vue'\nimport type {\n  AutocompleteOptionGroup,\n  AutocompleteOption,\n  AutocompleteProps,\n  Option,\n} from './types'\n\nconst props = withDefaults(defineProps<AutocompleteProps>(), {\n  multiple: false,\n  maxOptions: 50,\n  hideSearch: false,\n  compareFn: (a, b) => a.value === b.value,\n})\nconst emit = defineEmits(['update:modelValue', 'update:query', 'change'])\n\nconst searchInput = ref()\nconst showOptions = ref(false)\nconst query = ref('')\n\nconst groups = computed(() => {\n  if (!props.options?.length) return []\n\n  let groups: AutocompleteOptionGroup[]\n  if (isOptionGroup(props.options[0])) {\n    groups = props.options as AutocompleteOptionGroup[]\n  } else {\n    groups = [\n      {\n        group: '',\n        items: sanitizeOptions(props.options as AutocompleteOption[]),\n        hideLabel: false,\n      },\n    ]\n  }\n\n  return groups\n    .map((group, i) => {\n      return {\n        key: i,\n        group: group.group,\n        hideLabel: group.hideLabel,\n        items: filterOptions(sanitizeOptions(group.items || [])),\n      }\n    })\n    .filter((group) => group.items.length > 0)\n})\n\nconst allOptions = computed(() => {\n  return groups.value.flatMap((group) => group.items)\n})\n\nconst sanitizeOptions = (options: AutocompleteOption[]) => {\n  if (!options) return []\n  // in case the options are just values, convert them to objects\n  return options.map((option) => {\n    return isOption(option)\n      ? option\n      : { label: option.toString(), value: option }\n  })\n}\n\nconst filterOptions = (options: Option[]) => {\n  if (!query.value) return options\n  return options.filter((option) => {\n    return (\n      option.label.toLowerCase().includes(query.value.trim().toLowerCase()) ||\n      option.value\n        .toString()\n        .toLowerCase()\n        .includes(query.value.trim().toLowerCase())\n    )\n  })\n}\n\nconst selectedValue = computed({\n  get() {\n    if (!props.multiple) {\n      return (\n        findOption(props.modelValue as AutocompleteOption) ||\n        // if the modelValue is not found in the option list\n        // return the modelValue as is\n        makeOption(props.modelValue as AutocompleteOption)\n      )\n    }\n    // in case of `multiple`, modelValue is an array of values\n    // if the modelValue is a list of values, convert them to options\n    const values = (props.modelValue || []) as AutocompleteOption[]\n    return isOption(values[0])\n      ? values\n      : values.map((v) => findOption(v) || makeOption(v))\n  },\n  set(val) {\n    query.value = ''\n    if (val && !props.multiple) showOptions.value = false\n    if (!props.multiple) {\n      emit('update:modelValue', val)\n      return\n    }\n    emit('update:modelValue', val)\n  },\n})\n\nconst findOption = (option: AutocompleteOption) => {\n  if (!option) return option\n  const value = isOption(option) ? option.value : option\n  return allOptions.value.find((o) => o.value === value)\n}\n\nconst makeOption = (option: AutocompleteOption) => {\n  return isOption(option) ? option : { label: option, value: option }\n}\n\nconst getLabel = (option: AutocompleteOption) => {\n  if (isOption(option)) {\n    return option?.label || option?.value\n  }\n  return option\n}\n\nconst displayValue = computed(() => {\n  if (!selectedValue.value) return ''\n  if (!props.multiple) {\n    return getLabel(selectedValue.value as AutocompleteOption)\n  }\n  return (selectedValue.value as AutocompleteOption[])\n    .map((v) => getLabel(v))\n    .join(', ')\n})\n\nconst isOptionSelected = (option: AutocompleteOption) => {\n  if (!selectedValue.value) return false\n  const value = isOption(option) ? option.value : option\n  if (!props.multiple) {\n    return selectedValue.value === value\n  }\n  return (selectedValue.value as AutocompleteOption[]).find((v) =>\n    isOption(v) ? v.value === value : v === value,\n  )\n}\n\nconst areAllOptionsSelected = computed(() => {\n  if (!props.multiple) return false\n  return (\n    allOptions.value.length ===\n    (selectedValue.value as AutocompleteOption[])?.length\n  )\n})\n\nconst selectAll = () => {\n  selectedValue.value = allOptions.value\n}\n\nconst clearAll = () => {\n  selectedValue.value = props.multiple ? [] : undefined\n}\n\nconst isOption = (option: AutocompleteOption) => {\n  return typeof option === 'object'\n}\n\nconst isOptionGroup = (option: any) => {\n  return typeof option === 'object' && 'items' in option && 'group' in option\n}\n\nwatch(\n  () => query.value,\n  () => {\n    emit('update:query', query.value)\n  },\n)\n\nwatch(\n  () => showOptions.value,\n  () => {\n    if (showOptions.value) {\n      nextTick(() => searchInput.value?.$el.focus())\n    }\n  },\n)\n\nconst rootRef = ref()\n\nconst togglePopover = () => {\n  showOptions.value = !showOptions.value\n}\n\ndefineExpose({\n  rootRef,\n  togglePopover,\n})\n</script>\n","<template>\n  <div\n    class=\"relative inline-block shrink-0\"\n    :class=\"[sizeClasses, shapeClasses]\"\n  >\n    <img\n      v-if=\"image && !imgFetchError\"\n      :src=\"image\"\n      :alt=\"label\"\n      :class=\"[shapeClasses, 'h-full w-full object-cover']\"\n      @error=\"(err) => handleImageError(err)\"\n    />\n    <div\n      v-else\n      class=\"flex h-full w-full items-center justify-center bg-surface-gray-2 uppercase text-ink-gray-5 select-none\"\n      :class=\"[labelClasses, shapeClasses]\"\n    >\n      <div :class=\"iconClasses\" v-if=\"$slots.default\">\n        <slot></slot>\n      </div>\n      <template v-else>\n        {{ label && label[0] }}\n      </template>\n    </div>\n    <div\n      v-if=\"$slots.indicator\"\n      :class=\"[\n        'absolute bottom-0 right-0 grid place-items-center rounded-full bg-surface-white',\n        indicatorContainerClasses,\n      ]\"\n    >\n      <div :class=\"indicatorClasses\">\n        <slot name=\"indicator\"></slot>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport type { AvatarProps } from './types'\n\nconst imgFetchError = ref(false)\n\nconst props = withDefaults(defineProps<AvatarProps>(), {\n  size: 'md',\n  shape: 'circle',\n})\n\nconst shapeClasses = computed(() => {\n  return {\n    circle: 'rounded-full',\n    square: {\n      xs: 'rounded-[4px]',\n      sm: 'rounded-[5px]',\n      md: 'rounded-[5px]',\n      lg: 'rounded-[6px]',\n      xl: 'rounded-[6px]',\n      '2xl': 'rounded-[8px]',\n      '3xl': 'rounded-[10px]',\n    }[props.size],\n  }[props.shape]\n})\n\nconst sizeClasses = computed(() => {\n  return {\n    xs: 'w-4 h-4',\n    sm: 'w-5 h-5',\n    md: 'w-6 h-6',\n    lg: 'w-7 h-7',\n    xl: 'w-8 h-8',\n    '2xl': 'w-10 h-10',\n    '3xl': 'w-11.5 h-11.5',\n  }[props.size]\n})\n\nconst labelClasses = computed(() => {\n  let sizeClass = {\n    xs: 'text-2xs',\n    sm: 'text-sm',\n    md: 'text-base',\n    lg: 'text-base',\n    xl: 'text-lg',\n    '2xl': 'text-xl',\n    '3xl': 'text-2xl',\n  }[props.size]\n  return ['font-medium', sizeClass]\n})\n\nconst indicatorContainerClasses = computed(() => {\n  return {\n    xs: '-mr-[.1rem] -mb-[.1rem] h-2 w-2',\n    sm: '-mr-[.1rem] -mb-[.1rem] h-[9px] w-[9px]',\n    md: '-mr-[.1rem] -mb-[.1rem] h-2.5 w-2.5',\n    lg: '-mr-[.1rem] -mb-[.1rem] h-3 w-3',\n    xl: '-mr-[.1rem] -mb-[.1rem] h-3 w-3',\n    '2xl': '-mr-[.1rem] -mb-[.1rem] h-3.5 w-3.5',\n    '3xl': '-mr-[.2rem] -mb-[.2rem] h-4 w-4',\n  }[props.size]\n})\n\nconst indicatorClasses = computed(() => {\n  return {\n    xs: 'h-1 w-1',\n    sm: 'h-[5px] w-[5px]',\n    md: 'h-1.5 w-1.5',\n    lg: 'h-2 w-2',\n    xl: 'h-2 w-2',\n    '2xl': 'h-2.5 w-2.5',\n    '3xl': 'h-3 w-3',\n  }[props.size]\n})\n\nconst iconClasses = computed(() => {\n  return {\n    xs: 'h-2.5 w-2.5',\n    sm: 'h-3 w-3',\n    md: 'h-4 w-4',\n    lg: 'h-4 w-4',\n    xl: 'h-4 w-4',\n    '2xl': 'h-5 w-5',\n    '3xl': 'h-5 w-5',\n  }[props.size]\n})\n\nfunction handleImageError(err) {\n  if (err.type) {\n    imgFetchError.value = true\n  }\n}\n</script>\n","<template>\n  <div\n    class=\"inline-flex select-none items-center gap-1 rounded-full\"\n    :class=\"classes\"\n  >\n    <div\n      :class=\"[props.size == 'lg' ? 'max-h-6' : 'max-h-4']\"\n      v-if=\"$slots.prefix\"\n    >\n      <slot name=\"prefix\"></slot>\n    </div>\n    <slot>{{ props.label?.toString() }}</slot>\n    <div\n      :class=\"[props.size == 'lg' ? 'max-h-6' : 'max-h-4']\"\n      v-if=\"$slots.suffix\"\n    >\n      <slot name=\"suffix\"></slot>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed } from 'vue'\nimport type { BadgeProps } from './types'\n\nconst props = withDefaults(defineProps<BadgeProps>(), {\n  theme: 'gray',\n  size: 'md',\n  variant: 'subtle',\n})\n\nconst classes = computed(() => {\n  let solidClasses = {\n    gray: 'text-ink-white bg-surface-gray-7',\n    blue: 'text-ink-blue-1 bg-surface-blue-2',\n    green: 'text-ink-green-1 bg-surface-green-3',\n    orange: 'text-ink-amber-1 bg-surface-amber-2',\n    red: 'text-ink-red-1 bg-surface-red-4',\n  }[props.theme]\n\n  let subtleClasses = {\n    gray: 'text-ink-gray-6 bg-surface-gray-2',\n    blue: 'text-ink-blue-2 bg-surface-blue-1',\n    green: 'text-ink-green-3 bg-surface-green-2',\n    orange: 'text-ink-amber-3 bg-surface-amber-1',\n    red: 'text-ink-red-4 bg-surface-red-1',\n  }[props.theme]\n\n  let outlineClasses = {\n    gray: 'text-ink-gray-6 bg-transparent border border-outline-gray-1',\n    blue: 'text-ink-blue-2 bg-transparent border border-outline-blue-1',\n    green: 'text-ink-green-3 bg-transparent border border-outline-green-2',\n    orange: 'text-ink-amber-3 bg-transparent border border-outline-amber-2',\n    red: 'text-ink-red-4 bg-transparent border border-outline-red-2',\n  }[props.theme]\n\n  let ghostClasses = {\n    gray: 'text-ink-gray-6 bg-transparent',\n    blue: 'text-ink-blue-2 bg-transparent',\n    green: 'text-ink-green-3 bg-transparent',\n    orange: 'text-ink-amber-3 bg-transparent',\n    red: 'text-ink-red-4 bg-transparent',\n  }[props.theme]\n\n  let variantClasses = {\n    subtle: subtleClasses,\n    solid: solidClasses,\n    outline: outlineClasses,\n    ghost: ghostClasses,\n  }[props.variant]\n\n  let sizeClasses = {\n    sm: 'h-4 text-xs px-1.5',\n    md: 'h-5 text-xs px-1.5',\n    lg: 'h-6 text-sm px-2',\n  }[props.size]\n\n  return [variantClasses, sizeClasses]\n})\n</script>\n","let id = 0\nfunction generateId() {\n  return ++id\n}\n\nexport function useId() {\n  return 'frappe-ui-' + generateId()\n}\n","<template>\n  <div :class=\"switchGroupClasses\">\n    <div class=\"flex flex-col gap-1\">\n      <div class=\"flex items-center\">\n        <FeatherIcon\n          v-if=\"props.icon && typeof props.icon === 'string'\"\n          :name=\"props.icon\"\n          :class=\"iconClasses\"\n          aria-hidden=\"true\"\n        />\n        <component\n          :class=\"iconClasses\"\n          v-else-if=\"props.icon\"\n          :is=\"props.icon\"\n        />\n        <label :class=\"switchLabelClasses\" :for=\"id\">\n          {{ props.label }}\n        </label>\n      </div>\n\n      <span\n        v-if=\"props.description\"\n        class=\"max-w-xs text-p-sm text-ink-gray-7\"\n        >{{ props.description }}</span\n      >\n    </div>\n    <SwitchRoot\n      :id\n      v-model=\"model\"\n      @keyup.space.self=\"model = !model\"\n      :class=\"switchClasses\"\n      :disabled=\"props.disabled\"\n    >\n      <SwitchThumb :class=\"switchCircleClasses\" />\n    </SwitchRoot>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, watch } from 'vue'\nimport { useId } from '../../utils/useId'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport { SwitchRoot, SwitchThumb } from 'reka-ui'\nimport type { SwitchProps } from './types'\n\nconst props = withDefaults(defineProps<SwitchProps>(), {\n  size: 'sm',\n  label: '',\n  description: '',\n  disabled: false,\n  labelClasses: '',\n})\n\nconst model = defineModel<boolean>({ default: false })\nconst emit = defineEmits(['change'])\nwatch(model, (val) => {\n  emit('change', val)\n})\n\nconst id = useId()\nconst switchClasses = computed(() => {\n  return [\n    'relative inline-flex flex-shrink-0 cursor-pointer rounded-full border-transparent transition-colors duration-100 ease-in-out items-center',\n    'focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-outline-gray-3',\n    'disabled:cursor-not-allowed disabled:bg-surface-gray-3',\n    model.value\n      ? 'bg-surface-gray-7 enabled:hover:bg-surface-gray-6 active:bg-surface-gray-5 group-hover:enabled:bg-surface-gray-6'\n      : 'bg-surface-gray-4 enabled:hover:bg-gray-400 active:bg-gray-500 group-hover:enabled:bg-gray-400',\n    props.size === 'md' ? 'h-5 w-8 border-[3px]' : 'h-4 w-[26px] border-2',\n  ]\n})\n\nconst switchCircleClasses = computed(() => {\n  return [\n    'pointer-events-none inline-block transform rounded-full bg-surface-white shadow ring-0 transition duration-100 ease-in-out',\n    props.size === 'md' ? 'h-3.5 w-3.5' : 'h-3 w-3',\n    props.size === 'md'\n      ? model.value\n        ? 'translate-x-3 rtl:-translate-x-3'\n        : 'translate-x-0'\n      : model.value\n        ? 'translate-x-2.5 rtl:-translate-x-2.5'\n        : 'translate-x-0',\n  ]\n})\n\nconst iconClasses = 'mr-2 h-4 w-4 flex-shrink-0 text-ink-gray-6'\nconst switchLabelClasses = computed(() => {\n  return [\n    'font-medium leading-normal',\n    props.disabled && !props.description\n      ? 'text-ink-gray-4'\n      : 'text-ink-gray-8',\n    props.size === 'md' ? 'text-lg' : 'text-base',\n    props.labelClasses,\n  ]\n})\n\nconst switchGroupClasses = computed(() => {\n  if (!props.label) return\n  const classes = ['flex justify-between']\n  if (!props.description) {\n    classes.push(\n      'group items-center space-x-3 cursor-pointer rounded focus-visible:bg-surface-gray-2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-outline-gray-3',\n    )\n\n    classes.push(\n      props.disabled\n        ? 'cursor-not-allowed'\n        : 'hover:bg-surface-gray-3 active:bg-surface-gray-4',\n    )\n\n    classes.push(props.size === 'md' ? 'px-3 py-1.5' : 'px-2.5 py-1.5')\n  } else {\n    classes.push('items-start')\n    classes.push(\n      props.size === 'md' ? 'px-3 space-x-3.5' : 'px-2.5 space-x-2.5',\n    )\n  }\n\n  return classes\n})\n</script>\n","<template>\n  <DropdownMenuRoot v-model:open=\"toggleState\" v-slot=\"{ open }\">\n    <DropdownMenuTrigger as-child>\n      <slot v-if=\"$slots.default\" v-bind=\"{ open, close, ...attrs }\" />\n      <Button v-else :active=\"false\" v-bind=\"{ ...button, ...attrs }\">\n        {{ button ? button?.label || null : 'Options' }}\n      </Button>\n    </DropdownMenuTrigger>\n\n    <DropdownMenuPortal>\n      <DropdownMenuContent\n        :class=\"[\n          cssClasses.dropdownContent,\n          {\n            'origin-top-left': placement == 'left',\n            'origin-top-right': placement == 'right',\n            'origin-top': placement == 'center',\n          },\n        ]\"\n        :side=\"side\"\n        :align=\"align\"\n        :side-offset=\"offset\"\n      >\n        <template v-for=\"group in groups\" :key=\"group.key\">\n          <div v-if=\"group.items.length\" :class=\"cssClasses.groupContainer\">\n            <DropdownMenuLabel\n              v-if=\"group.group && !group.hideLabel\"\n              :class=\"[cssClasses.groupLabel, getTextColor(group)]\"\n            >\n              {{ group.group }}\n            </DropdownMenuLabel>\n\n            <template v-for=\"item in group.items\" :key=\"item.label\">\n              <div v-if=\"item.switch\" :class=\"cssClasses.itemButton\">\n                <FeatherIcon\n                  v-if=\"item.icon && typeof item.icon === 'string'\"\n                  :name=\"item.icon\"\n                  :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                  aria-hidden=\"true\"\n                />\n                <component\n                  :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                  v-else-if=\"item.icon\"\n                  :is=\"item.icon\"\n                />\n                <span :class=\"[cssClasses.itemLabel, getTextColor(item)]\">\n                  {{ item.label }}\n                </span>\n                <Switch\n                  class=\"ml-auto\"\n                  label-classes=\"font-normal cursor-pointer\"\n                  @change=\"item.onClick?.($event)\"\n                  :model-value=\"item.switchValue || false\"\n                />\n              </div>\n              <DropdownMenuItem v-else as-child @select=\"item.onClick\">\n                <slot v-if=\"$slots.item\" name=\"item\" v-bind=\"{ item, close }\" />\n                <component\n                  v-else-if=\"item.component\"\n                  :is=\"item.component\"\n                  :active=\"false\"\n                />\n\n                <DropdownMenuSub v-else-if=\"item.submenu\">\n                  <DropdownMenuSubTrigger as-child>\n                    <button\n                      :class=\"[\n                        cssClasses.submenuTrigger,\n                        getSubmenuBackgroundColor(item),\n                      ]\"\n                    >\n                      <FeatherIcon\n                        v-if=\"item.icon && typeof item.icon === 'string'\"\n                        :name=\"item.icon\"\n                        :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                        aria-hidden=\"true\"\n                      />\n                      <component\n                        :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                        v-else-if=\"item.icon\"\n                        :is=\"item.icon\"\n                      />\n                      <div\n                        v-else-if=\"groupHasIcons(group)\"\n                        :class=\"cssClasses.itemIconPlaceholder\"\n                      />\n                      <span :class=\"[cssClasses.itemLabel, getTextColor(item)]\">\n                        {{ item.label }}\n                      </span>\n                      <FeatherIcon\n                        name=\"chevron-right\"\n                        :class=\"[cssClasses.chevronIcon, getIconColor(item)]\"\n                        aria-hidden=\"true\"\n                      />\n                    </button>\n                  </DropdownMenuSubTrigger>\n                  <DropdownMenuPortal>\n                    <DropdownMenuSubContent\n                      :class=\"cssClasses.dropdownContent\"\n                      :side-offset=\"4\"\n                    >\n                      <div\n                        v-for=\"submenuGroup in getSubmenuGroups(item.submenu)\"\n                        :key=\"submenuGroup.key\"\n                        :class=\"cssClasses.groupContainer\"\n                      >\n                        <DropdownMenuLabel\n                          v-if=\"submenuGroup.group && !submenuGroup.hideLabel\"\n                          :class=\"cssClasses.groupLabel\"\n                        >\n                          {{ submenuGroup.group }}\n                        </DropdownMenuLabel>\n                        <template\n                          v-for=\"subItem in submenuGroup.items\"\n                          :key=\"subItem.label\"\n                        >\n                          <div\n                            v-if=\"subItem.switch\"\n                            :class=\"cssClasses.itemButton\"\n                          >\n                            <FeatherIcon\n                              v-if=\"\n                                subItem.icon && typeof subItem.icon === 'string'\n                              \"\n                              :name=\"subItem.icon\"\n                              :class=\"[\n                                cssClasses.itemIcon,\n                                getIconColor(subItem),\n                              ]\"\n                              aria-hidden=\"true\"\n                            />\n                            <component\n                              :class=\"[\n                                cssClasses.itemIcon,\n                                getIconColor(subItem),\n                              ]\"\n                              v-else-if=\"subItem.icon\"\n                              :is=\"subItem.icon\"\n                            />\n                            <span\n                              :class=\"[\n                                cssClasses.itemLabel,\n                                getTextColor(subItem),\n                              ]\"\n                            >\n                              {{ subItem.label }}\n                            </span>\n                            <Switch\n                              class=\"ml-auto\"\n                              label-classes=\"font-normal cursor-pointer\"\n                              @change=\"subItem.onClick?.($event)\"\n                              :model-value=\"subItem.switchValue || false\"\n                            />\n                          </div>\n\n                          <DropdownMenuItem\n                            v-else\n                            as-child\n                            @select=\"\n                              (event: PointerEvent) =>\n                                handleItemClick(subItem, event)\n                            \"\n                          >\n                            <component\n                              v-if=\"subItem.component\"\n                              :is=\"subItem.component\"\n                              :active=\"false\"\n                            />\n                            <button\n                              v-else\n                              :class=\"[\n                                cssClasses.itemButton,\n                                getBackgroundColor(subItem),\n                              ]\"\n                            >\n                              <FeatherIcon\n                                v-if=\"\n                                  subItem.icon &&\n                                  typeof subItem.icon === 'string'\n                                \"\n                                :name=\"subItem.icon\"\n                                :class=\"[\n                                  cssClasses.itemIcon,\n                                  getIconColor(subItem),\n                                ]\"\n                                aria-hidden=\"true\"\n                              />\n                              <component\n                                :class=\"[\n                                  cssClasses.itemIcon,\n                                  getIconColor(subItem),\n                                ]\"\n                                v-else-if=\"subItem.icon\"\n                                :is=\"subItem.icon\"\n                              />\n                              <div\n                                v-else-if=\"groupHasIcons(submenuGroup)\"\n                                :class=\"cssClasses.itemIconPlaceholder\"\n                              />\n                              <span\n                                :class=\"[\n                                  cssClasses.itemLabel,\n                                  getTextColor(subItem),\n                                ]\"\n                              >\n                                {{ subItem.label }}\n                              </span>\n                            </button>\n                          </DropdownMenuItem>\n                        </template>\n                      </div>\n                    </DropdownMenuSubContent>\n                  </DropdownMenuPortal>\n                </DropdownMenuSub>\n                <button\n                  v-else\n                  :class=\"[cssClasses.itemButton, getBackgroundColor(item)]\"\n                >\n                  <FeatherIcon\n                    v-if=\"item.icon && typeof item.icon === 'string'\"\n                    :name=\"item.icon\"\n                    :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                    aria-hidden=\"true\"\n                  />\n                  <component\n                    :class=\"[cssClasses.itemIcon, getIconColor(item)]\"\n                    v-else-if=\"item.icon\"\n                    :is=\"item.icon\"\n                  />\n                  <div\n                    v-else-if=\"groupHasIcons(group)\"\n                    :class=\"cssClasses.itemIconPlaceholder\"\n                  />\n                  <span :class=\"[cssClasses.itemLabel, getTextColor(item)]\"\n                    >{{ item.label }}\n                  </span>\n                </button>\n              </DropdownMenuItem>\n            </template>\n          </div>\n        </template>\n      </DropdownMenuContent>\n    </DropdownMenuPortal>\n  </DropdownMenuRoot>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  DropdownMenuRoot,\n  DropdownMenuTrigger,\n  DropdownMenuPortal,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuItem,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n} from 'reka-ui'\nimport { Button } from '../Button'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport { ref, computed, useAttrs } from 'vue'\nimport { useRouter } from 'vue-router'\nimport type {\n  DropdownProps,\n  DropdownOption,\n  DropdownGroupOption,\n  DropdownOptions,\n  DropdownItem,\n} from './types'\nimport Switch from '../Switch/Switch.vue'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst toggleState = ref(false)\nconst test = ref(true)\nconst router = useRouter()\nconst attrs = useAttrs()\n\nconst props = withDefaults(defineProps<DropdownProps>(), {\n  options: () => [],\n  placement: 'left',\n  side: 'bottom',\n  offset: 4,\n})\n\nfunction close() {\n  toggleState.value = false\n}\n\n// Unified click handling for all dropdown items\nconst handleItemClick = (item: DropdownOption, event: PointerEvent) => {\n  if (item.route) {\n    router.push(item.route)\n  } else if (item.onClick) {\n    item.onClick(event)\n  }\n}\n\nconst normalizeDropdownItem = (option: DropdownOption) => {\n  return {\n    ...option,\n    label: option.label,\n    theme: option.theme || 'gray',\n    icon: option.icon,\n    component: option.component,\n    onClick: (event: PointerEvent) => handleItemClick(option, event),\n    submenu: option.submenu,\n  }\n}\n\nconst getIconColor = (item: DropdownItem) =>\n  item.theme === 'red' ? 'text-ink-red-3' : 'text-ink-gray-6'\nconst getTextColor = (item: DropdownItem) =>\n  item.theme === 'red' ? 'text-ink-red-3' : 'text-ink-gray-7'\nconst getBackgroundColor = (item: DropdownItem) =>\n  item.theme === 'red'\n    ? 'focus:bg-surface-red-3 data-[highlighted]:bg-surface-red-3 data-[state=open]:bg-surface-red-3'\n    : 'focus:bg-surface-gray-3 data-[highlighted]:bg-surface-gray-3 data-[state=open]:bg-surface-gray-3'\nconst getSubmenuBackgroundColor = (item: DropdownItem) =>\n  getBackgroundColor(item) +\n  ' data-[state=open]:bg-surface-' +\n  (item.theme === 'red' ? 'red-3' : 'gray-3')\n\n// Unified group processing for both main options and submenu options\nconst processOptionsIntoGroups = (\n  options: DropdownOptions,\n): DropdownGroupOption[] => {\n  let groups: DropdownGroupOption[] = []\n  let currentGroup: DropdownGroupOption | null = null\n  let i = 0\n\n  for (let option of options) {\n    if (option == null) {\n      continue\n    }\n\n    if ('group' in option) {\n      if (currentGroup) {\n        groups.push(currentGroup)\n        currentGroup = null\n      }\n      let groupOption = {\n        key: i,\n        ...option,\n        items: filterOptions(option.items),\n      } as DropdownGroupOption\n      groups.push(groupOption)\n    } else {\n      if (!currentGroup) {\n        currentGroup = {\n          key: i,\n          group: '',\n          hideLabel: true,\n          items: [],\n        } as DropdownGroupOption\n      }\n      currentGroup.items.push(...filterOptions([option]))\n    }\n    i++\n  }\n\n  if (currentGroup) {\n    groups.push(currentGroup)\n  }\n\n  return groups\n}\n\nconst getSubmenuGroups = (submenuOptions: DropdownOptions) => {\n  return processOptionsIntoGroups(submenuOptions)\n}\n\nconst filterOptions = (options: DropdownOption[]) => {\n  return (options || [])\n    .filter(Boolean)\n    .filter((option) => (option.condition ? option.condition() : true))\n    .map((option) => normalizeDropdownItem(option))\n}\n\n// Check if any item in a group has an icon\nconst groupHasIcons = (group: DropdownGroupOption) => {\n  return group.items.some((item) => item.icon)\n}\n\n// Semantic CSS classes for consistent styling\nconst cssClasses = {\n  // Container classes\n  dropdownContent:\n    'min-w-40 divide-y divide-outline-gray-modals rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none dropdown-content',\n  groupContainer: 'p-1.5',\n\n  // Label classes\n  groupLabel: 'flex h-7 items-center px-2 text-sm font-medium',\n  itemLabel: 'whitespace-nowrap',\n\n  // Icon classes\n  itemIcon: 'mr-2 h-4 w-4 flex-shrink-0',\n  itemIconPlaceholder: 'mr-2 h-4 w-4 flex-shrink-0',\n  chevronIcon: 'ml-auto h-4 w-4 flex-shrink-0',\n\n  // Button classes\n  itemButton:\n    'group flex h-7 w-full items-center rounded px-2 text-base focus:outline-none',\n  submenuTrigger:\n    'group flex h-7 w-full items-center rounded px-2 text-base text-ink-gray-6 focus:outline-none',\n}\n\nconst groups = computed(() => {\n  return processOptionsIntoGroups(props.options)\n})\n\nconst align = computed(() => {\n  if (props.placement === 'left') return 'start' as const\n  if (props.placement === 'right') return 'end' as const\n  if (props.placement === 'center') return 'center' as const\n  return 'start' as const\n})\n</script>\n\n<style scoped>\n@keyframes dropdown-in {\n  from {\n    opacity: 0;\n    transform: scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n@keyframes dropdown-out {\n  from {\n    opacity: 1;\n    transform: scale(1);\n  }\n  to {\n    opacity: 0;\n    transform: scale(0.95);\n  }\n}\n\n:global(.dropdown-content[data-state='open']) {\n  animation: dropdown-in 100ms ease-out;\n}\n\n:global(.dropdown-content[data-state='closed']) {\n  animation: dropdown-out 75ms ease-in;\n}\n</style>\n","<template>\n  <div class=\"flex min-w-0 items-center\">\n    <template v-if=\"dropdownItems.length\">\n      <Dropdown class=\"h-7\" :options=\"dropdownItems\">\n        <Button variant=\"ghost\">\n          <template #icon>\n            <svg\n              class=\"w-4 text-ink-gray-5\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"24\"\n              height=\"24\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              stroke-width=\"2\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            >\n              <circle cx=\"12\" cy=\"12\" r=\"1\" />\n              <circle cx=\"19\" cy=\"12\" r=\"1\" />\n              <circle cx=\"5\" cy=\"12\" r=\"1\" />\n            </svg>\n          </template>\n        </Button>\n      </Dropdown>\n      <span class=\"ml-1 mr-0.5 text-base text-ink-gray-4\" aria-hidden=\"true\">\n        /\n      </span>\n    </template>\n    <div\n      class=\"flex min-w-0 items-center overflow-hidden text-ellipsis whitespace-nowrap\"\n    >\n      <template v-for=\"(item, i) in crumbs\" :key=\"item.label\">\n        <router-link\n          v-if=\"item.route\"\n          :to=\"item.route\"\n          @click=\"item.onClick ? item.onClick() : null\"\n          class=\"flex items-center rounded px-0.5 py-1 text-lg font-medium focus:outline-none focus-visible:ring-2 focus-visible:ring-outline-gray-3\"\n          :class=\"[\n            i == crumbs.length - 1\n              ? 'text-ink-gray-9'\n              : 'text-ink-gray-5 hover:text-ink-gray-7',\n          ]\"\n        >\n          <slot name=\"prefix\" :item=\"item\" />\n          <span>\n            {{ item.label }}\n          </span>\n          <slot name=\"suffix\" :item=\"item\" />\n        </router-link>\n        <button\n          v-else\n          @click=\"item.onClick ? item.onClick() : null\"\n          class=\"flex items-center rounded px-0.5 py-1 text-lg font-medium focus:outline-none focus-visible:ring-2 focus-visible:ring-outline-gray-3\"\n          :class=\"[\n            i == crumbs.length - 1\n              ? 'text-ink-gray-9'\n              : 'text-ink-gray-5 hover:text-ink-gray-7',\n          ]\"\n        >\n          <slot name=\"prefix\" :item=\"item\" />\n          <span>\n            {{ item.label }}\n          </span>\n          <slot name=\"suffix\" :item=\"item\" />\n        </button>\n        <span\n          v-if=\"i != crumbs.length - 1\"\n          class=\"mx-0.5 text-base text-ink-gray-4\"\n          aria-hidden=\"true\"\n        >\n          /\n        </span>\n      </template>\n    </div>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { useWindowSize } from '@vueuse/core'\nimport { computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Dropdown } from '../Dropdown'\nimport { Button } from '../Button'\nimport type { BreadcrumbsProps } from './types'\n\nconst props = defineProps<BreadcrumbsProps>()\n\nconst router = useRouter()\nconst { width } = useWindowSize()\n\nconst items = computed(() => {\n  return (props.items || []).filter(Boolean)\n})\n\nconst dropdownItems = computed(() => {\n  if (width.value > 640) return []\n\n  let allExceptLastTwo = items.value.slice(0, -2)\n  return allExceptLastTwo.map((item) => {\n    let onClick = () => {\n      if (item.onClick) {\n        item.onClick()\n      }\n      if (item.route) {\n        router.push(item.route)\n      }\n    }\n    return {\n      ...item,\n      icon: null,\n      label: item.label,\n      onClick,\n    }\n  })\n})\n\nconst crumbs = computed(() => {\n  if (width.value > 640) return items.value\n\n  let lastTwo = items.value.slice(-2)\n  return lastTwo\n})\n</script>\n","<template>\n  <div\n    class=\"inline-flex space-x-2 rounded transition\"\n    :class=\"{\n      'px-2.5 py-1.5': padding && size === 'sm',\n      'px-3 py-2': padding && size === 'md',\n      'focus-within:bg-surface-gray-2 focus-within:ring-2 focus-within:ring-outline-gray-3 hover:bg-surface-gray-3 active:bg-surface-gray-4':\n        padding && !disabled,\n    }\"\n  >\n    <input\n      class=\"rounded-sm mt-[1px]\"\n      :class=\"inputClasses\"\n      type=\"checkbox\"\n      :disabled=\"disabled\"\n      :id=\"htmlId\"\n      :checked=\"Boolean(modelValue)\"\n      @change=\"\n        (e) =>\n          $emit('update:modelValue', (e.target as HTMLInputElement).checked)\n      \"\n      v-bind=\"attrs\"\n    />\n    <label class=\"block\" :class=\"labelClasses\" v-if=\"label\" :for=\"htmlId\">\n      {{ label }}\n    </label>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { computed, useAttrs } from 'vue'\nimport { useId } from '../../utils/useId'\nimport type { CheckboxProps } from './types'\n\nconst props = withDefaults(defineProps<CheckboxProps>(), {\n  size: 'sm',\n  padding: false,\n})\n\nconst attrs = useAttrs()\n\nconst htmlId = props.id ?? useId()\n\nconst labelClasses = computed(() => {\n  return [\n    {\n      sm: 'text-base font-medium',\n      md: 'text-lg font-medium',\n    }[props.size],\n    props.disabled ? 'text-ink-gray-4' : 'text-ink-gray-8',\n    'select-none',\n  ]\n})\n\nconst inputClasses = computed(() => {\n  let baseClasses = props.disabled\n    ? 'border-outline-gray-2 bg-surface-menu-bar text-ink-gray-3'\n    : 'border-outline-gray-4 text-ink-gray-9 hover:border-gray-600 focus:ring-offset-0 focus:border-gray-900 active:border-gray-700 transition'\n\n  let interactionClasses = props.disabled\n    ? ''\n    : props.padding\n      ? 'focus:ring-0'\n      : 'hover:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3 active:bg-surface-gray-2'\n\n  let sizeClasses = {\n    sm: 'w-3.5 h-3.5',\n    md: 'w-4 h-4',\n  }[props.size]\n\n  return [baseClasses, interactionClasses, sizeClasses]\n})\n</script>\n","export default function debounce(\n  func: Function,\n  wait: number,\n  immediate?: boolean,\n) {\n  var timeout: number | undefined\n  return function () {\n    var context = this,\n      args = arguments\n    var later = function () {\n      timeout = undefined\n      if (!immediate) func.apply(context, args)\n    }\n    var callNow = immediate && !timeout\n    clearTimeout(timeout)\n    timeout = window.setTimeout(later, wait)\n    if (callNow) func.apply(context, args)\n  }\n}\n","<template>\n  <div\n    class=\"relative flex items-center\"\n    :class=\"attrs.class\"\n    :style=\"attrs.style\"\n  >\n    <div\n      :class=\"[\n        'absolute inset-y-0 left-0 flex items-center',\n        textColor,\n        prefixClasses,\n      ]\"\n      v-if=\"$slots.prefix\"\n    >\n      <slot name=\"prefix\"> </slot>\n    </div>\n    <input\n      ref=\"inputRef\"\n      :type=\"type\"\n      :placeholder=\"placeholder\"\n      :class=\"inputClasses\"\n      :disabled=\"disabled\"\n      :id=\"id\"\n      :value=\"modelValue\"\n      :required=\"required\"\n      @input=\"handleChange\"\n      @change=\"handleChange\"\n      v-bind=\"attrsWithoutClassStyle\"\n    />\n    <div\n      :class=\"[\n        'absolute inset-y-0 right-0 flex items-center',\n        textColor,\n        suffixClasses,\n      ]\"\n      v-if=\"$slots.suffix\"\n    >\n      <slot name=\"suffix\"> </slot>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, useSlots, useAttrs, ref } from 'vue'\nimport debounce from '../../utils/debounce'\nimport type { TextInputProps } from './types'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst props = withDefaults(defineProps<TextInputProps>(), {\n  type: 'text',\n  size: 'sm',\n  variant: 'subtle',\n})\n\nconst emit = defineEmits(['update:modelValue'])\n\nconst slots = useSlots()\nconst attrs = useAttrs()\n\nconst attrsWithoutClassStyle = computed(() => {\n  return Object.fromEntries(\n    // class and style is passed to the root element\n    Object.entries(attrs).filter(([key]) => key !== 'class' && key !== 'style'),\n  )\n})\n\nconst inputRef = ref<HTMLInputElement | null>(null)\n\ndefineExpose({ el: inputRef })\n\nconst textColor = computed(() => {\n  return props.disabled ? 'text-ink-gray-5' : 'text-ink-gray-8'\n})\n\nconst inputClasses = computed(() => {\n  let sizeClasses = {\n    sm: 'text-base rounded h-7',\n    md: 'text-base rounded h-8',\n    lg: 'text-lg rounded-md h-10',\n    xl: 'text-xl rounded-md h-10',\n  }[props.size]\n\n  let paddingClasses = {\n    sm: [\n      'py-1.5',\n      slots.prefix ? 'pl-8' : 'pl-2',\n      slots.suffix ? 'pr-8' : 'pr-2',\n    ],\n    md: [\n      'py-1.5',\n      slots.prefix ? 'pl-9' : 'pl-2.5',\n      slots.suffix ? 'pr-9' : 'pr-2.5',\n    ],\n    lg: [\n      'py-1.5',\n      slots.prefix ? 'pl-10' : 'pl-3',\n      slots.suffix ? 'pr-10' : 'pr-3',\n    ],\n    xl: [\n      'py-1.5',\n      slots.prefix ? 'pl-10' : 'pl-3',\n      slots.suffix ? 'pr-10' : 'pr-3',\n    ],\n  }[props.size]\n\n  let variant = props.disabled ? 'disabled' : props.variant\n  let variantClasses = {\n    subtle:\n      'border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    outline:\n      'border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    disabled: [\n      'border bg-surface-gray-1 placeholder-ink-gray-3',\n      props.variant === 'outline'\n        ? 'border-outline-gray-2'\n        : 'border-transparent',\n    ],\n    ghost: 'border-0 focus:ring-0 focus-visible:ring-0',\n  }[variant]\n\n  return [\n    sizeClasses,\n    paddingClasses,\n    variantClasses,\n    textColor.value,\n    'transition-colors w-full dark:[color-scheme:dark]',\n  ]\n})\n\nlet prefixClasses = computed(() => {\n  return {\n    sm: 'pl-2',\n    md: 'pl-2.5',\n    lg: 'pl-3',\n    xl: 'pl-3',\n  }[props.size]\n})\n\nlet suffixClasses = computed(() => {\n  return {\n    sm: 'pr-2',\n    md: 'pr-2.5',\n    lg: 'pr-3',\n    xl: 'pr-3',\n  }[props.size]\n})\n\nlet emitChange = (value: string) => {\n  emit('update:modelValue', value)\n}\nif (props.debounce) {\n  emitChange = debounce(emitChange, props.debounce)\n}\n\nlet handleChange = (e: Event) => {\n  emitChange((e.target as HTMLInputElement).value)\n}\n</script>\n","interface FrappeUIConfig {\n  // Timezone configurations\n  systemTimezone?: string | null\n  localTimezone?: string | null\n\n  // Resource fetcher function\n  resourceFetcher?: (options: any) => Promise<any>\n\n  // Default API endpoints for document operations\n  defaultDocGetUrl?: string\n  defaultDocInsertUrl?: string\n  defaultDocUpdateUrl?: string\n  defaultDocDeleteUrl?: string\n  defaultRunDocMethodUrl?: string\n\n  // Default API endpoints for list operations\n  defaultListUrl?: string\n\n  // Error handling\n  fallbackErrorHandler?: (error: any) => void\n}\n\nlet config: FrappeUIConfig = {}\n\nexport function setConfig<K extends keyof FrappeUIConfig>(\n  key: K,\n  value: FrappeUIConfig[K],\n): void {\n  config[key] = value\n}\n\nexport function getConfig<K extends keyof FrappeUIConfig>(\n  key: K,\n): FrappeUIConfig[K] | null {\n  return config[key] ?? null\n}\n","import _dayjs, { Dayjs } from 'dayjs/esm'\nimport relativeTime from 'dayjs/esm/plugin/relativeTime'\nimport localizedFormat from 'dayjs/esm/plugin/localizedFormat'\nimport updateLocale from 'dayjs/esm/plugin/updateLocale'\nimport isToday from 'dayjs/esm/plugin/isToday'\nimport duration from 'dayjs/esm/plugin/duration'\nimport utc from 'dayjs/esm/plugin/utc'\nimport timezone from 'dayjs/esm/plugin/timezone'\nimport advancedFormat from 'dayjs/esm/plugin/advancedFormat'\nimport customParseFormat from 'dayjs/esm/plugin/customParseFormat'\nimport { getConfig } from './config'\n\n_dayjs.extend(updateLocale)\n_dayjs.extend(relativeTime)\n_dayjs.extend(localizedFormat)\n_dayjs.extend(isToday)\n_dayjs.extend(duration)\n_dayjs.extend(utc)\n_dayjs.extend(timezone)\n_dayjs.extend(advancedFormat)\n_dayjs.extend(customParseFormat)\n\nfunction getBrowserTimezone(): string {\n  return Intl.DateTimeFormat().resolvedOptions().timeZone\n}\n\nexport function dayjsLocal(dateTimeString?: string): Dayjs {\n  let systemTimezone = getConfig('systemTimezone')\n  let localTimezone = getConfig('localTimezone') || getBrowserTimezone()\n\n  if (!systemTimezone) return _dayjs(dateTimeString)\n\n  if (!dateTimeString) return _dayjs().tz(localTimezone)\n  return _dayjs.tz(dateTimeString, systemTimezone).tz(localTimezone)\n}\n\nexport function dayjsSystem(dateTimeString?: string): Dayjs {\n  let systemTimezone = getConfig('systemTimezone')\n  let localTimezone = getConfig('localTimezone') || getBrowserTimezone()\n\n  if (!systemTimezone) return _dayjs(dateTimeString)\n\n  if (!dateTimeString) return _dayjs().tz(systemTimezone)\n  return _dayjs.tz(dateTimeString, localTimezone).tz(systemTimezone)\n}\n\nexport let dayjs = _dayjs\n","import { dayjs, dayjsLocal } from '../../utils/dayjs'\nimport type { Dayjs } from 'dayjs/esm'\nimport type { DatePickerDateObj as DateObj } from './types'\n\n// Constant list of month labels\nexport const months: string[] = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n]\n\n// Start of given month (0-indexed month)\nexport function monthStart(year: number, monthIndex: number): Dayjs {\n  return dayjs(`${year}-${monthIndex + 1}-01`)\n}\n\n// Build weeks grid for the calendar\nexport function generateWeeks(\n  year: number,\n  monthIndex: number,\n  selected: string,\n): DateObj[][] {\n  const start = monthStart(year, monthIndex).startOf('week')\n  const end = monthStart(year, monthIndex).endOf('month').endOf('week')\n  const days: DateObj[] = []\n  let d: Dayjs = start\n  while (d.isBefore(end) || d.isSame(end)) {\n    const inMonth = d.month() === monthIndex\n    const sel = dayjs(selected)\n    days.push({\n      date: d,\n      key: d.format('YYYY-MM-DD'),\n      inMonth,\n      isToday: d.isSame(dayjsLocal().format('YYYY-MM-DD'), 'day'),\n      isSelected: sel.isValid() && d.isSame(sel, 'day'),\n    })\n    d = d.add(1, 'day')\n  }\n  const chunked: DateObj[][] = []\n  for (let i = 0; i < days.length; i += 7) chunked.push(days.slice(i, i + 7))\n  return chunked\n}\n\ntype DateConstructorParam = string | number | Date\n\nfunction getDate(...args: DateConstructorParam[]): Date {\n  return new Date(...(args as [DateConstructorParam]))\n}\n\nfunction getDateValue(date: Date | string) {\n  if (!date || date.toString() === 'Invalid Date') return ''\n\n  return dayjs(date)\n    .set('hour', 0)\n    .set('minute', 0)\n    .set('second', 0)\n    .set('millisecond', 0)\n    .format('YYYY-MM-DD')\n}\n\nfunction getDatesAfter(date: Date, count: number) {\n  let incrementer = 1\n  if (count < 0) {\n    incrementer = -1\n    count = Math.abs(count)\n  }\n  const dates: Date[] = []\n\n  while (count) {\n    date = getDate(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate() + incrementer,\n    )\n    dates.push(date)\n    count--\n  }\n\n  if (incrementer === -1) {\n    return dates.reverse()\n  }\n  return dates\n}\n\nfunction getDaysInMonth(monthIndex: number, year: number) {\n  const daysInMonthMap = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\n  const daysInMonth = daysInMonthMap[monthIndex]\n  if (monthIndex === 1 && isLeapYear(year)) {\n    return 29\n  }\n  return daysInMonth\n}\n\nfunction isLeapYear(year: number) {\n  if (year % 400 === 0) return true\n  if (year % 100 === 0) return false\n  if (year % 4 === 0) return true\n  return false\n}\n\nexport { getDate, getDateValue, getDatesAfter, getDaysInMonth, isLeapYear }\n","<template>\n  <Popover\n    v-model:show=\"showOptions\"\n    transition=\"default\"\n    :placement=\"placement\"\n  >\n    <template #target=\"{ togglePopover, isOpen }\">\n      <TextInput\n        ref=\"inputRef\"\n        v-model=\"displayValue\"\n        :variant=\"variant\"\n        type=\"text\"\n        class=\"text-sm w-full cursor-text\"\n        :placeholder=\"placeholder\"\n        :disabled=\"disabled\"\n        :readonly=\"!props.allowCustom\"\n        @focus=\"onFocus\"\n        @click=\"onClickInput(isOpen, togglePopover)\"\n        @keydown.enter.prevent=\"onEnter\"\n        @blur=\"onBlur\"\n        @keydown.down.prevent=\"onArrowDown(togglePopover, isOpen)\"\n        @keydown.up.prevent=\"onArrowUp(togglePopover, isOpen)\"\n        @keydown.esc.prevent=\"onEscape\"\n      >\n        <template v-if=\"$slots.prefix\" #prefix>\n          <slot name=\"prefix\" />\n        </template>\n        <template #suffix>\n          <slot name=\"suffix\" v-bind=\"{ togglePopover, isOpen }\">\n            <FeatherIcon\n              name=\"chevron-down\"\n              class=\"h-4 w-4 cursor-pointer\"\n              @mousedown.prevent=\"togglePopover\"\n            />\n          </slot>\n        </template>\n      </TextInput>\n    </template>\n    <template #body=\"{ isOpen }\">\n      <div\n        v-show=\"isOpen\"\n        ref=\"panelRef\"\n        class=\"mt-2 max-h-48 w-44 overflow-y-auto rounded-lg bg-surface-modal p-1 text-base shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none\"\n        role=\"listbox\"\n        :aria-activedescendant=\"activeDescendantId\"\n      >\n        <button\n          v-for=\"(opt, idx) in displayedOptions\"\n          :key=\"opt.value\"\n          :data-value=\"opt.value\"\n          :data-index=\"idx\"\n          type=\"button\"\n          class=\"group flex h-7 w-full items-center rounded px-2 text-left\"\n          :class=\"buttonClasses(opt, idx)\"\n          @click=\"select(opt.value)\"\n          @mouseenter=\"highlightIndex = idx\"\n          role=\"option\"\n          :id=\"optionId(idx)\"\n          :aria-selected=\"internalValue === opt.value\"\n        >\n          <span class=\"truncate\">{{ opt.label }}</span>\n        </button>\n      </div>\n    </template>\n  </Popover>\n</template>\n\n<script setup lang=\"ts\">\nimport Popover from '../Popover/Popover.vue'\nimport TextInput from '../TextInput/TextInput.vue'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport { ref, computed, watch, nextTick } from 'vue'\nimport type {\n  Option,\n  ParsedTime,\n  TimePickerProps,\n  Placement,\n  Variant,\n  TimePickerEmits,\n} from './types'\n\nconst props = withDefaults(defineProps<TimePickerProps>(), {\n  value: '',\n  modelValue: '',\n  interval: 15,\n  options: () => [],\n  placement: 'bottom-start' as Placement,\n  placeholder: 'Select time',\n  variant: 'subtle' as Variant,\n  allowCustom: true,\n  autoClose: true,\n  use12Hour: true,\n  disabled: false,\n  scrollMode: 'center' as const,\n  minTime: '',\n  maxTime: '',\n})\n\nconst emit = defineEmits<TimePickerEmits>()\n\nconst panelRef = ref<HTMLElement | null>(null)\nconst isFocused = ref(false)\nconst showOptions = ref(false)\nconst highlightIndex = ref<number>(-1)\nconst hasSelectedOnFirstClick = ref(false)\nconst isTyping = ref(false)\nlet navUpdating = false\nlet invalidState = false\n\nconst inputRef = ref<any>(null)\nconst initial = props.modelValue || props.value || ''\nconst internalValue = ref<string>(initial)\nconst displayValue = ref<string>('')\ndisplayValue.value = formatDisplay(internalValue.value)\nconst uid = Math.random().toString(36).slice(2, 9)\nconst activeDescendantId = computed<string | undefined>(() =>\n  highlightIndex.value > -1 ? optionId(highlightIndex.value) : undefined,\n)\nfunction optionId(idx: number): string {\n  return `tp-${uid}-${idx}`\n}\n\nfunction minutesFromHHMM(str: string): number | null {\n  if (!str) return null\n  if (!/^\\d{2}:\\d{2}(:\\d{2})?$/.test(str)) return null\n  const [h, m] = str.split(':').map((n) => parseInt(n))\n  if (h > 23 || m > 59) return null\n  return h * 60 + m\n}\nconst minMinutes = computed<number | null>(() => minutesFromHHMM(props.minTime))\nconst maxMinutes = computed<number | null>(() => minutesFromHHMM(props.maxTime))\n\nconst displayedOptions = computed<Option[]>(() => {\n  if (props.options?.length) {\n    return props.options.map((o) => {\n      const value = normalize24(o.value)\n      return {\n        value,\n        label: o.label || formatDisplay(value),\n      }\n    })\n  }\n  const out: Option[] = []\n  for (let m = 0; m < 1440; m += props.interval) {\n    if (minMinutes.value != null && m < minMinutes.value) continue\n    if (maxMinutes.value != null && m > maxMinutes.value) continue\n    const hh = Math.floor(m / 60)\n      .toString()\n      .padStart(2, '0')\n    const mm = (m % 60).toString().padStart(2, '0')\n    const val = `${hh}:${mm}`\n    out.push({\n      value: val,\n      label: formatDisplay(val),\n    })\n  }\n  return out\n})\n\nwatch(\n  () => [props.modelValue, props.value],\n  ([m, v]) => {\n    const nv = m || v || ''\n    if (nv && nv !== internalValue.value) {\n      internalValue.value = normalize24(nv)\n      displayValue.value = formatDisplay(internalValue.value)\n    } else if (!nv) {\n      internalValue.value = ''\n      displayValue.value = ''\n    }\n  },\n)\n\nfunction normalize24(raw: string): string {\n  if (!raw) return ''\n  if (/^\\d{2}:\\d{2}$/.test(raw)) return raw\n  if (/^\\d{2}:\\d{2}:\\d{2}$/.test(raw)) return raw // keep seconds if present\n  const parsed = parseFlexibleTime(raw)\n  if (!parsed.valid) return ''\n  return parsed.ss\n    ? `${parsed.hh24}:${parsed.mm}:${parsed.ss}`\n    : `${parsed.hh24}:${parsed.mm}`\n}\n\nfunction formatDisplay(val24: string): string {\n  if (!val24) return ''\n  const segs = val24.split(':')\n  const h = parseInt(segs[0])\n  const m = parseInt(segs[1])\n  const s = segs[2]\n  const base24 = `${h.toString().padStart(2, '0')}:${m\n    .toString()\n    .padStart(2, '0')}${s ? `:${s}` : ''}`\n  if (!props.use12Hour) return base24\n  const am = h < 12\n  const hour12 = h % 12 === 0 ? 12 : h % 12\n  return `${hour12}:${m.toString().padStart(2, '0')}${s ? `:${s}` : ''} ${\n    am ? 'am' : 'pm'\n  }`\n}\n\nfunction parseFlexibleTime(input: string): ParsedTime {\n  if (!input) return { valid: false }\n  let s = input.trim().toLowerCase()\n  s = s.replace(/\\./g, '')\n  s = s.replace(/(\\d)(am|pm)$/, '$1 $2')\n  const re = /^(\\d{1,2})(?::(\\d{1,2}))?(?::(\\d{1,2}))?\\s*([ap]m)?$/\n  const m = s.match(re)\n  if (!m) return { valid: false }\n  let [, hhStr, mmStr, ssStr, ap] = m\n  let hh = parseInt(hhStr)\n  if (isNaN(hh) || hh < 0 || hh > 23) return { valid: false }\n  if (ssStr && !mmStr) return { valid: false }\n  let mm = mmStr != null && mmStr !== '' ? parseInt(mmStr) : 0\n  if (isNaN(mm) || mm < 0 || mm > 59) return { valid: false }\n  let ss: number | undefined\n  if (ssStr) {\n    ss = parseInt(ssStr)\n    if (isNaN(ss) || ss < 0 || ss > 59) return { valid: false }\n  }\n  if (ap) {\n    if (hh < 1 || hh > 12) return { valid: false }\n    if (hh === 12 && ap === 'am') hh = 0\n    else if (hh < 12 && ap === 'pm') hh += 12\n  }\n  return {\n    valid: true,\n    hh24: hh.toString().padStart(2, '0'),\n    mm: mm.toString().padStart(2, '0'),\n    ss: ss != null ? ss.toString().padStart(2, '0') : undefined,\n    total: hh * 60 + mm,\n  }\n}\n\nfunction findNearestIndex(targetMinutes: number, list: Option[]): number {\n  if (!list.length) return -1\n  const minutesArr = list.map((o) => {\n    const [hh, mm] = o.value.split(':').map(Number)\n    return hh * 60 + mm\n  })\n  let lo = 0,\n    hi = minutesArr.length - 1\n  while (lo <= hi) {\n    const mid = (lo + hi) >> 1\n    const val = minutesArr[mid]\n    if (val === targetMinutes) return mid\n    if (val < targetMinutes) lo = mid + 1\n    else hi = mid - 1\n  }\n  const candidates: number[] = []\n  if (lo < minutesArr.length) candidates.push(lo)\n  if (lo - 1 >= 0) candidates.push(lo - 1)\n  if (!candidates.length) return -1\n  return candidates.sort(\n    (a, b) =>\n      Math.abs(minutesArr[a] - targetMinutes) -\n      Math.abs(minutesArr[b] - targetMinutes),\n  )[0]\n}\n\nfunction isOutOfRange(totalMinutes: number): boolean {\n  if (minMinutes.value != null && totalMinutes < minMinutes.value) return true\n  if (maxMinutes.value != null && totalMinutes > maxMinutes.value) return true\n  return false\n}\n\nfunction applyValue(val24: string, commit = false) {\n  const prev = internalValue.value\n  internalValue.value = val24\n  displayValue.value = formatDisplay(val24)\n  if (commit || !isFocused.value) emit('update:modelValue', val24)\n  if (commit && val24 !== prev) emit('change', val24)\n  setInvalid(false)\n}\n\nfunction commitInput() {\n  const raw = displayValue.value\n  const parsed = parseFlexibleTime(raw)\n  if (!raw) {\n    const prev = internalValue.value\n    internalValue.value = ''\n    if (!isFocused.value) emit('update:modelValue', '')\n    if (prev && prev !== '') emit('change', '')\n    setInvalid(false)\n    return\n  }\n  if (!parsed.valid || isOutOfRange(parsed.total)) {\n    emit('input-invalid', raw)\n    setInvalid(true)\n    return\n  }\n  const normalized = parsed.ss\n    ? `${parsed.hh24}:${parsed.mm}:${parsed.ss}`\n    : `${parsed.hh24}:${parsed.mm}`\n  if (\n    !props.allowCustom &&\n    !displayedOptions.value.some((o) => {\n      const base = normalized.length === 8 ? normalized.slice(0, 5) : normalized\n      return o.value === base\n    })\n  ) {\n    const nearestIdx = findNearestIndex(parsed.total, displayedOptions.value)\n    if (nearestIdx > -1) {\n      const nearestVal = displayedOptions.value[nearestIdx].value\n      const committed =\n        normalized.length === 8 && nearestVal.length === 5\n          ? `${nearestVal}${normalized.slice(5)}`\n          : nearestVal\n      applyValue(committed, true)\n      return\n    }\n  }\n  applyValue(normalized, true)\n}\n\nfunction select(val: string, forceChange = false) {\n  const prev = internalValue.value\n  applyValue(val, true)\n  if (forceChange && prev === internalValue.value) {\n    emit('change', internalValue.value)\n  }\n  if (props.autoClose) showOptions.value = false\n}\n\nconst selectedAndNearest = computed<{\n  selected: Option | null\n  nearest: Option | null\n}>(() => {\n  const list = displayedOptions.value\n  if (!list.length) return { selected: null, nearest: null }\n  const parsedTyped = parseFlexibleTime(displayValue.value)\n  const candidate =\n    isTyping.value && parsedTyped.valid\n      ? parsedTyped.ss\n        ? `${parsedTyped.hh24}:${parsedTyped.mm}:${parsedTyped.ss}`\n        : `${parsedTyped.hh24}:${parsedTyped.mm}`\n      : internalValue.value || null\n  if (!candidate) return { selected: null, nearest: null }\n  const candidateCompare =\n    candidate && candidate.length === 8 ? candidate.slice(0, 5) : candidate\n  const selected = list.find((o) => o.value === candidateCompare) || null\n  if (selected) return { selected, nearest: null }\n  const parsed = parseFlexibleTime(candidate)\n  if (!parsed.valid) return { selected: null, nearest: null }\n  const idx = findNearestIndex(parsed.total, list)\n  return { selected: null, nearest: idx > -1 ? list[idx] : null }\n})\n\nfunction buttonClasses(opt: Option, idx: number): string {\n  if (idx === highlightIndex.value) return 'bg-surface-gray-3 text-ink-gray-8'\n  const { selected, nearest } = selectedAndNearest.value\n  if (isTyping.value && !selected) {\n    if (nearest && nearest.value === opt.value)\n      return 'text-ink-gray-7 italic bg-surface-gray-2'\n    return 'text-ink-gray-6 hover:bg-surface-gray-2 hover:text-ink-gray-8'\n  }\n  if (selected && selected.value === opt.value)\n    return 'bg-surface-gray-3 text-ink-gray-8'\n  if (nearest && nearest.value === opt.value)\n    return 'text-ink-gray-7 italic bg-surface-gray-2'\n  return 'text-ink-gray-6 hover:bg-surface-gray-2 hover:text-ink-gray-8'\n}\n\nwatch(\n  () => displayedOptions.value,\n  () => scheduleScroll(),\n)\n\nfunction scheduleScroll() {\n  nextTick(() => {\n    if (!panelRef.value || !showOptions.value) return\n    let targetEl: HTMLElement | null = null\n    if (highlightIndex.value > -1) {\n      targetEl = panelRef.value.querySelector(\n        `[data-index=\"${highlightIndex.value}\"]`,\n      ) as HTMLElement | null\n    } else {\n      const { selected, nearest } = selectedAndNearest.value\n      const target = selected || nearest\n      if (target)\n        targetEl = panelRef.value.querySelector(\n          `[data-value=\"${target.value}\"]`,\n        ) as HTMLElement | null\n    }\n    if (!targetEl) return\n    targetEl.scrollIntoView({\n      block:\n        props.scrollMode === 'center'\n          ? 'center'\n          : props.scrollMode === 'start'\n            ? 'start'\n            : 'nearest',\n    })\n  })\n}\n\nwatch(showOptions, (open) => {\n  if (open) {\n    emit('open')\n    initHighlight()\n    scheduleScroll()\n  } else {\n    emit('close')\n  }\n})\n\nwatch(\n  () => displayValue.value,\n  () => {\n    if (navUpdating) return\n    if (showOptions.value) scheduleScroll()\n    isTyping.value = true\n    highlightIndex.value = -1\n  },\n)\n\nfunction initHighlight() {\n  const { selected, nearest } = selectedAndNearest.value\n  const target = selected || nearest\n  if (!target) {\n    highlightIndex.value = -1\n    return\n  }\n  const idx = displayedOptions.value.findIndex((o) => o.value === target.value)\n  highlightIndex.value = idx\n}\n\nfunction moveHighlight(delta: number) {\n  const list = displayedOptions.value\n  if (!list.length) return\n  if (highlightIndex.value === -1) initHighlight()\n  else\n    highlightIndex.value =\n      (highlightIndex.value + delta + list.length) % list.length\n  const opt = list[highlightIndex.value]\n  if (opt) {\n    navUpdating = true\n    const val =\n      internalValue.value.length === 8 && opt.value.length === 5\n        ? `${opt.value}${internalValue.value.slice(5)}`\n        : opt.value\n    applyValue(val, false)\n    nextTick(() => {\n      navUpdating = false\n    })\n  }\n  isTyping.value = false\n  scheduleScroll()\n}\n\nfunction onArrowDown(togglePopover: () => void, isOpen?: boolean) {\n  if (!isOpen) togglePopover()\n  else moveHighlight(1)\n}\nfunction onArrowUp(togglePopover: () => void, isOpen?: boolean) {\n  if (!isOpen) togglePopover()\n  else moveHighlight(-1)\n}\n\nfunction onEnter() {\n  if (!showOptions.value) {\n    commitInput()\n    blurInput()\n    return\n  }\n  const parsed = parseFlexibleTime(displayValue.value)\n  const normalized = parsed.valid\n    ? parsed.ss\n      ? `${parsed.hh24}:${parsed.mm}:${parsed.ss}`\n      : `${parsed.hh24}:${parsed.mm}`\n    : null\n  const exists = normalized\n    ? displayedOptions.value.some((o) => {\n        const base =\n          normalized.length === 8 ? normalized.slice(0, 5) : normalized\n        return o.value === base\n      })\n    : false\n  if (parsed.valid && (!exists || isTyping.value)) {\n    commitInput()\n    if (props.autoClose) showOptions.value = false\n    blurInput()\n    return\n  }\n  if (highlightIndex.value > -1) {\n    const opt = displayedOptions.value[highlightIndex.value]\n    if (opt) select(opt.value, true)\n  } else {\n    commitInput()\n    if (props.autoClose) showOptions.value = false\n  }\n  blurInput()\n}\n\nfunction onClickInput(isOpen: boolean | undefined, togglePopover: () => void) {\n  if (!isOpen) togglePopover()\n  if (props.allowCustom) selectAll()\n}\n\nfunction onFocus() {\n  isFocused.value = true\n  if (props.allowCustom && !hasSelectedOnFirstClick.value) selectAll()\n}\n\nfunction onBlur() {\n  if (showOptions.value) {\n    isFocused.value = false\n    return\n  }\n  commitInput()\n  isFocused.value = false\n}\n\nfunction selectAll() {\n  nextTick(() => {\n    const el = inputRef.value?.el || inputRef.value\n    if (el && el.querySelector) {\n      const input: HTMLInputElement | any = el.querySelector('input') || el\n      input?.select?.()\n    } else if (el?.select) {\n      el.select()\n    }\n    hasSelectedOnFirstClick.value = true\n  })\n}\n\nfunction blurInput() {\n  nextTick(() => {\n    const el = inputRef.value?.el || inputRef.value\n    if (el && el.querySelector) {\n      const input: HTMLInputElement | any = el.querySelector('input') || el\n      input?.blur?.()\n    } else if (el?.blur) {\n      el.blur()\n    }\n    isFocused.value = false\n  })\n}\n\nfunction onEscape() {\n  if (showOptions.value) showOptions.value = false\n  blurInput()\n}\n\nfunction setInvalid(val: boolean) {\n  if (invalidState !== val) {\n    invalidState = val\n    emit('invalid-change', val)\n  }\n}\n</script>\n","<template>\n  <Popover\n    class=\"inline-block\"\n    :placement=\"placement\"\n    @open=\"initFromValue\"\n    @close=\"handleClose\"\n  >\n    <template #target=\"{ togglePopover, isOpen }\">\n      <slot\n        name=\"target\"\n        v-bind=\"{ togglePopover, isOpen, displayLabel, inputValue }\"\n      >\n        <TextInput\n          v-model=\"inputValue\"\n          type=\"text\"\n          class=\"cursor-text w-full\"\n          :class=\"props.inputClass\"\n          :label=\"props.label\"\n          :variant=\"props.variant\"\n          :placeholder=\"props.placeholder || 'Select date & time'\"\n          :disabled=\"props.disabled\"\n          :readonly=\"props.readonly || !props.allowCustom\"\n          @focus=\"activateInput(isOpen, togglePopover)\"\n          @click=\"activateInput(isOpen, togglePopover)\"\n          @blur=\"onBlur\"\n          @keydown.enter.prevent=\"onEnter(togglePopover)\"\n        >\n          <template v-if=\"$slots.prefix\" #prefix>\n            <slot\n              name=\"prefix\"\n              v-bind=\"{ togglePopover, isOpen, displayLabel, inputValue }\"\n            />\n          </template>\n          <template #suffix>\n            <slot\n              name=\"suffix\"\n              v-bind=\"{ togglePopover, isOpen, displayLabel, inputValue }\"\n            >\n              <FeatherIcon\n                name=\"chevron-down\"\n                class=\"h-4 w-4 cursor-pointer\"\n                @mousedown.prevent=\"togglePopover\"\n              />\n            </slot>\n          </template>\n        </TextInput>\n      </slot>\n    </template>\n\n    <template #body=\"{ togglePopover }\">\n      <div\n        ref=\"popoverContentRef\"\n        class=\"w-fit min-w-60 select-none text-base text-ink-gray-9 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 mt-2\"\n      >\n        <!-- Header (Month/Year navigation) -->\n        <div class=\"flex items-center justify-between p-2 pb-0 gap-1\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            class=\"text-sm font-medium text-ink-gray-7\"\n            @click=\"cycleView\"\n          >\n            <span v-if=\"view === 'date'\"\n              >{{ months[currentMonth] }} {{ currentYear }}</span\n            >\n            <span v-else-if=\"view === 'month'\">{{ currentYear }}</span>\n            <span v-else>{{ yearRangeStart }} - {{ yearRangeStart + 11 }}</span>\n          </Button>\n          <div class=\"flex items-center\">\n            <Button\n              variant=\"ghost\"\n              icon=\"chevron-left\"\n              class=\"size-7\"\n              @click=\"prev\"\n            />\n            <Button\n              v-if=\"!clearable\"\n              variant=\"ghost\"\n              class=\"text-xs\"\n              :label=\"'Now'\"\n              @click=\"() => handleNowClick(togglePopover)\"\n            />\n            <Button\n              variant=\"ghost\"\n              icon=\"chevron-right\"\n              class=\"size-7\"\n              @click=\"next\"\n            />\n          </div>\n        </div>\n\n        <!-- Calendar -->\n        <div class=\"p-2\">\n          <div v-if=\"view === 'date'\" role=\"grid\" aria-label=\"Calendar dates\">\n            <div\n              class=\"flex items-center text-xs font-medium uppercase text-ink-gray-4 mb-1\"\n            >\n              <div\n                v-for=\"d in ['S', 'M', 'T', 'W', 'T', 'F', 'S']\"\n                :key=\"d\"\n                class=\"flex h-6 w-8 items-center justify-center\"\n              >\n                {{ d }}\n              </div>\n            </div>\n            <div v-for=\"(week, wi) in weeks\" :key=\"wi\" class=\"flex\" role=\"row\">\n              <button\n                v-for=\"dateObj in week\"\n                type=\"button\"\n                :key=\"dateObj.key\"\n                class=\"flex h-8 w-8 items-center justify-center rounded cursor-pointer text-sm focus:outline-none focus:ring-2 focus:ring-outline-gray-2\"\n                :class=\"[\n                  dateObj.inMonth ? 'text-ink-gray-8' : 'text-ink-gray-3',\n                  dateObj.isToday ? 'font-extrabold text-ink-gray-9' : '',\n                  dateObj.disabled\n                    ? 'opacity-30 cursor-not-allowed hover:bg-transparent'\n                    : dateObj.isSelected\n                      ? 'bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6'\n                      : 'hover:bg-surface-gray-2',\n                ]\"\n                role=\"gridcell\"\n                :aria-selected=\"dateObj.isSelected ? 'true' : 'false'\"\n                :aria-label=\"\n                  dateObj.date.format('YYYY-MM-DD') +\n                  (dateObj.isToday ? ' (Today)' : '')\n                \"\n                :disabled=\"dateObj.disabled\"\n                @click=\"\n                  !dateObj.disabled &&\n                    handleDateCellClick(dateObj.date, togglePopover)\n                \"\n              >\n                {{ dateObj.date.date() }}\n              </button>\n            </div>\n          </div>\n          <div\n            v-else-if=\"view === 'month'\"\n            class=\"grid grid-cols-3 gap-1\"\n            role=\"grid\"\n            aria-label=\"Select month\"\n          >\n            <button\n              v-for=\"(m, i) in months\"\n              type=\"button\"\n              :key=\"m\"\n              class=\"py-2 text-sm rounded cursor-pointer text-center hover:bg-surface-gray-2 focus:outline-none focus:ring-2 focus:ring-brand-6\"\n              :class=\"{\n                'bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6':\n                  i === currentMonth,\n              }\"\n              :aria-selected=\"i === currentMonth ? 'true' : 'false'\"\n              @click=\"selectMonth(i)\"\n            >\n              {{ m.slice(0, 3) }}\n            </button>\n          </div>\n          <div\n            v-else\n            class=\"grid grid-cols-3 gap-1\"\n            role=\"grid\"\n            aria-label=\"Select year\"\n          >\n            <button\n              v-for=\"y in yearRange\"\n              type=\"button\"\n              :key=\"y\"\n              class=\"py-2 text-sm rounded cursor-pointer text-center hover:bg-surface-gray-2 focus:outline-none focus:ring-2 focus:ring-brand-6\"\n              :class=\"{\n                'bg-surface-gray-6 text-ink-white hover:bg-surface-gray-6':\n                  y === currentYear,\n              }\"\n              :aria-selected=\"y === currentYear ? 'true' : 'false'\"\n              @click=\"selectYear(y)\"\n            >\n              {{ y }}\n            </button>\n          </div>\n        </div>\n\n        <!-- Time Picker Section -->\n        <div class=\"flex flex-col gap-2 p-2 pt-0\">\n          <TimePicker\n            :value=\"timeValue\"\n            :allowCustom=\"props.allowCustomTime\"\n            :placement=\"'bottom-start'\"\n            placeholder=\"Select time\"\n            :minTime=\"computedMinTime\"\n            :maxTime=\"computedMaxTime\"\n            @change=\"onTimeChange\"\n          />\n        </div>\n\n        <!-- Footer Actions (clearable variant) -->\n        <div\n          v-if=\"props.clearable\"\n          class=\"flex items-center justify-between gap-1 p-2 border-t\"\n        >\n          <div class=\"flex gap-1\">\n            <Button\n              variant=\"outline\"\n              :label=\"'Now'\"\n              @click=\"() => handleNowClick(togglePopover)\"\n            />\n            <Button\n              variant=\"outline\"\n              :label=\"'Tomorrow'\"\n              @click=\"() => handleTomorrowClick()\"\n            />\n          </div>\n          <Button\n            v-if=\"selectedDate\"\n            size=\"sm\"\n            variant=\"outline\"\n            :label=\"'Clear'\"\n            @click=\"() => handleClearClick(togglePopover)\"\n          />\n        </div>\n      </div>\n    </template>\n  </Popover>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, toRefs } from 'vue'\nimport { Popover } from '../Popover'\nimport { Button } from '../Button'\nimport { TextInput } from '../TextInput'\n// @ts-ignore - Vue SFC without explicit types\nimport FeatherIcon from '../FeatherIcon.vue'\nimport TimePicker from '../TimePicker/TimePicker.vue'\nimport { dayjs, dayjsLocal, dayjsSystem } from '../../utils/dayjs'\nimport { months, monthStart, generateWeeks, getDateValue } from './utils'\nimport type { Dayjs } from 'dayjs/esm'\nimport type {\n  DatePickerProps,\n  DatePickerEmits,\n  DatePickerViewMode as ViewMode,\n} from './types'\n\ninterface ExtraDateTimeProps {\n  minDateTime?: string\n  maxDateTime?: string\n  allowCustomTime?: boolean\n}\n\nconst props = withDefaults(\n  defineProps<DatePickerProps & ExtraDateTimeProps>(),\n  {\n    value: '',\n    modelValue: '',\n    placement: 'bottom-start',\n    variant: 'subtle',\n    placeholder: 'Select date & time',\n    readonly: false,\n    allowCustom: true,\n    autoClose: true,\n    disabled: false,\n    clearable: true,\n    allowCustomTime: true,\n  },\n)\nconst emit = defineEmits<DatePickerEmits>()\n\nconst { autoClose } = toRefs(props)\n\nconst view = ref<ViewMode>('date')\nconst currentYear = ref<number>(dayjs().year())\nconst currentMonth = ref<number>(dayjs().month())\nconst DATE_FORMAT = 'YYYY-MM-DD'\nconst DATE_TIME_FORMAT = 'YYYY-MM-DD HH:mm:ss'\n\nconst selectedDate = ref<string>('') // YYYY-MM-DD\nconst timeValue = ref<string>('') // HH:mm:ss\n\nconst initialValue = ref(props.modelValue || props.value || '')\n\nfunction coerceDateTime(val?: string | null): Dayjs | null {\n  if (!val) return null\n  const raw = String(val).trim()\n  if (!raw) return null\n\n  if (props.format) {\n    const dStrict = dayjs(raw, props.format, true)\n    if (dStrict.isValid()) return dStrict\n  }\n\n  const dLoose = dayjsLocal(raw)\n  if (dLoose.isValid()) return dLoose\n\n  const normalized = getDateValue(raw)\n  if (normalized) {\n    const dNorm = dayjsLocal(normalized)\n    if (dNorm.isValid()) return dNorm\n  }\n  return null\n}\n\nfunction syncFromValue(val?: string): void {\n  if (!val) {\n    if (!props.clearable) {\n      const now = dayjsLocal()\n      currentYear.value = now.year()\n      currentMonth.value = now.month()\n      selectedDate.value = now.format(DATE_FORMAT)\n      timeValue.value = now.format('HH:mm:ss')\n    } else {\n      selectedDate.value = ''\n      timeValue.value = ''\n    }\n    return\n  }\n  const d = coerceDateTime(val)\n  if (!d) {\n    selectedDate.value = ''\n    timeValue.value = ''\n    return\n  }\n  currentYear.value = d.year()\n  currentMonth.value = d.month()\n  selectedDate.value = d.format(DATE_FORMAT)\n  timeValue.value = d.format('HH:mm:ss')\n}\n\nsyncFromValue(initialValue.value)\n\nfunction initFromValue(): void {\n  syncFromValue(props.modelValue || props.value)\n}\n\nwatch(\n  () => [props.modelValue, props.value],\n  ([m, v]) => {\n    const val = m || v\n    syncFromValue(val)\n  },\n)\n\nconst combinedValue = computed<string>(() => {\n  if (!selectedDate.value) return ''\n  const base = `${selectedDate.value} ${timeValue.value || '00:00:00'}`\n  const local = dayjs(base)\n  if (!local.isValid()) return ''\n  return local.format(DATE_TIME_FORMAT)\n})\n\nconst displayLabel = computed<string>(() => {\n  if (!combinedValue.value) return ''\n  if (props.format) return dayjs(combinedValue.value).format(props.format)\n  return combinedValue.value\n})\n\nconst inputValue = ref<string>(displayLabel.value)\nconst isTyping = ref(false)\nwatch(displayLabel, (val) => {\n  if (!isTyping.value) inputValue.value = val\n})\n\nfunction maybeClose(togglePopover?: () => void, condition = true) {\n  if (condition && autoClose.value && togglePopover) togglePopover()\n}\n\nfunction clearSelection() {\n  if (!selectedDate.value && !timeValue.value) return\n  selectedDate.value = ''\n  timeValue.value = ''\n  emit('update:modelValue', '')\n  emit('change', '')\n  initialValue.value = ''\n  inputValue.value = ''\n}\n\nfunction commitInput(close = false, togglePopover?: () => void): void {\n  const raw = inputValue.value.trim()\n  if (!raw) {\n    if (!props.clearable) {\n      const now = dayjsLocal()\n      selectDate(now)\n      timeValue.value = now.format('HH:mm:ss')\n      emitChange()\n      maybeClose(togglePopover, close)\n    } else {\n      clearSelection()\n      maybeClose(togglePopover, close)\n    }\n    return\n  }\n  const parsed = coerceDateTime(raw)\n  if (parsed) {\n    selectDate(parsed)\n    timeValue.value = parsed.format('HH:mm:ss')\n    emitChange()\n    maybeClose(togglePopover, close)\n  }\n}\n\nconst popoverContentRef = ref<HTMLElement | null>(null)\nfunction onBlur(e: FocusEvent) {\n  const next = e.relatedTarget as Node | null\n  if (next && popoverContentRef.value?.contains(next)) return\n  commitInput()\n  isTyping.value = false\n}\nfunction onEnter(togglePopover: () => void) {\n  commitInput(true, togglePopover)\n  isTyping.value = false\n}\nfunction activateInput(isOpen: boolean | undefined, togglePopover: () => void) {\n  isTyping.value = true\n  if (!isOpen) togglePopover()\n}\n\nconst minDT = computed<Dayjs | null>(() =>\n  props.minDateTime ? coerceDateTime(props.minDateTime) : null,\n)\nconst maxDT = computed<Dayjs | null>(() =>\n  props.maxDateTime ? coerceDateTime(props.maxDateTime) : null,\n)\n\nfunction dateDisabled(d: Dayjs): boolean {\n  if (minDT.value && d.endOf('day').isBefore(minDT.value)) return true\n  if (maxDT.value && d.startOf('day').isAfter(maxDT.value)) return true\n  return false\n}\n\nconst weeks = computed<any[][]>(() => {\n  const base = generateWeeks(\n    currentYear.value,\n    currentMonth.value,\n    selectedDate.value,\n  )\n  return base.map((week) =>\n    week.map((obj) => ({ ...obj, disabled: dateDisabled(obj.date) })),\n  )\n})\n\nconst computedMinTime = computed<string>(() => {\n  if (!minDT.value || !selectedDate.value) return ''\n  if (dayjs(selectedDate.value).isSame(minDT.value, 'day'))\n    return minDT.value.format('HH:mm:ss')\n  return ''\n})\nconst computedMaxTime = computed<string>(() => {\n  if (!maxDT.value || !selectedDate.value) return ''\n  if (dayjs(selectedDate.value).isSame(maxDT.value, 'day'))\n    return maxDT.value.format('HH:mm:ss')\n  return ''\n})\n\nwatch([computedMinTime, computedMaxTime, timeValue, selectedDate], () => {\n  if (!selectedDate.value || !timeValue.value) return\n  const cur = dayjs(`${selectedDate.value} ${timeValue.value}`)\n  if (minDT.value && cur.isBefore(minDT.value))\n    timeValue.value = computedMinTime.value || timeValue.value\n  if (maxDT.value && cur.isAfter(maxDT.value))\n    timeValue.value = computedMaxTime.value || timeValue.value\n})\n\nfunction selectDate(date: string | Date | Dayjs): void {\n  const d = dayjs(date as any)\n  if (!d.isValid()) return\n  if (dateDisabled(d)) return\n  selectedDate.value = d.format(DATE_FORMAT)\n  currentYear.value = d.year()\n  currentMonth.value = d.month()\n}\nfunction selectMonth(i: number): void {\n  currentMonth.value = i\n  view.value = 'date'\n}\nfunction selectYear(y: number): void {\n  currentYear.value = y\n  view.value = 'month'\n}\nfunction prev(): void {\n  if (view.value === 'date') {\n    const m = monthStart(currentYear.value, currentMonth.value).subtract(\n      1,\n      'month',\n    )\n    currentYear.value = m.year()\n    currentMonth.value = m.month()\n  } else if (view.value === 'month') currentYear.value -= 1\n  else currentYear.value -= 12\n}\nfunction next(): void {\n  if (view.value === 'date') {\n    const m = monthStart(currentYear.value, currentMonth.value).add(1, 'month')\n    currentYear.value = m.year()\n    currentMonth.value = m.month()\n  } else if (view.value === 'month') currentYear.value += 1\n  else currentYear.value += 12\n}\nfunction handleDateCellClick(\n  date: string | Date | Dayjs,\n  togglePopover: () => void,\n) {\n  selectDate(date)\n  emitChange(true, togglePopover)\n  isTyping.value = false\n  view.value = 'date'\n}\n\nfunction onTimeChange(val: string) {\n  timeValue.value = val\n  isTyping.value = false\n  if (selectedDate.value) emitChange()\n}\n\nfunction emitChange(close = false, togglePopover?: () => void) {\n  if (!selectedDate.value) {\n    clearSelection()\n    return\n  }\n\n  const localDateTime = combinedValue.value\n  const systemDateTime = dayjsSystem(localDateTime).format(DATE_TIME_FORMAT)\n\n  if (systemDateTime !== initialValue.value) {\n    emit('update:modelValue', systemDateTime)\n    emit('change', systemDateTime)\n    initialValue.value = systemDateTime\n  }\n\n  if (!isTyping.value) inputValue.value = displayLabel.value\n  maybeClose(togglePopover, close)\n}\n\nfunction handleNowClick(togglePopover: () => void) {\n  const now = dayjsLocal()\n  selectDate(now)\n  timeValue.value = now.format('HH:mm:ss')\n  emitChange(true, togglePopover)\n  isTyping.value = false\n}\nfunction handleTomorrowClick() {\n  const tomorrow = dayjsLocal().add(1, 'day')\n  selectDate(tomorrow)\n  // keep current time value if any, else set to now's time\n  if (!timeValue.value) timeValue.value = dayjsLocal().format('HH:mm:ss')\n  emitChange()\n  isTyping.value = false\n}\nfunction handleClearClick(togglePopover: () => void) {\n  clearSelection()\n  maybeClose(togglePopover)\n  isTyping.value = false\n  view.value = 'date'\n}\n\nfunction cycleView(): void {\n  if (view.value === 'date') view.value = 'month'\n  else if (view.value === 'month') view.value = 'year'\n  else view.value = 'date'\n}\nfunction handleClose() {\n  view.value = 'date'\n  if (isTyping.value) {\n    commitInput()\n    isTyping.value = false\n  }\n}\n\nconst yearRangeStart = computed(\n  () => currentYear.value - (currentYear.value % 12),\n)\nconst yearRange = computed<number[]>(() =>\n  Array.from({ length: 12 }, (_, i) => yearRangeStart.value + i),\n)\n</script>\n","<template>\n  <DialogRoot v-model:open=\"isOpen\" @update:open=\"handleOpenChange\">\n    <DialogPortal>\n      <DialogOverlay\n        class=\"fixed inset-0 bg-black-overlay-200 backdrop-filter backdrop-blur-[12px] overflow-y-auto dialog-overlay outline-none\"\n        :data-dialog=\"options.title\"\n        @after-leave=\"$emit('after-leave')\"\n      >\n        <div\n          class=\"flex min-h-screen flex-col items-center px-4 py-4 text-center\"\n          :class=\"dialogPositionClasses\"\n        >\n          <DialogContent\n            class=\"my-8 inline-block w-full transform overflow-hidden rounded-xl bg-surface-modal text-left align-middle shadow-xl dialog-content focus-visible:outline-none\"\n            :class=\"{\n              'max-w-7xl': options.size === '7xl',\n              'max-w-6xl': options.size === '6xl',\n              'max-w-5xl': options.size === '5xl',\n              'max-w-4xl': options.size === '4xl',\n              'max-w-3xl': options.size === '3xl',\n              'max-w-2xl': options.size === '2xl',\n              'max-w-xl': options.size === 'xl',\n              'max-w-lg': options.size === 'lg' || !options.size,\n              'max-w-md': options.size === 'md',\n              'max-w-sm': options.size === 'sm',\n              'max-w-xs': options.size === 'xs',\n            }\"\n            @escape-key-down=\"close()\"\n            @interact-outside=\"\n              (e: Event) => {\n                if (props.disableOutsideClickToClose) {\n                  e.preventDefault()\n                }\n              }\n            \"\n          >\n            <slot name=\"body\">\n              <slot name=\"body-main\">\n                <div class=\"bg-surface-modal px-4 pb-6 pt-5 sm:px-6\">\n                  <div class=\"flex\">\n                    <div class=\"w-full flex-1\">\n                      <slot name=\"body-header\">\n                        <div class=\"mb-6 flex items-center justify-between\">\n                          <div class=\"flex items-center space-x-2\">\n                            <div\n                              v-if=\"icon\"\n                              class=\"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full\"\n                              :class=\"dialogIconBgClasses\"\n                            >\n                              <FeatherIcon\n                                :name=\"icon.name\"\n                                class=\"h-4 w-4\"\n                                :class=\"dialogIconClasses\"\n                                aria-hidden=\"true\"\n                              />\n                            </div>\n                            <DialogTitle as=\"header\">\n                              <slot name=\"body-title\">\n                                <h3\n                                  class=\"text-2xl font-semibold leading-6 text-ink-gray-9\"\n                                >\n                                  {{ options.title || 'Untitled' }}\n                                </h3>\n                              </slot>\n                            </DialogTitle>\n                          </div>\n                          <DialogClose as-child>\n                            <Button variant=\"ghost\" @click=\"close\">\n                              <template #icon>\n                                <LucideX class=\"h-4 w-4 text-ink-gray-9\" />\n                              </template>\n                            </Button>\n                          </DialogClose>\n                        </div>\n                      </slot>\n\n                      <slot name=\"body-content\">\n                        <DialogDescription as-child v-if=\"options.message\">\n                          <p class=\"text-p-base text-ink-gray-7\">\n                            {{ options.message }}\n                          </p>\n                        </DialogDescription>\n                      </slot>\n                    </div>\n                  </div>\n                </div>\n              </slot>\n              <div\n                class=\"px-4 pb-7 pt-4 sm:px-6\"\n                v-if=\"actions.length || $slots.actions\"\n              >\n                <slot name=\"actions\" v-bind=\"{ close }\">\n                  <div class=\"space-y-2\">\n                    <Button\n                      class=\"w-full\"\n                      v-for=\"action in actions\"\n                      :key=\"action.label\"\n                      :disabled=\"action.disabled\"\n                      v-bind=\"action\"\n                    >\n                      {{ action.label }}\n                    </Button>\n                  </div>\n                </slot>\n              </div>\n            </slot>\n          </DialogContent>\n        </div>\n      </DialogOverlay>\n    </DialogPortal>\n  </DialogRoot>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  DialogRoot,\n  DialogPortal,\n  DialogOverlay,\n  DialogContent,\n  DialogTitle,\n  DialogDescription,\n  DialogClose,\n} from 'reka-ui'\nimport { computed, reactive } from 'vue'\nimport { Button } from '../Button'\nimport FeatherIcon from '../FeatherIcon.vue'\nimport LucideX from '~icons/lucide/x'\nimport type {\n  DialogProps,\n  DialogIcon,\n  DialogAction,\n  DialogActionContext,\n} from './types'\n\n// Type for dialog action with reactive loading state\ntype ReactiveDialogAction = DialogAction & {\n  loading: boolean\n}\n\nconst props = withDefaults(defineProps<DialogProps>(), {\n  options: () => ({}),\n  disableOutsideClickToClose: false,\n})\n\nconst emit = defineEmits<{\n  (event: 'update:modelValue', value: boolean): void\n  (event: 'close'): void\n  (event: 'after-leave'): void\n}>()\n\nconst actions = computed((): ReactiveDialogAction[] => {\n  let actions = props.options.actions\n  if (!actions?.length) return []\n\n  return actions.map((action) => {\n    let _action = reactive({\n      ...action,\n      loading: false,\n      onClick: !action.onClick\n        ? close\n        : async () => {\n            _action.loading = true\n            try {\n              if (action.onClick) {\n                // deprecated: uncomment this when we remove the backwards compatibility\n                // let context: DialogActionContext = { close }\n                type BackwardsCompatibleDialogActionContext = (() => void) &\n                  DialogActionContext\n\n                let backwardsCompatibleContext = (() => {\n                  console.warn(\n                    'Value passed to onClick is a context object. Please use context.close() instead of context() to close the dialog.',\n                  )\n                  close()\n                }) as BackwardsCompatibleDialogActionContext\n                backwardsCompatibleContext.close = close\n                await action.onClick(backwardsCompatibleContext)\n              }\n            } finally {\n              _action.loading = false\n            }\n          },\n    })\n    return _action\n  })\n})\n\nconst isOpen = computed({\n  get() {\n    return props.modelValue\n  },\n  set(val: boolean) {\n    emit('update:modelValue', val)\n    if (!val) {\n      emit('close')\n    }\n  },\n})\n\nfunction handleOpenChange(open: boolean) {\n  isOpen.value = open\n}\n\nfunction close() {\n  isOpen.value = false\n}\n\nconst icon = computed(() => {\n  if (!props.options?.icon) return null\n\n  let icon = props.options.icon\n  if (typeof icon === 'string') {\n    icon = { name: icon }\n  }\n  return icon as DialogIcon\n})\n\nconst dialogPositionClasses = computed(() => {\n  const position = props.options?.position || 'center'\n  const classMap: Record<string, string> = {\n    center: 'justify-center',\n    top: 'pt-[20vh]',\n  }\n  return classMap[position]\n})\n\nconst dialogIconBgClasses = computed(() => {\n  const appearance = icon.value?.appearance\n  if (!appearance) return 'bg-surface-gray-2'\n  const classMap: Record<string, string> = {\n    warning: 'bg-surface-amber-2',\n    info: 'bg-surface-blue-2',\n    danger: 'bg-surface-red-2',\n    success: 'bg-surface-green-2',\n  }\n  return classMap[appearance]\n})\n\nconst dialogIconClasses = computed(() => {\n  const appearance = icon.value?.appearance\n  if (!appearance) return 'text-ink-gray-5'\n  const classMap: Record<string, string> = {\n    warning: 'text-ink-amber-3',\n    info: 'text-ink-blue-3',\n    danger: 'text-ink-red-4',\n    success: 'text-ink-green-3',\n  }\n  return classMap[appearance]\n})\n</script>\n\n<style scoped>\n@keyframes dialog-overlay-in {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes dialog-overlay-out {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n@keyframes dialog-content-in {\n  from {\n    opacity: 0.5;\n    transform: scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n@keyframes dialog-content-out {\n  from {\n    opacity: 1;\n    transform: scale(1);\n  }\n  to {\n    opacity: 0.5;\n    transform: scale(0.98);\n  }\n}\n\n:global(.dialog-overlay[data-state='open']) {\n  animation: dialog-overlay-in 100ms ease-out;\n}\n\n:global(.dialog-overlay[data-state='closed']) {\n  animation: dialog-overlay-out 150ms ease-in;\n}\n\n:global(.dialog-content[data-state='open']) {\n  animation: dialog-content-in 100ms ease-out;\n}\n\n:global(.dialog-content[data-state='closed']) {\n  animation: dialog-content-out 150ms ease-in;\n}\n</style>\n","import DialogMain from './Dialog.vue'\nimport { DialogTitle, DialogDescription } from 'reka-ui'\nexport type { DialogProps } from './types'\n\ntype DialogExport = typeof DialogMain & {\n  Title: typeof DialogTitle\n  Description: typeof DialogDescription\n}\n\nconst Dialog = DialogMain as DialogExport\nDialog.Title = DialogTitle\nDialog.Description = DialogDescription\n\nexport { Dialog }\n","import ConfirmDialog from '../components/ConfirmDialog.vue'\nimport { h, ref } from 'vue'\n\nexport function confirmDialog({ title = 'Untitled', message = '', onConfirm, onCancel }) {\n  renderDialog(\n    h(ConfirmDialog, {\n      title,\n      message,\n      onConfirm,\n      onCancel\n    }),\n  )\n}\n\nexport const dialogs = ref([])\n\nexport function renderDialog(component) {\n  component.id = dialogs.length\n  dialogs.value.push(component)\n}\n","<template>\n  <div\n    v-if=\"message\"\n    class=\"whitespace-pre-line text-sm text-ink-red-4\"\n    role=\"alert\"\n    v-html=\"errorMessage\"\n  ></div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport type { ErrorMessageProps } from './types'\n\nconst props = defineProps<ErrorMessageProps>()\n\nconst errorMessage = computed(() => {\n  if (!props.message) return ''\n  if (props.message instanceof Error) {\n    return (props.message as any).messages || props.message.message\n  }\n  return props.message\n})\n</script>\n","import { UploadOptions } from \"./useFileUpload\"\n\ntype EventListenerOption = 'start' | 'progress' | 'finish' | 'error'\n\ndeclare global {\n  interface Window {\n    csrf_token?: string\n  }\n}\n\nclass FileUploadHandler {\n  listeners: { [event: string]: Function[] }\n  failed: boolean\n\n  constructor() {\n    this.listeners = {}\n    this.failed = false\n  }\n\n  on(event: EventListenerOption, handler: Function) {\n    this.listeners[event] = this.listeners[event] || []\n    this.listeners[event].push(handler)\n  }\n\n  trigger(event: string, data?: any) {\n    let handlers = this.listeners[event] || []\n    handlers.forEach((handler) => {\n      handler.call(this, data)\n    })\n  }\n\n  upload(file: File | null, options: UploadOptions): Promise<any> {\n    return new Promise((resolve, reject) => {\n      let xhr = new XMLHttpRequest()\n      xhr.upload.addEventListener('loadstart', () => {\n        this.trigger('start')\n      })\n      xhr.upload.addEventListener('progress', (e) => {\n        if (e.lengthComputable) {\n          this.trigger('progress', {\n            uploaded: e.loaded,\n            total: e.total,\n          })\n        }\n      })\n      xhr.upload.addEventListener('load', () => {\n        this.trigger('finish')\n      })\n      xhr.addEventListener('error', () => {\n        this.trigger('error')\n        reject()\n      })\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState == XMLHttpRequest.DONE) {\n          let error\n          if (xhr.status === 200) {\n            let r = null\n            try {\n              r = JSON.parse(xhr.responseText)\n            } catch (e) {\n              r = xhr.responseText\n            }\n            let out = r.message || r\n            resolve(out)\n          } else if (xhr.status === 403) {\n            error = JSON.parse(xhr.responseText)\n          } else {\n            this.failed = true\n            try {\n              error = JSON.parse(xhr.responseText)\n            } catch (e) {\n              // pass\n            }\n          }\n          if (error && error.exc) {\n            console.error(JSON.parse(error.exc)[0])\n          }\n          reject(error)\n        }\n      }\n\n      const uploadEndpoint =\n        options.upload_endpoint || '/api/method/upload_file'\n      xhr.open('POST', uploadEndpoint, true)\n      xhr.setRequestHeader('Accept', 'application/json')\n\n      if (window.csrf_token && window.csrf_token !== '{{ csrf_token }}') {\n        xhr.setRequestHeader('X-Frappe-CSRF-Token', window.csrf_token)\n      }\n\n      let form_data = new FormData()\n      if (file) {\n        form_data.append('file', file, file.name)\n      }\n      form_data.append('is_private', options.private || false ? '1' : '0')\n      form_data.append('folder', options.folder || 'Home')\n\n      if (options.file_url) {\n        form_data.append('file_url', options.file_url)\n      }\n\n      if (options.doctype) {\n        form_data.append('doctype', options.doctype)\n      }\n\n      if (options.docname) {\n        form_data.append('docname', options.docname)\n      }\n\n      if (options.fieldname) {\n        form_data.append('fieldname', options.fieldname)\n      }\n\n      if (options.method) {\n        form_data.append('method', options.method)\n      }\n\n      if (options.type) {\n        form_data.append('type', options.type)\n      }\n\n      if (options.optimize) {\n        form_data.append('optimize', '1')\n        if (options.max_width) {\n            form_data.append('max_width', options.max_width.toString())\n        }\n        if (options.max_height) {\n            form_data.append('max_height', options.max_height.toString())\n        }\n      }\n\n      xhr.send(form_data)\n    })\n  }\n}\n\nexport default FileUploadHandler\n","<template>\n  <div>\n    <input\n      ref=\"input\"\n      type=\"file\"\n      :accept=\"fileTypes\"\n      class=\"hidden\"\n      @change=\"onFileAdd\"\n    />\n    <slot\n      v-bind=\"{\n        file,\n        uploading,\n        progress,\n        uploaded,\n        message,\n        error,\n        total,\n        success,\n        openFileSelector,\n      }\"\n    />\n  </div>\n</template>\n\n<script>\nimport FileUploadHandler from '../../utils/fileUploadHandler'\n\nexport default {\n  name: 'FileUploader',\n  props: {\n    fileTypes: {\n      type: [String, Array],\n    },\n    uploadArgs: {\n      type: Object,\n    },\n    validateFile: {\n      type: Function,\n      default: null,\n    },\n  },\n  data() {\n    return {\n      uploader: null,\n      uploading: false,\n      uploaded: 0,\n      error: null,\n      message: '',\n      total: 0,\n      file: null,\n      finishedUploading: false,\n    }\n  },\n  computed: {\n    progress() {\n      let value = Math.floor((this.uploaded / this.total) * 100)\n      return isNaN(value) ? 0 : value\n    },\n    success() {\n      return this.finishedUploading && !this.error\n    },\n  },\n  methods: {\n    inputRef() {\n      return this.$refs['input']\n    },\n    openFileSelector() {\n      this.$refs['input'].click()\n    },\n    async onFileAdd(e) {\n      this.error = null\n      this.file = e.target.files[0]\n\n      if (this.file && this.validateFile) {\n        try {\n          let message = await this.validateFile(this.file)\n          if (message) {\n            this.error = message\n          }\n        } catch (error) {\n          this.error = error\n        }\n      }\n\n      if (!this.error) {\n        this.uploadFile(this.file)\n      }\n    },\n    async uploadFile(file) {\n      this.error = null\n      this.uploaded = 0\n      this.total = 0\n\n      this.uploader = new FileUploadHandler()\n      this.uploader.on('start', () => {\n        this.uploading = true\n      })\n      this.uploader.on('progress', (data) => {\n        this.uploaded = data.uploaded\n        this.total = data.total\n      })\n      this.uploader.on('error', () => {\n        this.uploading = false\n        this.error = 'Error Uploading File'\n      })\n      this.uploader.on('finish', () => {\n        this.uploading = false\n        this.finishedUploading = true\n      })\n      this.uploader\n        .upload(file, this.uploadArgs || {})\n        .then((data) => {\n          this.$emit('success', data)\n        })\n        .catch((error) => {\n          this.uploading = false\n          let errorMessage = 'Error Uploading File'\n          if (error?._server_messages) {\n            errorMessage = JSON.parse(\n              JSON.parse(error._server_messages)[0],\n            ).message\n          } else if (error?.exc) {\n            errorMessage = JSON.parse(error.exc)[0].split('\\n').slice(-2, -1)[0]\n          }\n          this.error = errorMessage\n          this.$emit('failure', error)\n        })\n    },\n  },\n  expose: ['inputRef'],\n}\n</script>\n","<template>\n  <div class=\"relative flex items-center\">\n    <div\n      :class=\"[\n        'absolute inset-y-0 left-0 flex items-center',\n        textColor,\n        prefixClasses,\n      ]\"\n      v-if=\"$slots.prefix\"\n    >\n      <slot name=\"prefix\"> </slot>\n    </div>\n    <div\n      v-if=\"placeholder\"\n      v-show=\"!modelValue\"\n      class=\"pointer-events-none absolute text-ink-gray-4 truncate w-full\"\n      :class=\"[fontSizeClasses, paddingClasses]\"\n    >\n      {{ placeholder }}\n    </div>\n    <select\n      :class=\"selectClasses\"\n      :disabled=\"disabled\"\n      :id=\"id\"\n      :value=\"modelValue\"\n      @change=\"handleChange\"\n      v-bind=\"attrs\"\n    >\n      <option\n        v-for=\"option in selectOptions\"\n        :key=\"option.value\"\n        :value=\"option.value\"\n        :disabled=\"option.disabled || false\"\n        :selected=\"modelValue === option.value\"\n      >\n        {{ option.label }}\n      </option>\n    </select>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, useSlots, useAttrs } from 'vue'\nimport type { SelectProps } from './types'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst props = withDefaults(defineProps<SelectProps>(), {\n  size: 'sm',\n  variant: 'subtle',\n})\n\nconst emit = defineEmits(['update:modelValue'])\nconst slots = useSlots()\nconst attrs = useAttrs()\n\nfunction handleChange(e: Event) {\n  emit('update:modelValue', (e.target as HTMLInputElement).value)\n}\n\nconst selectOptions = computed(() => {\n  return (\n    props.options\n      ?.map((option) => {\n        if (typeof option === 'string') {\n          return {\n            label: option,\n            value: option,\n          }\n        }\n        return option\n      })\n      .filter(Boolean) || []\n  )\n})\n\nconst textColor = computed(() => {\n  return props.disabled ? 'text-ink-gray-4' : 'text-ink-gray-8'\n})\n\nconst fontSizeClasses = computed(() => {\n  return {\n    sm: 'text-base',\n    md: 'text-base',\n    lg: 'text-lg',\n    xl: 'text-xl',\n  }[props.size]\n})\n\nconst paddingClasses = computed(() => {\n  return {\n    sm: 'pl-2 pr-5',\n    md: 'pl-2.5 pr-5.5',\n    lg: 'pl-3 pr-6',\n    xl: 'pl-3 pr-6',\n  }[props.size]\n})\n\nconst selectClasses = computed(() => {\n  let sizeClasses = {\n    sm: 'rounded h-7',\n    md: 'rounded h-8',\n    lg: 'rounded-md h-10',\n    xl: 'rounded-md h-10',\n  }[props.size]\n\n  let variant = props.disabled ? 'disabled' : props.variant\n  let variantClasses = {\n    subtle:\n      'border border-[--surface-gray-2] bg-surface-gray-2 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:border-outline-gray-4 focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    outline:\n      'border border-outline-gray-2 bg-surface-white hover:border-outline-gray-3 focus:border-outline-gray-4 focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    ghost:\n      'bg-transparent border-transparent hover:bg-surface-gray-3 focus:bg-surface-gray-3 focus:border-outline-gray-4 focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    disabled: [\n      'border',\n      props.variant !== 'ghost' ? 'bg-surface-gray-1' : '',\n      props.variant === 'outline'\n        ? 'border-outline-gray-2'\n        : 'border-transparent',\n    ],\n  }[variant]\n\n  return [\n    sizeClasses,\n    fontSizeClasses.value,\n    paddingClasses.value,\n    variantClasses,\n    textColor.value,\n    'transition-colors w-full py-0 truncate',\n  ]\n})\n\nlet prefixClasses = computed(() => {\n  return {\n    sm: 'pl-2',\n    md: 'pl-2.5',\n    lg: 'pl-3',\n    xl: 'pl-3',\n  }[props.size]\n})\n</script>\n","<template>\n  <div class=\"space-y-1.5\">\n    <label class=\"block\" :class=\"labelClasses\" v-if=\"label\" :for=\"id\">\n      {{ label }}\n    </label>\n    <textarea\n      ref=\"textareaRef\"\n      :placeholder=\"placeholder\"\n      :class=\"inputClasses\"\n      :disabled=\"disabled\"\n      :id=\"id\"\n      :value=\"modelValue\"\n      :rows=\"rows\"\n      @input=\"handleChange\"\n      @change=\"handleChange\"\n      v-bind=\"attrs\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, useAttrs, ref } from 'vue'\nimport debounce from '../../utils/debounce'\nimport type { TextareaProps } from './types'\n\nconst props = withDefaults(defineProps<TextareaProps>(), {\n  type: 'text',\n  size: 'sm',\n  variant: 'subtle',\n  rows: 3,\n})\n\nconst emit = defineEmits(['update:modelValue'])\nconst attrs = useAttrs()\nconst textareaRef = ref<HTMLTextAreaElement | null>(null)\n\nconst inputClasses = computed(() => {\n  let sizeClasses = {\n    sm: 'text-base rounded',\n    md: 'text-base rounded',\n    lg: 'text-lg rounded-md',\n    xl: 'text-xl rounded-md',\n  }[props.size]\n\n  let paddingClasses = {\n    sm: ['py-1.5 px-2'],\n    md: ['py-1.5 px-2.5'],\n    lg: ['py-1.5 px-3'],\n    xl: ['py-1.5 px-3'],\n  }[props.size]\n\n  let variant = props.disabled ? 'disabled' : props.variant\n  let variantClasses = {\n    subtle:\n      'border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    outline:\n      'border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3',\n    disabled: [\n      'border bg-surface-gray-1 placeholder-ink-gray-3',\n      props.variant === 'outline'\n        ? 'border-outline-gray-2'\n        : 'border-transparent',\n    ],\n  }[variant]\n\n  return [\n    sizeClasses,\n    paddingClasses,\n    variantClasses,\n    props.disabled ? 'text-ink-gray-5' : 'text-ink-gray-8',\n    'transition-colors w-full block',\n  ]\n})\n\nconst labelClasses = computed(() => {\n  return [\n    {\n      sm: 'text-xs',\n      md: 'text-base',\n      lg: 'text-lg',\n      xl: 'text-xl',\n    }[props.size],\n    'text-ink-gray-5',\n  ]\n})\n\nlet emitChange = (value: string) => {\n  emit('update:modelValue', value)\n}\nif (props.debounce) {\n  emitChange = debounce(emitChange, props.debounce)\n}\n\nlet handleChange = (e: Event) => {\n  emitChange((e.target as HTMLInputElement).value)\n}\n\ndefineExpose({ el: textareaRef })\n</script>\n","<template>\n  <label class=\"block\" :class=\"labelClasses\" :for=\"id\">\n    {{ label }}\n    <template v-if=\"required\">\n      <span class=\"text-ink-red-3 select-none\" aria-hidden=\"true\">*</span>\n      <span class=\"sr-only\">(required)</span>\n    </template>\n  </label>\n</template>\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\ninterface FormLabelProps {\n  label: string\n  size?: 'sm' | 'md'\n  id?: string\n  required?: boolean\n}\n\nconst props = withDefaults(defineProps<FormLabelProps>(), {\n  size: 'sm',\n})\n\nconst labelClasses = computed(() => {\n  return [\n    {\n      sm: 'text-xs',\n      md: 'text-base',\n    }[props.size],\n    'text-ink-gray-5',\n  ]\n})\n</script>\n","<template>\n  <div\n    v-if=\"type != 'checkbox'\"\n    :class=\"['space-y-1.5', attrs.class]\"\n    :style=\"attrs.style\"\n  >\n    <FormLabel\n      v-if=\"label\"\n      :label=\"label\"\n      :size=\"size\"\n      :id=\"id\"\n      :required=\"required\"\n    />\n    <Select\n      v-if=\"type === 'select'\"\n      :id=\"id\"\n      v-bind=\"{ ...controlAttrs, size, variant }\"\n    >\n      <template #prefix v-if=\"$slots.prefix\">\n        <slot name=\"prefix\" />\n      </template>\n    </Select>\n    <Autocomplete\n      v-else-if=\"type === 'autocomplete'\"\n      v-bind=\"{ ...controlAttrs }\"\n    >\n      <template #prefix v-if=\"$slots.prefix\">\n        <slot name=\"prefix\" />\n      </template>\n      <template #item-prefix=\"itemPrefixProps\" v-if=\"$slots['item-prefix']\">\n        <slot name=\"item-prefix\" v-bind=\"itemPrefixProps\" />\n      </template>\n    </Autocomplete>\n    <Textarea\n      v-else-if=\"type === 'textarea'\"\n      :id=\"id\"\n      v-bind=\"{ ...controlAttrs, size, variant }\"\n    />\n    <TextInput\n      v-else\n      :id=\"id\"\n      v-bind=\"{ ...controlAttrs, type, size, variant, required }\"\n    >\n      <template #prefix v-if=\"$slots.prefix\">\n        <slot name=\"prefix\" />\n      </template>\n      <template #suffix v-if=\"$slots.suffix\">\n        <slot name=\"suffix\" />\n      </template>\n    </TextInput>\n    <slot name=\"description\">\n      <p v-if=\"description\" :class=\"descriptionClasses\">{{ description }}</p>\n    </slot>\n  </div>\n  <Checkbox\n    v-else\n    :id=\"id\"\n    v-bind=\"{ ...controlAttrs, label, size, class: attrs.class }\"\n  />\n</template>\n<script setup lang=\"ts\">\nimport { useAttrs, computed } from 'vue'\nimport { useId } from '../../utils/useId'\nimport { TextInput } from '../TextInput'\nimport { Select } from '../Select'\nimport { Textarea } from '../Textarea'\nimport { Checkbox } from '../Checkbox'\nimport { Autocomplete } from '../Autocomplete'\nimport FormLabel from '../FormLabel.vue'\nimport type { FormControlProps } from './types'\n\nconst id = useId()\nconst props = withDefaults(defineProps<FormControlProps>(), {\n  type: 'text',\n  size: 'sm',\n  variant: 'subtle',\n})\n\nconst attrs = useAttrs()\nconst controlAttrs = computed(() => {\n  // pass everything except class and style\n  let _attrs: typeof attrs = {}\n  for (let key in attrs) {\n    if (key !== 'class' && key !== 'style') {\n      _attrs[key] = attrs[key]\n    }\n  }\n  return _attrs\n})\n\nconst descriptionClasses = computed(() => {\n  return [\n    {\n      sm: 'text-xs',\n      md: 'text-base',\n    }[props.size],\n    'text-ink-gray-5',\n  ]\n})\n</script>\n<script lang=\"ts\">\nexport default {\n  inheritAttrs: false,\n}\n</script>\n","<template>\n  <label :class=\"[type == 'checkbox' ? 'flex' : 'block', $attrs.class]\" :style=\"$attrs.style\">\n    <span\n      v-if=\"label && type != 'checkbox'\"\n      class=\"mb-2 block text-sm leading-4 text-gray-700\"\n    >\n      {{ label }}\n    </span>\n    <div\n      class=\"relative flex\"\n      :class=\"{ 'items-center': isNormalInput || type == 'select' }\"\n    >\n      <FeatherIcon\n        v-if=\"iconLeft && type != 'checkbox'\"\n        :name=\"iconLeft\"\n        class=\"absolute mx-2 h-4 w-4 text-gray-600\"\n        :class=\"{ 'mt-2': type == 'textarea' }\"\n      />\n      <input\n        v-if=\"isNormalInput\"\n        v-bind=\"inputAttributes\"\n        class=\"border-gray-400 placeholder-gray-500\"\n        ref=\"input\"\n        :class=\"[\n          {\n            'form-input block w-full': type != 'checkbox',\n            'form-checkbox': type == 'checkbox',\n            'pl-8': iconLeft && type != 'checkbox',\n          },\n          inputClass,\n        ]\"\n        :type=\"type || 'text'\"\n        :disabled=\"disabled\"\n        :placeholder=\"placeholder\"\n        :value=\"passedInputValue\"\n      />\n      <textarea\n        v-if=\"type === 'textarea'\"\n        v-bind=\"inputAttributes\"\n        :placeholder=\"placeholder\"\n        class=\"placeholder-gray-500\"\n        :class=\"[\n          'form-textarea block w-full resize-none',\n          inputClass,\n          {\n            'pl-8': iconLeft,\n          },\n        ]\"\n        ref=\"input\"\n        :value=\"passedInputValue\"\n        :disabled=\"disabled\"\n        :rows=\"rows\"\n      ></textarea>\n      <select\n        v-if=\"type === 'select'\"\n        v-bind=\"inputAttributes\"\n        class=\"form-select block w-full\"\n        :class=\"{ 'pl-8': iconLeft }\"\n        ref=\"input\"\n        :disabled=\"disabled\"\n      >\n        <option\n          v-for=\"option in selectOptions\"\n          :key=\"option.value\"\n          :value=\"option.value\"\n          :disabled=\"option.disabled || false\"\n          :selected=\"passedInputValue === option.value\"\n        >\n          {{ option.label }}\n        </option>\n      </select>\n    </div>\n    <span\n      v-if=\"label && type == 'checkbox'\"\n      class=\"ml-2 inline-block text-base leading-4\"\n    >\n      {{ label }}\n    </span>\n  </label>\n</template>\n\n<script>\nimport debounce from '../utils/debounce.ts'\nimport FeatherIcon from './FeatherIcon.vue'\n\nexport default {\n  name: 'Input',\n  inheritAttrs: false,\n  expose: ['getInputValue'],\n  components: { FeatherIcon },\n  props: {\n    label: {\n      type: String,\n    },\n    type: {\n      type: String,\n      default: 'text',\n      validator(value) {\n        let isValid = [\n          'text',\n          'number',\n          'checkbox',\n          'textarea',\n          'select',\n          'email',\n          'password',\n          'date',\n        ].includes(value)\n        if (!isValid) {\n          console.warn(`Invalid value \"${value}\" for \"type\" prop for Input`)\n        }\n        return isValid\n      },\n    },\n    modelValue: {\n      type: [String, Number, Boolean, Object, Array],\n    },\n    inputClass: {\n      type: [String, Array, Object],\n    },\n    debounce: {\n      type: Number,\n    },\n    options: {\n      type: Array,\n    },\n    disabled: {\n      type: Boolean,\n    },\n    rows: {\n      type: Number,\n      default: 3,\n    },\n    placeholder: {\n      type: String,\n    },\n    iconLeft: {\n      type: String,\n    },\n  },\n  emits: ['input', 'change', 'update:modelValue'],\n  methods: {\n    focus() {\n      this.$refs.input.focus()\n    },\n    blur() {\n      this.$refs.input.blur()\n    },\n    getInputValue(e) {\n      let $input = e ? e.target : this.$refs.input\n      let value = $input.value\n      if (this.type == 'checkbox') {\n        value = $input.checked\n      }\n      return value\n    },\n  },\n  computed: {\n    passedInputValue() {\n      if ('value' in this.$attrs) {\n        return this.$attrs.value\n      }\n      return this.modelValue || null\n    },\n    inputAttributes() {\n      let attrs = {}\n      let onInput = (e) => {\n        this.$emit('input', this.getInputValue(e))\n      }\n      if (this.debounce) {\n        onInput = debounce(onInput, this.debounce)\n      }\n      if (this.type == 'checkbox') {\n        attrs.checked = this.passedInputValue\n      }\n      return Object.assign(attrs, this.$attrs, {\n        onInput,\n        onChange: (e) => {\n          this.$emit('change', this.getInputValue(e))\n          this.$emit('update:modelValue', this.getInputValue(e))\n        },\n      })\n    },\n    selectOptions() {\n      return this.options\n        .map((option) => {\n          if (typeof option === 'string') {\n            return {\n              label: option,\n              value: option,\n            }\n          }\n          return option\n        })\n        .filter(Boolean)\n    },\n    isNormalInput() {\n      return [\n        'text',\n        'number',\n        'checkbox',\n        'email',\n        'password',\n        'date',\n      ].includes(this.type)\n    },\n  },\n}\n</script>\n<style>\n.form-select {\n  background-image: url(\"data:image/svg+xml;utf8,<svg fill='none' width='8' xmlns='http://www.w3.org/2000/svg' viewBox='-4 -2 16 16'><path d='M4.5 3.636 6.136 2l1.637 1.636M4.5 8.364 6.136 10l1.637-1.636' stroke='%23333C44' stroke-linecap='round' stroke-linejoin='round'/></svg>\");\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { NodeViewWrapper, nodeViewProps } from '@tiptap/vue-3'\nimport LoadingIndicator from '../../../LoadingIndicator.vue'\nimport { ErrorMessage } from '../../../ErrorMessage'\nimport LucideMoveDiagonal2 from '~icons/lucide/move-diagonal-2'\nimport LucideAlignLeft from '~icons/lucide/align-left'\nimport LucideAlignCenter from '~icons/lucide/align-center'\nimport LucideAlignRight from '~icons/lucide/align-right'\n\nconst props = defineProps(nodeViewProps)\n\nconst imageRef = ref<HTMLImageElement | null>(null)\nconst containerRef = ref<HTMLDivElement | null>(null)\nconst isResizing = ref(false)\nconst startDragX = ref(0)\nconst startWidth = ref(0)\nconst originalAspectRatio = ref(1)\n\nfunction selectImage() {\n  props.editor.commands.setNodeSelection(props.getPos())\n}\n\nconst caption = ref(props.node.attrs.alt || '')\nconst isEditable = ref(false)\n\nonMounted(() => {\n  isEditable.value = props.editor.isEditable\n  if (imageRef.value) {\n    // Ensure initial aspect ratio is captured if dimensions are available\n    const initialWidth = props.node.attrs.width || imageRef.value.naturalWidth\n    const initialHeight =\n      props.node.attrs.height || imageRef.value.naturalHeight\n    if (initialWidth && initialHeight) {\n      originalAspectRatio.value = initialHeight / initialWidth\n    }\n  }\n})\n\nprops.editor.on('update', () => {\n  isEditable.value = props.editor.isEditable\n})\n\nfunction updateCaption(event: Event) {\n  const newCaption = (event.target as HTMLInputElement).value\n  caption.value = newCaption\n  props.updateAttributes({ alt: newCaption })\n}\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter') {\n    event.preventDefault()\n    createParagraphAfterImage()\n  } else if (event.key === 'Escape' || event.key === 'ArrowDown') {\n    event.preventDefault()\n    setCursorAfterImage()\n  }\n  if (event.key === 'ArrowUp') {\n    event.preventDefault()\n    setCursorBeforeImage()\n  }\n}\n\nfunction setCursorAt(pos: number) {\n  props.editor.commands.focus()\n  props.editor.chain().setTextSelection(pos).scrollIntoView().run()\n}\n\nfunction createParagraphAfterImage() {\n  const pos = props.getPos()\n  props.editor.commands.focus()\n  props.editor\n    .chain()\n    .setTextSelection(pos + 1)\n    .createParagraphNear()\n    .scrollIntoView()\n    .run()\n}\n\nfunction setCursorAfterImage() {\n  const pos = props.getPos()\n  setCursorAt(pos + 1)\n}\n\nfunction setCursorBeforeImage() {\n  const pos = props.getPos()\n  setCursorAt(pos - 1)\n}\n\nfunction startResize(event: MouseEvent) {\n  if (!isEditable.value) return\n  selectImage()\n  isResizing.value = true\n  startDragX.value = event.clientX\n  startWidth.value = imageRef.value?.offsetWidth || props.node.attrs.width || 0\n\n  // Calculate aspect ratio from current attributes or natural dimensions\n  const width = props.node.attrs.width || imageRef.value?.naturalWidth\n  const height = props.node.attrs.height || imageRef.value?.naturalHeight\n  if (width && height) {\n    originalAspectRatio.value = height / width\n  } else {\n    originalAspectRatio.value = 1\n  }\n\n  window.addEventListener('mousemove', handleResize)\n  window.addEventListener('mouseup', stopResize)\n  document.body.style.cursor = 'ew-resize'\n}\n\nfunction handleResize(event: MouseEvent) {\n  if (!isResizing.value || !imageRef.value || !containerRef.value) return\n\n  const editorElement = props.editor.view.dom\n  const editorWidth = editorElement.clientWidth\n\n  const deltaX = event.clientX - startDragX.value\n  let newWidth = startWidth.value + deltaX\n\n  // Add constraints (e.g., minimum width and maximum width based on editor)\n  newWidth = Math.max(50, Math.min(newWidth, editorWidth))\n\n  const newHeight = newWidth * originalAspectRatio.value\n\n  // Apply temporary styles for visual feedback\n  imageRef.value.style.width = `${newWidth}px`\n  imageRef.value.style.height = `${newHeight}px`\n  containerRef.value.style.width = `${newWidth}px`\n}\n\nfunction stopResize() {\n  if (!isResizing.value) return\n\n  isResizing.value = false\n  window.removeEventListener('mousemove', handleResize)\n  window.removeEventListener('mouseup', stopResize)\n  document.body.style.cursor = ''\n\n  if (imageRef.value && containerRef.value) {\n    const finalWidth = imageRef.value.offsetWidth\n    const finalHeight = imageRef.value.offsetHeight\n    props.updateAttributes({ width: finalWidth, height: finalHeight })\n\n    // Clear temporary styles after updating attributes\n    imageRef.value.style.width = ''\n    imageRef.value.style.height = ''\n    containerRef.value.style.width = ''\n  }\n}\n\nfunction setAlignment(align: 'left' | 'center' | 'right') {\n  props.editor.commands.setImageAlign(align)\n}\n</script>\n\n<template>\n  <NodeViewWrapper>\n    <div\n      ref=\"containerRef\"\n      class=\"relative overflow-hidden not-prose my-6 rounded-[2px] block max-w-full\"\n      :class=\"[\n        { 'ring-2 ring-outline-gray-3 ring-offset-2': selected },\n        node.attrs.align === 'center' ? 'mx-auto' : '',\n        node.attrs.align === 'right' ? 'ml-auto mr-0' : '',\n        node.attrs.align === 'left' ? 'mr-auto ml-0' : '',\n      ]\"\n      :style=\"{ width: node.attrs.width ? `${node.attrs.width}px` : 'auto' }\"\n    >\n      <div class=\"relative\">\n        <img\n          v-if=\"node.attrs.src\"\n          ref=\"imageRef\"\n          class=\"rounded-[2px]\"\n          :src=\"node.attrs.src\"\n          :alt=\"node.attrs.alt || ''\"\n          :width=\"node.attrs.width\"\n          :height=\"node.attrs.height\"\n          @click.stop=\"selectImage\"\n        />\n\n        <div class=\"absolute bottom-2 right-2 flex items-center gap-2\">\n          <!-- Alignment Controls -->\n          <div\n            v-if=\"selected && isEditable\"\n            class=\"flex divide-x divide-outline-gray-5 rounded bg-black/65\"\n          >\n            <button\n              @click.stop=\"setAlignment('left')\"\n              :class=\"[\n                'px-1.5 py-1 hover:text-ink-white',\n                node.attrs.align === 'left'\n                  ? 'text-ink-white'\n                  : 'text-ink-gray-4',\n              ]\"\n            >\n              <LucideAlignLeft class=\"size-4\" />\n            </button>\n            <button\n              @click.stop=\"setAlignment('center')\"\n              :class=\"[\n                'px-1.5 py-1 hover:text-ink-white',\n                node.attrs.align === 'center'\n                  ? 'text-ink-white'\n                  : 'text-ink-gray-4',\n              ]\"\n            >\n              <LucideAlignCenter class=\"size-4\" />\n            </button>\n            <button\n              @click.stop=\"setAlignment('right')\"\n              :class=\"[\n                'px-1.5 py-1 hover:text-ink-white',\n                node.attrs.align === 'right'\n                  ? 'text-ink-white'\n                  : 'text-ink-gray-4',\n              ]\"\n            >\n              <LucideAlignRight class=\"size-4\" />\n            </button>\n          </div>\n\n          <!-- Resize Handle -->\n          <button\n            v-if=\"selected && isEditable\"\n            class=\"cursor-nw-resize bg-black/65 rounded p-1\"\n            @mousedown.prevent=\"startResize\"\n          >\n            <LucideMoveDiagonal2 class=\"text-white size-4\" />\n          </button>\n        </div>\n\n        <!-- Loading indicator overlay -->\n        <div\n          v-if=\"node.attrs.loading\"\n          class=\"inset-0 absolute flex items-center justify-center z-10\"\n        >\n          <div\n            class=\"bg-gray-900/80 p-2 inset-0 leading-none rounded-sm flex flex-col items-center justify-center gap-2\"\n          >\n            <div class=\"flex items-center gap-2\">\n              <LoadingIndicator class=\"text-gray-100 size-4\" />\n              <span class=\"text-gray-100\">Uploading...</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <input\n        v-if=\"(isEditable || node.attrs.alt) && !node.attrs.error\"\n        v-model=\"caption\"\n        class=\"w-full text-center bg-transparent text-sm text-ink-gray-6 h-7 border-none focus:ring-0 placeholder-ink-gray-4\"\n        placeholder=\"Add caption\"\n        :disabled=\"!isEditable\"\n        @change=\"updateCaption\"\n        @keydown=\"handleKeydown\"\n      />\n\n      <div v-if=\"node.attrs.error\" class=\"w-full py-1.5\">\n        <ErrorMessage :message=\"`Upload Failed: ${node.attrs.error}`\" />\n      </div>\n    </div>\n  </NodeViewWrapper>\n</template>\n","import {\n  Node as NodeExtension,\n  nodeInputRule,\n  mergeAttributes,\n} from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-3'\nimport ImageNodeView from './ImageNodeView.vue'\nimport { Plugin, Selection, Transaction, EditorState } from '@tiptap/pm/state'\nimport { EditorView } from '@tiptap/pm/view'\nimport { Node } from '@tiptap/pm/model'\nimport { fileToBase64 } from '../../../../index'\nimport { UploadedFile } from '../../../../utils/useFileUpload'\n\nexport interface ImageExtensionOptions {\n  /**\n   * Function to handle image uploads\n   * @default null\n   */\n  uploadFunction: ((file: File) => Promise<UploadedFile>) | null\n\n  /**\n   * HTML attributes to add to the image element\n   * @default {}\n   */\n  HTMLAttributes: Record<string, any>\n}\n\nexport interface SetImageOptions {\n  src: string\n  alt?: string\n  title?: string\n  width?: string | number | null\n  height?: string | number | null\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    image: {\n      /**\n       * Insert an image\n       */\n      setImage: (options: SetImageOptions) => ReturnType\n\n      /**\n       * Upload and insert an image\n       */\n      uploadImage: (file: File) => ReturnType\n\n      /**\n       * Select an image file using the file picker and upload it\n       */\n      selectAndUploadImage: () => ReturnType\n\n      /**\n       * Set image alignment\n       */\n      setImageAlign: (align: 'left' | 'center' | 'right') => ReturnType\n    }\n  }\n}\n\n/**\n * Matches markdown image syntax: ![alt](src \"title\")\n */\nconst inputRegex = /(?:^|\\s)(!\\[(.+|:?)]\\((\\S+)(?:(?:\\s+)[\"'](\\S+)[\"'])?\\))$/\n\nexport const ImageExtension = NodeExtension.create<ImageExtensionOptions>({\n  name: 'image',\n\n  group: 'block',\n  draggable: true,\n  selectable: true,\n\n  addAttributes() {\n    return {\n      src: { default: null },\n      alt: { default: null },\n      title: { default: null },\n      width: { default: null },\n      height: { default: null },\n      loading: {\n        default: false,\n        parseHTML: () => false,\n      },\n      align: {\n        default: 'left',\n        parseHTML: (element) => {\n          const align = (\n            element.getAttribute('data-align') ||\n            element.getAttribute('align') ||\n            'left'\n          ).toLowerCase()\n\n          if (['left', 'center', 'right'].includes(align)) {\n            return align as 'left' | 'center' | 'right'\n          }\n          return 'left'\n        },\n        renderHTML: (attributes) => {\n          return {\n            'data-align': attributes.align || 'left',\n          }\n        },\n      },\n      uploadId: {\n        default: null,\n        parseHTML: () => null,\n      },\n      error: {\n        default: null,\n        parseHTML: () => null,\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'img[src]',\n        getAttrs: (node) => {\n          if (typeof node === 'string') return {}\n          const element = node as HTMLElement\n          return {\n            src: element.getAttribute('src'),\n            alt: element.getAttribute('alt'),\n            title: element.getAttribute('title'),\n            width: element.getAttribute('width'),\n            height: element.getAttribute('height'),\n          }\n        },\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      'img',\n      mergeAttributes(this.options.HTMLAttributes || {}, HTMLAttributes),\n    ]\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(ImageNodeView)\n  },\n\n  addOptions() {\n    return {\n      uploadFunction: null,\n      HTMLAttributes: {},\n    }\n  },\n\n  addCommands() {\n    return {\n      setImageAlign:\n        (align: 'left' | 'center' | 'right') =>\n        ({ commands }) => {\n          return commands.updateAttributes(this.name, { align })\n        },\n\n      setImage:\n        (attributes: SetImageOptions) =>\n        ({ commands, editor }) => {\n          const result = commands.insertContent({\n            type: this.name,\n            attrs: attributes,\n          })\n\n          if (result && attributes.src) {\n            findImageNodeBySource(editor.view, attributes.src, (node, pos) => {\n              updateNodeWithDimensions(attributes.src, editor.view, pos)\n            })\n          }\n\n          return result\n        },\n\n      uploadImage:\n        (file: File) =>\n        ({ editor }) => {\n          return uploadImage(file, editor.view, null, this.options)\n        },\n\n      selectAndUploadImage:\n        () =>\n        ({ editor }) => {\n          const input = document.createElement('input')\n          input.type = 'file'\n          input.accept = 'image/*'\n          input.onchange = (event) => {\n            const target = event.target as HTMLInputElement\n            if (target.files && target.files.length) {\n              const file = target.files[0]\n              editor.commands.uploadImage(file)\n            }\n          }\n          input.click()\n          return true\n        },\n    }\n  },\n\n  addInputRules() {\n    return [\n      nodeInputRule({\n        find: inputRegex,\n        type: this.type,\n        getAttributes: (match) => {\n          const [, , alt, src, title] = match\n          return { src, alt, title }\n        },\n      }),\n    ]\n  },\n\n  addProseMirrorPlugins() {\n    const extensionThis = this\n\n    return [\n      new Plugin({\n        props: {\n          handleDOMEvents: {\n            drop: (view, event) => {\n              const hasFiles = event.dataTransfer?.files?.length\n\n              if (!hasFiles || !extensionThis.options.uploadFunction) {\n                return false\n              }\n\n              const images = Array.from(event.dataTransfer.files).filter(\n                (file) => /image/i.test(file.type),\n              )\n\n              if (images.length === 0) {\n                return false\n              }\n\n              event.preventDefault()\n\n              const coordinates = view.posAtCoords({\n                left: event.clientX,\n                top: event.clientY,\n              })\n\n              let pos: number | null = null\n              if (coordinates) {\n                pos = coordinates.pos\n                const transaction = view.state.tr.setSelection(\n                  Selection.near(view.state.doc.resolve(pos)),\n                )\n                view.dispatch(transaction)\n              }\n\n              processMultipleImages(images, view, pos, extensionThis.options)\n              return true\n            },\n\n            handlePaste: (view, event) => {\n              if (!extensionThis.options.uploadFunction) {\n                return false\n              }\n\n              const clipboardItems = event.clipboardData?.items\n              if (!clipboardItems || clipboardItems.length === 0) {\n                return false\n              }\n\n              const images: File[] = []\n\n              for (let i = 0; i < clipboardItems.length; i++) {\n                const item = clipboardItems[i]\n                if (\n                  item.kind === 'file' &&\n                  item.type.indexOf('image/') !== -1\n                ) {\n                  const file = item.getAsFile()\n                  if (file) {\n                    images.push(file)\n                  }\n                }\n              }\n\n              if (images.length === 0) {\n                return false\n              }\n\n              event.preventDefault()\n              processMultipleImages(images, view, null, extensionThis.options)\n              return true\n            },\n          },\n        },\n\n        appendTransaction(\n          transactions: readonly Transaction[],\n          oldState: EditorState,\n          newState: EditorState,\n        ): Transaction | null {\n          const newImageNodes: { node: Node; pos: number }[] = []\n\n          if (transactions.some((tr) => tr.docChanged)) {\n            newState.doc.descendants((node, pos) => {\n              if (\n                node.type.name === 'image' &&\n                node.attrs.src &&\n                (!node.attrs.width || !node.attrs.height) &&\n                !node.attrs.loading\n              ) {\n                newImageNodes.push({ node, pos })\n              }\n            })\n          }\n\n          if (newImageNodes.length === 0) return null\n\n          newImageNodes.forEach(({ node, pos }) => {\n            const editor = extensionThis.editor\n            if (editor) {\n              updateNodeWithDimensions(node.attrs.src, editor.view, pos)\n            }\n          })\n\n          return null\n        },\n      }),\n    ]\n  },\n})\n\nfunction findInsertPosition(\n  view: EditorView,\n  lastNodeId: string | null,\n): number | null {\n  if (!lastNodeId) {\n    return null\n  }\n\n  let insertPos = null\n\n  view.state.doc.descendants((node, pos) => {\n    if (node.type.name === 'image' && node.attrs.uploadId === lastNodeId) {\n      insertPos = pos + node.nodeSize\n      return false\n    }\n  })\n\n  return insertPos\n}\n\n// Base upload function shared by all image upload methods\nfunction uploadImageBase(\n  file: File,\n  view: EditorView,\n  pos: number | null | undefined,\n  options: Record<string, any>,\n  insertMode: 'insert' | 'replace',\n  onComplete?: (nodeId: string) => void,\n  moveCursor = false,\n): boolean {\n  if (!options.uploadFunction) {\n    console.error('uploadFunction option is not provided')\n    return false\n  }\n\n  const uploadId = `upload-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`\n\n  fileToBase64(file)\n    .then((base64Result: string) => {\n      const node = view.state.schema.nodes.image.create({\n        loading: true,\n        uploadId,\n        src: base64Result,\n      })\n\n      const tr = view.state.tr\n\n      if (pos != null) {\n        tr.insert(pos, node)\n      } else if (insertMode === 'replace') {\n        tr.replaceSelectionWith(node)\n      } else {\n        const insertPos = view.state.selection.from\n        tr.insert(insertPos, node)\n      }\n\n      view.dispatch(tr)\n\n      // Optionally move cursor after the node\n      if (moveCursor) {\n        const nodeSize = node.nodeSize || 1\n        setTimeout(() => {\n          try {\n            let nodePos = null\n            view.state.doc.descendants((n, p) => {\n              if (n.type.name === 'image' && n.attrs.uploadId === uploadId) {\n                nodePos = p\n                return false\n              }\n            })\n\n            if (nodePos !== null) {\n              const posAfter = nodePos + nodeSize\n              const transaction = view.state.tr.setSelection(\n                Selection.near(view.state.doc.resolve(posAfter)),\n              )\n              view.dispatch(transaction)\n            }\n          } catch (e) {\n            console.error('Error moving cursor:', e)\n          }\n        }, 10)\n      }\n\n      return options.uploadFunction(file)\n    })\n    .then((uploadedImage: UploadedFile) => {\n      return getImageDimensions(uploadedImage.file_url)\n        .then((dimensions) => {\n          return {\n            ...uploadedImage,\n            width: dimensions.width,\n            height: dimensions.height,\n          } as UploadedFile & { width: number; height: number }\n        })\n        .catch(() => {\n          return uploadedImage as UploadedFile & {\n            width: number\n            height: number\n          }\n        })\n    })\n    .then((uploadedImage) => {\n      const transaction = view.state.tr\n\n      view.state.doc.descendants((node, pos) => {\n        if (node.type.name === 'image' && node.attrs.uploadId === uploadId) {\n          transaction.setNodeMarkup(pos, undefined, {\n            ...node.attrs,\n            src: uploadedImage.file_url,\n            width: uploadedImage.width || node.attrs.width,\n            height: uploadedImage.height || node.attrs.height,\n            loading: false,\n          })\n          return false\n        }\n      })\n\n      view.dispatch(transaction)\n\n      if (onComplete) onComplete(uploadId)\n    })\n    .catch((error: Error) => {\n      console.error('Image upload failed:', error)\n\n      try {\n        const transaction = view.state.tr\n\n        view.state.doc.descendants((node, pos) => {\n          if (node.type.name === 'image' && node.attrs.uploadId === uploadId) {\n            transaction.setNodeMarkup(pos, undefined, {\n              ...node.attrs,\n              loading: false,\n              error: error.message || 'Failed to upload image',\n            })\n            return false\n          }\n        })\n\n        view.dispatch(transaction)\n      } catch (e) {\n        console.error('Error updating failed node:', e)\n      }\n\n      if (onComplete) onComplete(uploadId)\n    })\n\n  return true\n}\n\nfunction uploadImageWithTracking(\n  file: File,\n  view: EditorView,\n  pos: number | null | undefined,\n  options: Record<string, any>,\n  onComplete?: (nodeId: string) => void,\n): boolean {\n  return uploadImageBase(file, view, pos, options, 'insert', onComplete, true)\n}\n\nfunction uploadImage(\n  file: File,\n  view: EditorView,\n  pos: number | null | undefined,\n  options: Record<string, any>,\n): boolean {\n  return uploadImageBase(file, view, pos, options, 'replace')\n}\n\nfunction findImageNodeBySource(\n  view: EditorView,\n  src: string,\n  callback: (node: Node, pos: number) => void,\n) {\n  view.state.doc.descendants((node, pos) => {\n    if (node.type.name === 'image' && node.attrs.src === src) {\n      callback(node, pos)\n      return false\n    }\n  })\n}\n\nfunction updateNodeWithDimensions(\n  src: string,\n  view: EditorView,\n  pos: number,\n): void {\n  getImageDimensions(src)\n    .then((dimensions) => {\n      const node = view.state.doc.nodeAt(pos)\n      if (!node || node.type.name !== 'image') {\n        return\n      }\n      const currentAttrs = node.attrs\n\n      if (currentAttrs.width == null || currentAttrs.height == null) {\n        const transaction = view.state.tr.setNodeMarkup(pos, undefined, {\n          ...currentAttrs,\n          width: currentAttrs.width ?? dimensions.width,\n          height: currentAttrs.height ?? dimensions.height,\n        })\n        view.dispatch(transaction)\n      }\n    })\n    .catch((error) => {\n      // Don't log error if it's just about dimensions for an existing node\n    })\n}\n\nfunction getImageDimensions(\n  src: string,\n): Promise<{ width: number; height: number }> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () =>\n      resolve({\n        width: img.naturalWidth,\n        height: img.naturalHeight,\n      })\n    img.onerror = reject\n    img.src = src\n  })\n}\n\n/**\n * Process multiple image uploads sequentially\n */\nexport function processMultipleImages(\n  images: File[],\n  view: EditorView,\n  pos: number | null,\n  options: Record<string, any>,\n) {\n  if (images.length === 1) {\n    uploadImage(images[0], view, pos, options)\n    return\n  }\n\n  let imageQueue = [...images]\n  let lastInsertedNodeId: string | null = null\n\n  const processNextImage = () => {\n    if (imageQueue.length === 0) return\n\n    const file = imageQueue.shift()\n    if (!file) return\n\n    const currentPos = lastInsertedNodeId\n      ? findInsertPosition(view, lastInsertedNodeId)\n      : pos\n\n    uploadImageWithTracking(file, view, currentPos, options, (newNodeId) => {\n      lastInsertedNodeId = newNodeId\n      setTimeout(processNextImage, 100)\n    })\n  }\n\n  processNextImage()\n}\n","import { ref, watch, type Ref, readonly } from 'vue'\n\ninterface UseTouchHandlerOptions {\n  targetRef: Ref<HTMLElement | null | undefined>\n  zoomLevel?: Ref<number>\n  onSwipeLeft?: () => void\n  onSwipeRight?: () => void\n  onDoubleTap?: (event: TouchEvent) => void\n  onTap?: (event: TouchEvent) => void\n  onPanStart?: (event: TouchEvent) => void\n  onPanMove?: (deltaX: number, deltaY: number, event: TouchEvent) => void\n  onPanAnimate?: (x: number, y: number) => void // Callback for inertia animation frame updates\n  onPanEnd?: (event: TouchEvent) => void\n  onPinchStart?: (event: TouchEvent) => void\n  onPinchMove?: (scale: number, event: TouchEvent) => void\n  onPinchEnd?: (event: TouchEvent) => void\n  doubleTapDelay?: number\n  minSwipeDistance?: number\n  maxVerticalSwipeDistance?: number\n  maxTapDuration?: number\n  maxTapMovement?: number\n  panThreshold?: number\n  inertiaDamping?: number // Damping factor for inertia (e.g., 0.95)\n  inertiaVelocityThreshold?: number // Minimum velocity (pixels/ms) to trigger inertia\n}\n\nexport function useTouchHandler(options: UseTouchHandlerOptions) {\n  const {\n    targetRef,\n    zoomLevel = ref(100),\n    onSwipeLeft,\n    onSwipeRight,\n    onDoubleTap,\n    onTap,\n    onPanStart,\n    onPanMove,\n    onPanAnimate,\n    onPanEnd,\n    onPinchStart,\n    onPinchMove,\n    onPinchEnd,\n    doubleTapDelay = 300,\n    minSwipeDistance = 50,\n    maxVerticalSwipeDistance = 75,\n    maxTapDuration = 200,\n    maxTapMovement = 10,\n    panThreshold = 5, // Pixels moved before pan starts\n    inertiaDamping = 0.94, // Damping for inertia slowdown (higher = slower stop)\n    inertiaVelocityThreshold = 0.5, // Pixels per ms\n  } = options\n\n  const isPanning = ref(false)\n  const isPinching = ref(false)\n  const isAnimatingPan = ref(false) // Track inertia animation state\n  const startPanCoords = ref({ x: 0, y: 0 })\n  const lastTapTime = ref(0)\n  const touchStartTime = ref(0)\n  const touchStartDistance = ref(0)\n  const initialTouchPoints = ref<TouchList | null>(null)\n\n  // Velocity tracking for inertia\n  const lastMoveTime = ref(0)\n  const lastMoveCoords = ref({ x: 0, y: 0 })\n  const panVelocity = ref({ x: 0, y: 0 })\n\n  // Inertia animation frame\n  const animationFrameId = ref<number | null>(null)\n\n  const cancelInertiaAnimation = () => {\n    if (animationFrameId.value !== null) {\n      cancelAnimationFrame(animationFrameId.value)\n      animationFrameId.value = null\n    }\n    isAnimatingPan.value = false\n    panVelocity.value = { x: 0, y: 0 } // Reset velocity\n  }\n\n  const handleTouchStart = (event: TouchEvent) => {\n    cancelInertiaAnimation() // Stop any ongoing inertia animation\n    event.preventDefault() // Prevent default browser actions like scroll/zoom\n\n    isPanning.value = false\n    isPinching.value = false\n    initialTouchPoints.value = event.touches\n\n    const currentTime = performance.now()\n    const timeSinceLastTap = currentTime - lastTapTime.value\n\n    // Double Tap Detection\n    if (\n      timeSinceLastTap < doubleTapDelay &&\n      timeSinceLastTap > 0 &&\n      event.touches.length === 1 &&\n      onDoubleTap\n    ) {\n      onDoubleTap(event)\n      lastTapTime.value = 0 // Reset tap time after double tap\n      touchStartTime.value = 0\n      return // Don't process as single tap/pan/pinch start\n    }\n\n    // Record Start Info\n    touchStartTime.value = currentTime\n    if (event.touches.length === 1) {\n      lastTapTime.value = currentTime // Record for potential double tap\n      const touch = event.touches[0]\n      startPanCoords.value = { x: touch.clientX, y: touch.clientY }\n      // Reset velocity tracking on new touch start\n      lastMoveTime.value = currentTime\n      lastMoveCoords.value = { ...startPanCoords.value }\n      panVelocity.value = { x: 0, y: 0 }\n      if (onPanStart) onPanStart(event)\n    } else if (event.touches.length === 2) {\n      lastTapTime.value = 0 // Reset tap time if starting with pinch\n      const touch1 = event.touches[0]\n      const touch2 = event.touches[1]\n      touchStartDistance.value = Math.hypot(\n        touch2.clientX - touch1.clientX,\n        touch2.clientY - touch1.clientY,\n      )\n      isPinching.value = true\n      if (onPinchStart) onPinchStart(event)\n    } else {\n      // More than 2 touches, reset tap time\n      lastTapTime.value = 0\n      touchStartTime.value = 0\n    }\n  }\n\n  const handleTouchMove = (event: TouchEvent) => {\n    if (!initialTouchPoints.value) return // Should have initial points if touch started correctly\n\n    event.preventDefault() // Prevent scroll/zoom during move\n\n    const currentTime = performance.now()\n    const deltaTime = currentTime - lastMoveTime.value\n\n    // Pinching\n    if (event.touches.length === 2 && initialTouchPoints.value.length === 2) {\n      isPanning.value = false // Stop panning if pinch starts\n      isPinching.value = true\n      const touch1 = event.touches[0]\n      const touch2 = event.touches[1]\n      const currentDistance = Math.hypot(\n        touch2.clientX - touch1.clientX,\n        touch2.clientY - touch1.clientY,\n      )\n\n      if (touchStartDistance.value > 0 && onPinchMove) {\n        const scale = currentDistance / touchStartDistance.value\n        onPinchMove(scale, event)\n      }\n      // Reset velocity if pinching occurs\n      panVelocity.value = { x: 0, y: 0 }\n    }\n    // Panning\n    else if (\n      event.touches.length === 1 &&\n      initialTouchPoints.value.length === 1 &&\n      !isPinching.value // Don't pan if a pinch just ended but finger is still down\n    ) {\n      const currentX = event.touches[0].clientX\n      const currentY = event.touches[0].clientY\n      const rawDeltaX = currentX - lastMoveCoords.value.x\n      const rawDeltaY = currentY - lastMoveCoords.value.y\n\n      // Calculate velocity (pixels per millisecond) for inertia\n      // Ensure deltaTime is not zero to avoid division by zero\n      if (deltaTime > 1) {\n        // Use a small threshold > 0\n        panVelocity.value = {\n          x: rawDeltaX / deltaTime,\n          y: rawDeltaY / deltaTime,\n        }\n      } else {\n        // If deltaTime is too small, retain previous velocity or reset\n        panVelocity.value = { x: 0, y: 0 } // Resetting might be safer\n      }\n\n      // Update last move state\n      lastMoveTime.value = currentTime\n      lastMoveCoords.value = { x: currentX, y: currentY }\n\n      const deltaXFromStart = currentX - startPanCoords.value.x\n      const deltaYFromStart = currentY - startPanCoords.value.y\n\n      // Start panning only if threshold is met AND zoom level allows panning\n      if (\n        !isPanning.value &&\n        zoomLevel.value > 100 &&\n        (Math.abs(deltaXFromStart) > panThreshold ||\n          Math.abs(deltaYFromStart) > panThreshold)\n      ) {\n        isPanning.value = true\n        // Adjust start coords slightly to avoid jump if pan starts mid-movement\n        startPanCoords.value = {\n          x: currentX,\n          y: currentY,\n        }\n      }\n\n      if (isPanning.value && onPanMove) {\n        const zoomFactor = zoomLevel.value / 100\n        // Pass the delta relative to the start of the *current* pan gesture, adjusted for zoom\n        const panDeltaX = deltaXFromStart / zoomFactor\n        const panDeltaY = deltaYFromStart / zoomFactor\n        onPanMove(panDeltaX, panDeltaY, event)\n      }\n    }\n  }\n\n  const handleTouchEnd = (event: TouchEvent) => {\n    const touchesLeft = event.touches.length\n    const touchEndTime = performance.now()\n    const wasPanning = isPanning.value\n    const wasPinching = isPinching.value\n\n    // Store current velocity before resetting states for potential inertia\n    const finalVelocity = { ...panVelocity.value }\n\n    // Handle Pan End and Inertia\n    if (\n      wasPanning &&\n      initialTouchPoints.value &&\n      touchesLeft < initialTouchPoints.value.length\n    ) {\n      isPanning.value = false // Set panning to false *before* starting animation\n      if (onPanEnd) onPanEnd(event)\n\n      // Check velocity threshold and start inertia animation if needed\n      const velocityMagnitude = Math.hypot(finalVelocity.x, finalVelocity.y)\n      if (\n        velocityMagnitude > inertiaVelocityThreshold &&\n        onPanAnimate &&\n        zoomLevel.value > 100 // Only animate if zoomed in\n      ) {\n        isAnimatingPan.value = true\n        let lastFrameTime = performance.now()\n        // Use a copy of the velocity for the animation loop\n        let animVelocity = { ...finalVelocity }\n\n        const animate = (currentTime: number) => {\n          // Ensure animation wasn't cancelled elsewhere (e.g., new touch start)\n          if (!isAnimatingPan.value) return\n\n          const frameDeltaTime = Math.max(1, currentTime - lastFrameTime) // Prevent zero/negative delta\n          lastFrameTime = currentTime\n\n          const zoomFactor = zoomLevel.value / 100\n          const moveX = (animVelocity.x * frameDeltaTime) / zoomFactor\n          const moveY = (animVelocity.y * frameDeltaTime) / zoomFactor\n\n          // Call component's pan update function for each frame\n          onPanAnimate(moveX, moveY)\n\n          // Apply damping (adjust based on frame time for consistency)\n          const dampingFactor = Math.pow(\n            Math.min(0.999, inertiaDamping), // Ensure base is < 1\n            frameDeltaTime / 16.67, // Normalize damping based on ~60fps\n          )\n          animVelocity.x *= dampingFactor\n          animVelocity.y *= dampingFactor\n\n          // Stop animation if velocity is negligible or zoom changed back to <= 100%\n          if (\n            Math.hypot(animVelocity.x, animVelocity.y) < 0.01 ||\n            zoomLevel.value <= 100\n          ) {\n            cancelInertiaAnimation()\n          } else {\n            animationFrameId.value = requestAnimationFrame(animate)\n          }\n        }\n        animationFrameId.value = requestAnimationFrame(animate)\n      } else {\n        panVelocity.value = { x: 0, y: 0 } // Reset velocity if no animation starts\n      }\n    } else if (!wasPanning) {\n      // Reset velocity if touch ended without panning (e.g., tap, pinch)\n      panVelocity.value = { x: 0, y: 0 }\n    }\n\n    // Handle Pinch End\n    if (wasPinching && touchesLeft < 2) {\n      isPinching.value = false\n      touchStartDistance.value = 0 // Reset pinch distance tracking\n      if (onPinchEnd) onPinchEnd(event)\n    }\n\n    // Gesture detection (Tap/Swipe) only when the *last* finger is lifted\n    if (\n      touchesLeft === 0 &&\n      event.changedTouches.length === 1 && // Ensure it's the end of a single touch sequence\n      touchStartTime.value > 0 && // Ensure there was a valid start time recorded\n      initialTouchPoints.value?.length === 1 // Ensure it started as a single touch\n    ) {\n      const endCoords = event.changedTouches[0]\n      const deltaX = endCoords.clientX - startPanCoords.value.x\n      const deltaY = endCoords.clientY - startPanCoords.value.y\n      const duration = touchEndTime - touchStartTime.value\n\n      // Swipe Detection (only if not panning AND zoom is appropriate for swipe)\n      if (\n        !wasPanning && // Only detect swipe if not panning\n        zoomLevel.value <= 100 && // Swipes only make sense at base zoom\n        Math.abs(deltaX) > minSwipeDistance &&\n        Math.abs(deltaY) < maxVerticalSwipeDistance // Allow some vertical movement\n      ) {\n        if (deltaX < 0 && onSwipeLeft) {\n          onSwipeLeft()\n        } else if (deltaX > 0 && onSwipeRight) {\n          onSwipeRight()\n        }\n      }\n      // Tap Detection (if not panning, not swiping, and within time/movement limits)\n      else if (\n        !wasPanning &&\n        duration < maxTapDuration &&\n        Math.abs(deltaX) < maxTapMovement &&\n        Math.abs(deltaY) < maxTapMovement &&\n        onTap\n      ) {\n        onTap(event)\n      }\n    }\n\n    // Reset start time and coords only when all touches are up\n    if (touchesLeft === 0) {\n      touchStartTime.value = 0\n      startPanCoords.value = { x: 0, y: 0 }\n      initialTouchPoints.value = null\n      // Don't reset isPanning here if inertia animation might start\n      isPinching.value = false\n      // Reset velocity only if not animating\n      if (!isAnimatingPan.value) {\n        panVelocity.value = { x: 0, y: 0 }\n      }\n    }\n    // If some touches remain (e.g., pinch ended, one finger remains),\n    // update start coords for potential pan with the remaining finger.\n    else if (touchesLeft === 1 && !isPanning.value && !isPinching.value) {\n      startPanCoords.value = {\n        x: event.touches[0].clientX,\n        y: event.touches[0].clientY,\n      }\n      touchStartTime.value = performance.now() // Reset start time for the remaining finger\n      initialTouchPoints.value = event.touches // Update initial touches to the single remaining one\n    }\n  }\n\n  watch(\n    targetRef,\n    (newTarget, oldTarget) => {\n      if (oldTarget) {\n        oldTarget.removeEventListener('touchstart', handleTouchStart)\n        oldTarget.removeEventListener('touchmove', handleTouchMove)\n        oldTarget.removeEventListener('touchend', handleTouchEnd)\n        oldTarget.removeEventListener('touchcancel', handleTouchEnd) // Treat cancel like end\n        cancelInertiaAnimation() // Clean up animation on unmount/target change\n      }\n      if (newTarget) {\n        // Use passive: false for start/move to allow preventDefault()\n        newTarget.addEventListener('touchstart', handleTouchStart, {\n          passive: false,\n        })\n        newTarget.addEventListener('touchmove', handleTouchMove, {\n          passive: false,\n        })\n        // Use passive: true for end/cancel as we don't preventDefault there\n        newTarget.addEventListener('touchend', handleTouchEnd, {\n          passive: true,\n        })\n        newTarget.addEventListener('touchcancel', handleTouchEnd, {\n          passive: true,\n        })\n      }\n    },\n    { immediate: true },\n  )\n\n  return {\n    isPanning: readonly(isPanning),\n    isPinching: readonly(isPinching),\n    isAnimatingPan: readonly(isAnimatingPan), // Expose inertia animation status\n  }\n}\n","import { ref, watch, type Ref } from 'vue'\n\ninterface UseImageNavigationOptions {\n  initialIndex: Ref<number>\n  imageCount: Ref<number>\n  onNavigate?: () => void\n}\n\nexport function useImageNavigation({\n  initialIndex,\n  imageCount,\n  onNavigate,\n}: UseImageNavigationOptions) {\n  const currentIndex = ref(initialIndex.value)\n\n  watch(initialIndex, (newVal) => {\n    currentIndex.value = newVal\n    onNavigate?.()\n  })\n\n  function nextImage() {\n    if (imageCount.value > 0) {\n      currentIndex.value = (currentIndex.value + 1) % imageCount.value\n      onNavigate?.()\n    }\n  }\n\n  function previousImage() {\n    if (imageCount.value > 0) {\n      currentIndex.value =\n        (currentIndex.value - 1 + imageCount.value) % imageCount.value\n      onNavigate?.()\n    }\n  }\n\n  return {\n    currentIndex,\n    nextImage,\n    previousImage,\n  }\n}\n","import { ref, watch, onMounted, onUnmounted, type Ref } from 'vue'\n\ninterface UseZoomPanOptions {\n  containerRef: Ref<HTMLElement | null>\n  isEnabled: Ref<boolean>\n}\n\nexport function useZoomPan({ containerRef, isEnabled }: UseZoomPanOptions) {\n  const zoomLevel = ref(100)\n  const panPosition = ref({ x: 0, y: 0 })\n  const isMousePanning = ref(false)\n  const startMousePanCoords = ref({ x: 0, y: 0 })\n  const initialPanPositionOnGestureStart = ref({ x: 0, y: 0 })\n\n  const snapThresholdLower = 90\n  const snapThresholdUpper = 110\n\n  watch(zoomLevel, (newZoom, oldZoom) => {\n    if (newZoom <= 100 && oldZoom > 100) {\n      panPosition.value = { x: 0, y: 0 }\n    }\n  })\n\n  function zoomIn() {\n    zoomLevel.value = Math.min(zoomLevel.value + 25, 300)\n  }\n\n  function zoomOut() {\n    const newZoom = Math.max(zoomLevel.value - 25, 25)\n    if (zoomLevel.value > 100 && newZoom < 100) {\n      zoomLevel.value = 100\n    } else {\n      zoomLevel.value = newZoom\n    }\n  }\n\n  function resetZoom() {\n    zoomLevel.value = 100\n    panPosition.value = { x: 0, y: 0 }\n    isMousePanning.value = false\n    initialPanPositionOnGestureStart.value = { x: 0, y: 0 }\n  }\n\n  function handlePanStart(event: MouseEvent) {\n    if (zoomLevel.value <= 100) return\n    event.preventDefault()\n    isMousePanning.value = true\n    startMousePanCoords.value = { x: event.clientX, y: event.clientY }\n    initialPanPositionOnGestureStart.value = { ...panPosition.value }\n\n    const handlePanMove = (moveEvent: MouseEvent) => {\n      if (!isMousePanning.value) return\n      const deltaX = moveEvent.clientX - startMousePanCoords.value.x\n      const deltaY = moveEvent.clientY - startMousePanCoords.value.y\n      const zoomFactor = zoomLevel.value / 100\n\n      panPosition.value = {\n        x: initialPanPositionOnGestureStart.value.x + deltaX / zoomFactor,\n        y: initialPanPositionOnGestureStart.value.y + deltaY / zoomFactor,\n      }\n    }\n\n    const handlePanEnd = () => {\n      if (isMousePanning.value) {\n        isMousePanning.value = false\n        document.removeEventListener('mousemove', handlePanMove)\n        document.removeEventListener('mouseup', handlePanEnd)\n      }\n    }\n\n    document.addEventListener('mousemove', handlePanMove)\n    document.addEventListener('mouseup', handlePanEnd)\n  }\n\n  function handleWheel(event: WheelEvent) {\n    if (!isEnabled.value) return\n\n    if (containerRef.value?.contains(event.target as Node)) {\n      event.preventDefault()\n\n      let dampingFactor = event.ctrlKey ? 0.5 : 0.2\n\n      const zoomChange = -event.deltaY * dampingFactor\n      const currentZoom = zoomLevel.value\n      const newZoom = Math.round(currentZoom + zoomChange)\n      let clampedZoom = Math.max(25, Math.min(300, newZoom))\n\n      if (\n        (currentZoom > 100 && clampedZoom < 100) ||\n        (currentZoom < 100 && clampedZoom > 100)\n      ) {\n        if (Math.abs(100 - clampedZoom) < Math.abs(zoomChange) * 1.5) {\n          clampedZoom = 100\n        }\n      }\n\n      zoomLevel.value = clampedZoom\n    }\n  }\n\n  onMounted(() => {\n    const container = containerRef.value\n    if (container) {\n      container.addEventListener('wheel', handleWheel, {\n        passive: false,\n        capture: true,\n      })\n    }\n  })\n\n  onUnmounted(() => {\n    const container = containerRef.value\n    if (container) {\n      container.removeEventListener('wheel', handleWheel, { capture: true })\n    }\n    if (isMousePanning.value) {\n      isMousePanning.value = false\n    }\n  })\n\n  return {\n    zoomLevel,\n    panPosition,\n    isMousePanning,\n    initialPanPositionOnGestureStart,\n    zoomIn,\n    zoomOut,\n    resetZoom,\n    handlePanStart,\n    snapThresholdLower,\n    snapThresholdUpper,\n  }\n}\n","<template>\n  <Teleport to=\"body\">\n    <Transition\n      enter-active-class=\"transition-opacity duration-150 ease-in-out\"\n      leave-active-class=\"transition-opacity duration-150 ease-in-out\"\n      enter-from-class=\"opacity-0\"\n      leave-to-class=\"opacity-0\"\n      appear\n    >\n      <div\n        v-if=\"props.show\"\n        class=\"fixed top-0 left-0 w-full h-full bg-black sm:bg-black/90 z-[50] flex flex-col justify-center items-center overflow-hidden touch-none\"\n        ref=\"imageContainer\"\n        @mousemove=\"handleActivity\"\n        @touchstart=\"handleActivity\"\n        @touchmove=\"handleActivity\"\n      >\n        <!-- Dedicated Backdrop -->\n        <div\n          class=\"absolute inset-0 z-0\"\n          ref=\"backdropElement\"\n          @click=\"close\"\n        ></div>\n\n        <!-- Image Container -->\n        <div class=\"relative z-10 flex flex-col items-center\">\n          <img\n            :src=\"currentImage.src\"\n            :alt=\"currentImage.alt || 'Image preview'\"\n            class=\"max-w-screen max-h-screen object-contain block\"\n            :style=\"{\n              transform: `scale(${zoomLevel / 100}) translate(${panPosition.x}px, ${panPosition.y}px)`,\n              cursor:\n                zoomLevel > 100\n                  ? isMousePanning\n                    ? 'grabbing'\n                    : 'grab'\n                  : 'default',\n              transition:\n                isPanning || isPinching || isAnimatingPan\n                  ? 'none'\n                  : 'transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)',\n            }\"\n            @mousedown=\"handlePanStart\"\n            draggable=\"false\"\n          />\n        </div>\n\n        <!-- Caption -->\n        <div\n          v-if=\"currentImage.alt\"\n          class=\"absolute bottom-4 p-2 text-center rounded-sm text-white text-sm bg-black/65 z-10 transition-opacity duration-300 ease-in-out\"\n          :class=\"{ 'opacity-0 pointer-events-none': !isControlsVisible }\"\n        >\n          {{ currentImage.alt }}\n        </div>\n\n        <!-- Controls bar -->\n        <div\n          ref=\"controlsBar\"\n          class=\"absolute top-4 flex items-center space-x-3 p-2 text-white z-20 transition-opacity duration-300 ease-in-out\"\n          :class=\"{ 'opacity-0 pointer-events-none': !isControlsVisible }\"\n          @touchstart.stop\n          @touchmove.stop\n          @touchend.stop\n          @mousedown.stop\n          @wheel.stop\n        >\n          <!-- Navigation controls -->\n          <div class=\"bg-black/65 rounded flex items-center\">\n            <Tooltip text=\"Previous image\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-l focus:outline-none\"\n                @click.stop=\"previousImage\"\n              >\n                <LucideChevronLeft class=\"size-4\" />\n              </button>\n            </Tooltip>\n\n            <span class=\"px-2 text-sm tabular-nums text-gray-400 select-none\">\n              {{ currentIndex + 1 }}/{{ props.images.length }}\n            </span>\n\n            <Tooltip text=\"Next image\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-r focus:outline-none\"\n                @click.stop=\"nextImage\"\n              >\n                <LucideChevronRight class=\"size-4\" />\n              </button>\n            </Tooltip>\n          </div>\n\n          <!-- Zoom controls -->\n          <div class=\"bg-black/65 rounded flex items-center\">\n            <Tooltip text=\"Zoom out\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-l focus:outline-none\"\n                @click.stop=\"zoomOut\"\n              >\n                <LucideMinus class=\"size-4\" />\n              </button>\n            </Tooltip>\n\n            <Tooltip text=\"Reset zoom\">\n              <button\n                class=\"p-2 hover:bg-gray-900 text-sm text-gray-400 focus:outline-none\"\n                @click.stop=\"resetZoom\"\n              >\n                {{ zoomLevel }}%\n              </button>\n            </Tooltip>\n\n            <Tooltip text=\"Zoom in\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-r focus:outline-none\"\n                @click.stop=\"zoomIn\"\n              >\n                <LucidePlus class=\"size-4\" />\n              </button>\n            </Tooltip>\n          </div>\n\n          <!-- Action controls -->\n          <div class=\"bg-black/65 rounded flex items-center\">\n            <Tooltip text=\"Download image\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-l focus:outline-none\"\n                @click.stop=\"downloadImage\"\n              >\n                <LucideDownload class=\"size-4\" />\n              </button>\n            </Tooltip>\n\n            <Tooltip\n              :text=\"isFullscreen ? 'Exit fullscreen' : 'Enter fullscreen'\"\n            >\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded-r focus:outline-none hidden sm:block\"\n                @click.stop=\"toggleFullscreen\"\n              >\n                <LucideMaximize v-if=\"!isFullscreen\" class=\"size-4\" />\n                <LucideMinimize v-else class=\"size-4\" />\n              </button>\n            </Tooltip>\n          </div>\n\n          <!-- Close button -->\n          <div class=\"bg-black/65 rounded flex items-center\">\n            <Tooltip text=\"Close\">\n              <button\n                class=\"p-2 hover:bg-gray-900 rounded focus:outline-none\"\n                @click.stop=\"close\"\n              >\n                <LucideX class=\"size-4\" />\n              </button>\n            </Tooltip>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  ref,\n  onMounted,\n  onUnmounted,\n  useTemplateRef,\n  computed,\n  toRef,\n  watch,\n} from 'vue'\nimport Tooltip from '../Tooltip/Tooltip.vue'\nimport { useTouchHandler } from '../../composables/useTouchHandler'\nimport { useImageNavigation } from '../../composables/useImageNavigation'\nimport { useZoomPan } from '../../composables/useZoomPan'\n\nimport LucideDownload from '~icons/lucide/download'\nimport LucideMaximize from '~icons/lucide/maximize'\nimport LucideMinimize from '~icons/lucide/minimize'\nimport LucideChevronLeft from '~icons/lucide/chevron-left'\nimport LucideChevronRight from '~icons/lucide/chevron-right'\nimport LucidePlus from '~icons/lucide/plus'\nimport LucideMinus from '~icons/lucide/minus'\nimport LucideX from '~icons/lucide/x'\n\ninterface ImageInfo {\n  src: string\n  alt: string | null\n}\n\nconst props = defineProps<{\n  show: boolean\n  images: ImageInfo[]\n  initialIndex: number\n}>()\n\nconst emit = defineEmits<{\n  'update:show': [value: boolean]\n}>()\n\nconst imageContainer = useTemplateRef('imageContainer')\nconst backdropElement = useTemplateRef('backdropElement')\nconst controlsBar = useTemplateRef('controlsBar')\nconst controlsBarHeight = ref(0)\n\nconst isFullscreen = ref(false)\nconst touchStartZoom = ref(100)\n\nconst isControlsVisible = ref(true)\nconst inactivityTimer = ref<ReturnType<typeof setTimeout> | null>(null)\nconst INACTIVITY_TIMEOUT = 3000 // 3 seconds\n\nconst {\n  zoomLevel,\n  panPosition,\n  isMousePanning,\n  initialPanPositionOnGestureStart,\n  zoomIn,\n  zoomOut,\n  resetZoom,\n  handlePanStart,\n  snapThresholdLower,\n  snapThresholdUpper,\n} = useZoomPan({\n  containerRef: imageContainer,\n  isEnabled: toRef(props, 'show'),\n})\n\nconst { currentIndex, nextImage, previousImage } = useImageNavigation({\n  initialIndex: toRef(props, 'initialIndex'),\n  imageCount: computed(() => props.images.length),\n  onNavigate: resetZoom,\n})\n\nconst currentImage = computed(() => props.images[currentIndex.value])\n\nconst {\n  isPanning: isTouchPanning,\n  isPinching,\n  isAnimatingPan,\n} = useTouchHandler({\n  targetRef: imageContainer,\n  zoomLevel: zoomLevel,\n  panThreshold: 10,\n  onSwipeLeft: () => {\n    if (zoomLevel.value <= 100) nextImage()\n  },\n  onSwipeRight: () => {\n    if (zoomLevel.value <= 100) previousImage()\n  },\n  onDoubleTap: (event) => {\n    if (controlsBar.value?.contains(event.target as Node)) return\n\n    if (zoomLevel.value > 100) {\n      resetZoom()\n    } else {\n      zoomLevel.value = 200\n      panPosition.value = { x: 0, y: 0 }\n    }\n  },\n  onTap: (event) => {\n    if (event.target === backdropElement.value) {\n      close()\n    }\n  },\n  onPanStart: () => {\n    if (zoomLevel.value <= 100) return\n    initialPanPositionOnGestureStart.value = { ...panPosition.value }\n  },\n  onPanMove: (deltaX, deltaY) => {\n    if (zoomLevel.value <= 100) return\n    panPosition.value = {\n      x: initialPanPositionOnGestureStart.value.x + deltaX,\n      y: initialPanPositionOnGestureStart.value.y + deltaY,\n    }\n  },\n  onPanAnimate: (deltaX, deltaY) => {\n    panPosition.value = {\n      x: panPosition.value.x + deltaX,\n      y: panPosition.value.y + deltaY,\n    }\n  },\n  onPinchStart: () => {\n    touchStartZoom.value = zoomLevel.value\n    initialPanPositionOnGestureStart.value = { ...panPosition.value }\n  },\n  onPinchMove: (scale) => {\n    const newZoom = touchStartZoom.value * scale\n    let finalZoom = Math.max(25, Math.min(300, Math.round(newZoom)))\n\n    if (finalZoom > snapThresholdLower && finalZoom < snapThresholdUpper) {\n      finalZoom = 100\n    }\n    zoomLevel.value = finalZoom\n  },\n  onPinchEnd: () => {\n    if (zoomLevel.value < 100) {\n      resetZoom()\n    }\n    initialPanPositionOnGestureStart.value = { x: 0, y: 0 }\n  },\n})\n\nconst isPanning = computed(() => isMousePanning.value || isTouchPanning.value)\n\nfunction showControlsAndResetTimer() {\n  isControlsVisible.value = true\n  if (inactivityTimer.value) {\n    clearTimeout(inactivityTimer.value)\n  }\n  inactivityTimer.value = setTimeout(() => {\n    if (!isPanning.value && !isPinching.value) {\n      isControlsVisible.value = false\n    } else {\n      showControlsAndResetTimer()\n    }\n  }, INACTIVITY_TIMEOUT)\n}\n\nfunction handleActivity() {\n  if (!isPinching.value || !isControlsVisible.value) {\n    showControlsAndResetTimer()\n  }\n}\n\nfunction close() {\n  emit('update:show', false)\n  resetZoom()\n  if (inactivityTimer.value) {\n    clearTimeout(inactivityTimer.value)\n    inactivityTimer.value = null\n  }\n}\n\nfunction downloadImage() {\n  const imageToDownload = currentImage.value\n\n  const link = document.createElement('a')\n  link.href = imageToDownload.src\n\n  const filename =\n    imageToDownload.alt?.replace(/[^a-z0-9]/gi, '_').toLowerCase() ||\n    imageToDownload.src.split('/').pop() ||\n    'download'\n  link.download = filename.includes('.') ? filename : `${filename}.jpg`\n\n  document.body.appendChild(link)\n  link.click()\n  document.body.removeChild(link)\n}\n\nfunction toggleFullscreen() {\n  const container = imageContainer.value\n\n  if (!isFullscreen.value) {\n    if (container?.requestFullscreen) {\n      container.requestFullscreen()\n      isFullscreen.value = true\n    }\n  } else {\n    if (document.exitFullscreen) {\n      document.exitFullscreen()\n      isFullscreen.value = false\n    }\n  }\n}\n\nfunction handleFullscreenChange() {\n  isFullscreen.value = Boolean(document.fullscreenElement)\n}\n\nfunction handleKeyDown(event: KeyboardEvent) {\n  if (!props.show) return\n\n  handleActivity()\n\n  switch (event.key) {\n    case 'ArrowLeft':\n      if (!isPanning.value) previousImage()\n      event.preventDefault()\n      break\n    case 'ArrowRight':\n      if (!isPanning.value) nextImage()\n      event.preventDefault()\n      break\n    case '+':\n    case '=':\n      zoomIn()\n      event.preventDefault()\n      break\n    case '-':\n      zoomOut()\n      event.preventDefault()\n      break\n    case 'Escape':\n      close()\n      event.preventDefault()\n      break\n    case 'f':\n    case 'F':\n      toggleFullscreen()\n      event.preventDefault()\n      break\n  }\n}\n\nwatch(\n  () => props.show,\n  (newValue) => {\n    if (newValue) {\n      isControlsVisible.value = true\n      resetZoom()\n      showControlsAndResetTimer()\n    } else {\n      if (inactivityTimer.value) {\n        clearTimeout(inactivityTimer.value)\n        inactivityTimer.value = null\n      }\n      if (isFullscreen.value && document.exitFullscreen) {\n        document.exitFullscreen()\n      }\n    }\n  },\n)\n\nwatch(controlsBar, (newVal) => {\n  if (newVal) {\n    const updateHeight = () => {\n      controlsBarHeight.value = newVal.offsetHeight\n    }\n    const resizeObserver = new ResizeObserver(updateHeight)\n    resizeObserver.observe(newVal)\n    updateHeight()\n    onUnmounted(() => resizeObserver.disconnect())\n  } else {\n    controlsBarHeight.value = 0\n  }\n})\n\nonMounted(() => {\n  document.addEventListener('fullscreenchange', handleFullscreenChange)\n  document.addEventListener('keydown', handleKeyDown)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('fullscreenchange', handleFullscreenChange)\n  document.removeEventListener('keydown', handleKeyDown)\n\n  if (inactivityTimer.value) {\n    clearTimeout(inactivityTimer.value)\n  }\n\n  if (isFullscreen.value && document.exitFullscreen) {\n    document.exitFullscreen()\n  }\n})\n</script>\n","import { Extension } from '@tiptap/core'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { createApp, h } from 'vue'\nimport ImageViewerModal from './ImageViewerModal.vue'\n\ninterface ImageInfo {\n  src: string\n  alt: string | null\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    imageViewer: {\n      /**\n       * Open the image viewer\n       */\n      openImageViewer: (src: string) => ReturnType\n    }\n  }\n}\n\nexport default Extension.create({\n  name: 'imageViewer',\n\n  onBeforeCreate() {\n    // Only add the style if it doesn't already exist\n    if (!document.querySelector('style[data-image-viewer-style]')) {\n      // Add a CSS rule to make images clickable when the editor is not editable\n      const style = document.createElement('style')\n      style.textContent = `\n          .ProseMirror:not(.ProseMirror-focused) img {\n            cursor: pointer;\n          }\n        `\n      style.setAttribute('data-image-viewer-style', 'true')\n      document.head.appendChild(style)\n    }\n  },\n\n  onDestroy() {\n    // Clean up the style element when the editor instance is destroyed\n    const style = document.querySelector('style[data-image-viewer-style]')\n    if (style) {\n      document.head.removeChild(style)\n    }\n  },\n\n  addCommands() {\n    return {\n      openImageViewer:\n        (src: string) =>\n        ({ editor }) => {\n          // Find all images in the document to populate the viewer\n          const images: ImageInfo[] = []\n          editor.state.doc.descendants((node) => {\n            if (node.type.name === 'image') {\n              images.push({\n                src: node.attrs.src,\n                alt: node.attrs.alt || null,\n              })\n            }\n            return true\n          })\n\n          // Find the index of the clicked image to start the viewer at the correct position\n          const currentIndex = images.findIndex((image) => image.src === src)\n\n          // Create and open the image viewer modal\n          openImageViewerModal(images, currentIndex)\n\n          return true\n        },\n    }\n  },\n\n  addProseMirrorPlugins() {\n    const extension = this\n\n    return [\n      new Plugin({\n        key: new PluginKey('imageViewer'),\n        props: {\n          handleClick(view, pos, event) {\n            // Only allow opening the viewer when the editor is not editable\n            if (extension.editor.isEditable) {\n              return false\n            }\n\n            const { state } = view\n            const clickedNode = state.doc.nodeAt(pos)\n\n            // Check if the click was directly on an image node\n            if (clickedNode?.type.name === 'image') {\n              event.preventDefault()\n              const src = clickedNode.attrs.src\n              extension.editor.commands.openImageViewer(src)\n              return true // Indicate that the event was handled\n            }\n\n            // If the click target was an <img> element, but not directly the node at pos\n            // (e.g., clicking near the edge, handled by browser event bubbling)\n            if (event.target instanceof HTMLImageElement) {\n              let foundImageNode = false\n              // Traverse the document to find the ProseMirror node corresponding to the clicked <img>\n              state.doc.descendants((node, nodePos) => {\n                if (node.type.name === 'image' && !foundImageNode) {\n                  const domNode = view.nodeDOM(nodePos)\n                  // Check if the event target is the DOM representation of this node or inside it\n                  if (\n                    domNode &&\n                    (domNode === event.target || domNode.contains(event.target))\n                  ) {\n                    event.preventDefault()\n                    extension.editor.commands.openImageViewer(node.attrs.src)\n                    foundImageNode = true\n                    return false // Stop traversal once found\n                  }\n                }\n                return true // Continue traversal\n              })\n\n              if (foundImageNode) return true // Indicate that the event was handled\n            }\n\n            return false // Event not handled by this plugin\n          },\n        },\n      }),\n    ]\n  },\n})\n\nfunction openImageViewerModal(images: ImageInfo[], initialIndex: number) {\n  // Create a temporary container div for the Vue modal instance\n  const container = document.createElement('div')\n  document.body.appendChild(container)\n\n  // Create the Vue app instance for the modal\n  const app = createApp({\n    render() {\n      return h(ImageViewerModal, {\n        show: true,\n        images, // Pass the collected image data\n        initialIndex, // Pass the starting index\n        'onUpdate:show': (value: boolean) => {\n          // Handle the modal closing\n          if (!value) {\n            // Delay unmounting and removal to allow for closing animations\n            setTimeout(() => {\n              app.unmount()\n              container.remove()\n            }, 0) // Timeout 0 ensures it runs after the current execution context\n          }\n        },\n      })\n    },\n  })\n\n  // Mount the Vue app to the container div\n  app.mount(container)\n}\n","import { Node, mergeAttributes, Editor } from '@tiptap/core'\nimport { Node as ProseMirrorNode } from '@tiptap/pm/model'\nimport { EditorView } from '@tiptap/pm/view'\nimport { UploadedFile } from '../../utils/useFileUpload'\n\nexport interface VideoOptions {\n  uploadFunction: ((file: File) => Promise<UploadedFile>) | null\n  HTMLAttributes: Record<string, any>\n}\n\nexport interface SetVideoOptions {\n  src: string\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    video: {\n      setVideo: (options: SetVideoOptions) => ReturnType\n      uploadVideo: (file: File) => ReturnType\n      selectAndUploadVideo: () => ReturnType\n    }\n  }\n}\n\nexport default Node.create<VideoOptions>({\n  name: 'video',\n  group: 'block',\n  selectable: true,\n  draggable: true,\n  atom: true,\n\n  addOptions() {\n    return {\n      uploadFunction: null,\n      HTMLAttributes: {},\n    }\n  },\n\n  addAttributes() {\n    return {\n      src: {\n        default: null,\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'video',\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      'video',\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes, {\n        controls: '',\n      }),\n    ]\n  },\n\n  addCommands() {\n    return {\n      setVideo:\n        (options: SetVideoOptions) =>\n        ({ commands }) => {\n          return commands.insertContent({\n            type: this.name,\n            attrs: options,\n          })\n        },\n\n      uploadVideo:\n        (file: File) =>\n        ({ editor }) => {\n          const pos = editor.state.selection.from\n          return uploadVideoInternal(file, editor.view, pos, this.options)\n        },\n\n      selectAndUploadVideo:\n        () =>\n        ({ editor }) => {\n          if (!this.options.uploadFunction) {\n            console.error('uploadFunction option is not provided for videos.')\n            return false\n          }\n\n          const input = document.createElement('input')\n          input.type = 'file'\n          input.accept = 'video/*'\n          input.onchange = (event) => {\n            const target = event.target as HTMLInputElement\n            if (target.files && target.files.length) {\n              const file = target.files[0]\n              editor.commands.uploadVideo(file)\n            }\n          }\n          input.click()\n          return true\n        },\n    }\n  },\n\n  addNodeView() {\n    return ({ editor, node }: { editor: Editor; node: ProseMirrorNode }) => {\n      const div = document.createElement('div')\n      div.className =\n        'relative aspect-w-16 aspect-h-9' +\n        (editor.isEditable ? ' cursor-pointer' : '')\n\n      const video = document.createElement('video')\n      video.src = node.attrs.src\n      video.setAttribute('controls', '')\n\n      if (editor.isEditable) {\n        let videoPill = document.createElement('div')\n        videoPill.className =\n          'absolute top-0 right-0 text-xs m-2 bg-surface-gray-6 text-ink-white px-2 py-1 rounded-md'\n        videoPill.innerHTML = 'Video'\n        div.append(videoPill)\n      }\n      div.append(video)\n      return {\n        dom: div,\n      }\n    }\n  },\n})\n\nfunction uploadVideoInternal(\n  file: File,\n  view: EditorView,\n  pos: number | null | undefined,\n  options: Record<string, any>,\n): boolean {\n  if (!options.uploadFunction) {\n    console.error('uploadFunction option is not provided for videos.')\n    return false\n  }\n\n  options\n    .uploadFunction(file)\n    .then((uploadedVideo: UploadedFile) => {\n      const { schema } = view.state\n      const node = schema.nodes.video.create({ src: uploadedVideo.file_url })\n\n      const transaction = view.state.tr\n      if (pos != null) {\n        transaction.insert(pos, node)\n      } else {\n        transaction.replaceSelectionWith(node)\n      }\n      view.dispatch(transaction)\n    })\n    .catch((error: Error) => {\n      console.error('Video upload failed:', error)\n    })\n\n  return true\n}\n","import { IframeOptions } from './iframe-extension'\n\n\nexport const ALLOWED_DOMAINS = [\n  'youtube.com',\n  'www.youtube.com',\n  'youtu.be',\n  'vimeo.com',\n  'player.vimeo.com',\n  'codepen.io',\n  'codesandbox.io',\n  'figma.com',\n  'www.figma.com',\n  'embed.figma.com',\n  'docs.google.com',\n  'drive.google.com',\n  'notion.so',\n  'www.notion.so',\n]\n\nexport interface AspectRatioInfo {\n  ratio: number\n  width: number\n  height: number\n  platform: string\n}\n\nexport interface PlatformConfig {\n  name: string\n  ratio: number\n  defaultWidth: number\n  urlPatterns: string[]\n}\n\n// Platform-specific configurations\nconst PLATFORM_CONFIGS: PlatformConfig[] = [\n  {\n    name: 'YouTube',\n    ratio: 9/16, // 16:9 aspect ratio\n    defaultWidth: 640,\n    urlPatterns: ['youtube.com', 'youtu.be', 'youtube-nocookie.com']\n  },\n  {\n    name: 'Vimeo',\n    ratio: 9/16, // 16:9 aspect ratio\n    defaultWidth: 640,\n    urlPatterns: ['vimeo.com', 'player.vimeo.com']\n  },\n  {\n    name: 'CodePen',\n    ratio: 3/2, // 2:3 aspect ratio (taller for code demos)\n    defaultWidth: 500,\n    urlPatterns: ['codepen.io']\n  },\n  {\n    name: 'CodeSandbox',\n    ratio: 3/2, // 2:3 aspect ratio\n    defaultWidth: 500,\n    urlPatterns: ['codesandbox.io']\n  },\n  {\n    name: 'Figma',\n    ratio: 9/16, // 16:9 default for design embeds\n    defaultWidth: 800,\n    urlPatterns: ['figma.com', 'www.figma.com', 'embed.figma.com']\n  },\n  {\n    name: 'Google Docs',\n    ratio: 4/3, // 4:3 for documents\n    defaultWidth: 600,\n    urlPatterns: ['docs.google.com', 'drive.google.com']\n  },\n  {\n    name: 'Notion',\n    ratio: 4/3, // 4:3 for pages\n    defaultWidth: 600,\n    urlPatterns: ['notion.so', 'www.notion.so']\n  },\n]\n\nexport function detectPlatform(url: string): PlatformConfig | null {\n  try {\n    const urlObj = new URL(url)\n    const domain = urlObj.hostname.toLowerCase()\n\n    return PLATFORM_CONFIGS.find(config =>\n      config.urlPatterns.some(pattern => domain.includes(pattern))\n    ) || null\n  } catch {\n    return null\n  }\n}\n\nexport function calculateAspectRatio(url: string): AspectRatioInfo {\n  const platform = detectPlatform(url)\n\n  if (platform) {\n    return {\n      ratio: platform.ratio,\n      width: platform.defaultWidth,\n      height: Math.round(platform.defaultWidth * platform.ratio),\n      platform: platform.name\n    }\n  }\n\n  // Default to 16:9 for unknown platforms\n  return {\n    ratio: 9/16,\n    width: 640,\n    height: 360,\n    platform: 'Generic'\n  }\n}\n\nexport function getOptimalDimensions(url: string, containerWidth?: number): { width: number, height: number } {\n  const aspectInfo = calculateAspectRatio(url)\n\n  // If container width is provided, scale to fit\n  if (containerWidth) {\n    const CONTAINER_PADDING = 40 // px for editor padding\n    const maxWidth = Math.min(containerWidth - CONTAINER_PADDING, aspectInfo.width)\n    return {\n      width: maxWidth,\n      height: Math.round(maxWidth * aspectInfo.ratio)\n    }\n  }\n\n  return {\n    width: aspectInfo.width,\n    height: aspectInfo.height\n  }\n}\n\nexport function validateURL(url: string, options: IframeOptions): boolean {\n  try {\n    if (url.startsWith('/')) return true\n    const urlObj = new URL(url)\n    const domain = urlObj.hostname.toLowerCase()\n\n    // Check blocked domains first\n    if (options.blockedDomains?.some((blocked) => domain.includes(blocked))) {\n      return false\n    }\n\n    // If allowedDomains is specified, check if domain is allowed\n    if (options.allowedDomains?.length) {\n      return options.allowedDomains.some((allowed) =>\n        domain.includes(allowed.toLowerCase())\n      )\n    }\n\n    // If no allowedDomains specified, allow all except blocked\n    return true\n  } catch {\n    return false\n  }\n}\n\nexport function processURL(url: string): string {\n  try {\n    const urlObj = new URL(url)\n    const domain = urlObj.hostname.toLowerCase()\n\n    // YouTube URL processing\n    if (domain.includes('youtube.com') || domain.includes('youtu.be')) {\n      return convertToYouTubeEmbed(url)\n    }\n\n    // Vimeo URL processing\n    if (domain.includes('vimeo.com')) {\n      return convertToVimeoEmbed(url)\n    }\n\n    // CodePen URL processing\n    if (domain.includes('codepen.io')) {\n      return convertToCodePenEmbed(url)\n    }\n\n    // Figma URL processing\n    if (domain.includes('figma.com')) {\n      return convertToFigmaEmbed(url)\n    }\n\n    // For other supported domains, return as-is\n    return url\n  } catch {\n    return url\n  }\n}\n\nfunction convertToYouTubeEmbed(url: string): string {\n  try {\n    const urlObj = new URL(url)\n    let videoId = ''\n\n    if (urlObj.hostname === 'youtu.be') {\n      videoId = urlObj.pathname.slice(1)\n    } else if (urlObj.hostname.includes('youtube.com')) {\n      videoId = urlObj.searchParams.get('v') || ''\n\n      // Handle /embed/ URLs that are already in embed format\n      if (urlObj.pathname.includes('/embed/')) {\n        return url\n      }\n    }\n\n    if (videoId) {\n      // Add common YouTube embed parameters for better UX\n      return `https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1`\n    }\n  } catch (e) {\n    console.warn('Failed to convert YouTube URL:', e)\n  }\n\n  return url\n}\n\nfunction convertToVimeoEmbed(url: string): string {\n  try {\n    // Handle already embedded URLs\n    if (url.includes('player.vimeo.com')) {\n      return url\n    }\n\n    const match = url.match(/vimeo\\.com\\/(?:.*\\/)?(\\d+)/)\n    if (match?.[1]) {\n      return `https://player.vimeo.com/video/${match[1]}?title=0&byline=0&portrait=0`\n    }\n  } catch (e) {\n    console.warn('Failed to convert Vimeo URL:', e)\n  }\n\n  return url\n}\n\nfunction convertToCodePenEmbed(url: string): string {\n  try {\n    // Handle already embedded URLs\n    if (url.includes('/embed/')) {\n      return url\n    }\n\n    const match = url.match(/codepen\\.io\\/([^\\/]+)\\/pen\\/([^\\/\\?]+)/)\n    if (match?.[1] && match?.[2]) {\n      return `https://codepen.io/${match[1]}/embed/${match[2]}?default-tab=result`\n    }\n  } catch (e) {\n    console.warn('Failed to convert CodePen URL:', e)\n  }\n\n  return url\n}\n\nfunction convertToFigmaEmbed(url: string): string {\n  try {\n    const urlObj = new URL(url)\n\n    // Convert direct Figma links to embed URLs\n    if (urlObj.hostname === 'www.figma.com' || urlObj.hostname === 'figma.com') {\n      // Convert https://www.figma.com/design/... to https://embed.figma.com/design/...\n      if (urlObj.pathname.startsWith('/design/')) {\n        urlObj.hostname = 'embed.figma.com'\n        // Set embed-host to 'share' for public embeds\n        urlObj.searchParams.set('embed-host', 'share')\n        return urlObj.toString()\n      }\n    }\n\n    // For already embedded URLs, just ensure embed-host is set\n    if (urlObj.hostname === 'embed.figma.com') {\n      if (!urlObj.searchParams.has('embed-host')) {\n        urlObj.searchParams.set('embed-host', 'share')\n      }\n      return urlObj.toString()\n    }\n\n    return url\n  } catch (e) {\n    console.warn('Failed to convert Figma URL:', e)\n  }\n\n  return url\n}\n","<script setup lang=\"ts\">\nimport { ref, onMounted, computed, nextTick } from 'vue'\nimport { NodeViewWrapper, nodeViewProps } from '@tiptap/vue-3'\nimport { detectPlatform, calculateAspectRatio } from './utils'\nimport LucideMoveDiagonal2 from '~icons/lucide/move-diagonal-2'\nimport LucideAlignLeft from '~icons/lucide/align-left'\nimport LucideAlignCenter from '~icons/lucide/align-center'\nimport LucideAlignRight from '~icons/lucide/align-right'\n\nconst props = defineProps(nodeViewProps)\n\nconst iframeRef = ref<HTMLIFrameElement | null>(null)\nconst containerRef = ref<HTMLDivElement | null>(null)\nconst isResizing = ref(false)\nconst startDragX = ref(0)\nconst startWidth = ref(0)\nconst originalAspectRatio = ref(9/16) // Default 16:9\nconst isEditable = ref(false)\n\nfunction selectIframe() {\n  props.editor.commands.setNodeSelection(props.getPos())\n}\n\n// Computed properties for styling and info\nconst platformInfo = computed(() => {\n  if (props.node.attrs.src) {\n    const platform = detectPlatform(props.node.attrs.src)\n    const aspectInfo = calculateAspectRatio(props.node.attrs.src)\n    return {\n      platform: platform?.name || 'Generic',\n      aspectRatio: aspectInfo.ratio\n    }\n  }\n  return { platform: 'Generic', aspectRatio: 9/16 }\n})\n\nconst iframeStyles = computed(() => {\n  const width = props.node.attrs.width || 640\n  const height = props.node.attrs.height || (width * originalAspectRatio.value)\n\n  return {\n    width: `${width}px`,\n    height: `${height}px`\n  }\n})\n\nonMounted(() => {\n  isEditable.value = props.editor.isEditable\n\n  // Calculate aspect ratio from node attributes or URL\n  if (props.node.attrs.aspectRatio) {\n    originalAspectRatio.value = props.node.attrs.aspectRatio\n  } else if (props.node.attrs.src) {\n    const aspectInfo = calculateAspectRatio(props.node.attrs.src)\n    originalAspectRatio.value = aspectInfo.ratio\n\n    // Update node with calculated aspect ratio\n    props.updateAttributes({ aspectRatio: aspectInfo.ratio })\n  }\n})\n\nprops.editor.on('update', () => {\n  isEditable.value = props.editor.isEditable\n})\n\nfunction startResize(event: MouseEvent) {\n  if (!isEditable.value) return\n  selectIframe()\n  isResizing.value = true\n  startDragX.value = event.clientX\n  startWidth.value = containerRef.value?.offsetWidth || props.node.attrs.width || 640\n\n  // Use stored aspect ratio or calculate from current dimensions\n  if (props.node.attrs.aspectRatio) {\n    originalAspectRatio.value = props.node.attrs.aspectRatio\n  } else {\n    const width = props.node.attrs.width || startWidth.value\n    const height = props.node.attrs.height || (width * originalAspectRatio.value)\n    if (width && height) {\n      originalAspectRatio.value = height / width\n    }\n  }\n\n  window.addEventListener('mousemove', handleResize)\n  window.addEventListener('mouseup', stopResize)\n  document.body.style.cursor = 'ew-resize'\n}\n\nfunction handleResize(event: MouseEvent) {\n  if (!isResizing.value || !iframeRef.value || !containerRef.value) return\n\n  const editorElement = props.editor.view.dom\n  const editorWidth = editorElement.clientWidth\n\n  const deltaX = event.clientX - startDragX.value\n  let newWidth = startWidth.value + deltaX\n\n  // Add constraints (minimum width, maximum editor width with padding)\n  const MIN_WIDTH = 200\n  const PADDING = 40\n  newWidth = Math.max(MIN_WIDTH, Math.min(newWidth, editorWidth - PADDING))\n\n  const newHeight = newWidth * originalAspectRatio.value\n\n  // Apply temporary styles for visual feedback\n  iframeRef.value.style.width = `${newWidth}px`\n  iframeRef.value.style.height = `${newHeight}px`\n  containerRef.value.style.width = `${newWidth}px`\n}\n\nfunction stopResize() {\n  if (!isResizing.value) return\n\n  isResizing.value = false\n  window.removeEventListener('mousemove', handleResize)\n  window.removeEventListener('mouseup', stopResize)\n  document.body.style.cursor = ''\n\n  if (iframeRef.value && containerRef.value) {\n    // Capture final dimensions while temporary styles are still applied\n    const finalWidth = iframeRef.value.offsetWidth\n    const finalHeight = iframeRef.value.offsetHeight\n\n    // Update attributes\n    props.updateAttributes({\n      width: finalWidth,\n      height: finalHeight,\n      aspectRatio: originalAspectRatio.value\n    })\n\n    // Clear temporary styles immediately (like image extension)\n    iframeRef.value.style.width = ''\n    iframeRef.value.style.height = ''\n    containerRef.value.style.width = ''\n  }\n}\n\nfunction setAlignment(align: 'left' | 'center' | 'right') {\n  props.updateAttributes({ align })\n}\n\n// Handle keyboard navigation\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Enter') {\n    event.preventDefault()\n    createParagraphAfterIframe()\n  } else if (event.key === 'Escape' || event.key === 'ArrowDown') {\n    event.preventDefault()\n    setCursorAfterIframe()\n  }\n  if (event.key === 'ArrowUp') {\n    event.preventDefault()\n    setCursorBeforeIframe()\n  }\n}\n\nfunction setCursorAt(pos: number) {\n  props.editor.commands.focus()\n  props.editor.chain().setTextSelection(pos).scrollIntoView().run()\n}\n\nfunction createParagraphAfterIframe() {\n  const pos = props.getPos()\n  props.editor.commands.focus()\n  props.editor\n    .chain()\n    .setTextSelection(pos + 1)\n    .createParagraphNear()\n    .scrollIntoView()\n    .run()\n}\n\nfunction setCursorAfterIframe() {\n  const pos = props.getPos()\n  setCursorAt(pos + 1)\n}\n\nfunction setCursorBeforeIframe() {\n  const pos = props.getPos()\n  setCursorAt(pos - 1)\n}\n</script>\n\n<template>\n  <NodeViewWrapper>\n    <div\n      ref=\"containerRef\"\n      class=\"relative overflow-hidden not-prose my-6 rounded-lg block max-w-full focus:outline-none\"\n      :class=\"[\n        { 'ring-2 ring-outline-gray-3 ring-offset-2': selected },\n        node.attrs.align === 'center' ? 'mx-auto' : '',\n        node.attrs.align === 'right' ? 'ml-auto mr-0' : '',\n        node.attrs.align === 'left' ? 'mr-auto ml-0' : '',\n      ]\"\n      :style=\"{\n        width: node.attrs.width ? `${node.attrs.width}px` : 'auto',\n        maxWidth: '100%'\n      }\"\n      @keydown=\"handleKeydown\"\n      tabindex=\"0\"\n    >\n      <div class=\"relative\">\n        <iframe\n          v-if=\"node.attrs.src\"\n          ref=\"iframeRef\"\n          class=\"rounded-lg border-0 block max-w-full h-auto\"\n          :class=\"{\n            'pointer-events-none': isEditable && !props.node.attrs.interactive,\n          }\"\n          :src=\"node.attrs.src\"\n          :style=\"iframeStyles\"\n          :title=\"node.attrs.title || ''\"\n          frameborder=\"0\"\n          allowfullscreen\n          loading=\"lazy\"\n          referrerpolicy=\"no-referrer-when-downgrade\"\n          sandbox=\"allow-scripts allow-same-origin allow-popups allow-forms\"\n          @click.stop=\"selectIframe\"\n        />\n\n        <!-- Transparent overlay for selection in edit mode -->\n        <div\n          v-if=\"isEditable && !props.node.attrs.interactive\"\n          class=\"absolute inset-0 cursor-pointer z-10\"\n          @click.stop=\"selectIframe\"\n        ></div>\n\n        <!-- Controls overlay -->\n        <div class=\"absolute bottom-2 right-2 flex items-center gap-2 z-20\">\n          <!-- Alignment Controls -->\n          <div\n            v-if=\"selected && isEditable\"\n            class=\"flex divide-x divide-ink-gray-6 rounded-md bg-black/65\"\n          >\n            <button\n              @click.stop=\"setAlignment('left')\"\n              :class=\"[\n                'px-1.5 py-1 text-ink-gray-4 hover:text-white transition-colors duration-150',\n                { 'text-white': node.attrs.align === 'left' }\n              ]\"\n              title=\"Align Left\"\n            >\n              <LucideAlignLeft class=\"size-4\" />\n            </button>\n            <button\n              @click.stop=\"setAlignment('center')\"\n              :class=\"[\n                'px-1.5 py-1 text-ink-gray-4 hover:text-white transition-colors duration-150',\n                { 'text-white': node.attrs.align === 'center' }\n              ]\"\n              title=\"Align Center\"\n            >\n              <LucideAlignCenter class=\"size-4\" />\n            </button>\n            <button\n              @click.stop=\"setAlignment('right')\"\n              :class=\"[\n                'px-1.5 py-1 text-ink-gray-4 hover:text-white transition-colors duration-150',\n                { 'text-white': node.attrs.align === 'right' }\n              ]\"\n              title=\"Align Right\"\n            >\n              <LucideAlignRight class=\"size-4\" />\n            </button>\n          </div>\n\n          <!-- Resize Handle -->\n          <button\n            v-if=\"selected && isEditable\"\n            class=\"cursor-nw-resize bg-black/65 rounded-md p-1\"\n            @mousedown.prevent=\"startResize\"\n            title=\"Resize\"\n          >\n            <LucideMoveDiagonal2 class=\"text-white size-4\" />\n          </button>\n        </div>\n\n\n        <!-- Loading state for new embeds -->\n        <div\n          v-if=\"!node.attrs.src\"\n          class=\"flex items-center justify-center bg-surface-gray-1 rounded-lg w-[640px] h-[360px]\"\n        >\n          <div class=\"text-ink-gray-5 text-center\">\n            <div class=\"text-lg mb-1\"></div>\n            <div class=\"text-sm\">Loading embed...</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Caption/Title input -->\n      <input\n        v-if=\"(isEditable || node.attrs.title) && node.attrs.src\"\n        :value=\"node.attrs.title\"\n        class=\"w-full text-center bg-transparent text-sm text-ink-gray-6 h-7 border-0 mt-2 focus:outline-none focus:ring-0 placeholder-ink-gray-4 disabled:opacity-60\"\n        placeholder=\"Add caption\"\n        :disabled=\"!isEditable\"\n        @input=\"(e) => props.updateAttributes({ title: (e.target as HTMLInputElement).value })\"\n        @keydown=\"handleKeydown\"\n      />\n    </div>\n  </NodeViewWrapper>\n</template>\n\n<style scoped>\n/* Component-specific styles if needed */\n</style>\n","import { Node, mergeAttributes } from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-3'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport IframeNodeView from './IframeNodeView.vue'\nimport { validateURL, processURL, getOptimalDimensions, ALLOWED_DOMAINS } from './utils'\n\n// Constants for iframe constraints\nconst MIN_IFRAME_WIDTH = 200\nconst EDITOR_PADDING = 40\nconst DEFAULT_EMBED_HOST = 'gameplan'\n\nexport interface IframeOptions {\n  allowedDomains?: string[]\n  blockedDomains?: string[]\n  HTMLAttributes: Record<string, any>\n}\n\nexport interface SetIframeOptions {\n  src: string\n  width?: number\n  height?: number\n  title?: string\n  interactive?: boolean\n  align?: 'left' | 'center' | 'right'\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    iframe: {\n      setIframe: (options: SetIframeOptions) => ReturnType\n      insertIframeURL: (url: string) => ReturnType\n      setIframeAlign: (align: 'left' | 'center' | 'right') => ReturnType\n      openIframeDialog: () => ReturnType\n    }\n  }\n}\n\nexport const IframeExtension = Node.create<IframeOptions>({\n  name: 'iframe',\n  group: 'block',\n  selectable: true,\n  draggable: true,\n  atom: true,\n\n  addOptions() {\n    return {\n      allowedDomains: ALLOWED_DOMAINS,\n      blockedDomains: [],\n      HTMLAttributes: {},\n    }\n  },\n\n  addAttributes() {\n    return {\n      src: {\n        default: null,\n        parseHTML: (element) => element.getAttribute('src'),\n        renderHTML: (attributes) => ({\n          src: attributes.src,\n        }),\n      },\n      width: {\n        default: null,\n        parseHTML: (element) => {\n          const width = element.getAttribute('width')\n          return width ? parseInt(width, 10) : null\n        },\n        renderHTML: (attributes) => ({\n          width: attributes.width ? String(attributes.width) : null,\n        }),\n      },\n      height: {\n        default: null,\n        parseHTML: (element) => {\n          const height = element.getAttribute('height')\n          return height ? parseInt(height, 10) : null\n        },\n        renderHTML: (attributes) => ({\n          height: attributes.height ? String(attributes.height) : null,\n        }),\n      },\n      aspectRatio: {\n        default: 9/16, // Default 16:9 aspect ratio\n        parseHTML: () => null, // Don't parse from HTML\n        renderHTML: () => ({}), // Don't render to HTML\n      },\n      align: {\n        default: 'center',\n        parseHTML: (element) => {\n          const align = (\n            element.getAttribute('data-align') ||\n            element.getAttribute('align') ||\n            'left'\n          ).toLowerCase()\n\n          if (['left', 'center', 'right'].includes(align)) {\n            return align as 'left' | 'center' | 'right'\n          }\n          return 'left'\n        },\n        renderHTML: (attributes) => {\n          return {\n            'data-align': attributes.align || 'center',\n          }\n        },\n      },\n      title: {\n        default: null,\n        parseHTML: (element) => element.getAttribute('title'),\n        renderHTML: (attributes) => ({\n          title: attributes.title,\n        }),\n      },\n      frameborder: {\n        default: '0',\n        renderHTML: () => ({\n          frameborder: '0',\n        }),\n      },\n      allowfullscreen: {\n        default: 'true',\n        renderHTML: () => ({\n          allowfullscreen: 'true',\n        }),\n      },\n      sandbox: {\n        default: 'allow-scripts allow-same-origin allow-popups allow-forms',\n        renderHTML: (attributes) => ({\n          sandbox: attributes.sandbox,\n        }),\n      },\n      interactive: {\n        default: false,\n        parseHTML: (el) => el.getAttribute('data-interactive') === 'true',\n        renderHTML: (attrs) => ({\n          'data-interactive': attrs.interactive ? 'true' : 'false',\n        }),\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'iframe[src]',\n        getAttrs: (element) => {\n          const src = (element as HTMLElement).getAttribute('src')\n          const width = (element as HTMLElement).getAttribute('width')\n          const height = (element as HTMLElement).getAttribute('height')\n          const title = (element as HTMLElement).getAttribute('title')\n          const align = (element as HTMLElement).getAttribute('data-align')\n\n          return {\n            src,\n            width: width ? parseInt(width, 10) : null,\n            height: height ? parseInt(height, 10) : null,\n            title: title || null,\n            align: align || 'center'\n          }\n        },\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      'iframe',\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes, {\n        loading: 'lazy',\n        referrerpolicy: 'no-referrer-when-downgrade',\n      }),\n    ]\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(IframeNodeView)\n  },\n\n  addCommands() {\n    return {\n      setIframeAlign:\n        (align: 'left' | 'center' | 'right') =>\n        ({ commands }) => {\n          return commands.updateAttributes(this.name, { align })\n        },\n\n      setIframe:\n        (options: SetIframeOptions) =>\n        ({ commands, editor }) => {\n          if (!validateURL(options.src, this.options)) {\n            return false\n          }\n\n          const processedSrc = processURL(options.src)\n\n          // Calculate optimal dimensions if not provided\n          const editorElement = editor.view.dom\n          const editorWidth = editorElement?.clientWidth || 800\n          const optimalDimensions = getOptimalDimensions(processedSrc, editorWidth)\n\n          const attrs = {\n            src: processedSrc,\n            width: options.width || optimalDimensions.width,\n            height: options.height || optimalDimensions.height,\n            title: options.title,\n            align: options.align || 'center',\n            aspectRatio: optimalDimensions.height / optimalDimensions.width,\n            interactive: options.interactive,\n          }\n\n          return commands.insertContent({\n            type: this.name,\n            attrs\n          })\n        },\n\n      insertIframeURL:\n        (url: string) =>\n        ({ commands }) => {\n          const processedUrl = processURL(url)\n          return commands.setIframe({ src: processedUrl })\n        },\n\n      openIframeDialog:\n        () =>\n        ({ editor }) => {\n          // Emit a custom event on the editor's view DOM element\n          // This is more localized than document.dispatchEvent\n          const event = new CustomEvent('iframe:open-dialog', {\n            detail: { editor }\n          })\n          editor.view.dom.dispatchEvent(event)\n          return true\n        },\n    }\n  },\n\n  // Add ProseMirror plugin for paste handling\n  addProseMirrorPlugins() {\n    const extensionThis = this\n\n    return [\n      new Plugin({\n        key: new PluginKey('iframe-paste-handler'),\n        props: {\n          handlePaste: (view, event, slice) => {\n            const text = event.clipboardData?.getData('text/plain')\n            const html = event.clipboardData?.getData('text/html')\n\n            // First, check for iframe embed codes in HTML content\n            if (html) {\n              const iframeData = parseIframeFromHTML(html)\n              if (iframeData) {\n                return createIframeNode(view, extensionThis, iframeData.src, iframeData.width, iframeData.height, iframeData.title)\n              }\n            }\n\n            // Check if plain text contains iframe embed code\n            if (text && text.includes('<iframe')) {\n              const iframeData = parseIframeFromHTML(text)\n              if (iframeData) {\n                return createIframeNode(view, extensionThis, iframeData.src, iframeData.width, iframeData.height, iframeData.title)\n              }\n            }\n\n            // Fallback to URL detection for plain text\n            if (text) {\n              // Check if pasted text is a supported embed URL\n              const urlPattern = /^https?:\\/\\/(?:www\\.)?(?:youtube\\.com\\/watch\\?v=[\\w-]+|youtu\\.be\\/[\\w-]+|youtube\\.com\\/embed\\/[\\w-]+|vimeo\\.com\\/\\d+|player\\.vimeo\\.com\\/video\\/\\d+|codepen\\.io\\/[\\w-]+\\/pen\\/[\\w-]+|codesandbox\\.io\\/[\\w\\/.-]+|figma\\.com\\/[\\w\\/.-]+|embed\\.figma\\.com\\/[\\w\\/.-]+)$/\n\n              if (urlPattern.test(text.trim())) {\n                return createIframeNode(view, extensionThis, text.trim())\n              }\n            }\n\n            return false // Allow default paste behavior\n          },\n        },\n      }),\n    ]\n  },\n})\n\n// Helper function to parse iframe embed codes from pasted HTML content\nfunction parseIframeFromHTML(html: string): { src: string, width?: number, height?: number, title?: string } | null {\n  try {\n    const parser = new DOMParser()\n    const doc = parser.parseFromString(html, 'text/html')\n    const iframe = doc.querySelector('iframe')\n\n    if (!iframe) {\n      // Fallback: try to parse iframe tag using regex\n      const iframeMatch = html.match(/<iframe[^>]*src=[\"']([^\"']+)[\"'][^>]*>/i)\n      if (iframeMatch) {\n        const src = iframeMatch[1]\n        const widthMatch = html.match(/width=[\"'](\\d+)[\"']/i)\n        const heightMatch = html.match(/height=[\"'](\\d+)[\"']/i)\n        const titleMatch = html.match(/title=[\"']([^\"']+)[\"']/i)\n\n        return {\n          src,\n          width: widthMatch ? parseInt(widthMatch[1], 10) : undefined,\n          height: heightMatch ? parseInt(heightMatch[1], 10) : undefined,\n          title: titleMatch ? titleMatch[1] : undefined\n        }\n      }\n      return null\n    }\n\n    const src = iframe.getAttribute('src')\n    if (!src) return null\n\n    const width = iframe.getAttribute('width') ? parseInt(iframe.getAttribute('width')!, 10) : undefined\n    const height = iframe.getAttribute('height') ? parseInt(iframe.getAttribute('height')!, 10) : undefined\n    const title = iframe.getAttribute('title') || undefined\n\n    return { src, width, height, title }\n  } catch (error) {\n    return null\n  }\n}\n\n// Helper function to create iframe node from parsed data\nfunction createIframeNode(view: any, extensionThis: any, src: string, width?: number, height?: number, title?: string) {\n  // Ask user for confirmation before creating iframe\n  const shouldCreateEmbed = confirm(`Do you want to embed this content?\\n\\nURL: ${src}\\n\\nClick \"OK\" to create an embed, or \"Cancel\" to paste as plain text.`)\n\n  if (!shouldCreateEmbed) {\n    return false // Allow default paste behavior (paste as text)\n  }\n\n  if (!validateURL(src, extensionThis.options)) {\n    return false\n  }\n\n  console.log('URL validated, creating iframe node')\n  const processedUrl = processURL(src)\n  const editorElement = extensionThis.editor.view.dom\n  const editorWidth = editorElement?.clientWidth || 800\n\n  // Use provided dimensions or calculate optimal ones\n  const finalWidth = width || getOptimalDimensions(processedUrl, editorWidth).width\n  const finalHeight = height || getOptimalDimensions(processedUrl, editorWidth).height\n\n  const attrs = {\n    src: processedUrl,\n    width: finalWidth,\n    height: finalHeight,\n    title: title,\n    align: 'center' as const,\n    aspectRatio: finalHeight / finalWidth\n  }\n\n  const node = view.state.schema.nodes.iframe.create(attrs)\n  const tr = view.state.tr.replaceSelectionWith(node)\n  view.dispatch(tr)\n\n  return true // Prevent default paste behavior\n}\n\nexport default IframeExtension\n","/**\n * Validates if the given string is a valid URL, including common protocols,\n * relative paths, and anchor links. It also allows an empty string.\n *\n * @param url The URL string to validate.\n * @returns True if the URL is considered valid, false otherwise.\n */\nexport function isValidUrl(url: string): boolean {\n  if (url === '') {\n    return true // Allows empty string as per documentation\n  }\n\n  // Regex for absolute URLs with common schemes (http, https, mailto, tel, //)\n  // Allows for paths, query strings, and fragments.\n  if (/^(https?:\\/\\/|mailto:|tel:|\\/\\/)[^\\s]+$/i.test(url)) {\n    return true\n  }\n\n  // Regex for:\n  // 1. Relative paths (starting with / or .)\n  // 2. Anchor links (starting with #)\n  // These allow for most characters except whitespace, as the initial characters\n  // prevent misinterpretation as a scheme like 'javascript:'.\n  if (/^([./#][^\\s]*)$/i.test(url)) {\n    return true\n  }\n\n  // Regex for \"Schemeless\" paths (e.g., page.html, my-document, slug-name)\n  // Must start with a word character or hyphen.\n  // Subsequent characters are restricted to common URL path/query/fragment characters\n  // (alphanumeric, -, _, ., /, #, ?, =, &, %).\n  // This prevents colons (avoiding 'javascript:' like schemes) and other problematic\n  // characters like spaces, (, ), !, {, }.\n  if (/^[\\w\\-]([\\w\\-./#?=&%]*)$/i.test(url)) {\n    return true\n  }\n\n  return false\n}\n","<template>\n  <div\n    class=\"p-2 flex min-w-72 items-center gap-2 bg-surface-white shadow-xl rounded-lg\"\n  >\n    <TextInput\n      ref=\"input\"\n      type=\"text\"\n      class=\"w-full\"\n      placeholder=\"https://example.com\"\n      v-model=\"_href\"\n      @keydown.enter=\"submitLink\"\n      @keydown.esc=\"$emit('close')\"\n    />\n    <div class=\"shrink-0 flex items-center gap-2\">\n      <Tooltip text=\"Submit\" placement=\"top\">\n        <Button label=\"Submit\" @click=\"submitLink\">\n          <template #icon><LucideCheck class=\"size-4\" /></template>\n        </Button>\n      </Tooltip>\n      <Tooltip text=\"Remove link\" placement=\"top\">\n        <Button label=\"Remove link\" @click=\"$emit('updateHref', '')\">\n          <template #icon><LucideX class=\"size-4\" /></template>\n        </Button>\n      </Tooltip>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, ref, useTemplateRef, nextTick } from 'vue'\nimport Button from '../Button/Button.vue'\nimport TextInput from '../TextInput/TextInput.vue'\nimport Tooltip from '../Tooltip/Tooltip.vue'\nimport LucideCheck from '~icons/lucide/check'\nimport LucideX from '~icons/lucide/x'\nimport { isValidUrl } from '../../utils/url-validation'\n\nconst props = defineProps<{\n  href: string\n}>()\n\nconst emit = defineEmits<{\n  (e: 'updateHref', href: string): void\n  (e: 'close'): void\n}>()\n\nconst _href = ref(props.href)\nconst input = useTemplateRef('input')\n\nconst submitLink = () => {\n  if (_href.value === '' || isValidUrl(_href.value)) {\n    emit('updateHref', _href.value)\n  }\n}\n\nonMounted(async () => {\n  await nextTick()\n  if (input.value?.el) {\n    input.value.el.focus()\n    input.value.el.select()\n  }\n})\n</script>\n","import { Editor } from '@tiptap/core'\nimport { MarkType } from '@tiptap/pm/model'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { isValidUrl } from '../../utils/url-validation'\n\ntype PasteHandlerOptions = {\n  editor: Editor\n  defaultProtocol: string\n  type: MarkType\n}\n\nexport function linkPasteHandler(options: PasteHandlerOptions): Plugin {\n  return new Plugin({\n    key: new PluginKey('handlePasteLink'),\n    props: {\n      handlePaste: (view, event, slice) => {\n        const { state } = view\n        const { selection } = state\n        const { empty } = selection\n\n        if (empty) {\n          return false\n        }\n\n        let textContent = ''\n        slice.content.forEach((node) => {\n          textContent += node.textContent\n        })\n        if (!textContent) {\n          return false\n        }\n\n        let link = isValidUrl(textContent) ? textContent : null\n        if (!link) {\n          return false\n        }\n\n        return options.editor\n          .chain()\n          .setTextSelection({ from: selection.from, to: selection.to })\n          .setLink({ href: link })\n          .setTextSelection(selection.to)\n          .command(({ tr }) => {\n            tr.setStoredMarks([])\n            return true\n          })\n          .run()\n      },\n    },\n  })\n}\n","import { createApp, h } from 'vue'\nimport Link from '@tiptap/extension-link'\nimport tippy, { type Instance as TippyInstance } from 'tippy.js'\nimport { getMarkRange, Range, Editor } from '@tiptap/core'\nimport { MarkType, Mark as ProseMirrorMark } from '@tiptap/pm/model'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport EditLink from './EditLink.vue'\nimport { linkPasteHandler } from './linkPasteHandler'\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    link: {\n      /**\n       * Opens the link editor bubble menu.\n       */\n      openLinkEditor: () => ReturnType\n    }\n  }\n}\n\nexport const LinkExtension = Link.extend({\n  addOptions() {\n    return {\n      ...this.parent?.(),\n      openOnClick: false,\n      autolink: true,\n      defaultProtocol: 'https',\n      linkOnPaste: false,\n    }\n  },\n\n  addCommands() {\n    return {\n      ...this.parent?.(),\n      openLinkEditor:\n        () =>\n        ({ editor }: { editor: Editor }): boolean => {\n          const { state } = editor\n          const { from, to } = state.selection\n          const { doc } = state\n\n          let range: Range | undefined = undefined\n          let mark: ProseMirrorMark | undefined = undefined\n          let shouldDelayPopover = false\n\n          // Check if cursor is within a link or if there's a selection\n          if (from === to) {\n            // Cursor is within a link\n            const $pos = state.selection.$from\n            const markRange = getMarkRange($pos, this.type)\n            if (markRange) {\n              range = markRange\n              mark = doc\n                .resolve(markRange.from)\n                .marks()\n                .find((m) => m.type === this.type)\n\n              // Select the link text\n              editor\n                .chain()\n                .setTextSelection({ from: markRange.from, to: markRange.to })\n                .run()\n              shouldDelayPopover = true\n            } else {\n              // No selection and not within a link, and cursor not in link\n              return false\n            }\n          } else {\n            // There is a selection\n            range = { from, to }\n            // Check if the selection is already a link\n            mark = doc\n              .resolve(from)\n              .marks()\n              .find((m) => m.type === this.type)\n          }\n\n          if (!range) return false\n\n          const existingHref = mark?.attrs.href || ''\n          const selectionFrom = range.from\n          const selectionTo = range.to\n\n          const showPopover = () => {\n            openLinkEditor(existingHref, editor.view.dom)\n              .then((href) => {\n                if (href === null) {\n                  return\n                }\n\n                let chain = editor\n                  .chain()\n                  .focus(null, { scrollIntoView: false })\n\n                if (href === '') {\n                  chain\n                    .setTextSelection({ from: selectionFrom, to: selectionTo })\n                    .unsetLink()\n                    .command(({ tr }) => {\n                      tr.setStoredMarks([])\n                      return true\n                    })\n                    .run()\n                  return\n                }\n\n                chain = chain\n                  .setTextSelection({ from: selectionFrom, to: selectionTo })\n                  .setLink({ href })\n                  .setTextSelection(selectionTo)\n                  .command(({ tr }) => {\n                    tr.setStoredMarks([])\n                    return true\n                  })\n\n                const posAfterLink = selectionTo\n                const charAfter =\n                  posAfterLink < doc.content.size\n                    ? doc.textBetween(posAfterLink, posAfterLink + 1)\n                    : null\n\n                if (charAfter === null || charAfter !== ' ') {\n                  chain = chain.insertContent(' ')\n                }\n\n                chain.run()\n              })\n              .catch(() => {})\n          }\n\n          if (shouldDelayPopover) {\n            requestAnimationFrame(showPopover)\n          } else {\n            showPopover()\n          }\n\n          return true\n        },\n    }\n  },\n\n  addKeyboardShortcuts() {\n    return {\n      'Mod-k': () => this.editor.commands.openLinkEditor(),\n    }\n  },\n\n  addProseMirrorPlugins() {\n    let plugins = this.parent?.() || []\n\n    plugins.push(\n      linkPasteHandler({\n        editor: this.editor,\n        defaultProtocol: this.options.defaultProtocol,\n        type: this.type,\n      }),\n    )\n\n    plugins.push(\n      clearLinkOnBoundaryPlugin({\n        editor: this.editor,\n        type: this.type,\n      }),\n    )\n\n    return plugins\n  },\n})\n\nfunction openLinkEditor(href: string, anchor: HTMLElement): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const container = document.createElement('div')\n    document.body.appendChild(container)\n\n    let virtualReference: {\n      getBoundingClientRect: () => DOMRect | { [key: string]: any }\n    }\n\n    const selection = window.getSelection()\n    if (selection && selection.rangeCount > 0) {\n      const range = selection.getRangeAt(0)\n      const rect = range.getBoundingClientRect()\n      const isCollapsed = range.collapsed\n\n      virtualReference = {\n        getBoundingClientRect: () => ({\n          width: 0,\n          height: rect.height,\n          top: rect.top,\n          right: isCollapsed ? rect.left : rect.right,\n          bottom: rect.bottom,\n          left: rect.left,\n          x: rect.left,\n          y: rect.top,\n          toJSON: () => {},\n        }),\n      }\n    } else {\n      virtualReference = {\n        getBoundingClientRect: () => anchor.getBoundingClientRect(),\n      }\n    }\n\n    let app: ReturnType<typeof createApp> | null = null\n    let tippyInstance: TippyInstance | null = null\n    let isDestroyed = false\n    let promiseSettled = false\n\n    const settlePromise = (action: 'resolve' | 'reject', value?: any) => {\n      if (promiseSettled) return\n      promiseSettled = true\n      if (action === 'resolve') {\n        resolve(value)\n      } else {\n        reject(value)\n      }\n    }\n\n    const destroy = () => {\n      if (isDestroyed) return\n      isDestroyed = true\n\n      settlePromise('reject', 'Link editing cancelled or destroyed')\n\n      requestAnimationFrame(() => {\n        tippyInstance?.destroy()\n        app?.unmount()\n        container?.remove()\n        app = null\n        tippyInstance = null\n      })\n    }\n\n    app = createApp({\n      render() {\n        return h(EditLink, {\n          href,\n          onClose: () => {\n            settlePromise('reject', 'Link editing cancelled')\n            destroy()\n          },\n          onUpdateHref: (newHref: string) => {\n            settlePromise('resolve', newHref)\n            destroy()\n          },\n        })\n      },\n    })\n\n    app.mount(container)\n\n    tippyInstance = tippy(anchor, {\n      getReferenceClientRect: () => virtualReference.getBoundingClientRect(),\n      content: container,\n      trigger: 'manual',\n      interactive: true,\n      appendTo: document.body,\n      placement: 'top',\n      arrow: false,\n      theme: 'link-editor',\n      maxWidth: 'none',\n      onHidden() {\n        destroy()\n      },\n      hideOnClick: true,\n      interactiveDebounce: 75,\n    })\n\n    if (!tippyInstance) {\n      container.remove()\n      settlePromise('reject', 'Failed to initialize link editor tooltip')\n      return\n    }\n\n    tippyInstance.show()\n  })\n}\n\nfunction clearLinkOnBoundaryPlugin(options: {\n  editor: Editor\n  type: MarkType\n}) {\n  return new Plugin({\n    key: new PluginKey('clearLinkMarkOnBoundary'),\n    appendTransaction: (transactions, oldState, newState) => {\n      if (!options.editor.isEditable) {\n        return null\n      }\n\n      const { tr, doc, selection, storedMarks } = newState\n      const { $from, empty } = selection\n\n      if (!empty || !storedMarks || storedMarks.length === 0) {\n        // Only apply for cursor selections and if there are stored marks\n        return null\n      }\n\n      const linkMarkType = options.type\n      const hasStoredLinkMark = storedMarks.some(\n        (mark) => mark.type === linkMarkType,\n      )\n\n      if (!hasStoredLinkMark) {\n        return null\n      }\n\n      // Check if the cursor position itself has an active link mark in the document\n      const marksAtCursor = $from.marks()\n      const activeLinkAtCursor = marksAtCursor.some(\n        (mark) => mark.type === linkMarkType,\n      )\n\n      if (activeLinkAtCursor) {\n        // If there's an actual link mark active in the document at the cursor,\n        // then it's correct for the stored mark to be there.\n        return null\n      }\n\n      // If we are here, it means:\n      // 1. Selection is a cursor (empty).\n      // 2. There's a stored link mark.\n      // 3. There's no active link mark in the document at the cursor position.\n      // This indicates the stored link mark should be cleared.\n      return tr.setStoredMarks([])\n    },\n  })\n}\n\nexport default LinkExtension\n","/**\n * Shared utilities for color conversion and mapping across text editor extensions\n */\n\n// Foreground/text color mappings (tailwind scale 600)\nexport const textColorHexMap: Record<string, string> = {\n  black: '#000000',\n  red: '#dc2626',\n  blue: '#1579D0',\n  green: '#16a34a',\n  yellow: '#ca8a04',\n  orange: '#ea580c',\n  purple: '#9333ea',\n  pink: '#db2777',\n  gray: '#6b7280',\n  indigo: '#4f46e5',\n  teal: '#0d9488',\n  cyan: '#06b6d4',\n}\n\n// Background/highlight color mappings (tailwind scale 100)\nexport const highlightColorHexMap: Record<string, string> = {\n  red: '#fecaca',\n  blue: '#bfdbfe',\n  green: '#bbf7d0',\n  yellow: '#fef08a',\n  orange: '#fed7aa',\n  purple: '#e9d5ff',\n  pink: '#fbcfe8',\n  gray: '#e5e7eb',\n  indigo: '#c7d2fe',\n  teal: '#99f6e4',\n  cyan: '#a5f3fc',\n}\n\n// Legacy color mappings for backward compatibility\nexport const legacyTextColorMap: Record<string, string> = {\n  '#1F272E': 'gray',\n  '#ca8a04': 'yellow',\n  '#ea580c': 'orange',\n  '#dc2626': 'red',\n  '#16a34a': 'green',\n  '#1579D0': 'blue',\n  '#9333ea': 'purple',\n  '#db2777': 'pink',\n}\n\nexport const legacyHighlightColorMap: Record<string, string> = {\n  '#fef9c3': 'yellow',\n  '#ffedd5': 'orange',\n  '#fee2e2': 'red',\n  '#dcfce7': 'green',\n  '#D3E9FC': 'blue',\n  '#f3e8ff': 'purple',\n  '#fce7f3': 'pink',\n}\n\n/**\n * Converts a hex or RGB color to the closest named color from our allowed list\n * @param color - Color to convert (e.g. \"#fee2e2\" or \"rgb(254, 226, 226)\")\n * @param allowedColors - List of allowed color names\n * @param colorMap - Map of color names to hex values to compare against\n * @param legacyMap - Optional legacy color mapping for exact matches\n * @returns The closest named color\n */\nexport function getClosestNamedColor(\n  color: string,\n  allowedColors: string[],\n  colorMap: Record<string, string>,\n  legacyMap?: Record<string, string>,\n): string | null {\n  // Check exact match first for quick returns\n  if (legacyMap && color.startsWith('#') && legacyMap[color]) {\n    return legacyMap[color]\n  }\n\n  // Parse the color to RGB values\n  let r = 0,\n    g = 0,\n    b = 0\n\n  // Handle hex format\n  if (color.startsWith('#')) {\n    const hex = color.substring(1)\n    if (hex.length === 6) {\n      r = parseInt(hex.substring(0, 2), 16)\n      g = parseInt(hex.substring(2, 4), 16)\n      b = parseInt(hex.substring(4, 6), 16)\n    }\n  }\n  // Handle rgb format\n  else if (color.startsWith('rgb')) {\n    const rgbMatch = /rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/i.exec(color)\n    if (rgbMatch) {\n      r = parseInt(rgbMatch[1], 10)\n      g = parseInt(rgbMatch[2], 10)\n      b = parseInt(rgbMatch[3], 10)\n    }\n  }\n\n  // Invalid color format\n  if (isNaN(r) || isNaN(g) || isNaN(b)) {\n    return null\n  }\n\n  let closestColor = null\n  let minDistance = Infinity\n\n  // Find the closest color by calculating the Euclidean distance in RGB space\n  for (const colorName of allowedColors) {\n    const namedHex = colorMap[colorName]\n    if (!namedHex) continue\n\n    const namedHexClean = namedHex.startsWith('#')\n      ? namedHex.substring(1)\n      : namedHex\n\n    if (namedHexClean.length !== 6) continue\n\n    const nr = parseInt(namedHexClean.substring(0, 2), 16)\n    const ng = parseInt(namedHexClean.substring(2, 4), 16)\n    const nb = parseInt(namedHexClean.substring(4, 6), 16)\n\n    // Calculate Euclidean distance\n    const distance = Math.sqrt(\n      Math.pow(r - nr, 2) + Math.pow(g - ng, 2) + Math.pow(b - nb, 2),\n    )\n\n    if (distance < minDistance) {\n      minDistance = distance\n      closestColor = colorName\n    }\n  }\n\n  return closestColor\n}\n\n/**\n * Extracts color from a style attribute and converts it to the closest named color\n * @param style - CSS style string (e.g., \"color: #ff0000; font-weight: bold;\")\n * @param allowedColors - List of allowed color names\n * @param colorMap - Map of color names to hex values\n * @param legacyMap - Optional legacy color mapping\n * @param property - CSS property to extract ('color' or 'background-color')\n * @returns The closest named color or null\n */\nexport function extractColorFromStyle(\n  style: string,\n  allowedColors: string[],\n  colorMap: Record<string, string> = textColorHexMap,\n  legacyMap: Record<string, string> = legacyTextColorMap,\n  property: string = 'color',\n): string | null {\n  const allColorsInMap = Object.keys(colorMap)\n\n  // Check for color in hex format\n  const hexColorMatch = new RegExp(`${property}:\\\\s*(#[0-9a-f]{6})`, 'i').exec(\n    style,\n  )\n  if (hexColorMatch && hexColorMatch[1]) {\n    const closestOverallColor = getClosestNamedColor(\n      hexColorMatch[1],\n      allColorsInMap, // Search in all colors from the map\n      colorMap,\n      legacyMap,\n    )\n    if (closestOverallColor) {\n      // Check if this color is in the originally passed 'allowedColors'\n      if (allowedColors.includes(closestOverallColor)) {\n        if (closestOverallColor === 'gray') {\n          return null // Special handling for gray\n        }\n        return closestOverallColor // It's the closest, allowed, and not gray\n      }\n      // If not in allowedColors, this match is invalid for the current context\n    }\n  }\n\n  // Check for color in rgb format\n  const rgbColorMatch = new RegExp(\n    `${property}:\\\\s*(rgb\\\\(\\\\s*\\\\d+\\\\s*,\\\\s*\\\\d+\\\\s*,\\\\s*\\\\d+\\\\s*\\\\))`,\n    'i',\n  ).exec(style)\n  if (rgbColorMatch && rgbColorMatch[1]) {\n    const closestOverallColor = getClosestNamedColor(\n      rgbColorMatch[1],\n      allColorsInMap, // Search in all colors from the map\n      colorMap,\n      legacyMap,\n    )\n    if (closestOverallColor) {\n      // Check if this color is in the originally passed 'allowedColors'\n      if (allowedColors.includes(closestOverallColor)) {\n        if (closestOverallColor === 'gray') {\n          return null // Special handling for gray\n        }\n        return closestOverallColor // It's the closest, allowed, and not gray\n      }\n      // If not in allowedColors, this match is invalid for the current context\n    }\n  }\n\n  return null\n}\n\n/**\n * Extracts text color from a style attribute\n */\nexport function extractTextColorFromStyle(\n  style: string,\n  allowedColors: string[],\n): string | null {\n  return extractColorFromStyle(\n    style,\n    allowedColors,\n    textColorHexMap,\n    legacyTextColorMap,\n    'color',\n  )\n}\n\n/**\n * Extracts background color from a style attribute for highlights\n */\nexport function extractHighlightColorFromStyle(\n  style: string,\n  allowedColors: string[],\n): string | null {\n  return extractColorFromStyle(\n    style,\n    allowedColors,\n    highlightColorHexMap,\n    legacyHighlightColorMap,\n    'background-color',\n  )\n}\n","import '@tiptap/extension-text-style'\n\nimport { Extension } from '@tiptap/core'\nimport { extractTextColorFromStyle } from '../shared/color-utils'\n\nexport type ColorOptions = {\n  /**\n   * The types where the color can be applied\n   * @default ['textStyle']\n   */\n  types: string[]\n\n  /**\n   * Available color names that can be used\n   * @default ['red', 'blue', 'green', 'yellow', 'orange', 'purple', 'pink', 'gray']\n   */\n  colors: string[]\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    namedColor: {\n      /**\n       * Set the text color by name\n       * @param colorName The named color to set (e.g., 'blue', 'red')\n       * @example editor.commands.setColorByName('blue')\n       */\n      setColorByName: (colorName: string) => ReturnType\n\n      /**\n       * Unset the text color\n       * @example editor.commands.unsetColor()\n       */\n      unsetColor: () => ReturnType\n    }\n  }\n}\n\n/**\n * This extension allows you to color your text using named colors instead of hex/rgb values.\n * Colors are applied as data attributes that can be styled with CSS for light/dark mode support.\n */\nexport const NamedColorExtension = Extension.create<ColorOptions>({\n  name: 'namedColor',\n\n  addOptions() {\n    return {\n      types: ['textStyle'],\n      colors: [\n        'red',\n        'blue',\n        'green',\n        'yellow',\n        'orange',\n        'purple',\n        'pink',\n        'gray',\n        'teal',\n        'cyan',\n      ],\n    }\n  },\n\n  addGlobalAttributes() {\n    return [\n      {\n        types: this.options.types,\n        attributes: {\n          color: {\n            default: null,\n            parseHTML: (element) => {\n              // Check for CSS custom property format in style attribute\n              const style = element.getAttribute('style')\n              if (style) {\n                const colorMatch = style.match(\n                  /color:\\s*var\\(--prose-color-(\\w+)\\)/,\n                )\n                if (colorMatch && this.options.colors.includes(colorMatch[1])) {\n                  return colorMatch[1]\n                }\n\n                // Fallback: try extracting from legacy formats\n                const extractedColor = extractTextColorFromStyle(\n                  style,\n                  this.options.colors,\n                )\n                if (extractedColor) {\n                  return extractedColor\n                }\n              }\n\n              return null\n            },\n            renderHTML: (attributes) => {\n              if (\n                !attributes.color ||\n                !this.options.colors.includes(attributes.color)\n              ) {\n                return {}\n              }\n              return {\n                style: `color: var(--prose-color-${attributes.color})`,\n              }\n            },\n          },\n        },\n      },\n    ]\n  },\n\n  addCommands() {\n    return {\n      setColorByName:\n        (colorName: string) =>\n        ({ chain, state, editor }) => {\n          // Validate that the color name is allowed\n          if (!this.options.colors.includes(colorName)) {\n            console.warn(\n              `Color \"${colorName}\" is not in the allowed colors list`,\n            )\n            return false\n          }\n\n          const { to, empty } = state.selection\n\n          let commandChain = chain().setMark('textStyle', { color: colorName })\n\n          if (!empty) {\n            commandChain = commandChain\n              .setTextSelection(to)\n              .command(({ tr }) => {\n                tr.setStoredMarks([])\n                return true\n              })\n          }\n\n          return commandChain.focus().run()\n        },\n      unsetColor:\n        () =>\n        ({ chain }) => {\n          return chain()\n            .setMark('textStyle', { color: null })\n            .removeEmptyTextStyle()\n            .run()\n        },\n    }\n  },\n})\n\nexport { NamedColorExtension as default }\n","import { Mark, mergeAttributes } from '@tiptap/core'\nimport {\n  getClosestNamedColor,\n  highlightColorHexMap,\n  legacyHighlightColorMap,\n  extractHighlightColorFromStyle,\n} from '../shared/color-utils'\n\nexport interface HighlightOptions {\n  /**\n   * HTML tag to wrap the highlighted text\n   * @default 'mark'\n   */\n  HTMLAttributes: Record<string, any>\n\n  /**\n   * Available highlight color names that can be used\n   * @default ['yellow', 'blue', 'green', 'red', 'orange', 'purple', 'pink', 'gray']\n   */\n  colors: string[]\n\n  /**\n   * Enable multiple highlight colors\n   * @default true\n   */\n  multicolor: boolean\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    namedHighlight: {\n      /**\n       * Set a highlight by color name\n       * @param colorName The named color to set (e.g., 'yellow', 'blue')\n       * @example editor.commands.setHighlightByName('yellow')\n       */\n      setHighlightByName: (colorName: string) => ReturnType\n      /**\n       * Toggle a highlight by color name\n       * @param colorName The named color to toggle (e.g., 'yellow', 'blue')\n       * @example editor.commands.toggleHighlightByName('yellow')\n       */\n      toggleHighlightByName: (colorName: string) => ReturnType\n      /**\n       * Unset the highlight\n       * @example editor.commands.unsetHighlight()\n       */\n      unsetHighlight: () => ReturnType\n    }\n  }\n}\n\n/**\n * This extension allows you to highlight your text using named colors instead of hex/rgb values.\n * Highlights are applied as data attributes that can be styled with CSS for light/dark mode support.\n */\nexport const NamedHighlightExtension = Mark.create<HighlightOptions>({\n  name: 'namedHighlight',\n\n  addOptions() {\n    return {\n      HTMLAttributes: {},\n      multicolor: true,\n      colors: [\n        'yellow',\n        'blue',\n        'green',\n        'red',\n        'orange',\n        'purple',\n        'pink',\n        'gray',\n        'teal',\n        'cyan',\n      ],\n    }\n  },\n\n  addAttributes() {\n    if (!this.options.multicolor) {\n      return {}\n    }\n\n    return {\n      color: {\n        default: null,\n        parseHTML: (element) => {\n          // Check for CSS custom property format in style attribute\n          const style = element.getAttribute('style')\n          if (style) {\n            const highlightMatch = style.match(\n              /background-color:\\s*var\\(--prose-highlight-(\\w+)\\)/,\n            )\n            if (\n              highlightMatch &&\n              this.options.colors.includes(highlightMatch[1])\n            ) {\n              return highlightMatch[1]\n            }\n          }\n\n          // Check for legacy format with data-color attribute (hex value)\n          const legacyColorAttr = element.getAttribute('data-color')\n          if (legacyColorAttr) {\n            const closestColor = getClosestNamedColor(\n              legacyColorAttr,\n              this.options.colors,\n              highlightColorHexMap,\n              legacyHighlightColorMap,\n            )\n            if (closestColor) {\n              return closestColor\n            }\n          }\n\n          // Try extracting from style attribute as fallback\n          if (style) {\n            const extractedColor = extractHighlightColorFromStyle(\n              style,\n              this.options.colors,\n            )\n            if (extractedColor) {\n              return extractedColor\n            }\n          }\n\n          return null\n        },\n        renderHTML: (attributes) => {\n          if (\n            !attributes.color ||\n            !this.options.colors.includes(attributes.color)\n          ) {\n            return {}\n          }\n\n          return {\n            style: `background-color: var(--prose-highlight-${attributes.color})`,\n          }\n        },\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'mark',\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      'mark',\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ]\n  },\n\n  addCommands() {\n    return {\n      setHighlightByName:\n        (colorName) =>\n        ({ chain, commands, editor, state }) => {\n          // Validate that the color name is allowed\n          if (!this.options.colors.includes(colorName)) {\n            console.warn(\n              `Highlight color \"${colorName}\" is not in the allowed colors list`,\n            )\n            return false\n          }\n\n          const { from, to, empty } = state.selection // Get original selection details\n\n          let commandChain = chain()\n          if (this.options.multicolor) {\n            commandChain = commandChain.setMark(this.name, { color: colorName })\n          } else {\n            commandChain = commandChain.setMark(this.name)\n          }\n\n          if (!empty) {\n            commandChain = commandChain\n              .setTextSelection(to)\n              .command(({ tr }) => {\n                tr.setStoredMarks([])\n                return true\n              })\n          }\n\n          return commandChain.focus().run()\n        },\n      toggleHighlightByName:\n        (colorName) =>\n        ({ chain, commands, editor, state }) => {\n          // Validate that the color name is allowed\n          if (!this.options.colors.includes(colorName)) {\n            console.warn(\n              `Highlight color \"${colorName}\" is not in the allowed colors list`,\n            )\n            return false\n          }\n\n          const { to, empty } = state.selection // Get original selection details\n          const highlightAttributes = this.options.multicolor\n            ? { color: colorName }\n            : undefined\n\n          // Check if the mark is currently active with the given attributes *before* toggling\n          // This helps determine if the toggle action will be setting or unsetting the mark.\n          const isCurrentlyActive = editor.isActive(\n            this.name,\n            highlightAttributes,\n          )\n\n          let commandChain = chain().toggleMark(this.name, highlightAttributes)\n\n          // If the selection was not empty AND the toggle action is about to *set* the mark\n          // (i.e., it wasn't active before)\n          if (!empty && !isCurrentlyActive) {\n            commandChain = commandChain\n              .setTextSelection(to)\n              .command(({ tr }) => {\n                tr.setStoredMarks([])\n                return true\n              })\n          }\n\n          return commandChain.focus().run()\n        },\n      unsetHighlight:\n        () =>\n        ({ commands }) => {\n          return commands.unsetMark(this.name)\n        },\n    }\n  },\n})\n\nexport { NamedHighlightExtension as default }\n","<template>\n  <node-view-wrapper>\n    <div class=\"code-block-container\">\n      <select\n        class=\"language-selector form-select py-0\"\n        contenteditable=\"false\"\n        v-model=\"selectedLanguage\"\n      >\n        <option :value=\"null\">auto</option>\n        <option disabled></option>\n        <option\n          v-for=\"(language, index) in languages\"\n          :value=\"language.value\"\n          :key=\"language.value\"\n        >\n          {{ language.label }}\n        </option>\n      </select>\n      <pre><code><node-view-content /></code></pre>\n    </div>\n  </node-view-wrapper>\n</template>\n\n<script>\nimport { NodeViewContent, nodeViewProps, NodeViewWrapper } from '@tiptap/vue-3'\n\nexport default {\n  components: {\n    NodeViewWrapper,\n    NodeViewContent,\n  },\n  props: nodeViewProps,\n  computed: {\n    selectedLanguage: {\n      get() {\n        return this.node.attrs.language\n      },\n      set(language) {\n        this.updateAttributes({ language })\n      },\n    },\n    languages() {\n      let supportedLanguages = this.extension.options.lowlight.listLanguages()\n      return supportedLanguages\n        .map((language) => {\n          return {\n            label: language,\n            value: language,\n          }\n        })\n        .concat([{ label: 'html', value: 'xml' }])\n        .sort((a, b) => a.label.localeCompare(b.label))\n    },\n  },\n}\n</script>\n\n<style>\n/* CodeBlock styles */\n.code-block {\n  position: relative;\n}\n\n.code-block-container {\n  position: relative;\n}\n\n.language-selector {\n  position: absolute;\n  top: 0.25rem;\n  right: 0.25rem;\n  padding-top: 0;\n  padding-bottom: 0;\n  opacity: 0;\n  z-index: 10;\n  transition-property: opacity;\n  transition-duration: 0.2s;\n  transition-timing-function: ease-in-out;\n  transition-delay: 0s;\n  pointer-events: none;\n}\n\n.code-block-container:hover .language-selector {\n  opacity: 1;\n  transition-delay: 0s;\n  pointer-events: auto;\n}\n\n.language-selector:focus-within {\n  opacity: 1;\n  transition-delay: 0s;\n  pointer-events: auto;\n}\n\n/* When mouse leaves the code block, delay the hiding */\n.code-block-container:not(:hover) .language-selector:not(:focus-within) {\n  transition-delay: 1.5s;\n}\n\n.ProseMirror pre {\n  background: #0d0d0d;\n  color: #fff;\n  font-family: ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono',\n    'Roboto Mono', 'Oxygen Mono', 'Ubuntu Mono', 'Source Code Pro', 'Fira Mono',\n    'Droid Sans Mono', 'Consolas', 'Courier New', monospace;\n  padding: 0.75rem 1rem;\n  border-radius: 0.75rem;\n  caret-color: #fff;\n}\n\n.ProseMirror pre code {\n  color: inherit;\n  padding: 0;\n  background: none;\n  font-size: 12px;\n}\n\n.ProseMirror pre .hljs-comment,\n.ProseMirror pre .hljs-quote {\n  color: #999;\n}\n\n.ProseMirror pre .hljs-variable,\n.ProseMirror pre .hljs-template-variable,\n.ProseMirror pre .hljs-attribute,\n.ProseMirror pre .hljs-tag,\n.ProseMirror pre .hljs-name,\n.ProseMirror pre .hljs-regexp,\n.ProseMirror pre .hljs-link,\n.ProseMirror pre .hljs-selector-id,\n.ProseMirror pre .hljs-selector-class {\n  color: #f2777a;\n}\n\n.ProseMirror pre .hljs-number,\n.ProseMirror pre .hljs-meta,\n.ProseMirror pre .hljs-built_in,\n.ProseMirror pre .hljs-builtin-name,\n.ProseMirror pre .hljs-literal,\n.ProseMirror pre .hljs-type,\n.ProseMirror pre .hljs-params {\n  color: #f99157;\n}\n\n.ProseMirror pre .hljs-string,\n.ProseMirror pre .hljs-symbol,\n.ProseMirror pre .hljs-bullet {\n  color: #99cc99;\n}\n\n.ProseMirror pre .hljs-title,\n.ProseMirror pre .hljs-section {\n  color: #ffcc66;\n}\n\n.ProseMirror pre .hljs-keyword,\n.ProseMirror pre .hljs-selector-tag {\n  color: #6196cc;\n}\n\n.ProseMirror pre .hljs-emphasis {\n  font-style: italic;\n}\n\n.ProseMirror pre .hljs-strong {\n  font-weight: 700;\n}\n</style>\n","import { Extension, Editor, Range } from '@tiptap/core'\nimport { VueRenderer } from '@tiptap/vue-3'\nimport Suggestion, {\n  SuggestionOptions,\n  SuggestionProps,\n} from '@tiptap/suggestion'\nimport { PluginKey } from '@tiptap/pm/state'\nimport tippy, { Instance as TippyInstance, Props as TippyProps } from 'tippy.js'\nimport { Component as VueComponent } from 'vue'\n\nexport interface BaseSuggestionItem {\n  title?: string\n  name?: string\n  [key: string]: any\n}\n\nexport interface CreateSuggestionExtensionOptions<\n  TItem extends BaseSuggestionItem,\n> {\n  name: string\n  char: string\n  pluginKey: PluginKey\n  items: (props: {\n    query: string\n    editor: Editor\n  }) => TItem[] | Promise<TItem[]>\n  command: (props: { editor: Editor; range: Range; props: TItem }) => void\n  component: VueComponent\n  tippyOptions?: Partial<TippyProps>\n  allowSpaces?: boolean\n  startOfLine?: boolean\n  decorationTag?: string\n  decorationClass?: string\n  addOptions?: () => Record<string, any>\n}\n\nexport function createSuggestionExtension<TItem extends BaseSuggestionItem>(\n  options: CreateSuggestionExtensionOptions<TItem>,\n) {\n  type ExtensionFullOptions = Record<string, any> & {\n    suggestion: Omit<SuggestionOptions<TItem>, 'editor'>\n  }\n\n  return Extension.create<ExtensionFullOptions>({\n    name: options.name,\n\n    addOptions() {\n      const customOptions = options.addOptions\n        ? options.addOptions.call(this)\n        : {}\n\n      return {\n        ...customOptions,\n        suggestion: {\n          char: options.char,\n          pluginKey: options.pluginKey,\n          items: options.items,\n          command: options.command,\n          allowSpaces: options.allowSpaces,\n          startOfLine: options.startOfLine,\n          decorationTag: options.decorationTag || 'span',\n          decorationClass: options.decorationClass || 'suggestion',\n          render: () => {\n            let component: VueRenderer | null\n            let popup: TippyInstance[] | null\n\n            return {\n              onStart: (props: SuggestionProps<TItem>) => {\n                component = new VueRenderer(options.component, {\n                  editor: props.editor,\n                  props: props,\n                })\n\n                if (!props.clientRect || !component.element) {\n                  return\n                }\n\n                const defaultTippyOptions: Partial<TippyProps> = {\n                  getReferenceClientRect: props.clientRect as () => DOMRect,\n                  appendTo: () => document.body,\n                  content: component.element,\n                  showOnCreate: true,\n                  interactive: true,\n                  trigger: 'manual',\n                  placement: 'bottom-start',\n                }\n\n                popup = tippy('body', {\n                  ...defaultTippyOptions,\n                  ...options.tippyOptions,\n                })\n              },\n\n              onUpdate(props: SuggestionProps<TItem>) {\n                component?.updateProps(props)\n\n                if (!props.clientRect) {\n                  return\n                }\n\n                if (popup && popup[0]) {\n                  popup[0].setProps({\n                    getReferenceClientRect: props.clientRect as () => DOMRect,\n                  })\n                }\n              },\n\n              onKeyDown(props: { event: KeyboardEvent }): boolean {\n                if (props.event.key === 'Escape') {\n                  if (popup && popup[0]) {\n                    popup[0].hide()\n                  }\n                  return true\n                }\n\n                if (\n                  component &&\n                  component.ref &&\n                  typeof (component.ref as any).onKeyDown === 'function'\n                ) {\n                  return (component.ref as any).onKeyDown(props)\n                }\n                return false\n              },\n\n              onExit() {\n                if (popup && popup[0]) {\n                  popup[0].destroy()\n                }\n                if (component) {\n                  component.destroy()\n                }\n                popup = null\n                component = null\n              },\n            }\n          },\n        } as Omit<SuggestionOptions<TItem>, 'editor'>,\n      }\n    },\n\n    addProseMirrorPlugins() {\n      return [\n        Suggestion<TItem>({\n          editor: this.editor,\n          ...this.options.suggestion,\n        }),\n      ]\n    },\n  })\n}\n","<template>\n  <div\n    v-if=\"items.length\"\n    ref=\"container\"\n    class=\"relative max-h-[300px] min-w-40 overflow-y-auto rounded-lg bg-surface-white p-1 text-base shadow-lg\"\n    :class=\"containerClass\"\n  >\n    <button\n      v-for=\"(item, index) in items\"\n      :key=\"index\"\n      :ref=\"\n        (el) => {\n          if (el) itemRefs[index] = el as HTMLButtonElement\n        }\n      \"\n      :class=\"[\n        'flex w-full items-center whitespace-nowrap rounded-md px-2 py-1.5 text-sm text-ink-gray-9',\n        index === selectedIndex ? 'bg-surface-gray-2' : '',\n        itemClass,\n      ]\"\n      @click=\"selectItem(index)\"\n      @mouseover=\"selectedIndex = index\"\n    >\n      <slot :item=\"item\" :index=\"index\">\n        <span>{{ item.display || item.title || item.name }}</span>\n      </slot>\n    </button>\n    <div\n      v-if=\"!items.length && showNoResults\"\n      class=\"px-3 py-1.5 text-sm text-ink-gray-5\"\n    >\n      No results\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, type PropType, nextTick, onBeforeUpdate } from 'vue'\nimport type { BaseSuggestionItem } from './createSuggestionExtension'\n\nconst props = defineProps({\n  items: {\n    type: Array as PropType<BaseSuggestionItem[]>,\n    required: true,\n  },\n  command: {\n    type: Function as PropType<(item: BaseSuggestionItem) => void>,\n    required: true,\n  },\n  containerClass: {\n    type: String,\n    default: '',\n  },\n  itemClass: {\n    type: String,\n    default: '',\n  },\n  showNoResults: {\n    type: Boolean,\n    default: false,\n  },\n})\n\nconst selectedIndex = ref(0)\nconst container = ref<HTMLDivElement | null>(null)\nconst itemRefs = ref<HTMLButtonElement[]>([])\n\nonBeforeUpdate(() => {\n  itemRefs.value = []\n})\n\nconst scrollIntoView = () => {\n  nextTick(() => {\n    const selectedElement = itemRefs.value[selectedIndex.value]\n    if (selectedElement) {\n      selectedElement.scrollIntoView({ block: 'nearest' })\n    }\n  })\n}\n\nconst selectItem = (index: number) => {\n  const item = props.items[index]\n  if (item) {\n    props.command(item)\n  }\n}\n\nconst onKeyDown = ({ event }: { event: KeyboardEvent }) => {\n  if (!props.items.length) return false\n\n  if (event.key === 'ArrowUp') {\n    upHandler()\n    return true\n  }\n  if (event.key === 'ArrowDown') {\n    downHandler()\n    return true\n  }\n  if (event.key === 'Enter') {\n    enterHandler()\n    return true\n  }\n  return false\n}\n\nconst upHandler = () => {\n  selectedIndex.value =\n    (selectedIndex.value + props.items.length - 1) % props.items.length\n  scrollIntoView()\n}\n\nconst downHandler = () => {\n  selectedIndex.value = (selectedIndex.value + 1) % props.items.length\n  scrollIntoView()\n}\n\nconst enterHandler = () => {\n  selectItem(selectedIndex.value)\n}\n\nwatch(\n  () => props.items,\n  () => {\n    selectedIndex.value = 0\n  },\n)\n\ndefineExpose({\n  onKeyDown,\n})\n</script>\n","import { MaybeRefOrGetter, toValue, type Component } from 'vue'\nimport { Extension, Node, mergeAttributes } from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-3'\nimport { PluginKey } from '@tiptap/pm/state'\nimport {\n  createSuggestionExtension,\n  BaseSuggestionItem,\n} from '../suggestion/createSuggestionExtension'\nimport SuggestionList from '../suggestion/SuggestionList.vue'\nimport './style.css'\n\nexport interface MentionSuggestionItem extends BaseSuggestionItem {\n  id: string\n  label: string\n  value?: string\n  email?: string\n  full_name?: string\n}\n\nfunction createMentionNode(component?: Component) {\n  const config: any = {\n    name: 'mention',\n    group: 'inline',\n    inline: true,\n    selectable: true,\n    atom: true,\n\n    addOptions() {\n      return {\n        component: undefined,\n      }\n    },\n\n    addAttributes() {\n      return {\n        id: {\n          default: null,\n          parseHTML: (element: HTMLElement) => element.getAttribute('data-id'),\n          renderHTML: (attributes: any) => {\n            if (!attributes.id) {\n              return {}\n            }\n            return { 'data-id': attributes.id }\n          },\n        },\n        label: {\n          default: null,\n          parseHTML: (element: HTMLElement) =>\n            element.getAttribute('data-label'),\n          renderHTML: (attributes: any) => {\n            if (!attributes.label) {\n              return {}\n            }\n            return { 'data-label': attributes.label }\n          },\n        },\n      }\n    },\n\n    parseHTML() {\n      return [\n        {\n          tag: 'span.mention[data-type=\"mention\"]',\n          getAttrs: (dom: any) => {\n            const element = dom as HTMLElement\n            return {\n              id: element.getAttribute('data-id'),\n              label: element.getAttribute('data-label'),\n            }\n          },\n        },\n      ]\n    },\n\n    renderHTML({ HTMLAttributes }: any) {\n      return [\n        'span',\n        mergeAttributes(HTMLAttributes, {\n          class: 'mention',\n          'data-type': 'mention',\n        }),\n        `@${HTMLAttributes['data-label'] || HTMLAttributes.id || ''}`,\n      ]\n    },\n  }\n\n  if (component) {\n    config.addNodeView = () => {\n      return VueNodeViewRenderer(component)\n    }\n  }\n\n  return Node.create(config)\n}\n\nconst MentionSuggestionExtension =\n  createSuggestionExtension<MentionSuggestionItem>({\n    name: 'mentionSuggestion',\n    char: '@',\n    pluginKey: new PluginKey('mentionSuggestion'),\n    component: SuggestionList,\n\n    addOptions() {\n      return {\n        mentions: [],\n      }\n    },\n\n    items: ({ query, editor }) => {\n      const { mentions: _mentions } = editor.extensionManager.extensions.find(\n        (ext) => ext.name === 'mentionSuggestion',\n      )!.options\n      const mentions = toValue(_mentions)\n\n      const filtered = mentions\n        .filter((mention: MentionSuggestionItem) =>\n          mention.label.toLowerCase().startsWith(query.toLowerCase()),\n        )\n        .slice(0, 10)\n        .map((mention: MentionSuggestionItem) => ({\n          ...mention,\n          display: mention.label,\n        }))\n\n      return filtered\n    },\n\n    command: ({ editor, range, props }) => {\n      const attributes = {\n        id: props.id || props.value,\n        label: props.label,\n      }\n\n      editor\n        .chain()\n        .focus()\n        .insertContentAt(range, [\n          {\n            type: 'mention',\n            attrs: attributes,\n          },\n          {\n            type: 'text',\n            text: ' ',\n          },\n        ])\n        .run()\n    },\n\n    tippyOptions: {\n      placement: 'bottom-start',\n      offset: [0, 8],\n    },\n    allowSpaces: false,\n    decorationTag: 'span',\n    decorationClass: 'mention-suggestion-active',\n  })\n\nexport const MentionExtension = Extension.create<{\n  mentions: MaybeRefOrGetter<MentionSuggestionItem[]>\n  component?: Component\n}>({\n  name: 'mentionExtension',\n\n  addOptions() {\n    return {\n      mentions: [],\n      component: undefined,\n    }\n  },\n\n  addExtensions() {\n    return [\n      createMentionNode(this.options.component),\n      MentionSuggestionExtension.configure({\n        mentions: this.options.mentions,\n      }),\n    ]\n  },\n})\n","<template>\n  <div class=\"inline-flex bg-surface-white px-1 py-1\">\n    <div class=\"inline-flex items-center gap-1\">\n      <template v-for=\"button in buttons\" :key=\"button.label\">\n        <div\n          class=\"h-4 w-[2px] border-l\"\n          v-if=\"button.type === 'separator'\"\n        ></div>\n        <div class=\"shrink-0\" v-else-if=\"button.map\">\n          <Popover>\n            <template #target=\"{ togglePopover }\">\n              <button\n                class=\"rounded px-2 py-1 text-base font-medium text-ink-gray-8 transition-colors hover:bg-surface-gray-2\"\n                @click=\"togglePopover\"\n                :set=\"\n                  activeBtn =\n                    button.find((b) => b.isActive(editor)) || button[0]\n                \"\n              >\n                <component\n                  v-if=\"activeBtn.icon\"\n                  :is=\"activeBtn.icon\"\n                  class=\"h-4 w-4\"\n                />\n                <span v-else>\n                  {{ activeBtn.label }}\n                </span>\n              </button>\n            </template>\n            <template #body=\"{ close }\">\n              <ul\n                class=\"p-1.5 mt-2 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none\"\n              >\n                <li\n                  v-for=\"option in button\"\n                  v-show=\"option.isDisabled ? !option.isDisabled(editor) : true\"\n                >\n                  <button\n                    class=\"w-full h-7 rounded px-2 text-base flex items-center gap-2 hover:bg-surface-gray-3\"\n                    @click=\"\n                      () => {\n                        onButtonClick(option)\n                        close()\n                      }\n                    \"\n                  >\n                    <component\n                      v-if=\"option.icon\"\n                      :is=\"option.icon\"\n                      class=\"size-4 flex-shrink-0 text-ink-gray-6\"\n                    />\n                    <span\n                      v-if=\"option.label\"\n                      class=\"whitespace-nowrap text-ink-gray-7\"\n                      >{{ option.label }}</span\n                    >\n                  </button>\n                </li>\n              </ul>\n            </template>\n          </Popover>\n        </div>\n        <component v-else :is=\"button.component || 'div'\" v-bind=\"{ editor }\">\n          <template v-slot=\"componentSlotProps\">\n            <button\n              class=\"flex rounded p-1 text-ink-gray-8 transition-colors\"\n              :class=\"[\n                button.isActive(editor) || componentSlotProps?.isActive\n                  ? 'bg-surface-gray-3'\n                  : 'hover:bg-surface-gray-2',\n                button.class,\n              ]\"\n              @click=\"\n                componentSlotProps?.onClick\n                  ? componentSlotProps.onClick(button)\n                  : onButtonClick(button)\n              \"\n              :title=\"button.label\"\n            >\n              <component v-if=\"button.icon\" :is=\"button.icon\" class=\"h-4 w-4\" />\n              <span\n                class=\"inline-block h-4 min-w-[1rem] text-sm leading-4\"\n                v-else\n              >\n                {{ button.text }}\n              </span>\n            </button>\n          </template>\n        </component>\n      </template>\n    </div>\n  </div>\n</template>\n<script>\nimport Popover from '../Popover/Popover.vue'\n\nexport default {\n  name: 'TipTapMenu',\n  props: ['buttons'],\n  inject: ['editor'],\n  components: {\n    Popover,\n  },\n  methods: {\n    onButtonClick(button) {\n      button.action(this.editor)\n    },\n  },\n}\n</script>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm8-12v12h-2v-9.796l-2 .536V8.67L19.5 8H21z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 4c2.071 0 3.75 1.679 3.75 3.75 0 .857-.288 1.648-.772 2.28l-.148.18L18.034 18H22v2h-7v-1.556l4.82-5.546c.268-.307.43-.709.43-1.148 0-.966-.784-1.75-1.75-1.75-.918 0-1.671.707-1.744 1.606l-.006.144h-2C14.75 9.679 16.429 8 18.5 8z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M22 8l-.002 2-2.505 2.883c1.59.435 2.757 1.89 2.757 3.617 0 2.071-1.679 3.75-3.75 3.75-1.826 0-3.347-1.305-3.682-3.033l1.964-.382c.156.806.866 1.415 1.718 1.415.966 0 1.75-.784 1.75-1.75s-.784-1.75-1.75-1.75c-.286 0-.556.069-.794.19l-1.307-1.547L19.35 10H15V8h7zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm9-12v8h1.5v2H22v2h-2v-2h-5.5v-1.34l5-8.66H22zm-2 3.133L17.19 16H20v-4.867z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M22 8v2h-4.323l-.464 2.636c.33-.089.678-.136 1.037-.136 2.21 0 4 1.79 4 4s-1.79 4-4 4c-1.827 0-3.367-1.224-3.846-2.897l1.923-.551c.24.836 1.01 1.448 1.923 1.448 1.105 0 2-.895 2-2s-.895-2-2-2c-.63 0-1.193.292-1.56.748l-1.81-.904L16 8h6zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M21.097 8l-2.598 4.5c2.21 0 4.001 1.79 4.001 4s-1.79 4-4 4-4-1.79-4-4c0-.736.199-1.426.546-2.019L18.788 8h2.309zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 10.5c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path d=\"M13 6v15h-2V6H5V4h14v2z\" fill=\"currentColor\" />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M8 3v9a4 4 0 1 0 8 0V3h2v9a6 6 0 1 1-12 0V3h2zM4 20h16v2H4v-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M17.154 14c.23.516.346 1.09.346 1.72 0 1.342-.524 2.392-1.571 3.147C14.88 19.622 13.433 20 11.586 20c-1.64 0-3.263-.381-4.87-1.144V16.6c1.52.877 3.075 1.316 4.666 1.316 2.551 0 3.83-.732 3.839-2.197a2.21 2.21 0 0 0-.648-1.603l-.12-.117H3v-2h18v2h-3.846zm-4.078-3H7.629a4.086 4.086 0 0 1-.481-.522C6.716 9.92 6.5 9.246 6.5 8.452c0-1.236.466-2.287 1.397-3.153C8.83 4.433 10.271 4 12.222 4c1.471 0 2.879.328 4.222.984v2.152c-1.2-.687-2.515-1.03-3.946-1.03-2.48 0-3.719.782-3.719 2.346 0 .42.218.786.654 1.099.436.313.974.562 1.613.75.62.18 1.297.414 2.03.699z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M3 4h18v2H3V4zm2 15h14v2H5v-2zm-2-5h18v2H3v-2zm2-5h14v2H5V9z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M3 4h18v2H3V4zm0 15h14v2H3v-2zm0-5h18v2H3v-2zm0-5h14v2H3V9z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M3 4h18v2H3V4zm4 15h14v2H7v-2zm-4-5h18v2H3v-2zm4-5h14v2H7V9z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M15.246 14H8.754l-1.6 4H5l6-15h2l6 15h-2.154l-1.6-4zm-.8-2L12 5.885 9.554 12h4.892zM3 20h18v2H3v-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M8 4h13v2H8V4zM5 3v3h1v1H3V6h1V4H3V3h2zM3 14v-2.5h2V11H3v-1h3v2.5H4v.5h2v1H3zm2 5.5H3v-1h2V18H3v-1h3v4H3v-1h2v-.5zM8 11h13v2H8v-2zm0 7h13v2H8v-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M8 4h13v2H8V4zM4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 6.9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM8 11h13v2H8v-2zm0 7h13v2H8v-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"24\"\n    height=\"24\"\n    viewBox=\"0 0 24 24\"\n    fill=\"none\"\n    stroke=\"currentColor\"\n    stroke-width=\"2\"\n    stroke-linecap=\"round\"\n    stroke-linejoin=\"round\"\n    class=\"lucide lucide-list-checks-icon lucide-list-checks\"\n  >\n    <path d=\"m3 17 2 2 4-4\" />\n    <path d=\"m3 7 2 2 4-4\" />\n    <path d=\"M13 6h8\" />\n    <path d=\"M13 12h8\" />\n    <path d=\"M13 18h8\" />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M19.417 6.679C20.447 7.773 21 9 21 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311-1.804-.167-3.226-1.648-3.226-3.489a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179zm-10 0C10.447 7.773 11 9 11 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311C4.591 12.322 3.17 10.841 3.17 9a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M16.95 8.464l1.414-1.414 4.95 4.95-4.95 4.95-1.414-1.414L20.485 12 16.95 8.464zm-9.9 0L3.515 12l3.535 3.536-1.414 1.414L.686 12l4.95-4.95L7.05 8.464z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M21 15v3h3v2h-3v3h-2v-3h-3v-2h3v-3h2zm.008-12c.548 0 .992.445.992.993V13h-2V5H4v13.999L14 9l3 3v2.829l-3-3L6.827 19H14v2H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016zM8 7a2 2 0 1 1 0 4 2 2 0 0 1 0-4z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0H24V24H0z\" />\n    <path\n      d=\"M16 4c.552 0 1 .448 1 1v4.2l5.213-3.65c.226-.158.538-.103.697.124.058.084.09.184.09.286v12.08c0 .276-.224.5-.5.5-.103 0-.203-.032-.287-.09L17 14.8V19c0 .552-.448 1-1 1H2c-.552 0-1-.448-1-1V5c0-.552.448-1 1-1h14zm-1 2H3v12h12V6zM8 8h2v3h3v2H9.999L10 16H8l-.001-3H5v-2h3V8zm13 .841l-4 2.8v.718l4 2.8V8.84z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M5.828 7l2.536 2.536L6.95 10.95 2 6l4.95-4.95 1.414 1.414L5.828 5H13a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H5.828z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M18.172 7H11a6 6 0 1 0 0 12h9v2h-9a8 8 0 1 1 0-16h7.172l-2.536-2.536L17.05 1.05 22 6l-4.95 4.95-1.414-1.414L18.172 7z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M2 11h2v2H2v-2zm4 0h12v2H6v-2zm14 0h2v2h-2v-2z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","<template>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 24 24\"\n    width=\"24\"\n    height=\"24\"\n  >\n    <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n    <path\n      d=\"M13 10v4h6v-4h-6zm-2 0H5v4h6v-4zm2 9h6v-3h-6v3zm-2 0v-3H5v3h6zm2-14v3h6V5h-6zm-2 0H5v3h6V5zM4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z\"\n      fill=\"currentColor\"\n    />\n  </svg>\n</template>\n","import { defineAsyncComponent } from 'vue'\nimport H1 from './icons/h-1.vue'\nimport H2 from './icons/h-2.vue'\nimport H3 from './icons/h-3.vue'\nimport H4 from './icons/h-4.vue'\nimport H5 from './icons/h-5.vue'\nimport H6 from './icons/h-6.vue'\nimport Text from './icons/text.vue'\nimport Bold from './icons/bold.vue'\nimport Italic from './icons/italic.vue'\nimport Underline from './icons/underline.vue'\nimport Strikethrough from './icons/strikethrough.vue'\nimport AlignCenter from './icons/align-center.vue'\nimport AlignLeft from './icons/align-left.vue'\nimport AlignRight from './icons/align-right.vue'\nimport FontColor from './icons/font-color.vue'\nimport ListOrdered from './icons/list-ordered.vue'\nimport ListUnordered from './icons/list-unordered.vue'\nimport ListTask from './icons/list-task.vue'\nimport DoubleQuotes from './icons/double-quotes-r.vue'\nimport CodeView from './icons/code-view.vue'\nimport Link from './icons/link.vue'\nimport Image from './icons/image-add-line.vue'\nimport Video from './icons/video-add-line.vue'\nimport GalleryVertical from '~icons/lucide/gallery-vertical'\nimport ArrowGoBack from './icons/arrow-go-back-line.vue'\nimport ArrowGoForward from './icons/arrow-go-forward-line.vue'\nimport Separator from './icons/separator.vue'\nimport Table from './icons/table-2.vue'\n\nexport default {\n  Paragraph: {\n    label: 'Paragraph',\n    icon: Text,\n    action: (editor) => editor.chain().focus().setParagraph().run(),\n    isActive: (editor) => editor.isActive('paragraph'),\n  },\n  'Heading 1': {\n    label: 'Heading 1',\n    text: 'H1',\n    icon: H1,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 1 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 1 }),\n  },\n  'Heading 2': {\n    label: 'Heading 2',\n    text: 'H2',\n    icon: H2,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 2 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 2 }),\n  },\n  'Heading 3': {\n    label: 'Heading 3',\n    text: 'H3',\n    icon: H3,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 3 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 3 }),\n  },\n  'Heading 4': {\n    label: 'Heading 4',\n    text: 'H4',\n    icon: H4,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 4 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 4 }),\n  },\n  'Heading 5': {\n    label: 'Heading 5',\n    text: 'H5',\n    icon: H5,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 5 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 5 }),\n  },\n  'Heading 6': {\n    label: 'Heading 6',\n    text: 'H6',\n    icon: H6,\n    action: (editor) =>\n      editor.chain().focus().toggleHeading({ level: 6 }).run(),\n    isActive: (editor) => editor.isActive('heading', { level: 6 }),\n  },\n  Bold: {\n    label: 'Bold',\n    icon: Bold,\n    action: (editor) => editor.chain().focus().toggleBold().run(),\n    isActive: (editor) => editor.isActive('bold'),\n  },\n  Italic: {\n    label: 'Italic',\n    icon: Italic,\n    action: (editor) => editor.chain().focus().toggleItalic().run(),\n    isActive: (editor) => editor.isActive('italic'),\n  },\n  Underline: {\n    label: 'Underline',\n    icon: Underline,\n    action: (editor) => editor.chain().focus().toggleUnderline().run(),\n    isActive: (editor) => editor.isActive('underline'),\n  },\n  Strikethrough: {\n    label: 'Strikethrough',\n    icon: Strikethrough,\n    action: (editor) => editor.chain().focus().toggleStrike().run(),\n    isActive: (editor) => editor.isActive('strike'),\n  },\n  'Bullet List': {\n    label: 'Bullet List',\n    icon: ListUnordered,\n    action: (editor) => editor.chain().focus().toggleBulletList().run(),\n    isActive: (editor) => editor.isActive('bulletList'),\n  },\n  'Numbered List': {\n    label: 'Numbered List',\n    icon: ListOrdered,\n    action: (editor) => editor.chain().focus().toggleOrderedList().run(),\n    isActive: (editor) => editor.isActive('orderedList'),\n  },\n  'Task List': {\n    label: 'Task List',\n    icon: ListTask,\n    action: (editor) => editor.chain().focus().toggleTaskList().run(),\n    isActive: (editor) => editor.isActive('taskList'),\n  },\n  'Align Center': {\n    label: 'Align Center',\n    icon: AlignCenter,\n    action: (editor) => editor.chain().focus().setTextAlign('center').run(),\n    isActive: (editor) => editor.isActive({ textAlign: 'center' }),\n  },\n  'Align Left': {\n    label: 'Align Left',\n    icon: AlignLeft,\n    action: (editor) => editor.chain().focus().setTextAlign('left').run(),\n    isActive: (editor) => editor.isActive({ textAlign: 'left' }),\n  },\n  'Align Right': {\n    label: 'Align Right',\n    icon: AlignRight,\n    action: (editor) => editor.chain().focus().setTextAlign('right').run(),\n    isActive: (editor) => editor.isActive({ textAlign: 'right' }),\n  },\n  FontColor: {\n    label: 'Font Color',\n    icon: FontColor,\n    isActive: (editor) =>\n      editor.isActive('textStyle') || editor.isActive('highlight'),\n    component: defineAsyncComponent(() => import('./FontColor.vue')),\n  },\n  Blockquote: {\n    label: 'Blockquote',\n    icon: DoubleQuotes,\n    action: (editor) => editor.chain().focus().toggleBlockquote().run(),\n    isActive: (editor) => editor.isActive('blockquote'),\n  },\n  Code: {\n    label: 'Code',\n    icon: CodeView,\n    action: (editor) => editor.chain().focus().toggleCodeBlock().run(),\n    isActive: (editor) => editor.isActive('codeBlock'),\n  },\n  'Horizontal Rule': {\n    label: 'Horizontal Rule',\n    icon: Separator,\n    action: (editor) => editor.chain().focus().setHorizontalRule().run(),\n    isActive: (editor) => false,\n  },\n  Link: {\n    label: 'Link',\n    icon: Link,\n    isActive: (editor) => editor.isActive('link'),\n    component: defineAsyncComponent(() => import('./InsertLink.vue')),\n  },\n  Image: {\n    label: 'Image',\n    icon: Image,\n    isActive: (editor) => false,\n    component: defineAsyncComponent(() => import('./InsertImage.vue')),\n  },\n  Video: {\n    label: 'Video',\n    icon: Video,\n    isActive: (editor) => false,\n    component: defineAsyncComponent(() => import('./InsertVideo.vue')),\n  },\n  Iframe: {\n    label: 'Embed',\n    icon: GalleryVertical,\n    isActive: (editor) => editor.isActive('iframe'),\n    component: defineAsyncComponent(() => import('./extensions/iframe/InsertIframe.vue')),\n  },\n  Undo: {\n    label: 'Undo',\n    icon: ArrowGoBack,\n    action: (editor) => editor.chain().focus().undo().run(),\n    isActive: (editor) => false,\n  },\n  Redo: {\n    label: 'Redo',\n    icon: ArrowGoForward,\n    action: (editor) => editor.chain().focus().redo().run(),\n    isActive: (editor) => false,\n  },\n  InsertTable: {\n    label: 'Insert Table',\n    icon: Table,\n    action: (editor) =>\n      editor\n        .chain()\n        .focus()\n        .insertTable({ rows: 3, cols: 3, withHeaderRow: true })\n        .run(),\n    isActive: (editor) => false,\n  },\n  AddColumnBefore: {\n    label: 'Add Column Before',\n    action: (editor) => editor.chain().focus().addColumnBefore().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().addColumnBefore(),\n  },\n  AddColumnAfter: {\n    label: 'Add Column After',\n    action: (editor) => editor.chain().focus().addColumnAfter().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().addColumnAfter(),\n  },\n  DeleteColumn: {\n    label: 'Delete Column',\n    action: (editor) => editor.chain().focus().deleteColumn().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().deleteColumn(),\n  },\n  AddRowBefore: {\n    label: 'Add Row Before',\n    action: (editor) => editor.chain().focus().addRowBefore().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().addRowBefore(),\n  },\n  AddRowAfter: {\n    label: 'Add Row After',\n    action: (editor) => editor.chain().focus().addRowAfter().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().addRowAfter(),\n  },\n  DeleteRow: {\n    label: 'Delete Row',\n    action: (editor) => editor.chain().focus().deleteRow().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().deleteRow(),\n  },\n  DeleteTable: {\n    label: 'Delete Table',\n    action: (editor) => editor.chain().focus().deleteTable().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().deleteTable(),\n  },\n  MergeCells: {\n    label: 'Merge Cells',\n    action: (editor) => editor.chain().focus().mergeCells().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().mergeCells(),\n  },\n  SplitCell: {\n    label: 'Split Cell',\n    action: (editor) => editor.chain().focus().splitCell().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().splitCell(),\n  },\n  ToggleHeaderColumn: {\n    label: 'Toggle Header Column',\n    action: (editor) => editor.chain().focus().toggleHeaderColumn().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().toggleHeaderColumn(),\n  },\n  ToggleHeaderRow: {\n    label: 'Toggle Header Row',\n    action: (editor) => editor.chain().focus().toggleHeaderRow().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().toggleHeaderRow(),\n  },\n  ToggleHeaderCell: {\n    label: 'Toggle Header Cell',\n    action: (editor) => editor.chain().focus().toggleHeaderCell().run(),\n    isActive: (editor) => false,\n    isDisabled: (editor) => !editor.can().toggleHeaderCell(),\n  },\n  Separator: {\n    type: 'separator',\n  },\n}\n","import commands from './commands'\n\nexport function createEditorButton(option) {\n  if (option instanceof Array) {\n    return option.map(createEditorButton)\n  }\n  if (typeof option == 'object') {\n    return option\n  }\n  return commands[option]\n}\n","<template>\n  <Menu v-if=\"fixedMenuButtons\" :buttons=\"fixedMenuButtons\" />\n</template>\n<script>\nimport Menu from './Menu.vue'\nimport { createEditorButton } from './utils'\n\nexport default {\n  name: 'TextEditorFixedMenu',\n  props: ['buttons'],\n  components: { Menu },\n  inject: ['editor'],\n  computed: {\n    fixedMenuButtons() {\n      if (!this.buttons) return false\n      let buttons\n      if (Array.isArray(this.buttons)) {\n        buttons = this.buttons\n      } else {\n        buttons = [\n          [\n            'Heading 1',\n            'Heading 2',\n            'Heading 3',\n            'Heading 4',\n            'Heading 5',\n            'Heading 6',\n          ],\n          'Paragraph',\n          'Separator',\n          'Bold',\n          'Italic',\n          'Separator',\n          'Bullet List',\n          'Numbered List',\n          'Task List',\n          'Separator',\n          'Align Left',\n          'Align Center',\n          'Align Right',\n          'FontColor',\n          'Separator',\n          'Image',\n          'Video',\n          'Iframe',\n          'Link',\n          'Blockquote',\n          'Code',\n          'Horizontal Rule',\n          [\n            'InsertTable',\n            'AddColumnBefore',\n            'AddColumnAfter',\n            'DeleteColumn',\n            'AddRowBefore',\n            'AddRowAfter',\n            'DeleteRow',\n            'MergeCells',\n            'SplitCell',\n            'ToggleHeaderColumn',\n            'ToggleHeaderRow',\n            'ToggleHeaderCell',\n            'DeleteTable',\n          ],\n          'Separator',\n          'Undo',\n          'Redo',\n        ]\n      }\n      return buttons.map(createEditorButton)\n    },\n  },\n}\n</script>\n","<template>\n  <BubbleMenu\n    v-if=\"bubbleMenuButtons\"\n    class=\"bubble-menu rounded-md shadow-sm\"\n    :tippy-options=\"{ duration: 100 }\"\n    :editor=\"editor\"\n    v-bind=\"options\"\n  >\n    <Menu\n      class=\"rounded-md border-gray-100 shadow-lg\"\n      :buttons=\"bubbleMenuButtons\"\n    />\n  </BubbleMenu>\n</template>\n<script>\nimport { BubbleMenu } from '@tiptap/vue-3'\nimport { createEditorButton } from './utils'\nimport Menu from './Menu.vue'\n\nexport default {\n  name: 'TextEditorBubbleMenu',\n  props: ['buttons', 'options'],\n  components: { BubbleMenu, Menu },\n  inject: ['editor'],\n  computed: {\n    bubbleMenuButtons() {\n      if (!this.buttons) return false\n\n      let buttons\n      if (Array.isArray(this.buttons)) {\n        buttons = this.buttons\n      } else {\n        buttons = [\n          'Paragraph',\n          'Heading 2',\n          'Heading 3',\n          'Separator',\n          'Bold',\n          'Italic',\n          'Strikethrough',\n          'FontColor',\n          'Link',\n          'Separator',\n          'Bullet List',\n          'Numbered List',\n          'Task List',\n          'Separator',\n          'Align Left',\n          'Align Center',\n          'Align Right',\n          'Separator',\n          'Image',\n          'Video',\n          'Blockquote',\n          'Code',\n          [\n            'InsertTable',\n            'AddColumnBefore',\n            'AddColumnAfter',\n            'DeleteColumn',\n            'AddRowBefore',\n            'AddRowAfter',\n            'DeleteRow',\n            'MergeCells',\n            'SplitCell',\n            'ToggleHeaderColumn',\n            'ToggleHeaderRow',\n            'ToggleHeaderCell',\n            'DeleteTable',\n          ],\n        ]\n      }\n      return buttons.map(createEditorButton)\n    },\n  },\n}\n</script>\n","<template>\n  <FloatingMenu\n    v-if=\"floatingMenuButtons\"\n    :tippy-options=\"{ duration: 100 }\"\n    :editor=\"editor\"\n    class=\"flex\"\n  >\n    <button\n      v-for=\"button in floatingMenuButtons\"\n      :key=\"button.label\"\n      class=\"flex rounded p-1 text-ink-gray-8 transition-colors\"\n      :class=\"\n        button.isActive(editor)\n          ? 'bg-surface-gray-2'\n          : 'hover:bg-surface-gray-2'\n      \"\n      @click=\"() => button.action(editor)\"\n      :title=\"button.label\"\n    >\n      <component v-if=\"button.icon\" :is=\"button.icon\" class=\"h-4 w-4\" />\n      <span class=\"inline-block h-4 min-w-[1rem] text-sm leading-4\" v-else>\n        {{ button.text }}\n      </span>\n    </button>\n  </FloatingMenu>\n</template>\n<script>\nimport { FloatingMenu } from '@tiptap/vue-3'\nimport { createEditorButton } from './utils'\n\nexport default {\n  name: 'TextEditorFloatingMenu',\n  props: ['buttons'],\n  components: { FloatingMenu },\n  inject: ['editor'],\n  computed: {\n    floatingMenuButtons() {\n      if (!this.buttons) return false\n\n      let buttons\n      if (Array.isArray(this.buttons)) {\n        buttons = this.buttons\n      } else {\n        buttons = [\n          'Paragraph',\n          'Heading 2',\n          'Heading 3',\n          'Bullet List',\n          'Numbered List',\n          'Task List',\n          'Blockquote',\n          'Code',\n          'Horizontal Rule',\n        ]\n      }\n      return buttons.map(createEditorButton)\n    },\n  },\n}\n</script>\n","<template>\n  <SuggestionList\n    ref=\"suggestionList\"\n    :items=\"items\"\n    :command=\"(item) => onItemSelect(item as EmojiItem)\"\n    item-class=\"py-2\"\n  >\n    <template #default=\"{ item }\">\n      <span class=\"mr-2\">{{ item.emoji }}</span>\n      <span>{{ item.name }}</span>\n    </template>\n  </SuggestionList>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, type PropType } from 'vue'\nimport SuggestionList from '../suggestion/SuggestionList.vue'\nimport type { Editor, Range } from '@tiptap/core'\nimport type { EmojiItem } from './emoji-extension'\n\nconst props = defineProps({\n  items: {\n    type: Array as PropType<EmojiItem[]>,\n    required: true,\n  },\n  editor: {\n    type: Object as PropType<Editor>,\n    required: true,\n  },\n  range: {\n    type: Object as PropType<Range>,\n    required: true,\n  },\n  command: {\n    type: Function as PropType<(item: EmojiItem) => void>,\n    required: true,\n  },\n})\n\nconst suggestionList = ref<InstanceType<typeof SuggestionList> | null>(null)\n\nconst onItemSelect = (item: EmojiItem) => {\n  if (item) {\n    props.command(item)\n  }\n}\n\nconst onKeyDown = ({ event }: { event: KeyboardEvent }) => {\n  return suggestionList.value?.onKeyDown({ event }) ?? false\n}\n\ndefineExpose({\n  onKeyDown,\n})\n</script>\n","import { PluginKey } from '@tiptap/pm/state'\nimport {\n  BaseSuggestionItem,\n  createSuggestionExtension,\n} from '../suggestion/createSuggestionExtension'\nimport EmojiList from './EmojiList.vue'\nimport _EMOJIS from './emojis.json'\n\nconst EMOJIS = _EMOJIS as EmojiItem[]\n\nexport interface EmojiItem extends BaseSuggestionItem {\n  name: string\n  emoji: string\n}\n\nexport default createSuggestionExtension<EmojiItem>({\n  name: 'emoji',\n  char: ':',\n  pluginKey: new PluginKey('emojiSuggestion'),\n  items: ({ query }: { query: string }) => {\n    return EMOJIS.filter((item) =>\n      item.name.toLowerCase().includes(query.toLowerCase()),\n    )\n      .sort((a, b) => {\n        const aName = a.name.toLowerCase()\n        const bName = b.name.toLowerCase()\n        const queryLower = query.toLowerCase()\n\n        // Exact matches first\n        if (aName === queryLower && bName !== queryLower) return -1\n        if (bName === queryLower && aName !== queryLower) return 1\n\n        // Then names starting with the query\n        if (aName.startsWith(queryLower) && !bName.startsWith(queryLower))\n          return -1\n        if (bName.startsWith(queryLower) && !aName.startsWith(queryLower))\n          return 1\n\n        // Then sort by name length (shorter first)\n        return aName.length - bName.length\n      })\n      .slice(0, 5)\n  },\n  command: ({ editor, range, props: item }) => {\n    if (item && item.emoji) {\n      editor.chain().focus().deleteRange(range).insertContent(item.emoji).run()\n    } else {\n      console.error(\n        'Emoji command execution error: emoji property not found on selected item or item is invalid.',\n        item,\n      )\n    }\n  },\n  component: EmojiList,\n})\n","<template>\n  <SuggestionList\n    ref=\"suggestionList\"\n    :items=\"props.items\"\n    :command=\"(item) => onItemSelect(item as CommandItem)\"\n    container-class=\"min-w-48\"\n    item-class=\"h-7\"\n    :show-no-results=\"true\"\n  >\n    <template #default=\"{ item }\">\n      <component :is=\"item.icon\" v-if=\"item.icon\" class=\"mr-2 h-4 w-4\" />\n      <div v-else class=\"mr-2 h-4 w-4\"></div>\n      <span>{{ item.title }}</span>\n    </template>\n  </SuggestionList>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, type PropType } from 'vue'\nimport SuggestionList from '../suggestion/SuggestionList.vue'\nimport type { Editor, Range } from '@tiptap/core'\nimport type { CommandItem } from './slash-commands-extension'\n\nconst props = defineProps({\n  items: {\n    type: Array as PropType<CommandItem[]>,\n    required: true,\n  },\n  editor: {\n    type: Object as PropType<Editor>,\n    required: true,\n  },\n  range: {\n    type: Object as PropType<Range>,\n    required: true,\n  },\n  command: {\n    type: Function as PropType<(item: CommandItem) => void>,\n    required: true,\n  },\n  query: String,\n})\n\nconst suggestionList = ref<InstanceType<typeof SuggestionList> | null>(null)\n\nconst onItemSelect = (item: CommandItem) => {\n  if (item) {\n    props.command(item)\n  }\n}\n\nconst onKeyDown = ({ event }: { event: KeyboardEvent }) => {\n  return suggestionList.value?.onKeyDown({ event }) ?? false\n}\n\ndefineExpose({\n  onKeyDown,\n})\n</script>\n","import { Editor, Range } from '@tiptap/core'\nimport { PluginKey } from '@tiptap/pm/state'\nimport {\n  createSuggestionExtension,\n  type BaseSuggestionItem,\n} from '../suggestion/createSuggestionExtension'\nimport SlashCommandsList from './SlashCommandsList.vue'\nimport { Component as VueComponent } from 'vue'\n\nimport Heading2 from '~icons/lucide/heading-2'\nimport Heading3 from '~icons/lucide/heading-3'\nimport List from '~icons/lucide/list'\nimport ListOrdered from '~icons/lucide/list-ordered'\nimport ListTask from '~icons/lucide/list-checks'\nimport Code from '~icons/lucide/code'\nimport Quote from '~icons/lucide/quote'\nimport Image from '~icons/lucide/image'\nimport Video from '~icons/lucide/video'\nimport GalleryVertical from '~icons/lucide/gallery-vertical'\nimport Link from '~icons/lucide/link'\nimport Minus from '~icons/lucide/minus'\nimport Table from '~icons/lucide/table-2'\n\nexport const SlashCommandSuggestionKey = new PluginKey<any>(\n  'slashCommandSuggestion',\n)\n\nexport interface CommandItem extends BaseSuggestionItem {\n  title: string\n  icon: VueComponent\n  command: (props: CommandExecutionProps) => void\n}\n\ntype CommandExecutionProps = {\n  editor: Editor\n  range: Range\n}\n\nconst getCommands = (): CommandItem[] => [\n  {\n    title: 'Heading 2',\n    icon: Heading2,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor\n        .chain()\n        .focus()\n        .deleteRange(range)\n        .setNode('heading', { level: 2 })\n        .run()\n    },\n  },\n  {\n    title: 'Heading 3',\n    icon: Heading3,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor\n        .chain()\n        .focus()\n        .deleteRange(range)\n        .setNode('heading', { level: 3 })\n        .run()\n    },\n  },\n  {\n    title: 'Bullet List',\n    icon: List,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).toggleBulletList().run()\n    },\n  },\n  {\n    title: 'Numbered List',\n    icon: ListOrdered,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).toggleOrderedList().run()\n    },\n  },\n  {\n    title: 'Task List',\n    icon: ListTask,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).toggleTaskList().run()\n    },\n  },\n  {\n    title: 'Code Block',\n    icon: Code,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).toggleCodeBlock().run()\n    },\n  },\n  {\n    title: 'Blockquote',\n    icon: Quote,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).toggleBlockquote().run()\n    },\n  },\n  {\n    title: 'Image',\n    icon: Image,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).selectAndUploadImage().run()\n    },\n  },\n  {\n    title: 'Video',\n    icon: Video,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).selectAndUploadVideo().run()\n    },\n  },\n  {\n    title: 'Embed',\n    icon: GalleryVertical,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).openIframeDialog().run()\n    },\n  },\n  {\n    title: 'Link',\n    icon: Link,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).setLink({ href: '' }).run()\n    },\n  },\n  {\n    title: 'Horizontal Rule',\n    icon: Minus,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor.chain().focus().deleteRange(range).setHorizontalRule().run()\n    },\n  },\n  {\n    title: 'Table',\n    icon: Table,\n    command: ({ editor, range }: CommandExecutionProps) => {\n      editor\n        .chain()\n        .focus()\n        .deleteRange(range)\n        .insertTable({ rows: 3, cols: 3, withHeaderRow: true })\n        .run()\n    },\n  },\n]\n\nexport const SlashCommands = createSuggestionExtension<CommandItem>({\n  name: 'slashCommands',\n  char: '/',\n  pluginKey: SlashCommandSuggestionKey,\n  items: ({ query }) => {\n    const commands = getCommands()\n    return commands.filter((item) =>\n      item.title.toLowerCase().startsWith(query.toLowerCase()),\n    )\n  },\n  command: ({ editor, range, props: item }) => {\n    if (item && typeof item.command === 'function') {\n      item.command({ editor, range })\n    } else {\n      console.error(\n        'Slash command execution error: command function not found on selected item or item is invalid.',\n        item,\n      )\n    }\n  },\n  component: SlashCommandsList,\n})\n\nexport default SlashCommands\n","import { marked } from 'marked'\n\nexport function markdownToHTML(text: string): string {\n  // Use synchronous marked.parse\n  return marked.parse(text, {\n    gfm: true,\n    breaks: true,\n    async: false,\n  }) as string\n}\n\nexport function detectMarkdown(text: string): boolean {\n  const lines = text.split('\\n')\n  const markdown = lines.filter(\n    (line) =>\n      // check for inline markdown content like images, links, italic, bold, etc.\n      /!\\[.*\\]\\(.*\\)/.test(line) ||\n      /\\[.*\\]\\(.*\\)/.test(line) ||\n      /(^|\\s)\\*.*\\*(\\s|$)/.test(line) ||\n      /(^|\\s)_.*_(\\s|$)/.test(line) ||\n      /(^|\\s)\\*\\*.*\\*\\*(\\s|$)/.test(line) ||\n      /(^|\\s)__.*__(\\s|$)/.test(line) ||\n      /(^|\\s)~~.*~~(\\s|$)/.test(line) ||\n      // check for block markdown content like headings, code blocks, lists, etc.\n      line.startsWith('![') ||\n      line.startsWith('#') ||\n      line.startsWith('> ') ||\n      line.startsWith('*') ||\n      line.startsWith('- ') ||\n      line.startsWith('1. ') ||\n      line.startsWith('```') ||\n      line.startsWith('`') ||\n      line.startsWith('[') ||\n      line.startsWith('---'),\n  )\n  return markdown.length > 0\n}\n","import { Extension } from '@tiptap/core'\nimport { Plugin, PluginKey } from '@tiptap/pm/state'\nimport { DOMParser } from '@tiptap/pm/model'\nimport { EditorView } from '@tiptap/pm/view'\nimport { detectMarkdown, markdownToHTML } from '../../../utils/markdown'\nimport { processMultipleImages } from './image/image-extension'\n\nexport interface ContentPasteOptions {\n  enabled: boolean\n  showConfirmation: boolean\n  uploadFunction: Function | null\n}\n\nexport const ContentPasteExtension = Extension.create<ContentPasteOptions>({\n  name: 'contentPaste',\n\n  addOptions() {\n    return {\n      enabled: true,\n      showConfirmation: true,\n      uploadFunction: null,\n    }\n  },\n\n  addProseMirrorPlugins() {\n    const extensionThis = this\n    return [\n      new Plugin({\n        key: new PluginKey('contentPaste'),\n        props: {\n          handlePaste: (\n            view: EditorView,\n            event: ClipboardEvent,\n            slice: any,\n          ) => {\n            if (!this.options.enabled) return false\n\n            // handle image pasting\n            const files: File[] | [] = Array.from(\n              event.clipboardData?.files || [],\n            )\n            const images = Array.from(files).filter((file) =>\n              file.type.startsWith('image/'),\n            )\n            if (images.length > 0) {\n              processMultipleImages(images, view, null, extensionThis.options)\n              return true\n            }\n\n            // handle markdown pasting\n            const text = event.clipboardData?.getData('text/plain')\n            if (!text) return false\n\n            if (!detectMarkdown(text)) return false\n\n            if (this.options.showConfirmation) {\n              const shouldConvert = confirm(\n                'Do you want to convert markdown content to HTML before pasting?',\n              )\n              if (!shouldConvert) return false\n            }\n\n            const htmlContent = markdownToHTML(text)\n            const tempDiv = document.createElement('div')\n            tempDiv.innerHTML = htmlContent\n\n            const parser = DOMParser.fromSchema(view.state.schema)\n            const parsedSlice = parser.parseSlice(tempDiv, {\n              preserveWhitespace: true,\n            })\n\n            const tr = view.state.tr.replaceSelection(parsedSlice)\n            view.dispatch(tr)\n\n            return true\n          },\n        },\n      }),\n    ]\n  },\n})\n","import { Node, mergeAttributes, Range, Editor } from '@tiptap/core'\nimport { PluginKey } from '@tiptap/pm/state'\nimport {\n  createSuggestionExtension,\n  BaseSuggestionItem,\n} from '../suggestion/createSuggestionExtension'\nimport SuggestionList from '../suggestion/SuggestionList.vue'\nimport { toValue, unref } from 'vue'\n\nexport const TagNode = Node.create({\n  name: 'tagItem',\n  group: 'inline',\n  inline: true,\n  selectable: true,\n  atom: true,\n\n  addAttributes() {\n    return {\n      tagId: {\n        default: null,\n        parseHTML: (element) => element.getAttribute('data-tag-id'),\n        renderHTML: (attributes) => {\n          if (!attributes.tagId) {\n            return {}\n          }\n          return { 'data-tag-id': attributes.tagId }\n        },\n      },\n      tagLabel: {\n        default: 'tag',\n        parseHTML: (element) => element.getAttribute('data-tag-label'),\n        renderHTML: (attributes) => ({ 'data-tag-label': attributes.tagLabel }),\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'span.tag-item',\n        getAttrs: (dom) => {\n          const element = dom as HTMLElement\n          return {\n            tagId: element.getAttribute('data-tag-id'),\n            tagLabel:\n              element.getAttribute('data-tag-label') ||\n              element.innerText.replace(/^#/, ''),\n          }\n        },\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    // HTMLAttributes will include data-tag-id and data-tag-label\n    return [\n      'span',\n      mergeAttributes(HTMLAttributes, { class: 'tag-item' }),\n      `#${HTMLAttributes['data-tag-label']}`,\n    ]\n  },\n\n  addCommands() {\n    return {\n      setTag:\n        (attributes: { tagLabel: string; tagId?: string }) =>\n        ({ commands }) => {\n          return commands.insertContent({\n            type: this.name,\n            attrs: attributes,\n          })\n        },\n    }\n  },\n})\n\ninterface TagSuggestionItem extends BaseSuggestionItem {\n  name?: string\n  label: string\n  isNew?: boolean\n}\n\nexport const TagExtension = createSuggestionExtension<TagSuggestionItem>({\n  name: 'tagSuggestion',\n  char: '#',\n  pluginKey: new PluginKey('tagSuggestion'),\n  component: SuggestionList,\n\n  addOptions() {\n    return {\n      tags: [],\n    }\n  },\n\n  items: ({ query, editor }) => {\n    const { tags: _tags } = editor.extensionManager.extensions.find(\n      (ext) => ext.name === 'tagSuggestion',\n    )!.options\n    let tags = toValue(_tags)\n\n    // Filter existing tags based on the query\n    let filteredTags = tags\n      .filter((tag: TagSuggestionItem) =>\n        tag.label.toLowerCase().startsWith(query.toLowerCase()),\n      )\n      .map((tag: TagSuggestionItem) => ({ ...tag, display: tag.label }))\n\n    if (\n      query.length > 0 &&\n      !tags.some(\n        (tag: TagSuggestionItem) =>\n          tag.label.toLowerCase() === query.toLowerCase(),\n      )\n    ) {\n      filteredTags.push({\n        display: `New tag: \"${query}\"`,\n        label: query,\n        isNew: true,\n      })\n    }\n    return filteredTags\n  },\n\n  command: ({ editor, range, props }) => {\n    const attributes = {\n      tagLabel: props.label,\n      ...(props.id && !props.isNew && { tagId: props.id }),\n    }\n\n    editor\n      .chain()\n      .focus()\n      .insertContentAt(range, [\n        {\n          type: TagNode.name,\n          attrs: attributes,\n        },\n        {\n          type: 'text',\n          text: ' ',\n        },\n      ])\n      .run()\n  },\n\n  tippyOptions: {\n    placement: 'bottom-start',\n    offset: [0, 8],\n  },\n  allowSpaces: false,\n  decorationTag: 'span',\n  decorationClass: 'tag-suggestion-active',\n})\n","import TiptapHeading from '@tiptap/extension-heading'\nimport { textblockTypeInputRule } from '@tiptap/core'\n\n// This custom Heading extension modifies the default input rule behavior.\n// The default Tiptap heading input rule converts text to a heading when '#' is followed by any whitespace (including Enter).\n// This customization ensures that headings are only created when '#' is followed by a literal space.\n// This change is necessary to prevent conflicts with other extensions, such as a tags extension,\n// which uses '#' followed by Enter to add a tag.\nexport const Heading = TiptapHeading.extend({\n  addInputRules() {\n    return this.options.levels.map((level) => {\n      let regexp = new RegExp(`^(#{${level}}) $`)\n      return textblockTypeInputRule({\n        find: regexp,\n        type: this.type,\n        getAttributes: { level },\n      })\n    })\n  },\n})\n","<template>\n  <Dialog\n    v-model=\"modelValue\"\n    :options=\"{\n      title: props.mode === 'edit' ? 'Edit Images' : 'Upload Images',\n      size: '3xl',\n    }\"\n    @close=\"$emit('close')\"\n    :disableOutsideClickToClose=\"true\"\n  >\n    <template #body-content>\n      <div class=\"space-y-2\">\n        <div class=\"flex items-center gap-2\">\n          <Button @click=\"triggerFileInput\">\n            <template #prefix>\n              <LucideImagePlus class=\"size-4\" />\n            </template>\n            Add images\n          </Button>\n          <Select\n            id=\"columns-select\"\n            :options=\"selectOptions\"\n            v-model=\"internalColumns\"\n            size=\"sm\"\n            variant=\"subtle\"\n            class=\"w-28\"\n            @update:modelValue=\"(val) => (columns = +val)\"\n          />\n        </div>\n        <div\n          v-if=\"images && images.length\"\n          class=\"grid gap-px mb-4\"\n          :style=\"gridStyle\"\n        >\n          <div\n            v-for=\"(item, idx) in images\"\n            :key=\"item.id\"\n            class=\"relative aspect-square w-full h-full overflow-hidden group bg-surface-white\"\n            :draggable=\"true\"\n            @dragstart=\"onDragStart(idx)\"\n            @dragover=\"onDragOver($event, idx)\"\n            @drop=\"onDrop($event)\"\n            @dragend=\"onDragEnd\"\n            @dragleave=\"onDragLeave($event, idx)\"\n            :class=\"{ 'ring-2 ring-primary-400 z-10': isDropTarget(idx) }\"\n          >\n            <button\n              type=\"button\"\n              class=\"absolute top-1 right-1 z-10 bg-white/80 hover:bg-white rounded-full p-1 shadow transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100\"\n              aria-label=\"Remove image\"\n              @click.stop=\"removeImage(idx)\"\n            >\n              <LucideX class=\"w-4 h-4 text-gray-700\" />\n            </button>\n\n            <!-- Existing images from edit mode -->\n            <template v-if=\"item.type === 'existing'\">\n              <img\n                :src=\"item.existing?.src\"\n                :alt=\"item.existing?.alt || ''\"\n                class=\"object-cover w-full h-full rounded-[2px]\"\n              />\n              <!-- Caption overlay -->\n              <div\n                class=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent rounded-b-[2px] transition-opacity\"\n                :class=\"\n                  editingCaption === `${item.type}-${idx}`\n                    ? 'opacity-100'\n                    : 'opacity-0 group-hover:opacity-100'\n                \"\n              >\n                <div\n                  v-if=\"editingCaption !== `${item.type}-${idx}`\"\n                  class=\"p-2 cursor-pointer\"\n                  @click.stop=\"\n                    startEditingCaption(\n                      `${item.type}-${idx}`,\n                      item.existing?.alt || '',\n                    )\n                  \"\n                >\n                  <div\n                    class=\"text-white text-xs truncate\"\n                    :title=\"item.existing?.alt || 'Click to add caption'\"\n                  >\n                    {{ item.existing?.alt || 'Add caption...' }}\n                  </div>\n                </div>\n                <div v-else class=\"p-2\" @click.stop>\n                  <input\n                    :ref=\"(el) => (captionInputRef = el as HTMLInputElement)\"\n                    v-model=\"captionEditValue\"\n                    @blur=\"handleCaptionBlur(`${item.type}-${idx}`, idx)\"\n                    @keydown.enter.prevent=\"\n                      saveCaption(`${item.type}-${idx}`, idx)\n                    \"\n                    @keydown.escape=\"cancelEditingCaption\"\n                    class=\"w-full text-xs bg-white/90 text-gray-900 px-1 py-0.5 rounded-sm border-none outline-none\"\n                    placeholder=\"Add caption...\"\n                    maxlength=\"200\"\n                  />\n                </div>\n              </div>\n            </template>\n\n            <!-- New file uploads -->\n            <template v-else-if=\"item.type === 'file' && item.file\">\n              <template v-if=\"!isImageSupported(item.file)\">\n                <div\n                  class=\"flex flex-col items-center justify-center w-full h-full text-ink-gray-4 bg-surface-gray-1 rounded-[2px]\"\n                >\n                  <span\n                    class=\"text-p-xs text-ink-gray-4 w-full text-center px-2 mt-1\"\n                    :title=\"item.file.name\"\n                  >\n                    {{ item.file.name }}\n                  </span>\n                </div>\n              </template>\n              <template v-else-if=\"item.file.type.startsWith('image/')\">\n                <img\n                  :src=\"filePreview(item.file)\"\n                  class=\"object-cover w-full h-full rounded-[2px]\"\n                  :alt=\"item.alt || ''\"\n                />\n                <!-- Caption overlay -->\n                <div\n                  class=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent rounded-b-[2px] transition-opacity\"\n                  :class=\"\n                    editingCaption === `${item.type}-${idx}`\n                      ? 'opacity-100'\n                      : 'opacity-0 group-hover:opacity-100'\n                  \"\n                >\n                  <div\n                    v-if=\"editingCaption !== `${item.type}-${idx}`\"\n                    class=\"p-2 cursor-pointer\"\n                    @click.stop=\"\n                      startEditingCaption(`${item.type}-${idx}`, item.alt || '')\n                    \"\n                  >\n                    <div\n                      class=\"text-white text-xs truncate\"\n                      :title=\"item.alt || 'Click to add caption'\"\n                    >\n                      {{ item.alt || 'Add caption...' }}\n                    </div>\n                  </div>\n                  <div v-else class=\"p-2\" @click.stop>\n                    <input\n                      ref=\"captionInput\"\n                      v-model=\"captionEditValue\"\n                      @blur=\"handleCaptionBlur(`${item.type}-${idx}`, idx)\"\n                      @keydown.enter.prevent=\"\n                        saveCaption(`${item.type}-${idx}`, idx)\n                      \"\n                      @keydown.escape=\"cancelEditingCaption\"\n                      class=\"w-full text-xs bg-white/90 text-gray-900 px-1 py-0.5 rounded border-none outline-none\"\n                      placeholder=\"Add caption...\"\n                      maxlength=\"200\"\n                    />\n                  </div>\n                </div>\n              </template>\n            </template>\n          </div>\n        </div>\n        <div v-if=\"images && images.length\" class=\"text-p-sm text-ink-gray-5\">\n          Upload more images by dropping them anywhere in this window. Reorder\n          images by dragging them. Hover over an image to edit caption.\n        </div>\n        <div\n          v-else\n          class=\"flex flex-col items-center justify-center min-h-[200px]\"\n        >\n          <div\n            class=\"w-full flex flex-1 flex-col items-center justify-center border border-outline-gray-2 rounded-lg bg-surface-gray-1 h-full cursor-pointer transition hover:border-primary-400 hover:bg-primary-50 text-center\"\n            @click=\"triggerFileInput\"\n            @dragover.prevent\n            @drop.prevent=\"onDrop\"\n          >\n            <div class=\"text-ink-gray-4 mb-2\">\n              <LucideImagePlus class=\"size-6\" />\n            </div>\n            <div class=\"text-ink-gray-5 text-sm font-medium\">\n              Drag & drop images here or click to select\n            </div>\n          </div>\n        </div>\n        <div v-if=\"uploading\">\n          <div class=\"mb-2 text-sm\">\n            Uploading: {{ uploadedCount }}/{{ totalCount }}\n          </div>\n          <div class=\"w-full bg-gray-200 rounded h-2 overflow-hidden\">\n            <div\n              class=\"bg-surface-gray-5 h-2 transition-all\"\n              :style=\"{ width: uploadProgress + '%' }\"\n            ></div>\n          </div>\n          <div\n            v-if=\"uploadErrors && uploadErrors.some((e) => e)\"\n            class=\"mt-2 text-red-500 text-xs\"\n          >\n            Some files failed to upload.\n          </div>\n        </div>\n      </div>\n    </template>\n    <template #actions>\n      <div class=\"flex justify-end gap-2\">\n        <Button variant=\"ghost\" :disabled=\"uploading\" @click=\"handleCancel\">\n          Cancel\n        </Button>\n        <Button\n          v-if=\"props.mode === 'edit'\"\n          variant=\"solid\"\n          :loading=\"uploading\"\n          @click=\"handleSave\"\n        >\n          Save\n        </Button>\n        <Button\n          v-if=\"props.mode === 'new'\"\n          variant=\"solid\"\n          :loading=\"uploading\"\n          @click=\"handleUpload\"\n        >\n          Upload\n        </Button>\n      </div>\n    </template>\n  </Dialog>\n  <Teleport to=\"body\">\n    <Transition\n      name=\"fade\"\n      enter-active-class=\"transition-opacity duration-200\"\n      leave-active-class=\"transition-opacity duration-200\"\n      enter-from-class=\"opacity-0\"\n      enter-to-class=\"opacity-100\"\n      leave-from-class=\"opacity-100\"\n      leave-to-class=\"opacity-0\"\n    >\n      <div\n        v-if=\"isFileDragging\"\n        class=\"fixed inset-0 z-50 bg-gray-900/60 pointer-events-none flex items-center justify-center\"\n      >\n        <div class=\"text-ink-gray-1 text-base font-medium\">\n          Drop images anywhere\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  ref,\n  onMounted,\n  onUnmounted,\n  watch,\n  nextTick,\n  useTemplateRef,\n} from 'vue'\nimport Dialog from '../../../Dialog/Dialog.vue'\nimport Button from '../../../Button/Button.vue'\nimport Select from '../../../Select/Select.vue'\nimport type { Editor } from '@tiptap/vue-3'\nimport type { UploadedFile } from '../../../../utils/useFileUpload'\nimport LucideX from '~icons/lucide/x'\nimport LucideImagePlus from '~icons/lucide/image-plus'\n\ninterface UploadResult {\n  success: boolean\n  file?: UploadedFile\n  error?: Error\n}\n\ninterface ExistingImage {\n  src: string\n  alt: string\n}\n\ninterface ImageItem {\n  type: 'file' | 'existing'\n  file?: File\n  existing?: ExistingImage\n  alt?: string\n  id: string\n}\n\nconst props = withDefaults(\n  defineProps<{\n    modelValue: boolean\n    files: File[]\n    editor: Editor\n    mode: 'new' | 'edit'\n    existingImages?: ExistingImage[]\n    initialColumns?: number\n  }>(),\n  {\n    mode: 'new',\n  },\n)\n\nconst emit = defineEmits(['update:modelValue', 'close', 'update:files', 'save'])\n\nconst modelValue = computed({\n  get: () => props.modelValue,\n  set: (val) => emit('update:modelValue', val),\n})\n\nconst isFileDragging = ref(false)\nconst draggedIndex = ref<number | null>(null)\nconst overIndex = ref<number | null>(null)\nconst columnsInitialized = ref(false)\n\n// Caption editing state\nconst editingCaption = ref<string | null>(null)\nconst captionEditValue = ref('')\nconst captionInputRef = ref<HTMLInputElement | null>(null)\n\nconst uploading = ref(false)\nconst columns = ref(4)\nconst uploadProgress = ref(0)\nconst uploadedCount = ref(0)\nconst totalCount = ref(0)\nconst uploadErrors = ref<(Error | null)[]>([])\nconst uploadResults = ref<UploadResult[]>([])\n\n// Unified images array handling both files and existing images\nconst images = ref<ImageItem[]>([])\n\n// Initialize images when modal opens\nwatch(\n  () => props.modelValue,\n  (isOpen) => {\n    if (isOpen && props.mode === 'edit') {\n      const existingItems = (props.existingImages || []).map(\n        createExistingImageItem,\n      )\n      const fileItems = (props.files || []).map(createImageItem)\n      images.value = [...existingItems, ...fileItems]\n\n      if (props.initialColumns) {\n        columns.value = props.initialColumns\n        columnsInitialized.value = true\n      }\n    } else if (isOpen && props.mode === 'new') {\n      images.value = (props.files || []).map(createImageItem)\n      columns.value = getDefaultColumns(images.value.length)\n      columnsInitialized.value = true\n    }\n  },\n  { immediate: true },\n)\n\nwatch(\n  () => props.existingImages,\n  (newExistingImages) => {\n    if (props.modelValue && props.mode === 'edit') {\n      const existingItems = (newExistingImages || []).map(\n        createExistingImageItem,\n      )\n      const fileItems = (props.files || []).map(createImageItem)\n      images.value = [...existingItems, ...fileItems]\n    }\n  },\n  { deep: true },\n)\n\nwatch(\n  () => props.files,\n  (newFiles) => {\n    if (props.mode === 'new') {\n      images.value = (newFiles || []).map(createImageItem)\n    }\n  },\n  { deep: true },\n)\n\nonMounted(() => {\n  window.addEventListener('dragover', onDragOverWindow)\n  window.addEventListener('drop', onDrop)\n  window.addEventListener('dragleave', onDragLeaveWindow)\n})\n\nonUnmounted(() => {\n  window.removeEventListener('dragover', onDragOverWindow)\n  window.removeEventListener('drop', onDrop)\n  window.removeEventListener('dragleave', onDragLeaveWindow)\n})\n\nasync function handleSave() {\n  // Upload new files and combine with existing images\n  const newFiles = images.value\n    .filter((item) => item.type === 'file' && item.file)\n    .map((item) => item.file!)\n\n  const existingImages = images.value\n    .filter((item) => item.type === 'existing' && item.existing)\n    .map((item) => item.existing!)\n\n  let uploadResults: UploadResult[] = []\n\n  if (newFiles.length > 0) {\n    uploadResults = await uploadFiles(newFiles)\n  }\n\n  // Map files to their upload results for reliable lookup\n  const fileToUploadMap = new Map<File, ExistingImage>()\n  newFiles.forEach((file, index) => {\n    const result = uploadResults[index]\n    if (result?.success && result.file) {\n      fileToUploadMap.set(file, {\n        src: result.file.file_url || '',\n        alt: result.file.file_name || '',\n      })\n    }\n  })\n\n  // Build final images maintaining UI order\n  const finalImages: ExistingImage[] = []\n  for (const item of images.value) {\n    if (item.type === 'existing' && item.existing) {\n      finalImages.push(item.existing)\n    } else if (item.type === 'file' && item.file) {\n      const uploadedImage = fileToUploadMap.get(item.file)\n      if (uploadedImage) {\n        finalImages.push(uploadedImage)\n      }\n    }\n  }\n\n  emit('save', {\n    images: finalImages,\n    columns: columns.value,\n  })\n\n  uploading.value = false\n  modelValue.value = false\n}\n\nasync function handleUpload() {\n  if (!props.files || props.files.length === 0) return\n\n  const results = await uploadFiles(props.files)\n\n  const uploadedImages = results\n    .filter((result) => result.success && result.file)\n    .map((result) => ({\n      src: result.file?.file_url || '',\n      alt: result.file?.file_name || '',\n    }))\n\n  if (uploadedImages.length > 1) {\n    props.editor\n      .chain()\n      .focus()\n      .setImageGroup({ images: uploadedImages, columns: columns.value })\n      .run()\n  }\n\n  uploading.value = false\n  modelValue.value = false\n  emit('close')\n}\n\nfunction handleCancel() {\n  modelValue.value = false\n  emit('close')\n}\n\nfunction removeImage(idx: number) {\n  images.value.splice(idx, 1)\n\n  if (props.mode === 'new') {\n    const newFiles = images.value\n      .filter((item) => item.type === 'file' && item.file)\n      .map((item) => item.file!)\n    emit('update:files', newFiles)\n  }\n}\n\nfunction triggerFileInput() {\n  const fileInput = document.createElement('input')\n  fileInput.type = 'file'\n  fileInput.accept = 'image/*'\n  fileInput.multiple = true\n  fileInput.onchange = (e) => {\n    const files = (e.target as HTMLInputElement).files\n    if (files) {\n      addFiles(Array.from(files))\n    }\n  }\n  fileInput.click()\n}\n\nfunction addFiles(files: File[]) {\n  const imageFiles = files.filter((file) => file.type.startsWith('image/'))\n  const newImageItems = imageFiles.map(createImageItem)\n\n  const existingFileSignatures = images.value\n    .filter((item) => item.type === 'file' && item.file)\n    .map((item) => `${item.file!.name}-${item.file!.size}`)\n\n  const uniqueNewItems = newImageItems.filter(\n    (item) =>\n      !existingFileSignatures.includes(`${item.file!.name}-${item.file!.size}`),\n  )\n\n  images.value.push(...uniqueNewItems)\n\n  if (props.mode === 'new') {\n    const newFiles = images.value\n      .filter((item) => item.type === 'file' && item.file)\n      .map((item) => item.file!)\n    emit('update:files', newFiles)\n  }\n}\n\nfunction onDrop(e: DragEvent) {\n  e.preventDefault()\n  e.stopPropagation()\n  const droppedFiles = Array.from(e.dataTransfer?.files || [])\n  if (droppedFiles.length) {\n    addFiles(droppedFiles)\n  } else if (\n    draggedIndex.value !== null &&\n    overIndex.value !== null &&\n    draggedIndex.value !== overIndex.value\n  ) {\n    // Handle image reordering\n    const [moved] = images.value.splice(draggedIndex.value, 1)\n    images.value.splice(overIndex.value, 0, moved)\n\n    if (props.mode === 'new') {\n      const newFiles = images.value\n        .filter((item) => item.type === 'file' && item.file)\n        .map((item) => item.file!)\n      emit('update:files', newFiles)\n    }\n  }\n  isFileDragging.value = false\n  draggedIndex.value = null\n  overIndex.value = null\n}\n\nfunction createImageItem(file: File): ImageItem {\n  return {\n    type: 'file',\n    file,\n    id: `file-${file.name}-${file.size}-${Date.now()}`,\n  }\n}\n\nfunction createExistingImageItem(existing: ExistingImage): ImageItem {\n  return {\n    type: 'existing',\n    existing,\n    id: `existing-${existing.src}-${Date.now()}`,\n  }\n}\n\nfunction getDefaultColumns(count: number) {\n  if (count <= 4) return count\n  if (count % 4 === 0) return 4\n  if (count % 3 === 0) return 3\n  if (count > 10) return 4\n  return 3\n}\n\nfunction getUploadFunction() {\n  const imageGroupExtension = props.editor.extensionManager.extensions.find(\n    (ext) => ext.name === 'imageGroup',\n  )\n  return imageGroupExtension?.options?.uploadFunction\n}\n\nfunction filePreview(file: File) {\n  const url = URL.createObjectURL(file)\n\n  onUnmounted(() => {\n    URL.revokeObjectURL(url)\n  })\n\n  return url\n}\n\nfunction isImageSupported(file: File): boolean {\n  // HEIC/HEIF files can't be previewed in browsers\n  const unsupportedTypes = ['image/heic', 'image/heif']\n  const unsupportedExtensions = ['.heic', '.heif']\n\n  const hasUnsupportedType = unsupportedTypes.includes(file.type)\n  const hasUnsupportedExtension = unsupportedExtensions.some((ext) =>\n    file.name?.toLowerCase().endsWith(ext),\n  )\n\n  return !hasUnsupportedType && !hasUnsupportedExtension\n}\n\nfunction onDragOver(e: DragEvent, idx: number) {\n  e.preventDefault()\n  overIndex.value = idx\n}\n\nfunction onDragStart(idx: number) {\n  draggedIndex.value = idx\n}\n\nfunction onDragEnd() {\n  draggedIndex.value = null\n  overIndex.value = null\n}\n\nfunction onDragLeave(e: DragEvent, idx: number) {\n  if (overIndex.value === idx) {\n    overIndex.value = null\n  }\n}\n\nfunction isDropTarget(idx: number) {\n  return (\n    overIndex.value === idx &&\n    draggedIndex.value !== null &&\n    draggedIndex.value !== idx\n  )\n}\n\nfunction onDragOverWindow(e: DragEvent) {\n  e.preventDefault()\n  if (e.dataTransfer && Array.from(e.dataTransfer.types).includes('Files')) {\n    isFileDragging.value = true\n  }\n}\n\nfunction onDragLeaveWindow(e: DragEvent) {\n  if (e.target === window || e.relatedTarget === null) {\n    isFileDragging.value = false\n  }\n}\n\nconst gridStyle = computed(() => ({\n  gridTemplateColumns: `repeat(${columns.value || 4}, minmax(0, 1fr))`,\n}))\n\nconst internalColumns = computed({\n  get: () => String(columns.value ?? 4),\n  set: (val) => {\n    columns.value = +val\n  },\n})\n\nconst selectOptions = [\n  { label: '2 columns', value: '2' },\n  { label: '3 columns', value: '3' },\n  { label: '4 columns', value: '4' },\n]\n\nfunction startEditingCaption(itemId: string, currentAlt: string) {\n  editingCaption.value = itemId\n  captionEditValue.value = currentAlt\n\n  nextTick(() => {\n    if (captionInputRef.value) {\n      captionInputRef.value.focus()\n      captionInputRef.value.select()\n    }\n  })\n}\n\nfunction saveCaption(itemId: string, itemIndex: number) {\n  const [type, indexStr] = itemId.split('-')\n  const newCaption = captionEditValue.value.trim()\n\n  if (type === 'existing') {\n    if (images.value[itemIndex]?.existing) {\n      images.value[itemIndex].existing.alt = newCaption\n    }\n  } else if (type === 'file') {\n    if (images.value[itemIndex]) {\n      images.value[itemIndex].alt = newCaption\n    }\n  }\n\n  editingCaption.value = null\n  captionEditValue.value = ''\n}\n\nfunction cancelEditingCaption() {\n  editingCaption.value = null\n  captionEditValue.value = ''\n}\n\nfunction handleCaptionBlur(itemId: string, itemIndex: number) {\n  if (editingCaption.value === itemId) {\n    saveCaption(itemId, itemIndex)\n  }\n}\n\nasync function uploadFiles(files: File[]): Promise<UploadResult[]> {\n  const uploadFunction = getUploadFunction()\n  if (!uploadFunction) {\n    console.error('uploadFunction not found')\n    throw new Error('Upload function not found')\n  }\n\n  uploading.value = true\n  totalCount.value = files.length\n  uploadedCount.value = 0\n  uploadProgress.value = 0\n  uploadErrors.value = Array(files.length).fill(null)\n  uploadResults.value = Array(files.length).fill(null)\n\n  const uploadPromises = files.map(async (file, index) => {\n    try {\n      const result = await uploadFunction(file)\n      uploadResults.value[index] = { success: true, file: result }\n      return { success: true, file: result }\n    } catch (error) {\n      const err = error as Error\n      uploadErrors.value[index] = err\n      uploadResults.value[index] = { success: false, error: err }\n      return { success: false, error: err }\n    } finally {\n      uploadedCount.value++\n      uploadProgress.value = Math.round(\n        (uploadedCount.value / totalCount.value) * 100,\n      )\n    }\n  })\n\n  // Execute all uploads in parallel\n  const results = await Promise.all(uploadPromises)\n  return results\n}\n</script>\n","<template>\n  <NodeViewWrapper>\n    <div class=\"w-full\">\n      <div v-if=\"isEditable\" class=\"flex items-center mb-2 gap-2\">\n        <Button @click=\"edit\">\n          <template #prefix>\n            <LucideEdit class=\"size-4\" />\n          </template>\n          Edit\n        </Button>\n        <Select\n          :options=\"selectOptions\"\n          v-model=\"internalColumns\"\n          size=\"sm\"\n          variant=\"subtle\"\n          class=\"w-28\"\n        />\n      </div>\n      <div class=\"grid gap-px\" :style=\"gridStyle\">\n        <div\n          v-for=\"(img, idx) in images\"\n          :key=\"img.attrs.src + idx\"\n          class=\"relative aspect-square w-full h-full overflow-hidden bg-surface-white group\"\n        >\n          <button\n            v-if=\"isEditable\"\n            type=\"button\"\n            class=\"absolute top-1 right-1 z-10 bg-white/80 hover:bg-white rounded-full p-1 shadow transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100\"\n            aria-label=\"Remove image\"\n            @click.stop=\"removeImage(idx)\"\n          >\n            <LucideX class=\"w-4 h-4 text-gray-700\" />\n          </button>\n          <img\n            :src=\"img.attrs.src\"\n            :alt=\"img.attrs.alt || ''\"\n            class=\"object-cover w-full h-full not-prose cursor-pointer rounded-[2px]\"\n            v-if=\"!isEditable\"\n            @click=\"openViewer(idx)\"\n          />\n          <img\n            v-else\n            :src=\"img.attrs.src\"\n            :alt=\"img.attrs.alt || ''\"\n            class=\"object-cover w-full h-full not-prose rounded-[2px]\"\n          />\n\n          <!-- Caption overlay (visible when there's alt text) -->\n          <div\n            v-if=\"img.attrs.alt\"\n            class=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent rounded-b-[2px] opacity-0 group-hover:opacity-100 transition-opacity\"\n          >\n            <div class=\"p-2\">\n              <div class=\"text-white text-xs truncate\" :title=\"img.attrs.alt\">\n                {{ img.attrs.alt }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <ImageViewerModal\n        v-if=\"showViewer\"\n        v-model:show=\"showViewer\"\n        :images=\"viewerImages\"\n        :initialIndex=\"viewerIndex\"\n      />\n      <ImageGroupUploadDialog\n        v-if=\"showEditModal\"\n        v-model=\"showEditModal\"\n        :files=\"editFiles\"\n        :editor=\"props.editor\"\n        mode=\"edit\"\n        :existingImages=\"existingImages\"\n        :initialColumns=\"columns\"\n        @close=\"handleEditModalClose\"\n        @save=\"handleEditSave\"\n      />\n      <slot />\n    </div>\n  </NodeViewWrapper>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref, onMounted, onUnmounted } from 'vue'\nimport { NodeViewWrapper, type Editor } from '@tiptap/vue-3'\nimport type { NodeViewProps } from '@tiptap/vue-3'\nimport LucideX from '~icons/lucide/x'\nimport LucideEdit from '~icons/lucide/edit'\nimport Button from '../../../Button/Button.vue'\nimport Select from '../../../Select/Select.vue'\nimport ImageViewerModal from '../../ImageViewerModal.vue'\nimport ImageGroupUploadDialog from './ImageGroupUploadDialog.vue'\n\nconst props = defineProps<NodeViewProps & { editor: Editor }>()\n\nconst columns = computed(() => props.node.attrs.columns || 4)\nconst images = computed(() => props.node.content.content || [])\nconst gridStyle = computed(() => ({\n  gridTemplateColumns: `repeat(${columns.value}, minmax(0, 1fr))`,\n}))\nconst isEditable = ref(props.editor.isEditable)\n\nconst selectOptions = [\n  { label: '2 columns', value: '2' },\n  { label: '3 columns', value: '3' },\n  { label: '4 columns', value: '4' },\n]\n\nconst internalColumns = computed({\n  get: () => String(columns.value),\n  set: (val) => props.updateAttributes({ columns: +val }),\n})\n\nconst showViewer = ref(false)\nconst viewerIndex = ref(0)\nconst viewerImages = computed(() =>\n  images.value.map((img: any) => ({\n    src: img.attrs.src,\n    alt: img.attrs.alt || '',\n  })),\n)\n\nconst showEditModal = ref(false)\nconst editFiles = ref<File[]>([])\n\ninterface ExistingImage {\n  src: string\n  alt: string\n}\n\nconst existingImages = computed(() =>\n  images.value.map((img: any) => ({\n    src: img.attrs.src,\n    alt: img.attrs.alt || '',\n  })),\n)\n\nonMounted(() => {\n  const updateEditable = () => {\n    isEditable.value = props.editor.isEditable\n  }\n  props.editor.on('update', updateEditable)\n  onUnmounted(() => {\n    props.editor.off('update', updateEditable)\n  })\n})\n\nfunction edit() {\n  editFiles.value = []\n  showEditModal.value = true\n}\n\nfunction handleEditModalClose() {\n  showEditModal.value = false\n  editFiles.value = []\n}\n\nasync function handleEditSave(data: {\n  images: ExistingImage[]\n  columns: number\n}) {\n  // Update the node with the final images and columns from the modal\n  props.editor.commands.command(({ tr, state }) => {\n    const pos = props.getPos()\n    if (typeof pos === 'number') {\n      const node = state.doc.nodeAt(pos)\n      if (node && node.type.name === 'imageGroup') {\n        const newContent = data.images.map((img) =>\n          state.schema.nodes.image.create({ src: img.src, alt: img.alt }),\n        )\n\n        const newAttrs = { ...node.attrs, columns: data.columns }\n        const newNode = node.type.create(newAttrs, newContent)\n        tr.replaceWith(pos, pos + node.nodeSize, newNode)\n        return true\n      }\n    }\n    return false\n  })\n\n  showEditModal.value = false\n}\n\nfunction openViewer(idx: number) {\n  if (props.editor.isEditable) return\n  viewerIndex.value = idx\n  showViewer.value = true\n}\n\nfunction removeImage(idx: number) {\n  // Remove the image at the specified index and update the node\n  const newImages = images.value.slice()\n  newImages.splice(idx, 1)\n  if (newImages.length === 0) {\n    // Remove the whole node if no images left\n    props.editor.commands.deleteNode('imageGroup')\n  } else {\n    // Update the node content with remaining images\n    props.updateAttributes({})\n    props.editor.commands.command(({ tr, state }) => {\n      const pos = props.getPos()\n      if (typeof pos === 'number') {\n        const node = state.doc.nodeAt(pos)\n        if (node && node.type.name === 'imageGroup') {\n          const newContent = newImages.map((img) =>\n            state.schema.nodes.image.create(img.attrs),\n          )\n          tr.replaceWith(pos + 1, pos + 1 + node.content.size, newContent)\n          return true\n        }\n      }\n      return false\n    })\n  }\n}\n</script>\n","import { Node, mergeAttributes } from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-3'\nimport ImageGroupNodeView from './ImageGroupNodeView.vue'\nimport { UploadedFile } from '../../../../utils/useFileUpload'\n\nexport interface ImageGroupOptions {\n  /**\n   * Function to handle image uploads\n   * @default null\n   */\n  uploadFunction: ((file: File) => Promise<UploadedFile>) | null\n  HTMLAttributes: Record<string, any>\n}\n\nexport interface ImageGroupAttrs {\n  columns?: number\n  images: {\n    src: string\n    alt?: string\n  }[]\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    imageGroup: {\n      /**\n       * Insert an image group/gallery node\n       */\n      setImageGroup: (attrs: {\n        columns?: number\n        images: { src: string; alt?: string }[]\n      }) => ReturnType\n    }\n  }\n}\n\nexport const ImageGroup = Node.create<ImageGroupOptions>({\n  name: 'imageGroup',\n\n  group: 'block',\n  content: 'image+', // one or more images\n  selectable: true,\n  draggable: true,\n  isolating: true,\n\n  addOptions() {\n    return {\n      uploadFunction: null,\n      HTMLAttributes: {},\n    }\n  },\n\n  addAttributes() {\n    return {\n      columns: {\n        default: 4,\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'div[data-type=\"image-group\"]',\n        getAttrs: (element) => {\n          if (typeof element === 'string') return {}\n          const el = element as HTMLElement\n          return {\n            columns: el.getAttribute('data-columns')\n              ? Number(el.getAttribute('data-columns'))\n              : 4,\n          }\n        },\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes, node }) {\n    return [\n      'div',\n      mergeAttributes(\n        {\n          'data-type': 'image-group',\n          'data-columns': node.attrs.columns,\n        },\n        this.options.HTMLAttributes,\n        HTMLAttributes,\n      ),\n      0, // content placeholder for child images\n    ]\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(ImageGroupNodeView)\n  },\n\n  addCommands() {\n    return {\n      setImageGroup:\n        (attrs) =>\n        ({ commands }) => {\n          return commands.insertContent({\n            type: this.name,\n            attrs: {\n              columns: attrs.columns || 4,\n            },\n            content: attrs.images.map((img) => ({\n              type: 'image',\n              attrs: img,\n            })),\n          })\n        },\n    }\n  },\n})\n","import { reactive, computed } from 'vue'\n\nexport interface UploadOptions {\n  private?: boolean\n  folder?: string\n  file_url?: string\n  doctype?: string\n  docname?: string\n  fieldname?: string\n  method?: string\n  type?: string\n  upload_endpoint?: string\n  optimize?: boolean\n  max_width?: number\n  max_height?: number\n  params?: object\n}\n\nexport interface UploadState {\n  uploading: boolean\n  progress: number\n  uploaded: number\n  total: number\n  error: any | null\n  result: UploadedFile | null\n}\n\nexport interface UploadedFile {\n  file_name: string\n  file_size: number\n  file_url: string\n  name?: string\n  owner?: string\n  creation?: string\n  modified?: string\n  modified_by?: string\n  is_private?: 0 | 1\n  file_type?: string\n  folder?: string\n  is_folder?: 0 | 1\n  content_hash?: string\n}\n\nexport function useFileUpload() {\n  const state = reactive<UploadState>({\n    uploading: false,\n    progress: 0,\n    uploaded: 0,\n    total: 0,\n    error: null,\n    result: null,\n  })\n\n  // Function to reset the state\n  const reset = () => {\n    state.uploading = false\n    state.progress = 0\n    state.uploaded = 0\n    state.total = 0\n    state.error = null\n    state.result = null\n  }\n\n  // Computed values for convenience\n  const isUploading = computed(() => state.uploading)\n  const progress = computed(() => state.progress)\n  const error = computed(() => state.error)\n  const result = computed(() => state.result)\n\n  return {\n    upload: (file: File, options: UploadOptions = {}) =>\n      upload(file, options, state, reset),\n    reset,\n    state,\n    isUploading,\n    progress,\n    error,\n    result,\n  }\n}\n\nasync function upload(\n  file: File | null,\n  options: UploadOptions = {},\n  state: UploadState,\n  reset: () => void,\n): Promise<UploadedFile> {\n  reset()\n  state.uploading = true\n\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n\n    // Set up event listeners\n    xhr.upload.addEventListener('loadstart', () => {\n      state.uploading = true\n      state.error = null\n    })\n\n    xhr.upload.addEventListener('progress', (e) => {\n      if (e.lengthComputable) {\n        state.uploaded = e.loaded\n        state.total = e.total\n        state.progress = Math.round((e.loaded / e.total) * 100)\n      }\n    })\n\n    xhr.upload.addEventListener('load', () => {\n      state.progress = 100\n    })\n\n    xhr.addEventListener('error', (error) => {\n      state.uploading = false\n      state.error = 'Upload failed'\n      reject('Upload failed')\n    })\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState == XMLHttpRequest.DONE) {\n        let error\n        if (xhr.status === 200) {\n          let r = null\n          try {\n            r = JSON.parse(xhr.responseText)\n          } catch (e) {\n            r = xhr.responseText\n          }\n\n          const result = (r.message || r) as UploadedFile\n          state.result = result\n          resolve(result)\n        } else if (xhr.status === 403) {\n          error = JSON.parse(xhr.responseText)\n        } else {\n          try {\n            error = JSON.parse(xhr.responseText)\n          } catch (e) {\n            error = 'Upload failed'\n          }\n        }\n\n        if (error) {\n          let exception\n          let errorParts = [\n            [error.exc_type, error._error_message].filter(Boolean).join(' '),\n          ]\n          if (error.exc) {\n            exception = error.exc\n            try {\n              exception = JSON.parse(exception)[0]\n              console.log(exception)\n              // eslint-disable-next-line no-empty\n            } catch (e) {}\n          }\n          let e = new Error(errorParts.join('\\n'))\n          let messages = error._server_messages\n            ? JSON.parse(error._server_messages)\n            : []\n          messages = messages\n            .map((m: string) => {\n              try {\n                return JSON.parse(m).message\n              } catch (error) {\n                return m\n              }\n            })\n            .filter(Boolean)\n          if (!messages.length) {\n            messages = error._error_message\n              ? [error._error_message]\n              : ['Internal Server Error']\n          }\n          e.message = messages.join('\\n')\n          state.error = e\n          reject(e)\n        }\n\n        state.uploading = false\n      }\n    }\n\n    const uploadEndpoint = options.upload_endpoint || '/api/method/upload_file'\n    xhr.open('POST', uploadEndpoint, true)\n    xhr.setRequestHeader('Accept', 'application/json')\n\n    if (window.csrf_token && window.csrf_token !== '{{ csrf_token }}') {\n      xhr.setRequestHeader('X-Frappe-CSRF-Token', window.csrf_token)\n    }\n\n    const formData = new FormData()\n    if (file) {\n      formData.append('file', file, file.name)\n    }\n\n    formData.append('is_private', options.private ? '1' : '0')\n    formData.append('folder', options.folder || 'Home')\n\n    if (options.file_url) {\n      formData.append('file_url', options.file_url)\n    }\n\n    if (options.doctype) {\n      formData.append('doctype', options.doctype)\n    }\n\n    if (options.docname) {\n      formData.append('docname', options.docname)\n    }\n\n    if (options.fieldname) {\n      formData.append('fieldname', options.fieldname)\n    }\n\n    if (options.method) {\n      formData.append('method', options.method)\n    }\n\n    if (options.type) {\n      formData.append('type', options.type)\n    }\n\n    if (options.optimize) {\n      formData.append('optimize', '1')\n      if (options.max_width) {\n        formData.append('max_width', options.max_width.toString())\n      }\n      if (options.max_height) {\n        formData.append('max_height', options.max_height.toString())\n      }\n    }\n    if (options.params) {\n      for (let [k, v] of Object.entries(options.params)) {\n        formData.append(k, v)\n      }\n    }\n\n    xhr.send(formData)\n  })\n}\n\n// Add the Window interface for typescript\ndeclare global {\n  interface Window {\n    csrf_token?: string\n  }\n}\n\nexport { upload }\n","<template>\n  <div\n    v-if=\"editor\"\n    class=\"relative w-full\"\n    :class=\"attrsClass\"\n    :style=\"attrsStyle\"\n  >\n    <TextEditorBubbleMenu :buttons=\"bubbleMenu\" :options=\"bubbleMenuOptions\" />\n    <TextEditorFixedMenu\n      class=\"w-full overflow-x-auto rounded-t-lg border border-outline-gray-modals\"\n      :buttons=\"fixedMenu\"\n    />\n    <TextEditorFloatingMenu :buttons=\"floatingMenu\" />\n    <slot name=\"top\" :editor />\n    <slot name=\"editor\" :editor=\"editor\">\n      <EditorContent :editor=\"editor\" />\n    </slot>\n    <slot name=\"bottom\" :editor />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  normalizeClass,\n  normalizeStyle,\n  computed,\n  watch,\n  onMounted,\n  onBeforeUnmount,\n  provide,\n  ref,\n  useAttrs,\n} from 'vue'\n\ndefineOptions({ inheritAttrs: false })\n\nimport { Editor, EditorContent, VueNodeViewRenderer } from '@tiptap/vue-3'\nimport StarterKit from '@tiptap/starter-kit'\nimport Placeholder from '@tiptap/extension-placeholder'\nimport TextAlign from '@tiptap/extension-text-align'\nimport Table from '@tiptap/extension-table'\nimport TableCell from '@tiptap/extension-table-cell'\nimport TableHeader from '@tiptap/extension-table-header'\nimport TableRow from '@tiptap/extension-table-row'\nimport { ImageExtension } from './extensions/image'\nimport ImageViewerExtension from './image-viewer-extension'\nimport VideoExtension from './video-extension'\nimport { IframeExtension } from './extensions/iframe'\nimport LinkExtension from './link-extension'\nimport Typography from '@tiptap/extension-typography'\nimport TextStyle from '@tiptap/extension-text-style'\nimport TaskItem from '@tiptap/extension-task-item'\nimport TaskList from '@tiptap/extension-task-list'\nimport NamedColorExtension from './extensions/color'\nimport NamedHighlightExtension from './extensions/highlight'\nimport { common, createLowlight } from 'lowlight'\nimport CodeBlockLowlight from '@tiptap/extension-code-block-lowlight'\nimport CodeBlockComponent from './CodeBlockComponent.vue'\nimport { MentionExtension } from './extensions/mention'\nimport TextEditorFixedMenu from './TextEditorFixedMenu.vue'\nimport TextEditorBubbleMenu from './TextEditorBubbleMenu.vue'\nimport TextEditorFloatingMenu from './TextEditorFloatingMenu.vue'\nimport EmojiExtension from './extensions/emoji/emoji-extension'\nimport SlashCommands from './extensions/slash-commands/slash-commands-extension'\nimport { ContentPasteExtension } from './extensions/content-paste-extension'\nimport { TagNode, TagExtension } from './extensions/tag/tag-extension'\nimport { Heading } from './extensions/heading/heading'\nimport { ImageGroup } from './extensions/image-group/image-group-extension'\nimport { useFileUpload } from '../../utils/useFileUpload'\nimport { TextEditorEmits, TextEditorProps } from './types'\n\nconst lowlight = createLowlight(common)\n\nfunction defaultUploadFunction(file: File) {\n  // useFileUpload is frappe specific\n  let fileUpload = useFileUpload()\n  return fileUpload.upload(file)\n}\n\nconst props = withDefaults(defineProps<TextEditorProps>(), {\n  content: null,\n  placeholder: '',\n  editorClass: '',\n  editable: true,\n  autofocus: false,\n  bubbleMenu: false,\n  bubbleMenuOptions: () => ({}),\n  fixedMenu: false,\n  floatingMenu: false,\n  extensions: () => [],\n  starterkitOptions: () => ({}),\n  mentions: null,\n  tags: () => [],\n})\n\nconst emit = defineEmits<TextEditorEmits>()\n\nconst editor = ref<Editor | null>(null)\n\nconst attrs = useAttrs()\nconst attrsClass = computed(() => normalizeClass(attrs.class))\nconst attrsStyle = computed(() => normalizeStyle(attrs.style))\n\nconst editorProps = computed(() => {\n  return {\n    attributes: {\n      class: normalizeClass([\n        'prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2',\n        props.editorClass,\n      ]),\n    },\n  }\n})\n\nwatch(\n  () => props.content,\n  (val) => {\n    if (editor.value) {\n      let currentHTML = editor.value.getHTML()\n      if (currentHTML !== val) {\n        editor.value.commands.setContent(val)\n      }\n    }\n  },\n)\n\nwatch(\n  () => props.editable,\n  (value) => {\n    if (editor.value) {\n      editor.value.setEditable(value)\n    }\n  },\n)\n\nwatch(\n  editorProps,\n  (value) => {\n    if (editor.value) {\n      editor.value.setOptions({\n        editorProps: value,\n      })\n    }\n  },\n  { deep: true },\n)\n\nonMounted(() => {\n  editor.value = new Editor({\n    content: props.content || null,\n    editorProps: editorProps.value,\n    editable: props.editable,\n    autofocus: props.autofocus,\n    extensions: [\n      StarterKit.configure({\n        ...props.starterkitOptions,\n        codeBlock: false,\n        heading: false,\n      }),\n      Heading.configure({\n        ...(typeof props.starterkitOptions?.heading === 'object' &&\n        props.starterkitOptions.heading !== null\n          ? props.starterkitOptions.heading\n          : {}),\n      }),\n      Table.configure({\n        resizable: true,\n      }),\n      TaskList,\n      TaskItem.configure({\n        nested: true,\n      }),\n      TableRow,\n      TableHeader,\n      TableCell,\n      Typography,\n      TextAlign.configure({\n        types: ['heading', 'paragraph'],\n      }),\n      TextStyle,\n      NamedColorExtension,\n      NamedHighlightExtension,\n      CodeBlockLowlight.extend({\n        addNodeView() {\n          return VueNodeViewRenderer(CodeBlockComponent)\n        },\n      }).configure({ lowlight }),\n      ImageExtension.configure({\n        uploadFunction: props.uploadFunction || defaultUploadFunction,\n      }),\n      ImageGroup.configure({\n        uploadFunction: props.uploadFunction || defaultUploadFunction,\n      }),\n      ImageViewerExtension,\n      VideoExtension.configure({\n        uploadFunction: props.uploadFunction || defaultUploadFunction,\n      }),\n      IframeExtension,\n      LinkExtension.configure({\n        openOnClick: false,\n      }),\n      Placeholder.configure({\n        placeholder:\n          typeof props.placeholder === 'function'\n            ? props.placeholder\n            : () => props.placeholder as string,\n      }),\n      props.mentions &&\n        MentionExtension.configure(\n          Array.isArray(props.mentions)\n            ? { mentions: props.mentions }\n            : {\n                mentions: props.mentions.mentions,\n                component: props.mentions.component,\n              },\n        ),\n      EmojiExtension,\n      SlashCommands,\n      TagNode,\n      TagExtension.configure({\n        tags: () => props.tags,\n      }),\n      ContentPasteExtension.configure({\n        enabled: true,\n        showConfirmation: true,\n        uploadFunction: props.uploadFunction || defaultUploadFunction,\n      }),\n      ...(props.extensions || []),\n    ],\n    onUpdate: ({ editor }) => {\n      emit('change', editor.getHTML())\n    },\n    onTransaction: ({ editor }) => {\n      emit('transaction', editor)\n    },\n    onFocus: ({ editor, event }) => {\n      emit('focus', event)\n    },\n    onBlur: ({ editor, event }) => {\n      emit('blur', event)\n    },\n  })\n})\n\nonBeforeUnmount(() => {\n  if (editor.value) {\n    editor.value.destroy()\n    editor.value = null\n  }\n})\n\nprovide(\n  'editor',\n  computed(() => editor.value),\n)\n\ndefineExpose({\n  editor,\n})\n</script>\n\n<style>\n@import './extensions/color/color-styles.css';\n@import './extensions/highlight/highlight-styles.css';\n\n.ProseMirror {\n  outline: none;\n  caret-color: var(--ink-gray-9);\n  word-break: break-word;\n}\n\n/* Firefox */\n.ProseMirror-focused:focus-visible {\n  outline: none;\n}\n\n/* Placeholder */\n.ProseMirror:not(.ProseMirror-focused) p.is-editor-empty::before {\n  content: attr(data-placeholder);\n  float: left;\n  color: var(--ink-gray-4);\n  pointer-events: none;\n  height: 0;\n}\n\n.ProseMirror-selectednode video,\nimg.ProseMirror-selectednode {\n  outline: 2px solid var(--outline-gray-2);\n}\n\n/* Table styles */\n.prose table p {\n  margin: 0;\n}\n\n/* Prosemirror specific table styles */\n.ProseMirror table .selectedCell:after {\n  z-index: 2;\n  position: absolute;\n  content: '';\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  background: theme('colors.blue.200');\n  opacity: 0.3;\n}\n\n.ProseMirror table .column-resize-handle {\n  position: absolute;\n  right: -1px;\n  top: 0;\n  bottom: -2px;\n  width: 4px;\n  background-color: theme('colors.blue.200');\n  pointer-events: none;\n}\n\n.ProseMirror ul[data-type='taskList'] {\n  list-style: none;\n  padding: 0;\n\n  li {\n    align-items: flex-start;\n    display: flex;\n    margin: 0;\n\n    > label {\n      flex: 0 0 auto;\n      margin-right: 0.5rem;\n      margin-top: 0.25rem;\n      height: 1lh;\n      display: flex;\n      align-items: center;\n      user-select: none;\n    }\n\n    > div {\n      flex: 1 1 auto;\n      margin-bottom: 0;\n\n      > p {\n        margin: 0.25rem 0;\n      }\n    }\n  }\n  ul[data-type='taskList'] {\n    margin: 0;\n  }\n\n  input[type='checkbox'] {\n    cursor: pointer;\n    width: 14px;\n    height: 14px;\n    border-radius: 4px;\n    color: theme('colors.gray.900');\n  }\n}\n\n.resize-cursor {\n  cursor: ew-resize;\n  cursor: col-resize;\n}\n\n.tag-item,\n.tag-suggestion-active {\n  background-color: var(--surface-gray-1, #f8f8f8);\n  color: inherit;\n  border: 1px solid transparent;\n  padding: 0px 2px;\n  border-radius: 4px;\n  font-size: 1em;\n  white-space: nowrap;\n  cursor: default;\n}\n\n.tag-item.ProseMirror-selectednode {\n  border-color: var(--outline-gray-3, #c7c7c7);\n}\n\n.tag-suggestion-active {\n  background-color: var(--surface-gray-2, #f3f3f3);\n}\n</style>\n","<template>\n  <div\n    class=\"flex h-full w-full flex-col items-center justify-center text-base\"\n  >\n    <slot>\n      <div class=\"text-xl font-medium text-ink-gray-8 mt-6\">{{ list.options.emptyState.title }}</div>\n      <div class=\"mt-1 text-base text-ink-gray-5\">\n        {{ list.options.emptyState.description }}\n      </div>\n      <Button\n        v-if=\"list.options.emptyState.button\"\n        v-bind=\"list.options.emptyState.button\"\n        class=\"mt-4\"\n      ></Button>\n    </slot>\n  </div>\n</template>\n\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from '../Button'\n\nconst list = inject('list')\n</script>\n","export function getGridTemplateColumns(columns, withCheckbox = true) {\n  let checkBoxWidth = withCheckbox ? '14px ' : ''\n  let columnsWidth = columns\n    .map((col) => {\n      let width = col.width || 1\n      if (typeof width === 'number') {\n        return width + 'fr'\n      }\n      return width\n    })\n    .join(' ')\n  return checkBoxWidth + columnsWidth\n}\n\nexport const alignmentMap = {\n  left: 'justify-start',\n  start: 'justify-start',\n  center: 'justify-center',\n  middle: 'justify-center',\n  right: 'justify-end',\n  end: 'justify-end',\n}\n","<template>\n  <div\n    ref=\"columnRef\"\n    class=\"group relative flex items-center\"\n    :class=\"item.align ? alignmentMap[item.align] : 'justify-between'\"\n  >\n    <div\n      class=\"flex items-center space-x-2 truncate text-sm text-ink-gray-5\"\n      :class=\"$attrs.class\"\n    >\n      <slot name=\"prefix\" v-bind=\"{ item }\" />\n      <slot>\n        <div class=\"truncate\">\n          {{ item.label }}\n        </div>\n      </slot>\n      <slot name=\"suffix\" v-bind=\"{ item }\" />\n    </div>\n    <slot v-if=\"list.options.resizeColumn\" name=\"resizer\" v-bind=\"{ item }\">\n      <div\n        class=\"flex h-4 absolute -right-2 w-2 cursor-col-resize justify-center\"\n        @mousedown=\"startResizing\"\n      >\n        <div\n          ref=\"resizer\"\n          class=\"h-full w-[2px] rounded-full transition-all duration-300 ease-in-out group-hover:bg-gray-400\"\n        />\n      </div>\n    </slot>\n  </div>\n</template>\n\n<script setup>\nimport { alignmentMap } from './utils'\nimport { useDebounceFn } from '@vueuse/core'\nimport { ref, computed, inject } from 'vue'\n\nconst props = defineProps({\n  item: {\n    type: Object,\n    required: true,\n  },\n  debounce: {\n    type: Number,\n    default: 1000,\n  },\n})\n\nconst emit = defineEmits(['columnWidthUpdated'])\n\nconst resizer = ref(null)\nconst columnRef = ref(null)\n\nconst widthInPx = computed(() => {\n  if (typeof props.item.width === 'string') {\n    const parsedWidth = parseInt(props.item.width)\n    if (props.item.width.includes('rem')) {\n      return parsedWidth * 16\n    } else if (props.item.width.includes('px')) {\n      return parsedWidth\n    }\n  }\n  return columnRef.value.offsetWidth\n})\n\nconst startResizing = (e) => {\n  const initialX = e.clientX\n  const initialWidth = widthInPx.value\n  const onMouseMove = (e) => {\n    document.body.classList.add('select-none')\n    document.body.classList.add('cursor-col-resize')\n    resizer.value.style.backgroundColor = 'rgb(199 199 199)'\n    let newWidth = initialWidth + (e.clientX - initialX)\n\n    props.item.width = `${newWidth < 50 ? 50 : newWidth}px`\n    updateWidth(props.item.width)\n  }\n  const onMouseUp = () => {\n    document.body.classList.remove('select-none')\n    document.body.classList.remove('cursor-col-resize')\n    resizer.value.style.backgroundColor = ''\n    window.removeEventListener('mousemove', onMouseMove)\n    window.removeEventListener('mouseup', onMouseUp)\n  }\n  window.addEventListener('mousemove', onMouseMove)\n  window.addEventListener('mouseup', onMouseUp)\n}\n\nconst updateWidth = useDebounceFn((width) => {\n  props.item.width = width\n  emit('columnWidthUpdated')\n}, props.debounce)\n\nconst list = inject('list')\n</script>\n","<template>\n  <div\n    class=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\"\n    :style=\"{\n      gridTemplateColumns: getGridTemplateColumns(\n        list.columns,\n        list.options.selectable,\n      ),\n    }\"\n  >\n    <Checkbox\n      v-if=\"list.options.selectable\"\n      class=\"cursor-pointer duration-300\"\n      :modelValue=\"list.allRowsSelected\"\n      @click.stop=\"list.toggleAllRows\"\n    />\n    <slot>\n      <ListHeaderItem\n        v-for=\"column in list.columns\"\n        :key=\"column.key\"\n        :item=\"column\"\n        @columnWidthUpdated=\"emit('columnWidthUpdated', column)\"\n      />\n    </slot>\n  </div>\n</template>\n\n<script setup>\nimport Checkbox from '../Checkbox/Checkbox.vue'\nimport ListHeaderItem from './ListHeaderItem.vue'\nimport { getGridTemplateColumns } from './utils'\nimport { inject } from 'vue'\n\nconst emit = defineEmits(['columnWidthUpdated'])\n\nconst list = inject('list')\n</script>\n","<template>\n  <div class=\"flex items-center space-x-2\" :class=\"alignmentMap[align]\">\n    <slot name=\"prefix\">\n      <component\n        v-if=\"column.prefix\"\n        :is=\"\n          typeof column.prefix === 'function'\n            ? column.prefix({ row })\n            : column.prefix\n        \"\n      />\n    </slot>\n    <Tooltip\n      v-bind=\"\n        list.options.showTooltip\n          ? {\n              text: tooltip,\n            }\n          : { text: '' }\n      \"\n    >\n      <slot v-bind=\"{ label }\">\n        <div class=\"truncate text-base\">{{ label }}</div>\n      </slot>\n    </Tooltip>\n    <slot name=\"suffix\" />\n  </div>\n</template>\n<script setup>\nimport { computed, inject } from 'vue'\nimport { Tooltip } from '../../index'\nimport { alignmentMap } from './utils'\n\nconst props = defineProps({\n  column: {\n    type: Object,\n    default: {},\n  },\n  row: {\n    type: Object,\n    default: {},\n  },\n  item: {\n    type: [String, Number, Object],\n    default: '',\n  },\n  align: {\n    type: String,\n    default: 'left',\n  },\n})\n\nconst label = computed(() => {\n  if (props.column?.getLabel) return props.column?.getLabel({ row: props.row })\n  return getValue(props.item).label || ''\n})\n\nconst tooltip = computed(() => {\n  if (!list.value.options.showTooltip) return ''\n  return props.column.getTooltip\n    ? props.column.getTooltip(props.row)\n    : getValue(props.item).label\n})\n\nfunction getValue(value) {\n  if (value && typeof value === 'object') {\n    return value\n  }\n  return { label: value }\n}\n\nconst list = inject('list')\n</script>\n","<template>\n  <component\n    :is=\"list.options.getRowRoute ? 'router-link' : 'div'\"\n    :class=\"[\n      roundedClass,\n      isSelected || isActive ? 'bg-surface-gray-2' : '',\n      isHoverable ? 'cursor-pointer' : '',\n      isHoverable\n        ? isSelected || isActive\n          ? 'hover:bg-surface-gray-3'\n          : 'hover:bg-surface-menu-bar'\n        : '',\n    ]\"\n    class=\"flex flex-col transition-all duration-300 ease-in-out\"\n    v-bind=\"{\n      to: list.options.getRowRoute ? list.options.getRowRoute(row) : undefined,\n      onClick: (e) => onRowClick(row, e),\n    }\"\n  >\n    <component\n      :is=\"list.options.getRowRoute ? 'template' : 'button'\"\n      class=\"[all:unset] hover:[all:unset]\"\n    >\n      <div\n        class=\"grid items-center space-x-4 px-2\"\n        :style=\"{\n          height: rowHeight,\n          gridTemplateColumns: getGridTemplateColumns(\n            list.columns,\n            list.options.selectable,\n          ),\n        }\"\n      >\n        <div\n          v-if=\"list.options.selectable\"\n          class=\"w-fit pr-2 py-3 flex\"\n          @click.stop.prevent\n          @dblclick.stop\n        >\n          <Checkbox\n            :modelValue=\"isSelected\"\n            class=\"cursor-pointer duration-300\"\n            @click.stop=\"list.toggleRow(row[list.rowKey])\"\n          />\n        </div>\n        <div\n          v-for=\"(column, i) in list.columns\"\n          :key=\"column.key\"\n          :class=\"[\n            alignmentMap[column.align],\n            i == 0 ? 'text-ink-gray-9' : 'text-ink-gray-7',\n          ]\"\n        >\n          <slot v-bind=\"{ idx: i, column, item: row[column.key], isActive }\">\n            <component\n              v-if=\"list.slots.cell\"\n              :is=\"list.slots.cell\"\n              v-bind=\"{\n                column,\n                row,\n                item: row[column.key],\n                align: column.align,\n              }\"\n            />\n            <ListRowItem\n              v-else\n              :column=\"column\"\n              :row=\"row\"\n              :item=\"row[column.key]\"\n              :align=\"column.align\"\n            />\n          </slot>\n        </div>\n      </div>\n      <div\n        v-if=\"!isLastRow\"\n        class=\"h-px border-t\"\n        :class=\"\n          roundedClass === 'rounded' || roundedClass?.includes?.('rounded-b')\n            ? 'mx-2 border-outline-gray-1'\n            : 'border-t-[--surface-gray-2]'\n        \"\n      />\n    </component>\n  </component>\n</template>\n\n<script setup>\nimport Checkbox from '../Checkbox/Checkbox.vue'\nimport ListRowItem from './ListRowItem.vue'\nimport { alignmentMap, getGridTemplateColumns } from './utils'\nimport { computed, inject, ref } from 'vue'\n\nconst props = defineProps({\n  row: {\n    type: Object,\n    required: true,\n  },\n})\n\nconst list = inject('list')\n\nconst isLastRow = computed(() => {\n  if (!list.value.rows?.length) return false\n  return (\n    list.value.rows[list.value.rows.length - 1][list.value.rowKey] ===\n    props.row[list.value.rowKey]\n  )\n})\n\nconst isSelected = computed(() => {\n  return list.value.selections.has(props.row[list.value.rowKey])\n})\nconst isActive = computed(\n  () =>\n    list.value.options.enableActive &&\n    list.value.activeRow.value === props.row.name,\n)\n\nconst isHoverable = computed(() => {\n  return list.value.options.getRowRoute || list.value.options.onRowClick\n})\n\nconst rowHeight = computed(() => {\n  if (typeof list.value.options.rowHeight === 'number') {\n    return `${list.value.options.rowHeight}px`\n  }\n  return list.value.options.rowHeight\n})\n\nconst roundedClass = computed(() => {\n  if (!isSelected.value) return 'rounded'\n  const selections = [...list.value.selections]\n  let groups = list.value.rows[0]?.group\n    ? list.value.rows.map((k) => k.rows)\n    : [list.value.rows]\n\n  for (let rows of groups) {\n    let currentIndex = rows.findIndex((k) => k == props.row)\n    if (currentIndex === -1) continue\n    let atBottom = !selections.includes(rows[currentIndex + 1]?.name)\n    let atTop = !selections.includes(rows[currentIndex - 1]?.name)\n    return (atBottom ? 'rounded-b ' : '') + (atTop ? 'rounded-t' : '')\n  }\n})\n\nconst onRowClick = (row, e) => {\n  if (list.value.options.onRowClick) list.value.options.onRowClick(row, e)\n  if (list.value.activeRow.value === row.name) {\n    list.value.activeRow.value = null\n  } else {\n    list.value.activeRow.value = row.name\n  }\n}\n</script>\n","<template>\n  <div class=\"h-full overflow-y-auto\">\n    <slot>\n      <ListRow v-for=\"row in list.rows\" :key=\"row[list.rowKey]\" :row=\"row\" />\n    </slot>\n  </div>\n</template>\n\n<script setup>\nimport ListRow from './ListRow.vue'\nimport { inject } from 'vue'\n\nconst list = inject('list')\n</script>\n","<template>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\">\n    <path\n      fill=\"currentColor\"\n      d=\"M4.293 5.28h7.413a.5.5 0 0 1 .41.787l-3.707 5.295a.5.5 0 0 1-.82 0L3.884 6.067a.5.5 0 0 1 .41-.787Z\"\n    />\n  </svg>\n</template>\n","<template>\n  <div class=\"flex items-center\">\n    <button\n      @click=\"toggleGroup\"\n      class=\"ml-[3px] mr-[11px] rounded p-1 hover:bg-surface-gray-2\"\n    >\n      <DownSolid\n        class=\"h-4 w-4 text-ink-gray-6 transition-transform duration-200\"\n        :class=\"[group.collapsed ? '-rotate-90' : '']\"\n      />\n    </button>\n    <slot>\n      <div class=\"w-full py-1.5 pr-2\">\n        <component\n          v-if=\"list.slots['group-header']\"\n          :is=\"list.slots['group-header']\"\n          v-bind=\"{ group }\"\n        />\n        <span v-else class=\"text-base font-medium leading-6\">\n          {{ group.group }}\n        </span>\n      </div>\n    </slot>\n  </div>\n  <div class=\"mx-2 h-px border-t border-outline-gray-modals\"></div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport DownSolid from '../../icons/DownSolid.vue'\n\nconst props = defineProps({\n  group: {\n    type: Object,\n    required: true,\n  },\n})\n\nconst list = inject('list')\n\nfunction toggleGroup() {\n  if (props.group.collapsed == null) {\n    props.group.collapsed = false\n  }\n  props.group.collapsed = !props.group.collapsed\n}\n</script>\n","<template>\n  <div class=\"mb-5 mt-2\" v-if=\"!group.collapsed\">\n    <slot>\n      <ListRow v-for=\"row in group.rows\" :key=\"row[list.rowKey]\" :row=\"row\" />\n    </slot>\n  </div>\n</template>\n<script setup>\nimport ListRow from './ListRow.vue'\nimport { inject } from 'vue'\n\nconst props = defineProps({\n  group: {\n    type: Object,\n    required: true,\n  },\n})\nconst list = inject('list')\n</script>\n","<template>\n  <div class=\"h-full overflow-y-auto\">\n    <div v-for=\"group in list.rows\" :key=\"group.group\">\n      <slot>\n        <ListGroupHeader :group=\"group\">\n          <slot\n            name=\"group-header\"\n            v-if=\"$slots['group-header']\"\n            v-bind=\"{ group }\"\n          />\n        </ListGroupHeader>\n        <ListGroupRows :group=\"group\" />\n      </slot>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport ListGroupHeader from './ListGroupHeader.vue'\nimport ListGroupRows from './ListGroupRows.vue'\nimport { inject } from 'vue'\n\nconst list = inject('list')\n</script>\n","<template>\n  <transition\n    enter-active-class=\"duration-300 ease-out\"\n    enter-from-class=\"transform opacity-0\"\n    enter-to-class=\"opacity-100\"\n    leave-active-class=\"duration-300 ease-in\"\n    leave-from-class=\"opacity-100\"\n    leave-to-class=\"transform opacity-0\"\n  >\n    <div\n      v-if=\"list.selections.size\"\n      class=\"absolute inset-x-0 bottom-6 mx-auto w-max text-base\"\n    >\n      <div\n        class=\"flex min-w-[596px] items-center space-x-3 rounded-lg bg-surface-white px-4 py-2 shadow-2xl\"\n        :class=\"$attrs.class\"\n      >\n        <slot\n          v-bind=\"{\n            selections: list.selections,\n            allRowsSelected: list.allRowsSelected,\n            selectAll: () => list.toggleAllRows(true),\n            unselectAll: () => list.toggleAllRows(false),\n          }\"\n        >\n          <div\n            class=\"flex flex-1 justify-between border-r border-outline-gray-2 text-ink-gray-9\"\n          >\n            <div class=\"flex items-center space-x-3\">\n              <Checkbox\n                :modelValue=\"true\"\n                :disabled=\"true\"\n                class=\"text-ink-gray-9\"\n              />\n              <div>{{ selectedText }}</div>\n            </div>\n            <div class=\"mr-3\">\n              <slot\n                name=\"actions\"\n                v-bind=\"{\n                  selections: list.selections,\n                  allRowsSelected: list.allRowsSelected,\n                  selectAll: () => list.toggleAllRows(true),\n                  unselectAll: () => list.toggleAllRows(false),\n                }\"\n              />\n            </div>\n          </div>\n          <div class=\"flex items-center space-x-1\">\n            <Button\n              class=\"w- text-ink-gray-7\"\n              :disabled=\"list.allRowsSelected\"\n              :class=\"list.allRowsSelected ? 'cursor-not-allowed' : ''\"\n              variant=\"ghost\"\n              @click=\"list.toggleAllRows(true)\"\n            >\n              Select all\n            </Button>\n            <Button\n              icon=\"x\"\n              variant=\"ghost\"\n              @click=\"list.toggleAllRows(false)\"\n            />\n          </div>\n        </slot>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script setup>\nimport Checkbox from '../Checkbox/Checkbox.vue'\nimport { Button } from '../Button'\nimport { computed, inject } from 'vue'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst list = inject('list')\n\nlet selectedText = computed(() => {\n  return list.value.options.selectionText(list.value.selections.size)\n})\n</script>\n","<template>\n  <div class=\"relative flex w-full flex-1 flex-col overflow-x-auto\">\n    <div\n      class=\"flex w-max min-w-full flex-col overflow-y-hidden\"\n      :class=\"$attrs.class\"\n      :style=\"$attrs.style\"\n    >\n      <slot v-bind=\"{ showGroupedRows, selectable }\">\n        <ListHeader />\n        <template v-if=\"props.rows.length\">\n          <ListGroups v-if=\"showGroupedRows\" />\n          <ListRows v-else />\n        </template>\n        <ListEmptyState v-else />\n        <ListSelectBanner v-if=\"selectable\" />\n      </slot>\n    </div>\n  </div>\n</template>\n<script setup>\nimport ListEmptyState from './ListEmptyState.vue'\nimport ListHeader from './ListHeader.vue'\nimport ListRows from './ListRows.vue'\nimport ListGroups from './ListGroups.vue'\nimport ListSelectBanner from './ListSelectBanner.vue'\nimport { ref, reactive, computed, provide, watch, useSlots } from 'vue'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst props = defineProps({\n  columns: {\n    type: Array,\n    default: [],\n  },\n  rows: {\n    type: Array,\n    default: [],\n  },\n  rowKey: {\n    type: String,\n    required: true,\n  },\n  options: {\n    type: Object,\n    default: () => ({\n      getRowRoute: null,\n      onRowClick: null,\n      showTooltip: true,\n      selectable: true,\n      resizeColumn: false,\n      rowHeight: 40,\n      emptyState: {\n        title: 'No Data',\n        description: 'No data available',\n      },\n    }),\n  },\n})\n\nconst slots = useSlots()\n\nlet selections = reactive(new Set())\nlet activeRow = ref(null)\n\nconst emit = defineEmits(['update:selections', 'update:active-row'])\n\nwatch(selections, (value) => {\n  if (selections.size) {\n    activeRow.value = null\n  }\n  emit('update:selections', value)\n})\n\nwatch(activeRow, (value) => {\n  emit('update:active-row', value)\n})\n\nlet _options = computed(() => {\n  function defaultTrue(value) {\n    return value === undefined ? true : value\n  }\n\n  function defaultFalse(value) {\n    return value === undefined ? false : value\n  }\n\n  return {\n    getRowRoute: props.options.getRowRoute || null,\n    onRowClick: props.options.onRowClick || null,\n    showTooltip: defaultTrue(props.options.showTooltip),\n    selectionText:\n      props.options.selectionText ||\n      ((val) => (val === 1 ? '1 row selected' : `${val} rows selected`)),\n    enableActive: defaultFalse(props.options.enableActive),\n    selectable: defaultTrue(props.options.selectable),\n    resizeColumn: defaultFalse(props.options.resizeColumn),\n    rowHeight: props.options.rowHeight || 40,\n    emptyState: props.options.emptyState,\n  }\n})\n\nconst allRowsSelected = computed(() => {\n  if (!props.rows.length) return false\n  if (showGroupedRows.value) {\n    return (\n      selections.size ===\n      props.rows.reduce((acc, row) => acc + row.rows.length, 0)\n    )\n  }\n  return selections.size === props.rows.length\n})\n\nconst selectable = computed(() => {\n  return _options.value.selectable\n})\n\nlet showGroupedRows = computed(() => {\n  return props.rows.every(\n    (row) => row.group && row.rows && Array.isArray(row.rows)\n  )\n})\n\nfunction toggleRow(row) {\n  if (!selections.delete(row)) {\n    selections.add(row)\n  }\n}\n\nfunction toggleAllRows(select) {\n  if (!select || allRowsSelected.value) {\n    selections.clear()\n    return\n  }\n  if (showGroupedRows.value) {\n    props.rows.forEach((row) => {\n      row.rows.forEach((r) => selections.add(r[props.rowKey]))\n    })\n    return\n  }\n  props.rows.forEach((row) => selections.add(row[props.rowKey]))\n}\n\nprovide(\n  'list',\n  computed(() => ({\n    rowKey: props.rowKey,\n    rows: props.rows,\n    columns: props.columns,\n    options: _options.value,\n    selections: selections,\n    activeRow: activeRow,\n    allRowsSelected: allRowsSelected.value,\n    slots: slots,\n    toggleRow,\n    toggleAllRows,\n  }))\n)\n\ndefineExpose({\n  selections,\n  allRowsSelected,\n  toggleRow,\n  toggleAllRows,\n})\n</script>\n","<template>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\">\n    <path\n      fill=\"currentColor\"\n      d=\"M8 .75a7.25 7.25 0 1 1 0 14.5A7.25 7.25 0 0 1 8 .75Zm0 1a6.25 6.25 0 1 0 0 12.5 6.25 6.25 0 0 0 0-12.5Zm2.59 3.527a.501.501 0 0 1 .758.623l-.057.085-3.848 4.666a.501.501 0 0 1-.78-.011L4.936 8.41l-.053-.086a.501.501 0 0 1 .775-.6l.07.074 1.34 1.733 3.45-4.183.072-.072Z\"\n    />\n  </svg>\n</template>\n<script setup lang=\"ts\"></script>\n","<template>\n  <ToastRoot\n    v-model:open=\"modelOpen\"\n    :duration=\"closable ? duration : 0\"\n    :class=\"[\n      'toast-root-animatable',\n      'bg-surface-gray-6 border-none rounded-md px-4 py-1.5 shadow-lg flex items-center justify-between gap-3 min-w-[280px] max-w-[400px] pointer-events-auto list-none',\n    ]\"\n  >\n    <div class=\"flex items-center gap-2 flex-grow overflow-hidden\">\n      <div>\n        <component v-if=\"icon\" :is=\"icon\" class=\"flex-shrink-0 size-4\" />\n        <CircleCheck\n          v-else-if=\"type == 'success'\"\n          class=\"flex-shrink-0 size-4 text-ink-green-2\"\n        />\n        <LucideAlertTriangle\n          v-else-if=\"type == 'warning'\"\n          class=\"flex-shrink-0 size-4 text-ink-amber-2\"\n        />\n        <LucideInfo\n          v-else-if=\"type == 'error'\"\n          class=\"flex-shrink-0 size-4 text-ink-red-2\"\n        />\n      </div>\n      <div class=\"flex flex-col flex-grow overflow-hidden\">\n        <ToastDescription\n          v-if=\"message\"\n          class=\"text-p-sm break-words text-ink-white\"\n          v-html=\"message\"\n        />\n      </div>\n    </div>\n    <div class=\"flex items-center gap-2 h-7\">\n      <ToastAction\n        v-if=\"action\"\n        class=\"flex-shrink-0 rounded px-2 py-1 text-sm text-ink-blue-link hover:text-ink-gray-3 focus:outline-none focus-visible:ring focus-visible:ring-outline-gray-4\"\n        :alt-text=\"action.altText || action.label\"\n        @click=\"handleAction\"\n      >\n        {{ action.label }}\n      </ToastAction>\n      <ToastClose\n        v-if=\"closable\"\n        class=\"flex-shrink-0 rounded p-1 text-ink-white hover:text-ink-gray-3 focus:outline-none focus-visible:ring focus-visible:ring-outline-gray-4\"\n      >\n        <LucideX class=\"size-4\" />\n      </ToastClose>\n    </div>\n  </ToastRoot>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { ToastAction, ToastClose, ToastDescription, ToastRoot } from 'reka-ui'\nimport LucideInfo from '~icons/lucide/info'\nimport LucideAlertTriangle from '~icons/lucide/alert-triangle'\nimport LucideX from '~icons/lucide/x'\nimport CircleCheck from '../../icons/CircleCheck.vue'\nimport type { ToastProps } from './types'\n\nconst props = defineProps<ToastProps>()\n\nconst emit = defineEmits<{\n  (e: 'update:open', value: boolean): void\n  (e: 'action'): void\n}>()\n\nconst modelOpen = computed({\n  get: () => props.open,\n  set: (value) => emit('update:open', value),\n})\n\nfunction handleAction() {\n  props.action?.onClick?.()\n  emit('action')\n}\n</script>\n\n<style>\n@keyframes KSlideIn {\n  from {\n    transform: translateY(calc(100% + var(--viewport-padding, 32px)))\n      scale(0.95);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0) scale(1);\n    opacity: 1;\n  }\n}\n\n@keyframes KHide {\n  from {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(calc(50% + var(--viewport-padding, 32px))) scale(0.95);\n  }\n}\n\n@keyframes KSwipeOut {\n  from {\n    opacity: 1;\n    transform: translateY(var(--reka-toast-swipe-end-y)) scale(1);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(calc(100% + var(--viewport-padding, 32px))) scale(0.9);\n  }\n}\n\n.toast-root-animatable {\n  transition:\n    transform 400ms cubic-bezier(0.2, 0.8, 0.2, 1),\n    opacity 400ms cubic-bezier(0.2, 0.8, 0.2, 1);\n}\n\n.toast-root-animatable[data-state='open'] {\n  animation: KSlideIn 300ms cubic-bezier(0.21, 1.02, 0.73, 1) forwards;\n}\n\n.toast-root-animatable[data-state='closed'] {\n  animation: KHide 250ms cubic-bezier(0.26, 0.09, 0.58, 1) forwards;\n}\n\n.toast-root-animatable[data-swipe='move'] {\n  transform: translateY(var(--reka-toast-swipe-move-y));\n  opacity: 1;\n  transition: none;\n}\n\n.toast-root-animatable[data-swipe='cancel'] {\n  transform: translateY(0);\n  transition: transform 250ms cubic-bezier(0.21, 1.02, 0.73, 1);\n  opacity: 1;\n}\n\n.toast-root-animatable[data-swipe='end'] {\n  animation: KSwipeOut 250ms cubic-bezier(0.26, 0.09, 0.58, 1) forwards;\n}\n</style>\n","import DOMPurify from 'dompurify'\nimport { defineComponent, h, ref, Ref } from 'vue'\nimport LoadingIndicator from '../LoadingIndicator.vue'\nimport ToastComponent from './Toast.vue'\nimport type { ToastProps } from './types'\n\ninterface ToastOptions\n  extends Omit<Partial<ToastProps>, 'open' | 'message' | 'title'> {\n  id?: string\n  message: string\n}\n\ninterface ToastItem\n  extends Pick<\n    ToastProps,\n    'duration' | 'action' | 'type' | 'icon' | 'closable'\n  > {\n  id: string\n  open: boolean\n  message: string\n}\n\ninterface ToastPromiseOptions<TData = any, TError = any> {\n  loading: string\n  /** Message for success state, or a function that returns a message. */\n  success: string | ((data: TData) => string)\n  /** Message for error state, or a function that returns a message. */\n  error: string | ((error: TError) => string)\n  /** Optional: Duration in seconds for the success toast. Defaults to 5 seconds. */\n  successDuration?: number\n  /** Optional: Duration in seconds for the error toast. Defaults to 5 seconds. */\n  errorDuration?: number\n  /** Optional: Common duration in seconds for all toast states, unless overridden by successDuration or errorDuration. */\n  duration?: number\n}\n\nconst toastsState: Ref<ToastItem[]> = ref([])\nlet toastIdCounter = 0\n\nconst updateToastInState = (\n  id: string,\n  updates: Partial<Omit<ToastItem, 'id'>>,\n) => {\n  const index = toastsState.value.findIndex((t) => t.id === id)\n  if (index !== -1) {\n    toastsState.value[index] = {\n      ...toastsState.value[index],\n      ...updates,\n      open: true,\n    }\n  }\n}\n\nexport const toast = {\n  create: (options: ToastOptions): string => {\n    const id = `toast-${toastIdCounter++}`\n    const durationInMs =\n      options.duration != null ? options.duration * 1000 : 5000\n\n    const sanitizedMessage = DOMPurify.sanitize(options.message, {\n      ALLOWED_TAGS: ['a', 'em', 'strong', 'i', 'b', 'u'],\n    })\n\n    const toastItem: ToastItem = {\n      id: options.id || id,\n      open: true,\n      message: sanitizedMessage,\n      type: options.type || 'info',\n      duration: durationInMs,\n      action: options.action,\n      icon: options.icon,\n      closable: options.closable ?? true,\n    }\n    toastsState.value.push(toastItem)\n    return toastItem.id\n  },\n  remove: (id: string) => {\n    toastsState.value = toastsState.value.filter((t) => t.id !== id)\n  },\n  removeAll: () => {\n    toastsState.value = []\n  },\n\n  promise: async <TData = any, TError = any>(\n    promiseToResolve: Promise<TData>,\n    options: ToastPromiseOptions<TData, TError>,\n  ): Promise<TData> => {\n    const loadingDurationInSeconds = options.duration ?? 0\n\n    const toastId = toast.create({\n      message: options.loading,\n      type: 'info',\n      icon: () => h(LoadingIndicator, { class: 'text-ink-white' }),\n      duration: loadingDurationInSeconds,\n      closable: false,\n    })\n\n    try {\n      const data = await promiseToResolve\n      const successMessage =\n        typeof options.success === 'function'\n          ? options.success(data)\n          : options.success\n\n      const successToastDurationInSeconds =\n        options.successDuration ?? options.duration ?? 5\n\n      updateToastInState(toastId, {\n        message: successMessage,\n        type: 'success',\n        duration: successToastDurationInSeconds * 1000,\n        icon: undefined,\n        closable: true,\n      })\n      return data\n    } catch (error) {\n      const errorMessage =\n        typeof options.error === 'function'\n          ? options.error(error as TError)\n          : options.error\n\n      const errorToastDurationInSeconds =\n        options.errorDuration ?? options.duration ?? 5\n\n      updateToastInState(toastId, {\n        message: errorMessage,\n        type: 'error',\n        duration: errorToastDurationInSeconds * 1000,\n        icon: undefined,\n        closable: true,\n      })\n      throw error\n    }\n  },\n\n  success: (\n    message: string,\n    options: Omit<ToastOptions, 'message' | 'type'> = {},\n  ) => toast.create({ message, type: 'success', ...options }),\n  error: (\n    message: string,\n    options: Omit<ToastOptions, 'message' | 'type'> = {},\n  ) => toast.create({ message, type: 'error', ...options }),\n  warning: (\n    message: string,\n    options: Omit<ToastOptions, 'message' | 'type'> = {},\n  ) => toast.create({ message, type: 'warning', ...options }),\n  info: (\n    message: string,\n    options: Omit<ToastOptions, 'message' | 'type'> = {},\n  ) => toast.create({ message, type: 'info', ...options }),\n}\n\nexport const Toasts = defineComponent({\n  name: 'FrappeToasts',\n  setup() {\n    const handleUpdateOpen = (id: string, isOpen: boolean) => {\n      if (!isOpen) {\n        toast.remove(id)\n      } else {\n        const t = toastsState.value.find((item) => item.id === id)\n        if (t) t.open = true\n      }\n    }\n\n    const handleActionForItem = (toastItem: ToastItem) => {\n      toast.remove(toastItem.id)\n    }\n\n    return () =>\n      toastsState.value.map((t) =>\n        h(ToastComponent, {\n          key: t.id,\n          open: t.open,\n          message: t.message,\n          type: t.type,\n          duration: t.duration,\n          action: t.action,\n          icon: t.icon,\n          closable: t.closable,\n          'onUpdate:open': (isOpen) => handleUpdateOpen(t.id, isOpen),\n          onAction: () => handleActionForItem(t),\n        }),\n      )\n  },\n})\n","import { ref, computed } from 'vue'\nimport {\n  groupBy,\n  calculateMinutes,\n  findOverlappingEventsCount,\n} from '../calendarUtils'\n\nexport const activeEvent = ref('')\n\nexport default function useCalendarData(events, view = '') {\n  const timedEvents = computed(() => {\n    let groupByDate = groupBy(events, (row) => row.date)\n    let sortedArray = {}\n    if (view === 'Month') {\n      for (const [key, value] of Object.entries(groupByDate)) {\n        sortedArray[key] = sortMonthlyEvents(value)\n      }\n    } else {\n      for (let [key, value] of Object.entries(groupByDate)) {\n        value = value.filter((event) => !event.isFullDay)\n        value.forEach((task) => {\n          task.startTime = calculateMinutes(task.fromTime)\n          task.endTime = calculateMinutes(task.toTime)\n        })\n        let sortedEvents = value.sort((a, b) => a.startTime - b.startTime)\n        sortedArray[key] = findOverlappingEventsCount(sortedEvents)\n      }\n    }\n    return sortedArray\n  })\n\n  const fullDayEvents = computed(() => {\n    let fullDay = events.filter((event) => event.isFullDay)\n    let dateGroup = groupBy(fullDay, (row) => row.date)\n    return dateGroup\n  })\n\n  return { timedEvents, fullDayEvents }\n}\n\nfunction sortMonthlyEvents(events) {\n  let fullDayEvents = events.filter((event) => event.isFullDay)\n  let timedEvents = events\n    .filter((event) => !event.isFullDay)\n    .sort((a, b) =>\n      a.fromTime !== b.fromTime\n        ? calculateMinutes(a.fromTime) > calculateMinutes(b.fromTime)\n          ? 1\n          : -1\n        : calculateMinutes(a.toTime) > calculateMinutes(b.toTime)\n          ? 1\n          : -1,\n    )\n  // full day events should be at the top in month view\n  return [...fullDayEvents, ...timedEvents]\n}\n","<template>\n  <ToastProvider swipe-direction=\"down\">\n    <slot />\n    <Toasts />\n    <ToastViewport\n      class=\"fixed bottom-0 items-end right-0 flex flex-col p-5 gap-[10px] w-auto max-w-full z-[2147483647] outline-none pointer-events-none\"\n    />\n  </ToastProvider>\n</template>\n\n<script setup lang=\"ts\">\nimport { ToastProvider, ToastViewport } from 'reka-ui'\nimport { Toasts } from '../Toast/index'\n</script>\n","<template>\n  <ToastProvider>\n    <slot />\n  </ToastProvider>\n</template>\n\n<script setup lang=\"ts\">\nimport ToastProvider from '../Toast/ToastProvider.vue'\n</script>\n","export default async function call(method, args, options = {}) {\n  if (!args) {\n    args = {}\n  }\n\n  let headers = Object.assign(\n    {\n      Accept: 'application/json',\n      'Content-Type': 'application/json; charset=utf-8',\n      'X-Frappe-Site-Name': window.location.hostname,\n    },\n    options.headers || {},\n  )\n\n  if (window.csrf_token && window.csrf_token !== '{{ csrf_token }}') {\n    headers['X-Frappe-CSRF-Token'] = window.csrf_token\n  }\n\n  let path = method.startsWith('/') ? method : `/api/method/${method}`\n  const res = await fetch(path, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(args),\n  })\n\n  if (res.ok) {\n    const data = await res.json()\n    if (data.docs || method === 'login') {\n      return data\n    }\n    if (data.exc) {\n      try {\n        console.groupCollapsed(method)\n        console.log(`method: ${method}`)\n        console.log(`params:`, args)\n        let warning = JSON.parse(data.exc)\n        for (let text of warning) {\n          console.log(text)\n        }\n        console.groupEnd()\n      } catch (e) {\n        console.warn('Error printing debug messages', e)\n      }\n    }\n    return data.message\n  } else {\n    let response = await res.text()\n    let error, exception\n    try {\n      error = JSON.parse(response)\n      // eslint-disable-next-line no-empty\n    } catch (e) {}\n    let errorParts = [\n      [method, error.exc_type, error._error_message].filter(Boolean).join(' '),\n    ]\n    if (error.exc) {\n      exception = error.exc\n      try {\n        exception = JSON.parse(exception)[0]\n        console.log(exception)\n        // eslint-disable-next-line no-empty\n      } catch (e) {}\n    }\n    let e = new Error(errorParts.join('\\n'))\n    e.exc_type = error.exc_type\n    e.exc = exception\n    e.status = res.status\n    e.messages = error._server_messages\n      ? JSON.parse(error._server_messages)\n      : []\n    e.messages = e.messages.concat(error.message)\n    e.messages = e.messages.map((m) => {\n      try {\n        return JSON.parse(m).message\n      } catch (error) {\n        return m\n      }\n    })\n    e.messages = e.messages.filter(Boolean)\n    if (!e.messages.length) {\n      e.messages = error._error_message\n        ? [error._error_message]\n        : ['Internal Server Error']\n    }\n\n    if (options.onError) {\n      options.onError({ response: res, status: res.status, error: e })\n    }\n\n    throw e\n  }\n}\n\nexport function createCall(options) {\n  return function customCall(method, args) {\n    return call(method, args, options)\n  }\n}\n","export default (file: File): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.onloadend = () => {\n      if (reader.result == null) {\n        reject(new Error('FileReader result is null'))\n      } else if (typeof reader.result === 'string') {\n        resolve(reader.result)\n      }\n    }\n    reader.readAsDataURL(file)\n  })\n}\n","import {\n  watch,\n  getCurrentInstance,\n  onBeforeUnmount,\n  type App,\n  type WatchStopHandle,\n} from 'vue'\n\ninterface PageMeta {\n  title?: string\n  emoji?: string\n  icon?: string\n}\n\ntype PageMetaFunction = () => PageMeta | null | undefined\ntype StopWatcherFunction = () => void\n\nlet faviconRef: HTMLLinkElement | null = null\nlet defaultFavIcon: string | null = null\n\nfunction initializeFavicon(): void {\n  if (typeof window !== 'undefined' && !faviconRef) {\n    faviconRef = document.querySelector('link[rel=\"icon\"]')\n    defaultFavIcon = faviconRef?.href || null\n  }\n}\n\nexport function usePageMeta(fn: PageMetaFunction): StopWatcherFunction {\n  // Initialize favicon if we're on the client\n  if (typeof window !== 'undefined') {\n    initializeFavicon()\n  }\n\n  const stopWatcher: WatchStopHandle = watch(\n    () => {\n      try {\n        return fn()\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n          console.warn('Failed to parse pageMeta in', fn)\n          console.error(error)\n        }\n        return null\n      }\n    },\n    (pageMeta: PageMeta | null | undefined) => {\n      // Only execute on client side\n      if (typeof window === 'undefined') return\n      if (!pageMeta) return\n\n      if (pageMeta.title) {\n        document.title = pageMeta.title\n      }\n\n      // Ensure favicon ref is initialized\n      if (!faviconRef) initializeFavicon()\n\n      if (pageMeta.emoji) {\n        const href = `data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${pageMeta.emoji}</text></svg>`\n        if (faviconRef) faviconRef.href = href\n      } else if (pageMeta.icon) {\n        if (faviconRef) faviconRef.href = pageMeta.icon\n      } else {\n        if (faviconRef && defaultFavIcon) faviconRef.href = defaultFavIcon\n      }\n    },\n    {\n      immediate: true,\n      deep: true,\n    },\n  )\n\n  // Auto-cleanup if called within a component (like <script setup>)\n  const instance = getCurrentInstance()\n  if (instance) {\n    onBeforeUnmount(stopWatcher)\n  }\n\n  return stopWatcher\n}\n\ninterface PageMetaPlugin {\n  install(app: App): void\n}\n\nexport default {\n  install(app: App): void {\n    app.mixin(createMixin())\n  },\n} as PageMetaPlugin\n\ninterface ComponentWithPageMeta {\n  $options: {\n    pageMeta?: PageMetaFunction\n  }\n  _pageMetaStopWatcher?: StopWatcherFunction\n}\n\nfunction createMixin() {\n  return {\n    mounted(this: ComponentWithPageMeta): void {\n      if (this.$options.pageMeta) {\n        const fn = this.$options.pageMeta.bind(this)\n        this._pageMetaStopWatcher = usePageMeta(fn)\n      }\n    },\n    beforeUnmount(this: ComponentWithPageMeta): void {\n      if (this._pageMetaStopWatcher) {\n        this._pageMetaStopWatcher()\n        this._pageMetaStopWatcher = undefined\n      }\n    },\n  }\n}\n","export function request(_options) {\n  let options = Object.assign({}, _options)\n  if (!options.url) {\n    throw new Error('[request] options.url is required')\n  }\n  if (options.transformRequest) {\n    options = options.transformRequest(_options)\n  }\n  if (!options.responseType) {\n    options.responseType = 'json'\n  }\n  if (!options.method) {\n    options.method = 'GET'\n  }\n\n  let url = options.url\n  let body\n  if (options.params) {\n    if (options.method === 'GET') {\n      let params = new URLSearchParams()\n      for (let key in options.params) {\n        params.append(key, options.params[key])\n      }\n      url = options.url + '?' + params.toString()\n    } else {\n      body = JSON.stringify(options.params)\n    }\n  }\n\n  return fetch(url, {\n    method: options.method || 'GET',\n    headers: options.headers,\n    body,\n  })\n    .then((response) => {\n      if (options.transformResponse) {\n        return options.transformResponse(response, options)\n      }\n      if (response.status >= 200 && response.status < 300) {\n        if (options.responseType === 'json') {\n          return response.json()\n        }\n        return response\n      } else {\n        let error = new Error(response.statusText)\n        error.response = response\n        throw error\n      }\n    })\n    .catch((error) => {\n      if (options.transformError) {\n        return options.transformError(error)\n      }\n      throw error\n    })\n}\n","import { get, set, del } from 'idb-keyval'\n\nexport function saveLocal(key, data) {\n  if (typeof indexedDB === 'undefined') {\n    return Promise.resolve(null)\n  }\n  if (!key) return Promise.resolve()\n  return set(key, JSON.stringify(data))\n}\n\nexport function deleteLocal(key) {\n  if (typeof indexedDB === 'undefined') {\n    return Promise.resolve(null)\n  }\n  if (!key) return Promise.resolve()\n  return del(key)\n}\n\nexport function getLocal(key) {\n  if (typeof indexedDB === 'undefined') {\n    return Promise.resolve(null)\n  }\n  return get(key).then((val) => (val ? JSON.parse(val) : val))\n}\n","import { reactive } from 'vue'\nimport debounce from '../utils/debounce'\nimport { request } from '../utils/request'\nimport { getLocal, saveLocal } from './local'\nimport { getConfig } from '../utils/config'\n\nlet cached = {}\n\nexport function createResource(options, vm) {\n  let cacheKey = null\n  if (options.cache) {\n    cacheKey = getCacheKey(options.cache)\n    let cachedResource = cached[cacheKey]\n\n    if (cachedResource) {\n      if (cachedResource.auto) {\n        cachedResource.reload()\n      }\n      return cachedResource\n    }\n  }\n\n  if (typeof options == 'string') {\n    options = {\n      url: options,\n      auto: true,\n    }\n  }\n\n  let fetchFunction = options.debounce\n    ? debounce(fetch, options.debounce)\n    : fetch\n\n  let out = reactive({\n    method: options.method,\n    url: options.url,\n    data: options.initialData || null,\n    previousData: null,\n    loading: false,\n    fetched: false,\n    error: null,\n    promise: null,\n    auto: options.auto,\n    params: null,\n    fetch: fetchFunction,\n    reload: fetchFunction,\n    submit: fetchFunction,\n    reset,\n    update,\n    setData,\n  })\n\n  async function fetch(params, tempOptions = {}) {\n    let resourceFetcher =\n      options.resourceFetcher || getConfig('resourceFetcher') || request\n\n    if (params instanceof Event) {\n      params = null\n    }\n    params = params || out.params\n    if (options.makeParams) {\n      params = options.makeParams.call(vm, params)\n    }\n    out.params = params\n    out.previousData = out.data ? JSON.parse(JSON.stringify(out.data)) : null\n    out.loading = true\n    out.error = null\n\n    if (options.onFetch) {\n      options.onFetch.call(vm, out.params)\n    }\n\n    let beforeSubmitFunctions = [options.beforeSubmit, tempOptions.beforeSubmit]\n    for (let fn of beforeSubmitFunctions) {\n      if (fn) {\n        fn.call(vm, out.params)\n      }\n    }\n\n    let validateFunction = tempOptions.validate || options.validate\n    let errorFunctions = [options.onError, tempOptions.onError]\n    let successFunctions = [options.onSuccess, tempOptions.onSuccess]\n    let dataFunctions = [options.onData, tempOptions.onData]\n\n    if (validateFunction) {\n      let invalidMessage\n      try {\n        invalidMessage = await validateFunction.call(vm, out.params)\n        if (invalidMessage && typeof invalidMessage == 'string') {\n          throw new Error(invalidMessage)\n        }\n      } catch (error) {\n        handleError(error, errorFunctions)\n        return\n      }\n    }\n\n    try {\n      out.promise = resourceFetcher({\n        ...options,\n        params: params || options.params,\n      })\n      let data = await out.promise\n      saveLocal(cacheKey, data)\n      out.data = transform(data)\n      out.fetched = true\n      for (let fn of successFunctions) {\n        if (fn) {\n          fn.call(vm, data)\n        }\n      }\n      for (let fn of dataFunctions) {\n        if (fn) {\n          fn.call(vm, data)\n        }\n      }\n    } catch (error) {\n      handleError(error, errorFunctions)\n    }\n    out.loading = false\n    return out.data\n  }\n\n  function update({ method, url, params, auto }) {\n    if (method && method !== options.method) {\n      out.method = method\n    }\n    if (url && url !== options.url) {\n      out.url = url\n    }\n    if (params && params !== options.params) {\n      out.params = params\n    }\n    if (auto !== undefined && auto !== out.auto) {\n      out.auto = auto\n    }\n  }\n\n  function reset() {\n    out.data = options.initialData || null\n    out.previousData = null\n    out.loading = false\n    out.fetched = false\n    out.error = null\n    out.params = null\n    out.auto = options.auto\n  }\n\n  function handleError(error, errorFunctions) {\n    out.loading = false\n    if (out.previousData) {\n      out.data = out.previousData\n    }\n    out.error = error\n    for (let fn of errorFunctions) {\n      if (fn) {\n        fn.call(vm, error)\n      }\n    }\n    // if no error handler is defined, use fallbackErrorHandler\n    if (errorFunctions.every((fn) => fn == null)) {\n      let errorHandler = getConfig('fallbackErrorHandler')\n      if (errorHandler) {\n        try {\n          errorHandler(error)\n        } catch (error) {\n          // who handles the error handler?\n          console.warn('Error in fallbackErrorHandler', error)\n        }\n      }\n    }\n    throw error\n  }\n\n  // usage:\n  // setData(newData) or\n  // setData(data => data.filter(d => !d.deleted))\n  function setData(data) {\n    if (typeof data === 'function') {\n      data = data.call(vm, out.data)\n    }\n    out.data = transform(data)\n  }\n\n  function transform(data) {\n    if (options.transform) {\n      let returnValue = options.transform.call(vm, data)\n      if (returnValue != null) {\n        return returnValue\n      }\n    }\n    return data\n  }\n\n  if (cacheKey && !cached[cacheKey]) {\n    cached[cacheKey] = out\n    // offline\n    getLocal(cacheKey).then((data) => {\n      if ((out.loading || !out.fetched) && data) {\n        setData(data)\n        options.onData?.call(vm, data)\n      }\n    })\n  }\n\n  if (options.auto) {\n    out.fetch()\n  }\n\n  return out\n}\n\nexport function getCacheKey(cacheKey) {\n  if (!cacheKey) {\n    return null\n  }\n  if (typeof cacheKey === 'string') {\n    cacheKey = [cacheKey]\n  }\n  return JSON.stringify(cacheKey)\n}\n\nexport function getCachedResource(cacheKey) {\n  cacheKey = getCacheKey(cacheKey)\n  return cached[cacheKey] || null\n}\n","export function onDocUpdate(socket, doctype, callback) {\n  subscribe(socket, doctype)\n  socket.on('list_update', (data) => {\n    if (data.doctype == doctype) {\n      callback(data.name)\n    }\n  })\n}\n\nlet subscribed = {}\nfunction subscribe(socket, doctype) {\n  if (subscribed[doctype]) return\n  socket.emit('doctype_subscribe', doctype)\n  subscribed[doctype] = true\n}\n","import { reactive } from 'vue'\nimport { getCacheKey, createResource } from './resources'\nimport { saveLocal, getLocal } from './local'\nimport { onDocUpdate } from './realtime'\nimport { getConfig } from '../utils/config'\n\nlet listCache = reactive({})\nlet resourcesByDocType = {}\n\nexport function createListResource(options, vm) {\n  if (!options.doctype) {\n    throw new Error('List resource requires doctype')\n  }\n\n  let cacheKey = getCacheKey(options.cache)\n  if (cacheKey) {\n    let cachedResource = listCache[cacheKey]\n    if (cachedResource) {\n      if (cachedResource.auto) {\n        cachedResource.reload()\n      }\n      return cachedResource\n    }\n  }\n\n  let defaultListUrl = getConfig('defaultListUrl') || 'frappe.client.get_list'\n  let defaultDocInsertUrl =\n    getConfig('defaultDocInsertUrl') || 'frappe.client.insert'\n  let defaultDocUpdateUrl =\n    getConfig('defaultDocUpdateUrl') || 'frappe.client.set_value'\n  let defaultDocDeleteUrl =\n    getConfig('defaultDocDeleteUrl') || 'frappe.client.delete'\n  let defaultRunDocMethodUrl =\n    getConfig('defaultRunDocMethodUrl') || 'run_doc_method'\n\n  let out = reactive({\n    doctype: options.doctype,\n    fields: options.fields,\n    filters: options.filters,\n    orFilters: options.orFilters,\n    orderBy: options.orderBy,\n    start: options.start || 0,\n    pageLength: options.pageLength || 20,\n    groupBy: options.groupBy,\n    parent: options.parent,\n    debug: options.debug || 0,\n    originalData: null,\n    dataMap: {},\n    data: null,\n    previous,\n    hasPreviousPage: false,\n    next,\n    hasNextPage: true,\n    auto: options.auto,\n    list: createResource(\n      {\n        url: options.url || defaultListUrl,\n        makeParams() {\n          return {\n            doctype: out.doctype,\n            fields: out.fields,\n            filters: out.filters,\n            or_filters: out.orFilters,\n            order_by: out.orderBy,\n            start: out.start,\n            limit: out.pageLength,\n            limit_start: out.start,\n            limit_page_length: out.pageLength,\n            group_by: out.groupBy,\n            parent: out.parent,\n            debug: out.debug,\n          }\n        },\n        onSuccess(data) {\n          out.hasPreviousPage = !!out.start\n          out.hasNextPage = data.length < out.pageLength ? false : true\n          let pagedData\n          if (!out.start || out.start == 0) {\n            pagedData = data\n          } else if (out.start > 0) {\n            pagedData = out.originalData.concat(data)\n          }\n          saveLocal(cacheKey, pagedData)\n          setData(pagedData)\n          options.onSuccess?.call(vm, out.data)\n        },\n        onError: options.onError,\n      },\n      vm,\n    ),\n    fetchOne: createResource(\n      {\n        url: options.url || defaultListUrl,\n        makeParams(name) {\n          return {\n            doctype: out.doctype,\n            fields: out.fields || '*',\n            filters: { name },\n          }\n        },\n        onSuccess(data) {\n          if (data.length > 0 && out.originalData) {\n            let doc = data[0]\n            updateRowInListResource(out.doctype, doc)\n          }\n\n          options.fetchOne?.onSuccess?.call(vm, out.data)\n        },\n        onError: options.fetchOne?.onError,\n      },\n      vm,\n    ),\n    insert: createResource(\n      {\n        url: defaultDocInsertUrl,\n        makeParams(values) {\n          return {\n            doc: {\n              doctype: out.doctype,\n              ...values,\n            },\n          }\n        },\n        onSuccess(data) {\n          out.list.fetch()\n          options.insert?.onSuccess?.call(vm, data)\n        },\n        onError: options.insert?.onError,\n      },\n      vm,\n    ),\n    setValue: createResource(\n      {\n        url: defaultDocUpdateUrl,\n        makeParams(options) {\n          let { name, ...values } = options\n          return {\n            doctype: out.doctype,\n            name: name,\n            fieldname: values,\n          }\n        },\n        onSuccess(doc) {\n          updateRowInListResource(out.doctype, doc)\n          options.setValue?.onSuccess?.call(vm, doc)\n        },\n        onError: options.setValue?.onError,\n      },\n      vm,\n    ),\n    delete: createResource(\n      {\n        url: defaultDocDeleteUrl,\n        makeParams(name) {\n          return {\n            doctype: out.doctype,\n            name,\n          }\n        },\n        onSuccess(data) {\n          out.list.fetch()\n          options.delete?.onSuccess?.call(vm, data)\n        },\n        onError: options.delete?.onError,\n      },\n      vm,\n    ),\n    runDocMethod: createResource(\n      {\n        url: defaultRunDocMethodUrl,\n        makeParams({ method, name, ...values }) {\n          return {\n            dt: out.doctype,\n            dn: name,\n            method: method,\n            args: values,\n          }\n        },\n        onSuccess(data) {\n          if (data.docs) {\n            for (let doc of data.docs) {\n              updateRowInListResource(doc.doctype, doc)\n            }\n          }\n          options.runDocMethod?.onSuccess?.call(vm, data)\n        },\n        onError: options.runDocMethod?.onError,\n      },\n      vm,\n    ),\n    update,\n    fetch,\n    reload,\n    setData,\n    transform,\n    getRow,\n  })\n\n  function update(updatedOptions) {\n    Object.assign(out, updatedOptions)\n  }\n\n  function transform(data) {\n    if (options.transform) {\n      let returnValue = options.transform.call(vm, data)\n      if (returnValue != null) {\n        return returnValue\n      }\n    }\n    return data\n  }\n\n  function reload() {\n    let _start = out.start\n    let _pageLength = out.pageLength\n    if (out.start > 0) {\n      out.start = 0\n      out.pageLength = out.originalData.length\n    }\n    return out.list.fetch().finally(() => {\n      out.start = _start\n      out.pageLength = _pageLength\n    })\n  }\n\n  function fetch() {\n    reload()\n  }\n\n  function setData(data) {\n    out.originalData = data\n    if (typeof data === 'function') {\n      data = data.call(vm, out.data)\n    }\n    out.data = transform(data)\n\n    if (Array.isArray(out.data)) {\n      out.dataMap = {}\n      for (let row of out.data) {\n        if (!row.name) continue\n        let key = row.name.toString()\n        out.dataMap[key] = row\n      }\n    }\n  }\n\n  function previous() {\n    out.start = out.start - out.pageLength\n    out.list.fetch()\n  }\n\n  function next() {\n    out.start = out.start + out.pageLength\n    out.list.fetch()\n  }\n\n  function getRow(name) {\n    let key = name.toString()\n    return out.dataMap[key]\n  }\n\n  if (options.realtime && vm?.$socket) {\n    onDocUpdate(vm.$socket, out.doctype, (name) => {\n      if (out.originalData?.find((d) => d.name === name)) {\n        out.fetchOne.submit(name)\n      }\n    })\n  }\n\n  if (cacheKey) {\n    // cache\n    listCache[cacheKey] = out\n    // offline\n    getLocal(cacheKey).then((data) => {\n      if ((out.list.loading || !out.list.fetched) && data) {\n        setData(data)\n        options.onData?.call(vm, data)\n      }\n    })\n  }\n\n  if (options.auto) {\n    out.list.fetch()\n  }\n\n  resourcesByDocType[out.doctype] = resourcesByDocType[out.doctype] || []\n  resourcesByDocType[out.doctype].push(out)\n\n  return out\n}\n\nexport function getCachedListResource(cacheKey) {\n  cacheKey = getCacheKey(cacheKey)\n  return listCache[cacheKey] || null\n}\n\nexport function updateRowInListResource(doctype, doc) {\n  if (!doc.name) return\n  let resources = resourcesByDocType[doctype] || []\n  for (let resource of resources) {\n    if (resource.originalData) {\n      for (let row of resource.originalData) {\n        if (row.name && row.name == doc.name) {\n          delete row._previousData\n          let previousRowData = JSON.stringify(row)\n          for (let key in row) {\n            if (key in doc) {\n              row[key] = doc[key]\n            }\n          }\n          row._previousData = previousRowData\n        }\n      }\n      resource.data = resource.transform(resource.originalData)\n    }\n  }\n}\n\nexport function deleteRowInListResource(doctype, docname) {\n  let resources = resourcesByDocType[doctype] || []\n  for (let resource of resources) {\n    if (resource.originalData) {\n      resource.originalData = resource.originalData.filter(\n        (row) => row.name.toString() !== docname.toString(),\n      )\n      resource.data = resource.transform(resource.originalData)\n    }\n  }\n}\n\nexport function revertRowInListResource(doctype, doc) {\n  let resources = resourcesByDocType[doctype] || []\n  for (let resource of resources) {\n    if (resource.originalData) {\n      for (let row of resource.originalData) {\n        if (row.name && row.name == doc.name) {\n          let previousRowData = JSON.parse(row._previousData)\n          for (let key in row) {\n            row[key] = previousRowData[key]\n          }\n          delete row._previousData\n        }\n      }\n      resource.data = resource.transform(resource.originalData)\n    }\n  }\n}\n","import { reactive, watch } from 'vue'\nimport { getCacheKey, createResource } from './resources'\nimport {\n  updateRowInListResource,\n  deleteRowInListResource,\n  revertRowInListResource,\n} from './listResource'\nimport { getLocal, saveLocal, deleteLocal } from './local'\nimport { onDocUpdate } from './realtime'\nimport { getConfig } from '../utils/config'\n\nlet documentCache = reactive({})\n\nexport function createDocumentResource(options, vm) {\n  if (!(options.doctype && options.name)) return\n\n  let cacheKey = getCacheKey([options.doctype, options.name])\n  let cachedResource = documentCache[cacheKey]\n  if (cachedResource) {\n    if (cachedResource.auto) {\n      cachedResource.reload()\n    }\n    return cachedResource\n  }\n\n  let defaultDocGetUrl = getConfig('defaultDocGetUrl') || 'frappe.client.get'\n  let defaultDocUpdateUrl =\n    getConfig('defaultDocUpdateUrl') || 'frappe.client.set_value'\n  let defaultDocDeleteUrl =\n    getConfig('defaultDocDeleteUrl') || 'frappe.client.delete'\n  let defaultRunDocMethodUrl =\n    getConfig('defaultRunDocMethodUrl') || 'run_doc_method'\n\n  let setValueOptions = {\n    url: defaultDocUpdateUrl,\n    makeParams(values) {\n      return {\n        doctype: out.doctype,\n        name: out.name,\n        fieldname: values,\n      }\n    },\n    validate(data) {\n      options.setValue?.validate?.call(vm, data)\n    },\n    beforeSubmit(params) {\n      out.previousDoc = JSON.stringify(out.doc)\n      Object.assign(out.doc, params.fieldname || {})\n      // update data in list resources\n      updateRowInListResource(out.doctype, out.doc)\n    },\n    onSuccess(data) {\n      out.doc = transform(data)\n      out.originalDoc = JSON.parse(JSON.stringify(out.doc))\n      options.setValue?.onSuccess?.call(vm, data)\n    },\n    onError(error) {\n      out.doc = JSON.parse(out.previousDoc)\n      options.setValue?.onError?.call(vm, error)\n      // revert data in list resource\n      revertRowInListResource(out.doctype, out.doc)\n    },\n  }\n\n  const autoPropIsPassed = options.auto !== undefined\n\n  let out = reactive({\n    doctype: options.doctype,\n    name: options.name,\n    doc: null,\n    originalDoc: null,\n    isDirty: false,\n    auto: autoPropIsPassed ? options.auto : true,\n    get: createResource(\n      {\n        url: defaultDocGetUrl,\n        makeParams() {\n          return {\n            doctype: out.doctype,\n            name: out.name,\n          }\n        },\n        onSuccess(data) {\n          saveLocal(cacheKey, data)\n          out.doc = transform(data)\n          out.originalDoc = JSON.parse(JSON.stringify(out.doc))\n          options.onSuccess?.call(vm, out.doc)\n        },\n        onError(error) {\n          deleteLocal(cacheKey)\n          out.doc = null\n          out.originalDoc = null\n          options.onError?.call(vm, error)\n        },\n      },\n      vm,\n    ),\n    setValue: createResource(setValueOptions, vm),\n    setValueDebounced: createResource(\n      {\n        ...setValueOptions,\n        debounce: options.debounce || 500,\n      },\n      vm,\n    ),\n    save: createResource(\n      {\n        ...setValueOptions,\n        makeParams() {\n          let values = JSON.parse(JSON.stringify(out.doc))\n          delete values.doctype\n          delete values.name\n          return {\n            doctype: out.doctype,\n            name: out.name,\n            fieldname: values,\n          }\n        },\n      },\n      vm,\n    ),\n    delete: createResource(\n      {\n        url: defaultDocDeleteUrl,\n        makeParams() {\n          return {\n            doctype: out.doctype,\n            name: out.name,\n          }\n        },\n        onSuccess() {\n          out.doc = null\n          options.delete?.onSuccess?.call(vm)\n          // delete from list resources\n          deleteRowInListResource(out.doctype, out.name)\n        },\n        onError: options.delete?.onError,\n      },\n      vm,\n    ),\n    reload,\n    setDoc,\n  })\n\n  // keep track of isDirty as doc changes\n  watch(\n    () => out.doc,\n    () => {\n      out.isDirty = JSON.stringify(out.doc) !== JSON.stringify(out.originalDoc)\n    },\n    {\n      deep: true,\n    },\n  )\n\n  for (let methodKey in options.whitelistedMethods) {\n    let methodOptions = options.whitelistedMethods[methodKey]\n    if (typeof methodOptions == 'string') {\n      methodOptions = {\n        method: methodOptions,\n      }\n    }\n\n    let {\n      method,\n      onSuccess,\n      makeParams,\n      transform: _transform,\n      ...otherOptions\n    } = methodOptions\n\n    out[methodKey] = createResource(\n      {\n        url: defaultRunDocMethodUrl,\n        makeParams(values) {\n          values = makeParams ? makeParams.call(vm, values) : values\n          return {\n            dt: out.doctype,\n            dn: out.name,\n            method: method,\n            args: values,\n          }\n        },\n        transform(data) {\n          if (_transform) {\n            let returnValue = _transform.call(vm, data.message)\n            if (returnValue != null) {\n              return returnValue\n            }\n          }\n          return data.message\n        },\n        onSuccess(data) {\n          if (data.docs) {\n            for (let doc of data.docs) {\n              if (\n                doc.doctype === out.doctype &&\n                doc.name.toString() === out.name.toString()\n              ) {\n                out.doc = transform(doc)\n                // update data in list resources\n                updateRowInListResource(out.doctype, out.doc)\n                break\n              }\n            }\n          }\n          onSuccess?.call(vm, data.message)\n        },\n        ...otherOptions,\n      },\n      vm,\n    )\n  }\n\n  function reload() {\n    return out.get.fetch()\n  }\n\n  function setDoc(doc) {\n    if (typeof doc === 'function') {\n      doc = doc.call(vm, out.doc)\n    }\n    out.doc = transform(doc)\n  }\n\n  function transform(doc) {\n    if (options.transform) {\n      let returnValue = options.transform.call(vm, doc)\n      if (typeof returnValue === 'object') {\n        return returnValue\n      }\n    }\n    return doc\n  }\n\n  if (options.realtime && vm.$socket) {\n    onDocUpdate(vm.$socket, out.doctype, (name) => {\n      if (name == out.name) {\n        out.get.fetch()\n      }\n    })\n  }\n\n  // cache\n  documentCache[cacheKey] = out\n  // offline\n  getLocal(cacheKey).then((data) => {\n    if ((out.get.loading || !out.get.fetched) && data) {\n      out.doc = transform(data)\n    }\n  })\n\n  if (out.auto) {\n    out.get.fetch()\n  }\n\n  return out\n}\n\nexport function getCachedDocumentResource(doctype, name) {\n  let cacheKey = getCacheKey([doctype, name])\n  return documentCache[cacheKey] || null\n}\n","import { reactive, watch } from 'vue'\nimport { createResource, getCachedResource } from './resources'\nimport {\n  createDocumentResource,\n  getCachedDocumentResource,\n} from './documentResource'\nimport { createListResource, getCachedListResource } from './listResource'\n\nlet createMixin = (mixinOptions) => ({\n  created() {\n    if (this.$options.resources) {\n      this._resources = reactive({})\n      for (let key in this.$options.resources) {\n        let options = this.$options.resources[key]\n\n        if (typeof options == 'function') {\n          watch(\n            () => {\n              let out = null\n              try {\n                out = options.call(this)\n              } catch (error) {\n                console.warn('Failed to get resource options\\n\\n', error)\n                out = null\n              }\n              return out\n            },\n            (options, oldOptions) => {\n              if (!options) {\n                return\n              }\n\n              let changed =\n                !oldOptions ||\n                JSON.stringify(options) !== JSON.stringify(oldOptions)\n\n              if (!changed) return\n              this._resources[key] = createResourceForOptions(options, this)\n            },\n            {\n              immediate: true,\n              deep: true,\n            },\n          )\n        } else {\n          let resource = createResourceForOptions(options, this)\n          this._resources[key] = resource\n        }\n      }\n    }\n  },\n  methods: {\n    $getResource(cacheKey) {\n      return getCachedResource(cacheKey)\n    },\n    $getDocumentResource(doctype, name) {\n      return getCachedDocumentResource(doctype, name)\n    },\n    $getDoc(doctype, name) {\n      let resource = this.$getDocumentResource(doctype, name)\n      return resource ? resource.doc : null\n    },\n    $getListResource(cacheKey) {\n      return getCachedListResource(cacheKey)\n    },\n    $refetchResource(cache) {\n      let resource = this.$getResource(cache)\n      resource && resource.fetch()\n    },\n  },\n  computed: {\n    $resources() {\n      return this._resources\n    },\n  },\n})\n\nfunction createResourceForOptions(options, vm) {\n  if (options.type === 'document') {\n    return createDocumentResource(options, vm)\n  }\n  if (options.type === 'list') {\n    return createListResource(options, vm)\n  }\n  return createResource(options, vm)\n}\n\nexport default {\n  install(app, options) {\n    let resourceMixin = createMixin(options)\n    app.mixin(resourceMixin)\n  },\n}\n","import { getConfig } from './config'\nimport { request } from './request'\n\nexport function frappeRequest(options) {\n  return request({\n    ...options,\n    transformRequest: (options = {}) => {\n      if (!options.url) {\n        throw new Error('[frappeRequest] options.url is required')\n      }\n      let headers = Object.assign(\n        {\n          Accept: 'application/json',\n          'Content-Type': 'application/json; charset=utf-8',\n          'X-Frappe-Site-Name': window.location.hostname,\n        },\n        options.headers || {},\n      )\n      if (window.csrf_token && window.csrf_token !== '{{ csrf_token }}') {\n        headers['X-Frappe-CSRF-Token'] = window.csrf_token\n      }\n      if (!options.url.startsWith('/') && !options.url.startsWith('http')) {\n        options.url = '/api/method/' + options.url\n      }\n      return {\n        ...options,\n        method: options.method || 'POST',\n        headers,\n      }\n    },\n    transformResponse: async (response, options) => {\n      let url = options.url\n      if (response.ok) {\n        const data = await response.json()\n        if (data.docs || url === '/api/method/login') {\n          return data\n        }\n        if (data.exc) {\n          try {\n            console.groupCollapsed(url)\n            console.log(options)\n            let warning = JSON.parse(data.exc)\n            for (let text of warning) {\n              console.log(text)\n            }\n            console.groupEnd()\n          } catch (e) {\n            console.warn('Error printing debug messages', e)\n          }\n        }\n\n        if (data._server_messages) {\n          let onMessageHandler =\n            getConfig('serverMessagesHandler') || options.onServerMessages || null\n          if (onMessageHandler) {\n            onMessageHandler(JSON.parse(data?._server_messages) || [])\n          }\n        }\n\n        return data.message\n      } else {\n        let errorResponse = await response.text()\n        let error, exception\n        try {\n          error = JSON.parse(errorResponse)\n          // eslint-disable-next-line no-empty\n        } catch (e) {}\n        let errorParts = [\n          [options.url, error?.exc_type, error?._error_message]\n            .filter(Boolean)\n            .join(' '),\n        ]\n        if (error.exc) {\n          exception = error.exc\n          try {\n            exception = JSON.parse(exception)[0]\n            console.log(exception)\n            // eslint-disable-next-line no-empty\n          } catch (e) {}\n        }\n        let e = new Error(errorParts.join('\\n'))\n        e.exc_type = error.exc_type\n        e.exc = exception\n        e.response = response\n        e.status = errorResponse.status\n        e.messages = error._server_messages\n          ? JSON.parse(error._server_messages)\n          : []\n        e.messages = e.messages.concat(error.message)\n        e.messages = e.messages.map((m) => {\n          try {\n            return JSON.parse(m).message\n          } catch (error) {\n            return m\n          }\n        })\n        e.messages = e.messages.filter(Boolean)\n        if (!e.messages.length) {\n          e.messages = error._error_message\n            ? [error._error_message]\n            : ['Internal Server Error']\n        }\n        options.onError && options.onError(e)\n        throw e\n      }\n    },\n    transformError: (error) => {\n      options.onError && options.onError(error)\n      throw error\n    },\n  })\n}\n","import { io } from 'socket.io-client'\n\nexport default function initSocket(options = {}) {\n  let host = window.location.hostname\n  let siteName = import.meta.env.DEV ? host : window.site_name\n  let socketio_port = options.port || 9000\n  let port = window.location.port ? `:${socketio_port}` : ''\n  let protocol = port ? 'http' : 'https'\n  let url = `${protocol}://${host}${port}/${siteName}`\n  let socket = io(url, { withCredentials: true })\n  return socket\n}\n","import { get, set, del, setMany, keys } from 'idb-keyval'\n\nexport class IDBStore {\n  private memoryStore: Record<string, string> = {}\n  private useIndexedDB: boolean\n\n  constructor() {\n    this.useIndexedDB = typeof window !== 'undefined' && !!window.indexedDB\n  }\n\n  set(key: string, data: unknown): Promise<void | null> {\n    if (!this.validateKey(key)) {\n      return Promise.resolve(null)\n    }\n\n    try {\n      if (this.useIndexedDB) {\n        return set(key, JSON.stringify(data))\n      }\n      this.memoryStore[key] = JSON.stringify(data)\n      return Promise.resolve()\n    } catch (error) {\n      return this.handleError(error, 'save to')\n    }\n  }\n\n  setMany(data: Record<string, unknown>): Promise<void | null> {\n    try {\n      if (this.useIndexedDB) {\n        let entries: [IDBValidKey, any][] = []\n        for (const [key, value] of Object.entries(data)) {\n          entries.push([key, JSON.stringify(value)])\n        }\n        return setMany(entries)\n      }\n      for (const [key, value] of Object.entries(data)) {\n        this.memoryStore[key] = JSON.stringify(value)\n      }\n      return Promise.resolve()\n    } catch (error) {\n      return this.handleError(error, 'save to')\n    }\n  }\n\n  delete(key: string): Promise<void | null> {\n    if (!this.validateKey(key)) {\n      return Promise.resolve(null)\n    }\n\n    try {\n      if (this.useIndexedDB) {\n        return del(key)\n      }\n      delete this.memoryStore[key]\n      return Promise.resolve()\n    } catch (error) {\n      return this.handleError(error, 'delete from')\n    }\n  }\n\n  get(key: string): Promise<unknown | null> {\n    if (!this.validateKey(key)) {\n      return Promise.resolve(null)\n    }\n\n    if (this.useIndexedDB) {\n      return get(key).then((val) => {\n        if (!val) return null\n        try {\n          return JSON.parse(val)\n        } catch (error) {\n          return this.handleError(error, 'parse data from')\n        }\n      })\n    }\n\n    try {\n      const val = this.memoryStore[key]\n      return Promise.resolve(val ? JSON.parse(val) : null)\n    } catch (error) {\n      return this.handleError(error, 'parse data from')\n    }\n  }\n\n  async keys(): Promise<string[]> {\n    try {\n      if (this.useIndexedDB) {\n        return keys() as Promise<string[]>\n      }\n      return Promise.resolve(Object.keys(this.memoryStore))\n    } catch (error) {\n      console.error(\n        `Failed to get keys from ${this.useIndexedDB ? 'IndexedDB' : 'memory store'}:`,\n        error,\n      )\n      return Promise.resolve([])\n    }\n  }\n\n  private validateKey(key: string): boolean {\n    return !!key\n  }\n\n  private handleError(error: unknown, operation: string): Promise<null> {\n    console.error(\n      `Failed to ${operation} ${this.useIndexedDB ? 'IndexedDB' : 'memory store'}:`,\n      error,\n    )\n    return Promise.resolve(null)\n  }\n}\n\nexport let idbStore = new IDBStore()\n","import { Ref, ref, MaybeRefOrGetter, toValue } from 'vue'\nimport { idbStore } from './idbStore'\n\ntype Doc = {\n  doctype: string\n  name: string\n  [key: string]: any\n}\n\ntype DocKey = `${string}/${string}`\n\nclass DocStore {\n  private docs: Map<DocKey, Ref<Doc | null>>\n  private lastFetched: Map<DocKey, number>\n  private cacheTimeout: number = 5 * 60 * 1000 // 5 minutes\n  private storePrefix = 'doc:'\n\n  constructor() {\n    this.docs = new Map<DocKey, Ref<Doc | null>>()\n    this.lastFetched = new Map()\n  }\n\n  setCacheTimeout(minutes: number) {\n    if (minutes < 1) {\n      throw new Error('Cache timeout must be at least 1 minute')\n    }\n    this.cacheTimeout = minutes * 60 * 1000\n  }\n\n  async setDoc(doc: Doc) {\n    if (!doc?.doctype || !doc?.name) {\n      throw new Error('Invalid doc: must have doctype and name')\n    }\n    doc.name = doc.name.toString()\n    const key = this.getKey(doc.doctype, doc.name)\n    try {\n      await idbStore.set(this.storePrefix + key, doc)\n      if (!this.docs.has(key)) {\n        this.docs.set(key, ref(null))\n      }\n      const docRef = this.docs.get(key)\n      if (docRef) {\n        docRef.value = doc\n      }\n      this.lastFetched.set(key, Date.now())\n    } catch (error) {\n      console.error('Failed to set doc in IDB:', error)\n      throw error\n    }\n  }\n\n  getDoc(doctype: string, name: MaybeRefOrGetter<string>): Ref<Doc | null> {\n    const nameStr = toValue(name)\n    if (!doctype || !nameStr) {\n      throw new Error('doctype and name are required')\n    }\n    const key = this.getKey(doctype, nameStr)\n\n    if (!this.docs.has(key)) {\n      this.docs.set(key, ref(null))\n      this.loadDoc(key, true)\n    } else if (this.isStale(key)) {\n      this.loadDoc(key, false)\n    }\n\n    return this.docs.get(key)!\n  }\n\n  private async loadDoc(key: DocKey, isFirstLoad: boolean) {\n    try {\n      if (!isFirstLoad && this.isStale(key)) {\n        await this.cleanup(key)\n      }\n\n      const idbDoc = (await idbStore.get(this.storePrefix + key)) as Doc | null\n      if (idbDoc) {\n        const docRef = this.docs.get(key)\n        if (docRef) {\n          docRef.value = idbDoc\n        }\n        this.lastFetched.set(key, Date.now())\n      }\n    } catch (error) {\n      console.error('Failed to load doc from IDB:', error)\n      throw error\n    }\n  }\n\n  async setDocs(docs: Doc[]) {\n    const docMap: Record<string, Doc> = {}\n    for (const doc of docs) {\n      if (!doc?.doctype || !doc?.name) continue\n      doc.name = doc.name.toString()\n      const key = this.getKey(doc.doctype, doc.name)\n      if (!this.docs.has(key)) {\n        this.docs.set(key, ref(null))\n      }\n      const docRef = this.docs.get(key)\n      if (docRef) {\n        docRef.value = doc\n      }\n      this.lastFetched.set(key, Date.now())\n      docMap[this.storePrefix + key] = doc\n    }\n    await idbStore.setMany(docMap)\n  }\n\n  async invalidateDoc(doctype: string, name: string) {\n    if (!doctype || !name) return\n    const key = this.getKey(doctype, name)\n    await this.cleanup(key)\n  }\n\n  removeDoc(doctype: string, name: string) {\n    return this.invalidateDoc(doctype, name)\n  }\n\n  private getKey(doctype: string, name: string): DocKey {\n    return `${doctype.trim()}/${name.trim()}` as DocKey\n  }\n\n  private isStale(key: DocKey): boolean {\n    const fetchTime = this.lastFetched.get(key)\n    if (!fetchTime) return true\n    return Date.now() - fetchTime > this.cacheTimeout\n  }\n\n  private async cleanup(key: DocKey) {\n    this.docs.delete(key)\n    this.lastFetched.delete(key)\n    await idbStore.delete(this.storePrefix + key)\n  }\n\n  async clearAll() {\n    try {\n      const allKeys = await idbStore.keys()\n      const docKeys = allKeys.filter((key: string) =>\n        key.startsWith(this.storePrefix),\n      )\n      await Promise.all(docKeys.map((key: string) => idbStore.delete(key)))\n      this.docs.clear()\n      this.lastFetched.clear()\n    } catch (error) {\n      console.error('Failed to clear all docs:', error)\n      throw error\n    }\n  }\n}\n\nexport const docStore = new DocStore()\n","export interface ListInstanceMethods {\n  updateRow: (doc: Partial<{ name: string }> & Record<string, unknown>) => void\n  removeRow: (name: string) => void\n}\n\ninterface Doc {\n  name: string\n  [key: string]: any\n}\n\nclass ListStore {\n  byDocType: { [key: string]: Array<ListInstanceMethods> }\n\n  constructor() {\n    this.byDocType = {}\n  }\n\n  addList(doctype: string, list: ListInstanceMethods) {\n    this.ensureList(doctype)\n    this.byDocType[doctype].push(list)\n  }\n\n  updateRows(docs: Array<Doc>) {\n    for (let doc of docs) {\n      this.updateRow(doc.doctype, doc)\n    }\n  }\n\n  updateRow(doctype: string, doc: Doc) {\n    this.ensureList(doctype)\n    this.byDocType[doctype].forEach((list) => {\n      list.updateRow(doc)\n    })\n  }\n\n  removeRow(doctype: string, name: string) {\n    this.ensureList(doctype)\n    this.byDocType[doctype].forEach((list) => {\n      list.removeRow(name)\n    })\n  }\n\n  ensureList(docType: string) {\n    if (!this.byDocType[docType]) {\n      this.byDocType[docType] = []\n    }\n  }\n}\n\nexport const listStore = new ListStore()\n","import { createFetch } from '@vueuse/core'\nimport { docStore } from './docStore'\nimport { listStore } from './useList/listStore'\n\nexport class FrappeResponseError extends Error {\n  title: string\n  type: string\n  exception?: string\n  indicator?: string\n\n  constructor(\n    message: string,\n    options: {\n      title: string\n      type: string\n      exception?: string\n      indicator?: string\n    },\n  ) {\n    super(message)\n    this.name = 'FrappeResponseError'\n    this.title = options.title\n    this.type = options.type\n    this.exception = options.exception\n    this.indicator = options.indicator\n\n    // Maintains proper stack trace for where our error was thrown (only available on V8)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, FrappeResponseError)\n    }\n  }\n}\n\nexport const useFrappeFetch = createFetch({\n  options: {\n    fetch: (...args) => fetch(...args), // required for vitest\n    beforeFetch({ options }) {\n      options.headers = setHeaders(options.headers || {})\n      return { options }\n    },\n    afterFetch(ctx) {\n      let responseData = JSON.parse(ctx.data)\n      ctx.data = responseData\n      if (responseData.debug) {\n        let path = ctx.response.url.replace(window.location.origin, '')\n        console.group(path)\n        for (let d of responseData.debug) {\n          console.log(d?.message)\n        }\n        console.groupEnd()\n      }\n      if (responseData.docs) {\n        let docs = responseData.docs\n        for (let doc of docs) {\n          doc.name = doc.name.toString()\n        }\n        docStore.setDocs(docs)\n        listStore.updateRows(docs)\n      }\n      return ctx\n    },\n    onFetchError(ctx) {\n      if (ctx.response?.ok && ctx.error) {\n        // if response is ok and there is an error, it's a client side programming error\n        console.error(\n          'Fetch request succeeded but there was a programming error:\\n\\n',\n          ctx.error,\n        )\n        return ctx\n      }\n\n      type FrappeError = {\n        title: string\n        message: string\n        exception?: string\n        type: string\n        indicator: string\n      }\n      try {\n        let errorResponse = JSON.parse(ctx.data)\n        let errors: Array<FrappeError> = errorResponse.errors\n        let error = errors[0] // assuming only one error for now\n        let errorDescription = error.message\n          ? `: ${error.message}`\n          : error.exception\n            ? ` (Traceback)`\n            : ''\n        let frappeError = new FrappeResponseError(\n          `${error.type}${errorDescription}`,\n          {\n            title: error.title,\n            type: error.type,\n            exception: error.exception,\n            indicator: error.indicator,\n          },\n        )\n\n        if (import.meta.env.DEV && error.exception) {\n          console.log(error.exception)\n        }\n\n        ctx.error = frappeError\n        return ctx\n      } catch (e) {\n        console.log('Error parsing error response:', e)\n        return ctx\n      }\n    },\n  },\n})\n\nfunction setHeaders(headers: HeadersInit) {\n  // handle case where this could run in node environment (vitest)\n  let siteName = null\n  let csrfToken = null\n  if (typeof window !== 'undefined') {\n    siteName = window.location.hostname\n    csrfToken =\n      window.csrf_token !== '{{ csrf_token }}' ? window.csrf_token : null\n  }\n\n  const defaultHeaders: Record<string, string> = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json; charset=utf-8',\n  }\n  if (siteName) {\n    defaultHeaders['X-Frappe-Site-Name'] = siteName\n  }\n  if (csrfToken) {\n    defaultHeaders['X-Frappe-CSRF-Token'] = csrfToken\n  }\n\n  return { ...headers, ...defaultHeaders }\n}\n","import resourcesPlugin from '../resources/plugin'\nimport call from './call'\nimport initSocket from './socketio'\n\nlet defaultOptions = {\n  resources: true,\n  call: true,\n  socketio: true,\n}\n\nexport default {\n  install(app, options = {}) {\n    options = Object.assign({}, defaultOptions, options)\n    options.resources && app.use(resourcesPlugin, options.resources)\n\n    if (options.call) {\n      let callFunction = typeof options.call == 'function' ? options.call : call\n      app.config.globalProperties.$call = callFunction\n    }\n    if (options.socketio) {\n      app.config.globalProperties.$socket = initSocket(options.socketio)\n    }\n  },\n}\n","<template>\n  <Popover transition=\"default\">\n    <template #target=\"{ togglePopover, isOpen }\">\n      <slot\n        v-bind=\"{ onClick: () => togglePopover(), isActive: isOpen }\"\n      ></slot>\n    </template>\n    <template #body-main>\n      <div class=\"p-2\">\n        <div class=\"text-sm text-ink-gray-7\">Text Color</div>\n        <div class=\"mt-1 grid grid-cols-6 gap-1\">\n          <Tooltip\n            class=\"flex\"\n            v-for=\"color in foregroundColors\"\n            :key=\"color.name\"\n            :text=\"color.name\"\n          >\n            <button\n              :aria-label=\"color.name\"\n              class=\"flex h-5 w-5 items-center justify-center rounded border text-base\"\n              :class=\"color.class\"\n              @click=\"setForegroundColor(color)\"\n            >\n              A\n            </button>\n          </Tooltip>\n        </div>\n        <div class=\"mt-2 text-sm text-ink-gray-7\">Background Color</div>\n        <div class=\"mt-1 grid grid-cols-6 gap-1\">\n          <Tooltip\n            class=\"flex\"\n            v-for=\"color in backgroundColors\"\n            :key=\"color.name\"\n            :text=\"color.name\"\n          >\n            <button\n              :aria-label=\"color.name\"\n              class=\"flex h-5 w-5 items-center justify-center rounded border text-base text-ink-gray-9\"\n              :class=\"color.class\"\n              @click=\"setBackgroundColor(color)\"\n            >\n              A\n            </button>\n          </Tooltip>\n        </div>\n      </div>\n    </template>\n  </Popover>\n</template>\n<script>\nimport Popover from '../Popover/Popover.vue'\nimport { Tooltip } from '../../index'\n\nexport default {\n  name: 'FontColor',\n  props: ['editor'],\n  components: { Popover, Tooltip },\n  methods: {\n    setBackgroundColor(color) {\n      if (color.name != 'Default') {\n        this.editor\n          .chain()\n          .focus()\n          .toggleHighlightByName(color.name.toLowerCase())\n          .run()\n      } else {\n        this.editor.chain().focus().unsetHighlight().run()\n      }\n    },\n    setForegroundColor(color) {\n      if (color.name != 'Default') {\n        this.editor\n          .chain()\n          .focus()\n          .setColorByName(color.name.toLowerCase())\n          .run()\n      } else {\n        this.editor.chain().focus().unsetColor().run()\n      }\n    },\n  },\n  computed: {\n    foregroundColors() {\n      return [\n        { name: 'Default', class: 'text-ink-gray-9' },\n        { name: 'Red', class: 'text-red-600 dark:text-dark-red-400' },\n        { name: 'Orange', class: 'text-orange-600 dark:text-dark-orange-400' },\n        { name: 'Yellow', class: 'text-yellow-600 dark:text-dark-yellow-400' },\n        { name: 'Green', class: 'text-green-600 dark:text-dark-green-400' },\n        { name: 'Teal', class: 'text-teal-600 dark:text-dark-teal-400' },\n        { name: 'Cyan', class: 'text-cyan-600 dark:text-dark-cyan-400' },\n        { name: 'Blue', class: 'text-blue-600 dark:text-dark-blue-400' },\n        { name: 'Purple', class: 'text-purple-600 dark:text-dark-purple-400' },\n        { name: 'Pink', class: 'text-pink-600 dark:text-dark-pink-400' },\n        { name: 'Gray', class: 'text-gray-600 dark:text-dark-gray-400' },\n      ]\n    },\n    backgroundColors() {\n      return [\n        { name: 'Default', class: 'border-outline-gray-modals' },\n        {\n          name: 'Red',\n          class: 'bg-red-100 dark:bg-dark-red-800 border-transparent',\n        },\n        {\n          name: 'Orange',\n          class: 'bg-orange-100 dark:bg-dark-orange-800 border-transparent',\n        },\n        {\n          name: 'Yellow',\n          class: 'bg-yellow-100 dark:bg-dark-yellow-800 border-transparent',\n        },\n        {\n          name: 'Green',\n          class: 'bg-green-100 dark:bg-dark-green-800 border-transparent',\n        },\n        {\n          name: 'Teal',\n          class: 'bg-teal-100 dark:bg-dark-teal-800 border-transparent',\n        },\n        {\n          name: 'Cyan',\n          class: 'bg-cyan-100 dark:bg-dark-cyan-800 border-transparent',\n        },\n        {\n          name: 'Blue',\n          class: 'bg-blue-100 dark:bg-dark-blue-800 border-transparent',\n        },\n        {\n          name: 'Purple',\n          class: 'bg-purple-100 dark:bg-dark-purple-800 border-transparent',\n        },\n        {\n          name: 'Pink',\n          class: 'bg-pink-100 dark:bg-dark-pink-800 border-transparent',\n        },\n        {\n          name: 'Gray',\n          class: 'bg-gray-100 dark:bg-dark-gray-800 border-transparent',\n        },\n      ]\n    },\n  },\n}\n</script>\n","<template>\n  <slot v-bind=\"{ onClick: openLinkEditor }\"></slot>\n</template>\n<script setup lang=\"ts\">\nimport type { Editor } from '@tiptap/vue-3'\n\nconst props = defineProps<{\n  editor: Editor\n}>()\nfunction openLinkEditor() {\n  props.editor.commands.openLinkEditor()\n}\n</script>\n","<template>\n  <slot v-bind=\"{ onClick: openFileSelector }\"></slot>\n  <input\n    ref=\"fileInput\"\n    type=\"file\"\n    class=\"hidden\"\n    @change=\"onImageSelect\"\n    accept=\"image/*\"\n    multiple\n  />\n  <ImageGroupUploadDialog\n    v-if=\"showModal\"\n    mode=\"new\"\n    v-model=\"showModal\"\n    v-model:files=\"selectedFiles\"\n    :editor=\"editor\"\n    @close=\"handleCancel\"\n  />\n</template>\n<script setup lang=\"ts\">\nimport { ref, useTemplateRef } from 'vue'\nimport type { Editor } from '@tiptap/vue-3'\nimport ImageGroupUploadDialog from './extensions/image-group/ImageGroupUploadDialog.vue'\n\nconst props = defineProps<{\n  editor: Editor\n}>()\n\nconst fileInput = useTemplateRef<HTMLInputElement>('fileInput')\nconst showModal = ref(false)\nconst selectedFiles = ref<File[]>([])\n\nfunction openFileSelector() {\n  fileInput.value?.click()\n}\n\nfunction onImageSelect(e: Event) {\n  const target = e.target as HTMLInputElement\n  const files = target.files\n  if (files && files.length > 0) {\n    if (files.length === 1) {\n      props.editor.chain().focus().uploadImage(files[0]).run()\n    } else {\n      selectedFiles.value = Array.from(files)\n      showModal.value = true\n    }\n  }\n}\n\nfunction handleCancel() {\n  showModal.value = false\n  selectedFiles.value = []\n}\n</script>\n","<template>\n  <slot v-bind=\"{ onClick: selectAndUploadVideo }\"></slot>\n</template>\n<script setup lang=\"ts\">\nimport { Editor } from '@tiptap/vue-3'\n\nconst props = defineProps<{\n  editor: Editor\n}>()\n\nfunction selectAndUploadVideo() {\n  props.editor.chain().focus().selectAndUploadVideo().run()\n}\n</script>\n","<template>\n  <div>\n    <slot v-bind=\"{ onClick: openIframeDialog }\"></slot>\n\n    <!-- Iframe URL Input Dialog -->\n    <Dialog v-model=\"showDialog\" :options=\"{ title: 'Insert Embed', size: 'md' }\">\n      <template #body-content>\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-ink-gray-7 mb-2\">\n              URL or Embed Code\n            </label>\n            <Textarea\n              ref=\"urlInput\"\n              v-model=\"embedUrl\"\n              placeholder=\"https://youtube.com/watch?v=... or <iframe src=...>\"\n              @keydown.enter=\"insertIframe\"\n              @input=\"validateUrl\"\n            />\n            <p v-if=\"urlError\" class=\"text-red-500 text-sm mt-1\">{{ urlError }}</p>\n            <p v-else-if=\"embedUrl && isValidUrl\" class=\"text-ink-green-3 text-sm mt-1\">\n               Valid {{ platformInfo.platform }} URL\n            </p>\n          </div>\n        </div>\n      </template>\n\n      <template #actions>\n        <div class=\"flex justify-end space-x-2\">\n          <Button variant=\"subtle\" @click=\"showDialog = false\">Cancel</Button>\n          <Button\n            variant=\"solid\"\n            :disabled=\"!embedUrl || !isValidUrl\"\n            @click=\"insertIframe\"\n          >\n            Insert Embed\n          </Button>\n        </div>\n      </template>\n    </Dialog>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, nextTick, onMounted, onUnmounted } from 'vue'\nimport { Editor } from '@tiptap/vue-3'\nimport { Dialog, Button, TextInput, Textarea } from '../../../..'\n\nimport {\n  validateURL,\n  processURL,\n  detectPlatform,\n  calculateAspectRatio,\n  getOptimalDimensions,\n  ALLOWED_DOMAINS\n} from './utils'\n\n\nconst props = defineProps<{\n  editor: Editor\n}>()\n\nconst showDialog = ref(false)\nconst embedUrl = ref('')\nconst urlError = ref('')\nconst title = ref('')\nconst alignment = ref<'left' | 'center' | 'right'>('center')\nconst customWidth = ref<number>(640)\nconst customHeight = ref<number>(360)\n\nconst urlInput = ref<HTMLInputElement>()\n\nconst isValidUrl = computed(() => {\n  if (!embedUrl.value) return false\n\n  try {\n    // Handle iframe embed code\n    if (embedUrl.value.trim().startsWith('<iframe')) {\n      const srcMatch = embedUrl.value.match(/src=[\"']([^\"']+)[\"']/)\n      if (srcMatch?.[1]) {\n        return validateURL(srcMatch[1], {\n          allowedDomains: ALLOWED_DOMAINS,\n          HTMLAttributes: {}\n        })\n      }\n      return false\n    }\n\n    // Handle direct URLs\n    return validateURL(embedUrl.value, {\n      allowedDomains: ALLOWED_DOMAINS,\n      HTMLAttributes: {}\n    })\n  } catch {\n    return false\n  }\n})\n\nconst processedUrl = computed(() => {\n  if (!embedUrl.value) return ''\n\n  // Extract URL from iframe code if needed\n  if (embedUrl.value.trim().startsWith('<iframe')) {\n    const srcMatch = embedUrl.value.match(/src=[\"']([^\"']+)[\"']/)\n    if (srcMatch?.[1]) {\n      return processURL(srcMatch[1])\n    }\n    return embedUrl.value\n  }\n\n  return processURL(embedUrl.value)\n})\n\nconst platformInfo = computed(() => {\n  if (!embedUrl.value || !isValidUrl.value) return { platform: 'Generic', aspectRatio: 9/16 }\n\n  const platform = detectPlatform(processedUrl.value)\n  const aspectInfo = calculateAspectRatio(processedUrl.value)\n\n  return {\n    platform: platform?.name || 'Generic',\n    aspectRatio: aspectInfo.ratio\n  }\n})\n\nconst optimalDimensions = computed(() => {\n  if (!embedUrl.value || !isValidUrl.value) return { width: 640, height: 360 }\n\n  return getOptimalDimensions(processedUrl.value, 800) // Assume 800px editor width\n})\n\nfunction validateUrl() {\n  urlError.value = ''\n\n  if (!embedUrl.value) return\n\n  if (!isValidUrl.value) {\n    urlError.value = 'Please enter a supported URL or iframe embed code'\n  }\n}\n\nfunction openIframeDialog() {\n  showDialog.value = true\n  embedUrl.value = ''\n  urlError.value = ''\n  title.value = ''\n  alignment.value = 'center'\n\n  // Set initial dimensions\n  customWidth.value = 640\n  customHeight.value = 360\n\n  nextTick(() => {\n    urlInput.value?.el?.focus()\n  })\n}\n\n// Update custom dimensions when URL changes\ncomputed(() => {\n  if (embedUrl.value && isValidUrl.value) {\n    const dimensions = optimalDimensions.value\n    customWidth.value = dimensions.width\n    customHeight.value = dimensions.height\n  }\n})\n\nfunction insertIframe() {\n  if (!embedUrl.value || !isValidUrl.value) return\n\n  const success = props.editor.commands.setIframe({\n    src: processedUrl.value,\n    width: customWidth.value,\n    height: customHeight.value,\n    title: title.value,\n    align: alignment.value\n  })\n\n  if (success) {\n    showDialog.value = false\n    props.editor.commands.focus()\n  } else {\n    urlError.value = 'Failed to insert embed. Please check the URL and try again.'\n  }\n}\n\nfunction handleSlashCommandInsert(event: CustomEvent) {\n  if (event.detail?.editor === props.editor) {\n    openIframeDialog()\n  }\n}\n\nonMounted(() => {\n  props.editor.view.dom.addEventListener('iframe:open-dialog', handleSlashCommandInsert as EventListener)\n})\n\nonUnmounted(() => {\n  props.editor.view.dom.removeEventListener('iframe:open-dialog', handleSlashCommandInsert as EventListener)\n})\n</script>\n"],"file":"assets/frappe-ui-BC6vlBMo.js"}