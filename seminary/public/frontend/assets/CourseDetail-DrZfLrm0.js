import{j as w,c as j,I as S,u as O,D as B,v as T,d as D,w as I}from"./frappe-ui-BzEkZ7NZ.js";import{F as U,bk as M,c as C,a8 as z,t as b,b as c,z as x,g as e,a as $,e as d,w as v,u as s,D as i,bI as q,bR as H,U as R,V as F,am as P,I as G,C as Y,H as E,O as L,r as J,bS as K}from"./vendor-IWZbD1HA.js";import{_ as Q}from"./CourseOutline-rEsnVJrw.js";import{f as W,t as X,u as Z}from"./index-DYgOoCE_.js";import{_ as ee}from"./InstructorAvatar-B0-MpPT5.js";import{C as se}from"./CourseCardToDo-CtHyCUpK.js";import"./index-B0k3CMx6.js";import"./settings-D8_73kUS.js";import"./Link-DmVUQNbJ.js";/* empty css                                                                     */const te={class:"border-2 rounded-md min-w-80"},ne=["src"],oe={class:"p-5"},ae={key:0,class:"space-y-2"},re={class:"space-y-4"},le={class:"flex items-center text-ink-gray-9"},ue={class:"ml-2"},ie={class:"flex items-center text-ink-gray-9"},de={class:"ml-2"},ce={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(u){const _=U(),r=M("$user"),a=u,t=C(()=>a.course.data.video_link?"https://www.youtube.com/embed/"+a.course.data.video_link:null);function g(){r.data?setTimeout(()=>{_.push({name:"Lesson",params:{courseName:a.course.data.name,chapterNumber:1,lessonNumber:1}})},2e3):(toast.success(__("You need to login to access this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},2e3))}const f=()=>{let y=!1;return a.course.data.instructors.forEach(l=>{var n;!y&&l.user==((n=r.data)==null?void 0:n.name)&&(y=!0)}),console.log(y),y};return(y,l)=>{var m,o,p,k,N,V,h,A;const n=z("router-link");return c(),b("div",te,[u.course.data.video_link?(c(),b("iframe",{key:0,src:t.value,class:"rounded-t-md min-h-56 w-full"},null,8,ne)):x("",!0),e("div",oe,[u.course.data.membership?(c(),b("div",ae,[d(n,{to:{name:"Lesson",params:{courseName:u.course.name,chapterNumber:u.course.data.current_lesson?u.course.data.current_lesson.split("-")[0]:1,lessonNumber:u.course.data.current_lesson?u.course.data.current_lesson.split("-")[1]:1}}},{default:v(()=>[d(s(w),{variant:"solid",size:"md",class:"w-full"},{default:v(()=>[...l[1]||(l[1]=[e("span",null,i("Continue Learning"),-1)])]),_:1})]),_:1},8,["to"])])):(c(),$(s(w),{key:1,onClick:l[0]||(l[0]=Ke=>g()),variant:"solid",class:"w-full",size:"md"},{default:v(()=>[...l[2]||(l[2]=[e("span",null,i("Start Learning"),-1)])]),_:1})),(o=(m=s(r))==null?void 0:m.data)!=null&&o.is_moderator||f()?(c(),$(n,{key:2,to:{name:"CourseForm",params:{courseName:u.course.data.name}}},{default:v(()=>[d(s(w),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:v(()=>[...l[3]||(l[3]=[e("span",null,i("Edit"),-1)])]),_:1})]),_:1},8,["to"])):x("",!0),(k=(p=s(r))==null?void 0:p.data)!=null&&k.is_moderator||f()?(c(),$(n,{key:3,to:{name:"CourseAssessment",params:{courseName:u.course.data.name}}},{default:v(()=>[d(s(w),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:v(()=>[...l[4]||(l[4]=[e("span",null,i("Configure Assessments"),-1)])]),_:1})]),_:1},8,["to"])):x("",!0),(V=(N=s(r))==null?void 0:N.data)!=null&&V.is_moderator||f()?(c(),$(n,{key:4,to:{name:"Gradebook",params:{courseName:u.course.data.name}}},{default:v(()=>[d(s(w),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:v(()=>[...l[5]||(l[5]=[e("span",null,i("Gradebook"),-1)])]),_:1})]),_:1},8,["to"])):x("",!0),(A=(h=s(r))==null?void 0:h.data)!=null&&A.is_moderator||f()?(c(),$(n,{key:5,to:{name:"StudentAttendanceCS",params:{courseName:u.course.data.name}}},{default:v(()=>[d(s(w),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:v(()=>[...l[6]||(l[6]=[e("span",null,i("Attendance"),-1)])]),_:1})]),_:1},8,["to"])):x("",!0),e("div",re,[l[7]||(l[7]=e("div",{class:"mt-8 font-medium text-ink-gray-9"},i("This course has:"),-1)),e("div",le,[d(s(q),{class:"h-4 w-4 stroke-1.5"}),e("span",ue,i(u.course.data.lessons)+" "+i("Lessons"),1)]),e("div",ie,[d(s(H),{class:"h-4 w-4 stroke-1.5"}),e("span",de,i(s(W)(u.course.data.enrollments))+" "+i("Enrolled Students"),1)])])])])}}},me={class:"announcement-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto"},_e={class:""},pe={class:"mb-1.5 text-sm text-ink-gray-5"},fe={class:""},ve={class:"mb-1.5 text-sm text-ink-gray-5"},be={class:"mb-4"},ye={class:"mb-1.5 text-sm text-ink-gray-5"},he={__name:"AnnouncementModal",props:R({cs:{type:String,required:!0},students:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=F(u,"modelValue"),r=u,a=P({subject:"",replyTo:"",announcement:""}),t=()=>{a.subject="",a.replyTo="",a.announcement=""},g=j({url:"frappe.core.doctype.communication.email.make",makeParams(n){return{recipients:r.students.join(", "),cc:a.replyTo,subject:a.subject,content:a.announcement,doctype:"Course Schedule",name:r.cs,send_email:1}}}),f=n=>{g.submit({},{validate(){if(!r.students.length)return"No students in this course";if(!a.subject)return"Subject is required"},onSuccess(){_.value=!1,t(),n(),T.success(__("Announcement has been sent successfully"))},onError(m){var o;T.error(((o=m.messages)==null?void 0:o[0])||m)}})},y=n=>{_.value=!1,t(),n==null||n()};G(_,n=>{n||t()});const l=C(()=>({title:__("Make an Announcement"),size:"xl",actions:[{label:__("Submit"),variant:"solid",onClick:n=>f(n)},{label:__("Cancel"),variant:"text",onClick:n=>y(n)}]}));return(n,m)=>(c(),$(s(B),{modelValue:_.value,"onUpdate:modelValue":m[3]||(m[3]=o=>_.value=o),options:l.value,disableOutsideClickToClose:!0},{"body-content":v(()=>[e("div",me,[e("div",_e,[e("div",pe,[Y(i(n.__("Subject"))+" ",1),m[4]||(m[4]=e("span",{class:"text-ink-red-3"},"*",-1))]),d(s(S),{type:"text",modelValue:a.subject,"onUpdate:modelValue":m[0]||(m[0]=o=>a.subject=o)},null,8,["modelValue"])]),e("div",fe,[e("div",ve,i(n.__("Reply To")),1),d(s(S),{type:"text",modelValue:a.replyTo,"onUpdate:modelValue":m[1]||(m[1]=o=>a.replyTo=o)},null,8,["modelValue"])]),e("div",be,[e("div",ye,i(n.__("Announcement")),1),d(s(O),{content:a.announcement,fixedMenu:!0,onChange:m[2]||(m[2]=o=>a.announcement=o),editorClass:"prose-sm py-2 px-2 min-h-[200px] border-outline-gray-2 hover:border-outline-gray-3 rounded-b-md bg-surface-gray-3"},null,8,["content"])])])]),_:1},8,["modelValue","options"]))}},ge={class:"border-2 rounded-md min-w-80 p-5"},ke={key:0},xe={class:"mb-8"},we={class:"flex items-center justify-between mb-2"},$e={class:"flex items-center"},Ce={class:"ml-2 text-ink-gray-7"},Ne={class:"text-sm"},Ve=["innerHTML"],je={key:1,class:"text-sm italic text-ink-gray-5"},Ae={__name:"Announcements",props:{cs:{type:String,required:!0}},setup(u){const _=u,r=j({url:"seminary.seminary.api.get_announcements",makeParams(a){return{cs:_.cs}},auto:!0,cache:["announcement",_.cs]});return(a,t)=>{var g;return c(),b("div",ge,[(g=s(r).data)!=null&&g.length?(c(),b("div",ke,[(c(!0),b(E,null,L(s(r).data,f=>(c(),b("div",null,[e("div",xe,[e("div",we,[e("div",$e,[d(s(D),{label:f.sender_full_name,size:"lg"},null,8,["label"]),e("div",Ce,i(f.sender_full_name),1)]),e("div",Ne,i(s(X)(f.communication_date)),1)]),e("div",{class:"prose prose-sm bg-surface-menu-bar !min-w-full px-4 py-2 rounded-md",innerHTML:f.content},null,8,Ve)])]))),256))])):(c(),b("div",je,i(a.__("No announcements")),1))])}}},Se={key:0},Te={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},Me={class:"m-5"},ze={class:"flex justify-between w-full"},Ee={class:"md:w-2/3"},Le={class:"text-3xl font-semibold text-ink-gray-9"},Oe={class:"my-3 leading-6 text-ink-gray-7"},Be=["innerHTML"],De={class:"mt-10"},Ie={key:0,class:"text-lg font-semibold"},Ue={key:1,class:"text-lg font-semibold"},qe={class:"flex flex-wrap gap-4"},He={class:"text-center text-sm font-medium"},Re={class:"mt-10"},Fe={class:"border-0 rounded-md min-w-80"},Pe={class:"mt-5"},Ge={class:"mt-5"},Ye={key:0,class:"mt-5 flex justify-center"},Je={class:"mt-5"},rs={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(u){const _=M("$user"),r=u,a=J(!1);console.log("CourseName prop:",r.courseName);const t=j({url:"seminary.seminary.utils.get_course_details",cache:["course",r.courseName],params:{course:r.courseName},auto:!0});console.log(t),console.log("Course props:",r.courseName);const g=j({url:"seminary.seminary.utils.get_roster",cache:["roster",r.courseName],params:{course:r.courseName},auto:!0}),f=C(()=>(g.data||[]).map(o=>o.stuemail_rc));console.log("Student Emails:",f.value);const y=()=>{a.value=!0},l=C(()=>{const o=(_==null?void 0:_.data)||{};return!!(o.is_moderator||o.is_instructor||o.is_evaluator)}),n=C(()=>{var p,k;let o=[{label:"Courses",route:{name:"Courses"}}];return o.push({label:(p=t==null?void 0:t.data)==null?void 0:p.course,route:{name:"CourseDetail",params:{courseName:(k=t==null?void 0:t.data)==null?void 0:k.name}}}),o}),m=C(()=>{var o,p;return{title:(o=t==null?void 0:t.data)==null?void 0:o.title,description:(p=t==null?void 0:t.data)==null?void 0:p.short_introduction}});return Z(m),(o,p)=>{var N,V;const k=z("Button");return s(t).data?(c(),b("div",Se,[e("header",Te,[d(s(I),{class:"h-7",items:n.value},null,8,["items"])]),e("div",Me,[e("div",ze,[e("div",Ee,[e("div",Le,i(s(t).data.course),1),e("div",Oe,i(s(t).data.short_introduction),1),e("div",{innerHTML:s(t).data.course_description_for_lms,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,Be),e("div",De,[s(t).data.instructors.length===1?(c(),b("div",Ie,"Instructor")):(c(),b("div",Ue,"Instructors")),p[2]||(p[2]=e("br",null,null,-1)),e("div",qe,[(c(!0),b(E,null,L(s(t).data.instructors,h=>(c(),b("div",{key:h.instructor_name,class:"flex flex-col items-center"},[d(ee,{instructor:h,size:"xl",class:"mb-2 w-20 h-20"},null,8,["instructor"]),e("div",He,i(h.instructor_name),1)]))),128))])]),e("div",Re,[d(Q,{title:"Course Outline",courseName:s(t).data.name,showOutline:!0,allowEdit:l.value},null,8,["courseName","allowEdit"])])]),e("div",Fe,[d(ce,{course:s(t),class:"mb-4"},null,8,["course"]),e("div",Pe,[d(se,{course:r.courseName},null,8,["course"])]),e("div",Ge,[d(Ae,{cs:r.courseName},null,8,["cs"])]),(N=s(_).data)!=null&&N.is_moderator||(V=s(_).data)!=null&&V.is_instructor?(c(),b("div",Ye,[d(k,{onClick:p[0]||(p[0]=h=>y())},{suffix:v(()=>[d(s(K),{class:"h-4 stroke-1.5"})]),default:v(()=>[e("span",null,i(o.__("Make an Announcement")),1)]),_:1})])):x("",!0),e("div",Je,[d(he,{modelValue:a.value,"onUpdate:modelValue":p[1]||(p[1]=h=>a.value=h),cs:r.courseName,students:f.value},null,8,["modelValue","cs","students"])])])])])])):x("",!0)}}};export{rs as default};
//# sourceMappingURL=CourseDetail-DrZfLrm0.js.map
