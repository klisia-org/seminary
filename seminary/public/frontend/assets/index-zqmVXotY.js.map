{"version":3,"file":"index-zqmVXotY.js","sources":["../../../../frontend/src/components/ProgressBar.vue","../../../../frontend/src/components/Quiz.vue","../../../../frontend/src/components/QuizBlock.vue","../../../../frontend/src/components/AssessmentPlugin.vue","../../../../frontend/src/utils/quiz.js","../../../../frontend/src/components/Assignment.vue","../../../../frontend/src/components/AssignmentBlock.vue","../../../../frontend/src/utils/assignment.js","../../../../frontend/src/components/ExamGraded.vue","../../../../frontend/src/components/UserAvatar.vue","../../../../frontend/src/components/DiscussionReplies.vue","../../../../frontend/src/components/Modals/DiscussionModal.vue","../../../../frontend/src/utils/scrollContainer.js","../../../../frontend/src/components/Discussions.vue","../../../../frontend/src/components/Exam.vue","../../../../frontend/src/components/ExamBlock.vue","../../../../frontend/src/utils/exam.js","../../../../frontend/src/components/DiscussionActivity.vue","../../../../frontend/src/components/DiscussionActivityBlock.vue","../../../../frontend/src/utils/discussionactivity.js","../../../../frontend/src/components/AudioBlock.vue","../../../../frontend/src/components/VideoBlock.vue","../../../../frontend/src/components/UploadPlugin.vue","../../../../frontend/src/utils/upload.js","../../../../frontend/src/utils/markdownParser.js","../../../../frontend/src/utils/code.ts","../../../../frontend/src/components/FolderPlugin.vue","../../../../frontend/src/components/FolderBlock.vue","../../../../frontend/src/utils/foldertool.js","../../../../frontend/src/utils/index.js"],"sourcesContent":["<template>\n\t<Tooltip :text=\"`${props.progress}%`\">\n\t\t<div class=\"w-full bg-surface-gray-3 rounded-full h-1\">\n\t\t\t<div\n\t\t\t\tclass=\"bg-surface-gray-7 rounded-full\"\n\t\t\t\t:class=\"progressBarHeight\"\n\t\t\t\t:style=\"{ width: progressBarWidth }\"\n\t\t\t></div>\n\t\t</div>\n\t</Tooltip>\n</template>\n\n<script setup>\nimport { computed } from 'vue'\nimport { Tooltip } from 'frappe-ui'\n\nconst props = defineProps({\n\tprogress: {\n\t\ttype: Number,\n\t\tdefault: 0,\n\t},\n\tsize: {\n\t\ttype: String,\n\t\tdefault: 'sm',\n\t},\n})\n\nconst progressBarWidth = computed(() => {\n\tconst formattedPercentage = Math.min(Math.ceil(props.progress), 100)\n\treturn `${formattedPercentage}%`\n})\n\nconst progressBarHeight = computed(() => {\n\tif (props.size === 'sm') {\n\t\treturn 'h-1'\n\t}\n\tif (props.size === 'md') {\n\t\treturn 'h-2'\n\t}\n\tif (props.size === 'lg') {\n\t\treturn 'h-3'\n\t}\n})\n</script>\n","<template>\n\t<div v-if=\"isQuizLoaded\">\n\t\t<!-- Quiz Header -->\n\t\t<div\n\t\t\tclass=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\"\n\t\t>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`This quiz consists of ${questions.length} questions.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`Please ensure that you complete all the questions in ${quiz.data.duration} minutes.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t(\n\t\t\t\t\t\t'If you fail to do so, the quiz will be automatically submitted when the timer ends.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.passing_percentage\" class=\"leading-relaxed\">\n\t\t\t\t{{\n\t\t\t\t\t`You will have to get ${quiz.data.passing_percentage}% correct answers in order to pass the quiz.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"quiz.data.max_attempts\" class=\"leading-relaxed\">\n\t\t\t\t{{\n\t\t\t\t\t`You can attempt this quiz ${\n\t\t\t\t\t\tquiz.data.max_attempts === 1 ? '1 time' : `${quiz.data.max_attempts} times`\n\t\t\t\t\t}.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div v-if=\"quiz.data.duration\" class=\"flex flex-col space-x-1 my-4\">\n\t\t\t<div class=\"mb-2\">\n\t\t\t\t<span class=\"\"> {{ ('Time') }}: </span>\n\t\t\t\t<span class=\"font-semibold\">\n\t\t\t\t\t{{ formatTimer(timer) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ProgressBar :progress=\"timerProgress\" />\n\t\t</div>\n\n\t\t<!-- Start Screen -->\n<div v-if=\"!fullQuizMode\">\n  <div class=\"border text-center p-20 rounded-md\">\n    <div class=\"font-semibold text-lg\">\n      {{ quiz.data.title }}\n    </div>\n    <Button\n      v-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts) && quiz.data.qbyquestion\"\n      @click=\"startQuiz\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start') }}</span>\n    </Button>\n    <Button\n      v-else-if=\"(!quiz.data.max_attempts || attempts.data?.length < quiz.data.max_attempts)\"\n      @click=\"startQuiz2\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start full quiz') }}</span>\n    </Button>\n    <div v-else>\n      {{ 'You have already exceeded the maximum number of attempts allowed for this quiz.' }}\n    </div>\n  </div>\n</div>\n\n<!-- Question-by-Question Mode -->\n<div v-if=\"fullQuizMode === false && activeQuestion !== 0 && !quizSubmission.data && quiz.data.qbyquestion\">\n\t<div v-for=\"(question, qtidx) in questions\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"qtidx == activeQuestion - 1 && questionDetails.data\"\n\t\t\t\t\tclass=\"border rounded-md p-5\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex justify-between\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t<span class=\"mr-2\">\n\t\t\t\t\t\t\t\t{{ `Question ${activeQuestion}` }}:\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ getInstructions(questionDetails.data) }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n\t\t\t\t\t\t\t{{ question.points }}\n\t\t\t\t\t\t\t{{ question.points == 1 ? ('Point') : ('Points') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"text-ink-gray-9 font-semibold mt-2 leading-5\"\n\t\t\t\t\t\tv-html=\"questionDetails.data.question\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div v-if=\"questionDetails.data.type == 'Choices'\" v-for=\"index in 4\">\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\tv-if=\"questionDetails.data[`option_${index}`]\"\n\t\t\t\t\t\t\tclass=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-if=\"!showAnswers.length && !questionDetails.data.multiple\"\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\"\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-else-if=\"!showAnswers.length && questionDetails.data.multiple\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t:name=\"encodeURIComponent(questionDetails.data.question)\"\n\t\t\t\t\t\t\t\tclass=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n\t\t\t\t\t\t\t\t@change=\"markAnswer(index)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-else-if=\"quiz.data.show_answers\"\n\t\t\t\t\t\t\t\tv-for=\"(answer, idx) in showAnswers\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div v-if=\"index - 1 == idx\">\n\t\t\t\t\t\t\t\t\t<CheckCircle\n\t\t\t\t\t\t\t\t\t\tv-if=\"answer == 1\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-green-800\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<MinusCircle\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"answer == 2\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-ink-green-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<XCircle\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"answer == 0\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 text-red-600\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<MinusCircle v-else class=\"w-4 h-4\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"ml-2\"\n\t\t\t\t\t\t\t\tv-html=\"questionDetails.data[`option_${index}`]\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"questionDetails.data[`explanation_${index}`]\"\n\t\t\t\t\t\t\tclass=\"mt-2 text-xs\"\n\t\t\t\t\t\t\tv-show=\"showAnswers.length\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ questionDetails.data[`explanation_${index}`] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else-if=\"questionDetails.data.type == 'User Input'\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"possibleAnswer\"\n\t\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\t\t:disabled=\"showAnswers.length ? true : false\"\n\t\t\t\t\t\t\tclass=\"my-2\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"showAnswers.length\">\n\t\t\t\t\t\t\t<Badge v-if=\"showAnswers[0]\" :label=\"('Correct')\" theme=\"green\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t<Badge v-else theme=\"red\" :label=\"('Incorrect')\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t\tclass=\"mt-4\"\n\t\t\t\t\t\t\t:content=\"possibleAnswer\"\n\t\t\t\t\t\t\t@change=\"(val) => (possibleAnswer = val)\"\n\t\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center justify-between mt-4\">\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5\">\n\t\t\t\t\t\t\t{{ `Question ${activeQuestion} of ${questions.length}` }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"\n\t\t\t\t\t\t\t\tquiz.data.show_answers &&\n\t\t\t\t\t\t\t\t!showAnswers.length \n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t@click=\"checkAnswer()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Check') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-else-if=\"activeQuestion != questions.length\"\n\t\t\t\t\t\t\t@click=\"nextQuestion()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Next') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button v-else @click=\"submitQuiz()\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ ('Submit') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n<!-- Full Quiz Mode: All questions at once -->\n<div v-if=\"fullQuizMode && all_questions_details.data && all_questions_details.data.length > 0\">\n  <div v-for=\"(question, qtidx) in all_questions_details.data\" :key=\"question.name\" class=\"border rounded-md p-5 mb-4\">\n    <!-- Render each question header, text, and answer options -->\n    <div class=\"flex justify-between\">\n      <div class=\"text-sm text-ink-gray-5\">\n        <span class=\"mr-2\">{{ `Question ${qtidx + 1}` }}:</span>\n        <span>{{ getInstructions(question) }}</span>\n      </div>\n      <div class=\"text-ink-gray-9 text-sm font-semibold item-left\">\n        {{ question.points || 0 }} {{ question.points == 1 ? ('Point') : ('Points') }}\n      </div>\n    </div>\n    <div class=\"text-ink-gray-9 font-semibold mt-2 leading-5\" v-html=\"question.question_detail\"></div>\n    <!-- Answer Options -->\n    <div v-if=\"question.type == 'Choices'\" v-for=\"index in 4\">\n      <label\n        v-if=\"question[`option_${index}`]\"\n        class=\"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600\"\n      >\n        <input\n          v-if=\"!question.multiple\"\n          type=\"radio\"\n          :name=\"`question_${qtidx}`\"\n          class=\"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals\"\n          @change=\"recordAnswer(qtidx, question[`option_${index}`])\"\n        />\n        <input\n          v-else-if=\"question.multiple\"\n          type=\"checkbox\"\n          :name=\"`question_${qtidx}`\"\n          class=\"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals\"\n          @change=\"toggleAnswer(qtidx, question[`option_${index}`])\"\n        />\n        <span class=\"ml-2\" v-html=\"question[`option_${index}`]\"></span>\n      </label>\n    </div>\n    <!-- User Input Option -->\n    <div v-else-if=\"question.type == 'User Input'\">\n      <FormControl v-model=\"answers[qtidx]\" type=\"textarea\" class=\"my-2\" />\n    </div>\n  </div>\n  <!-- Submit Button -->\n  <div class=\"text-center mt-4\">\n    <Button @click=\"submitQuizComplete()\">\n      <span>{{ ('Submit Your Quiz') }}</span>\n    </Button>\n  </div>\n</div>\n\n<!-- Quiz Summary (if quizSubmission.data exists) -->\n<div v-else-if=\"quizSubmission.data\" class=\"border rounded-md p-20 text-center space-y-4\">\n  <div class=\"text-lg font-semibold\">{{ ('Quiz Summary') }}</div>\n  <div class=\"text-ink-gray-9\">\n    {{ `You got ${Math.ceil(quizSubmission.data.percentage)}% correct answers with a score of ${quizSubmission.data.score} out of ${quizSubmission.data.score_out_of}` }}\n  </div>\n  <div class=\"mt-6\">\n    <div v-for=\"(question, qtidx) in detailedQuestions\" :key=\"question.question_name\" class=\"border rounded-md p-5 mb-4\">\n      <!-- Question Header -->\n      <div class=\"flex justify-between\">\n        <div class=\"text-lg text-ink-gray-5\">\n          <span class=\"mr-2\">{{ `Question ${qtidx + 1}` }}:</span>\n\t\t  <span v-html=\"question.question_detail\"></span>\n        </div>\n      </div>\n\n      <!-- User Answer -->\n      <div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Your Answer:') }}</strong> {{ question.user_answer || 'No Answer' }}\n      </div>\n\n      <!-- Correct Answer -->\n      <div class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Correct Answer:') }}</strong> {{ question.correct_answer || 'No Correct Answer' }}\n      </div>\n\n      <!-- Explanation -->\n      <div v-if=\"question.explanation\" class=\"bg-surface-gray-3 rounded-md p-3 mt-4\">\n        <strong>{{ ('Explanation:') }}</strong> {{ question.explanation }}\n      </div>\n\n      <!-- Correct/Incorrect Indicator -->\n      <div class=\"mt-4\">\n        <Badge v-if=\"quizResults[qtidx]?.is_correct?.[0] === 1\" :label=\"('Correct')\" theme=\"green\">\n          <template #prefix>\n            <CheckCircle class=\"w-4 h-4 text-ink-green-2 mr-1\" />\n          </template>\n        </Badge>\n        <Badge v-else :label=\"('Incorrect')\" theme=\"red\">\n          <template #prefix>\n            <XCircle class=\"w-4 h-4 text-ink-red-3 mr-1\" />\n          </template>\n        </Badge>\n      </div>\n    </div>\n  </div>\n  <Button @click=\"resetQuiz()\" class=\"mt-4\">\n    <span>{{ ('Try Again') }}</span>\n  </Button>\n</div>\n\t</div>\n\t<div v-else>\n\t\t<p>Loading quiz data...</p>\n\t</div>\n</template>\n<script setup>\nimport {Badge, Button, call, createResource, ListView, TextEditor, FormControl, toast} from 'frappe-ui'\nimport { ref, watch, reactive, inject, computed } from 'vue'\nimport { createToast } from '@/utils/'\nimport { CheckCircle, XCircle, MinusCircle } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\n\nconst user = inject('$user')\nconst fullQuizMode = ref(false);\nconst activeQuestion = ref(0)\nconst currentQuestion = ref('')\nconst selectedOptions = reactive([0, 0, 0, 0])\nconst showAnswers = reactive([])\nlet questions = reactive([])\nconst possibleAnswer = ref(null)\nconst timer = ref(0)\nlet timerInterval = null\nconst router = useRouter()\nconst elapsedTime = ref(0); // Tracks the time taken in seconds\nconst answers = reactive({}); // Stores the answers for each question\n\n\nconst props = defineProps({\n\tquizName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\n// Ensure `quiz.data` is properly initialized and loaded\nconst quiz = createResource({\n    url: 'frappe.client.get',\n    makeParams(values) {\n        return {\n            doctype: 'Quiz',\n            name: props.quizName,\n        };\n    },\n    cache: ['quiz', props.quizName],\n    auto: true,\n    transform(data) {\n        if (!data) {\n            console.error(\"Quiz data is null or undefined.\"); // Debugging\n            return null;\n        }\n        data.duration = parseInt(data.duration) || 0; // Ensure duration is a valid number\n        return data;\n    },\n    onSuccess(data) {\n        if (data) {\n            populateQuestions();\n            setupTimer();\n        } else {\n            console.error(\"Failed to load quiz data.\"); // Debugging\n        }\n    },\n    onError(err) {\n        console.error(\"Error loading quiz data:\", err); // Debugging\n    },\n});\n\n// Add a computed property to check if `quiz.data` is loaded\nconst isQuizLoaded = computed(() => !!quiz.data);\n\nconst populateQuestions = () => {\n    let data = quiz.data;\n    if (data.shuffle_questions) {\n        // Shuffle the questions\n        const shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n        // Limit the number of questions if required\n        questions = data.limit_questions_to\n            ? shuffledQuestions.slice(0, data.limit_questions_to)\n            : shuffledQuestions;\n    } else {\n        // Use the original questions if no shuffle is required\n        questions = data.questions;\n    }\n\t\n}\n\nconst setupTimer = () => {\n\tif (quiz.data.duration) {\n\t\ttimer.value = quiz.data.duration * 60\n\t}\n}\n\nconst startTimer = () => {\n    timerInterval = setInterval(() => {\n        if (quiz.data.duration) {\n            timer.value--;\n            if (timer.value == 0) {\n                clearInterval(timerInterval);\n                submitQuiz();\n            }\n        }\n        elapsedTime.value++; // Always increment elapsed time\n    }, 1000);\n};\n\nconst formatTimer = (seconds) => {\n\tconst hrs = Math.floor(seconds / 3600)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst mins = Math.floor((seconds % 3600) / 60)\n\t\t.toString()\n\t\t.padStart(2, '0')\n\tconst secs = (seconds % 60).toString().padStart(2, '0')\n\treturn hrs != '00' ? `${hrs}:${mins}:${secs}` : `${mins}:${secs}`\n}\n\nconst timerProgress = computed(() => {\n\treturn (timer.value / (quiz.data.duration * 60)) * 100\n})\n\nconst shuffleArray = (array) => {\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tconst j = Math.floor(Math.random() * (i + 1))\n\t\t;[array[i], array[j]] = [array[j], array[i]]\n\t}\n\treturn array\n}\n\nconst attempts = createResource({\n\turl: 'frappe.client.get_list',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Quiz Submission',\n\t\t\tfilters: {\n\t\t\t\tmember: user.data?.name,\n\t\t\t\tquiz: quiz.data?.name,\n\t\t\t},\n\t\t\tfields: [\n\t\t\t\t'name',\n\t\t\t\t'creation',\n\t\t\t\t'score',\n\t\t\t\t'score_out_of',\n\t\t\t\t'percentage',\n\t\t\t\t'passing_percentage',\n\t\t\t],\n\t\t\torder_by: 'creation desc',\n\t\t}\n\t},\n\ttransform(data) {\n\t\tdata.forEach((submission, index) => {\n\t\t\tsubmission.creation = timeAgo(submission.creation)\n\t\t\tsubmission.idx = index + 1\n\t\t})\n\t},\n})\n\nwatch(\n\t() => quiz.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tpopulateQuestions()\n\t\t\t\n\t\t}\n\t\tif (newData && quiz.data.max_attempts) {\n\t\t\tattempts.reload()\n\t\t\tresetQuiz()\n\t\t}\n\t}\n)\n\nconst quizSubmission = createResource({\n    url: 'seminary.seminary.doctype.quiz.quiz.quiz_summary',\n    makeParams(values) {\n        // Add null-safe checks for `quiz.data`\n        if (!quiz.data) {\n            return {}; // Return an empty object to avoid errors\n        }\n        const timeTaken = quiz.data.duration\n            ? quiz.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n            : elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n       \n\n        return {\n            quiz: quiz.data.name,\n            course: router.currentRoute.value.params.courseName,\n            results: values?.results || localStorage.getItem(`${quiz.data.name}_results`), // Ensure `results` is properly initialized\n            time_taken: timeTaken, // Pass the correct time_taken\n        };\n    },\n    onSuccess(data) {\n       \n        if (data.corrected_answers) {\n            all_questions_details.data = data.corrected_answers.map((question) => ({\n                ...question,\n                user_answer: question.user_answer || null, // Ensure user_answer is included\n                correct_answer: question.correct_answer || null, // Ensure correct_answer is included\n            }));\n        }\n    },\n    onError(err) {\n        console.error(\"Error loading quiz summary:\", err); // Debugging\n    },\n    auto: true, // Re-enable auto-fetch\n});\n\nconst questionDetails = createResource({\n\turl: 'seminary.seminary.utils.get_question_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestion: currentQuestion.value,\n\t\t}\n\t},\n\t\n})\n\nwatch(activeQuestion, (value) => {\n\tif (value > 0) {\n\t\tcurrentQuestion.value = quiz.data.questions[value - 1].question\n\t\tquestionDetails.reload()\n\t}\n})\n\nwatch(\n\t() => props.quizName,\n\t(newName) => {\n\t\tif (newName) {\n\t\t\tquiz.reload()\n\t\t}\n\t}\n)\n\nconst all_questions_details = createResource({\n\turl: 'seminary.seminary.utils.get_all_questions_details',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tquestions: questions.map((q) => q.name), // Ensure only question names are sent\n\t\t}\n\t},\n})\n\n\n\nconst startQuiz = () => {\n\tactiveQuestion.value = 1\n\tlocalStorage.removeItem(quiz.data.title)\n\tstartTimer()\n}\n\nconst startQuiz2 = () => {\n    localStorage.removeItem(quiz.data.title);\n    fullQuizMode.value = true; // Set full quiz mode flag\n    startTimer();\n    all_questions_details.reload(); // Ensure the resource is reloaded\n    \n}\n\n\nconst markAnswer = (index) => {\n\tif (!questionDetails.data.multiple)\n\t\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tselectedOptions[index - 1] = selectedOptions[index - 1] ? 0 : 1\n}\n\nconst getAnswers = () => {\n\tlet answers = []\n\tconst type = questionDetails.data.type\n\n\tif (type == 'Choices') {\n\t\tselectedOptions.forEach((value, index) => {\n\t\t\tif (selectedOptions[index])\n\t\t\t\tanswers.push(questionDetails.data[`option_${index + 1}`])\n\t\t})\n\t} else {\n\t\tanswers.push(possibleAnswer.value)\n\t}\n\n\treturn answers\n}\n\nconst checkAnswer = () => {\n    let answers = getAnswers();\n    if (!answers.length) {\n        createToast({\n            title: 'Please select an option',\n            icon: 'alert-circle',\n            iconClasses: 'text-yellow-600 bg-yellow-100 rounded-full',\n            position: 'top-center',\n        });\n        return;\n    }\n\n    createResource({\n        url: 'seminary.seminary.doctype.quiz.quiz.check_answer',\n        params: {\n            question: currentQuestion.value,\n            type: questionDetails.data.type,\n            answers: JSON.stringify(answers),\n        },\n        auto: true,\n        onSuccess(data) {\n            let type = questionDetails.data.type;\n            if (type === 'Choices') {\n                selectedOptions.forEach((option, index) => {\n                    if (option) {\n                        showAnswers[index] = option && data[index];\n                    } else if (data[index] === 2) {\n                        showAnswers[index] = 2;\n                    } else {\n                        showAnswers[index] = undefined;\n                    }\n                });\n            } else {\n                showAnswers.push(data);\n            }\n            addToLocalStorage();\n            if (!quiz.data.show_answers) {\n                resetQuestion();\n            }\n        },\n    });\n};\n\nconst addToLocalStorage = () => {\n    let quizData = JSON.parse(localStorage.getItem(quiz.data.title)) || [];\n    let questionData = {\n        question_name: currentQuestion.value,\n        answer: getAnswers().join(),\n        is_correct: showAnswers.filter((answer) => {\n\t\t\treturn answer != undefined\n\t\t}),\n    };\n\n    // Check if the question already exists in localStorage\n    const existingIndex = quizData.findIndex(\n        (item) => item.question_name === questionData.question_name\n    );\n\n    if (existingIndex !== -1) {\n        // Update the existing question data\n        quizData[existingIndex] = questionData;\n    } else {\n        // Add the new question data\n        quizData ? quizData.push(questionData) : (quizData = [questionData])\n    }\n\n    \n  localStorage.setItem(quiz.data.title, JSON.stringify(quizData));\n  localStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(quizData)); // Save results for submission\n\n};\n\nconst nextQuestion = () => {\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t} else {\n\t\taddToLocalStorage()\n\t\tresetQuestion()\n\t}\n}\n\nconst resetQuestion = () => {\n\tif (activeQuestion.value == quiz.data.questions.length) return\n\tactiveQuestion.value = activeQuestion.value + 1\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tpossibleAnswer.value = null\n}\n\nconst submitQuiz = () => {\n\t\n\tif (!quiz.data.show_answers) {\n\t\tcheckAnswer()\n\t\tsetTimeout(() => {\n\t\t\tcreateSubmission()\n\t\t}, 500)\n\t\treturn\n\t}\n\tcreateSubmission()\n\tconsole.log('Quiz submitted with Submit Quiz button and asnwers shown')\n}\n\nconst submitQuizComplete = async () => {\n\tconst results = [];\n\tconst detailedQuestions = []; // Array to store detailed question data\n\n\t// Iterate through all questions and collect answers\n\tfor (let i = 0; i < all_questions_details.data.length; i++) {\n\t\tconst question = all_questions_details.data[i];\n\t\tconst answer = answers[i]?.[0] || \"\"; // Get the first recorded answer or an empty string\n\n\t\t\n\n\t\t// Call the backend to validate the answer\n\t\tconst response = await call('seminary.seminary.doctype.quiz.quiz.check_answer', {\n\t\t\tquestion: question.question, // Pass the unique question identifier\n\t\t\ttype: question.type,\n\t\t\tanswers: JSON.stringify([answer]), // Send the answer as an array\n\t\t});\n\n\t\t// Extract only the relevant value for `is_correct`\n\t\tconst is_correct = Array.isArray(response) ? [response.find((val) => val === 1) || 0] : [response];\n\n\t\tresults.push({\n\t\t\tquestion_name: question.question, // Use the unique question identifier\n\t\t\tanswer: answer, // Use the single answer string\n\t\t\tis_correct: is_correct, // Ensure this contains only the relevant value\n\t\t});\n\n\t\t// Add detailed question data (correct_answer will be fetched later)\n\t\tdetailedQuestions.push({\n\t\t\tquestion_name: question.question,\n\t\t\tquestion_detail: question.question_detail,\n\t\t\tuser_answer: answer,\n\t\t\tcorrect_answer: null, // Placeholder for correct answer\n\t\t\texplanation: question.explanation || null,\n\t\t});\n\t}\n\n\n\t// Submit the quiz results\n\tquizSubmission.submit(\n\t\t{ results: JSON.stringify(results) }, // Ensure results is passed as a string\n\t\t{\n\t\t\tonSuccess: async (data) => {\n\t\t\t\t\n\n\t\t\t\t// Fetch correct answers from the backend\n\t\t\t\tconst correctAnswers = await call('seminary.seminary.doctype.quiz.quiz.get_all_question_results', {\n\t\t\t\t\tquestions: questions.map(q => q.question),\n\t\t\t\t});\n\n\t\t\t\t// Update detailedQuestions with correct answers and explanations\n\t\t\t\tdetailedQuestions.forEach((question) => {\n\t\t\t\t\tconst correctAnswer = correctAnswers.find((item) => item.name === question.question_name);\n\t\t\t\t\tif (correctAnswer) {\n\t\t\t\t\t\tquestion.correct_answer = correctAnswer.correct_option;\n\t\t\t\t\t\tquestion.explanation = correctAnswer.correct_explanation || question.explanation;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Store detailed question data in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_questions`, JSON.stringify(detailedQuestions));\n\t\t\t\t\n\n\t\t\t\t// Store results in localStorage for use in `makeParams`\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_results`, JSON.stringify(results));\n\n\t\t\t\t// Store the quiz summary in localStorage\n\t\t\t\tlocalStorage.setItem(`${quiz.data.name}_summary`, JSON.stringify(data));\n\t\t\t\t\n\n\t\t\t\tquizSubmission.reload(); // Reload the quiz summary and corrected answers\n\t\t\t\tfullQuizMode.value = false; // Exit full quiz mode to show the summary\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconsole.error(\"Error submitting quiz:\", err);\n\t\t\t},\n\t\t}\n\t);\n};\n\nconst createSubmission = () => {\n\tconst results = localStorage.getItem(`${quiz.data.name}_results`); // Retrieve results from localStorage\n  if (!results) {\n    console.error(\"No results found to submit.\"); // Debugging\n    return;\n  }\n\n  quizSubmission.submit(\n    { results }, // Pass results to the backend\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\tmarkLessonProgress()\n\t\t\t\tif (quiz.data && quiz.data.max_attempts) attempts.reload()\n\t\t\t\tif (quiz.data.duration) clearInterval(timerInterval)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tconst errorTitle = err?.message || ''\n\t\t\t\tif (errorTitle.includes('MaximumAttemptsExceededError')) {\n\t\t\t\t\tconst errorMessage = err.messages?.[0] || err\n\t\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.reload()\n\t\t\t\t\t}, 3000)\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst resetQuiz = () => {\n\tactiveQuestion.value = 0\n\tselectedOptions.splice(0, selectedOptions.length, ...[0, 0, 0, 0])\n\tshowAnswers.length = 0\n\tquizSubmission.reset()\n\tpopulateQuestions()\n\tsetupTimer()\n\telapsedTime.value = 0 // Reset elapsed time\n}\n\nconst getInstructions = (question) => {\n\tif (question.type == 'Choices')\n\t\tif (question.multiple) return ('Choose all answers that apply')\n\t\telse return ('Choose one answer')\n\telse return ('Type your answer')\n}\n\nconst markLessonProgress = () => {\n\t\n\tif (router.currentRoute.value.name === 'Lesson') {\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: router.currentRoute.value.params.courseName,\n\t\t\tchapter_number: router.currentRoute.value.params.chapterNumber,\n\t\t\tlesson_number: router.currentRoute.value.params.lessonNumber,\n\t\t}).then(() => {\n\t\t\tif (fullQuizMode.value) {\n\t\t\t\tquizSubmission.reload(); // Ensure the quiz summary is reloaded for full quiz mode\n\t\t\t}\n\t\t});\n\t}\n};\n\nconst getSubmissionColumns = () => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'No.',\n\t\t\tkey: 'idx',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Date',\n\t\t\tkey: 'creation',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Score',\n\t\t\tkey: 'score',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Score out of',\n\t\t\tkey: 'score_out_of',\n\t\t\talign: 'center',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Percentage',\n\t\t\tkey: 'percentage',\n\t\t\talign: 'center',\n\t\t}\n\t]\n}\n\nconst recordAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and stores the selected answer\n\tanswers[qtidx] = [answer];\n\t\n};\n\nconst toggleAnswer = (qtidx, answer) => {\n\t// Ensure `answers` is reactive and handles multiple answers\n\tif (!answers[qtidx]) {\n\t\tanswers[qtidx] = [];\n\t}\n\tconst index = answers[qtidx].indexOf(answer);\n\tif (index === -1) {\n\t\tanswers[qtidx].push(answer); // Add the answer if not already selected\n\t} else {\n\t\tanswers[qtidx].splice(index, 1); // Remove the answer if already selected\n\t}\n\t\n};\n\nwatch(\n\t() => all_questions_details.data,\n\t(newData) => {\n\t\tif (newData) {\n\t\t\tconsole.log(\"All questions details updated\"); // Debugging\n\t\t} else {\n\t\t\tconsole.warn(\"No data available in all_questions_details.\"); // Debugging\n\t\t}\n\t}\n)\n\n// Load detailed question data and results from localStorage\nconst detailedQuestions = ref([]);\nconst quizResults = ref([]);\n\nwatch(\n  () => quizSubmission.data,\n  () => {\n    if (quizSubmission.data) {\n      const questions = localStorage.getItem(`${quiz.data.name}_questions`);\n      const results = localStorage.getItem(`${quiz.data.name}_results`);\n      detailedQuestions.value = questions ? JSON.parse(questions) : [];\n      quizResults.value = results ? JSON.parse(results) : [];\n    }\n  }\n);\n</script>","<template>\n\t<Quiz v-if=\"user.data\" :quizName=\"quiz\"></Quiz>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the quiz.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Quiz from '@/components/Quiz.vue'\n\nconst user = inject('$user')\nconst props = defineProps({\n\tquiz: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:options=\"{\n\t\t\tsize: 'xl',\n\t\t}\"\n\t>\n\t\t<template #body>\n\t\t\t<button style=\"opacity: 0; position: absolute;\">Fallback Focus</button>\n\t\t\t<div class=\"p-5 space-y-4\">\n\t\t\t\t<div v-if=\"type == 'quiz'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add a quiz to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"type == 'exam'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an exam to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"type == 'discussionactivity'\" class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add a discussion activity to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"text-lg font-semibold\">\n\t\t\t\t\t{{ __('Add an assignment to your lesson') }}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-if=\"type == 'quiz'\"\n\t\t\t\t\t\tv-model=\"quiz\"\n\t\t\t\t\t\tdoctype=\"Quiz\"\n\t\t\t\t\t\t:label=\"__('Select a quiz')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else-if=\"type == 'exam'\"\n\t\t\t\t\t\tv-model=\"exam\"\n\t\t\t\t\t\tdoctype=\"Exam Activity\"\n\t\t\t\t\t\t:label=\"__('Select an exam')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else-if=\"type == 'discussionactivity'\"\n\t\t\t\t\t\tv-model=\"discussionactivity\"\n\t\t\t\t\t\tdoctype=\"Discussion Activity\"\n\t\t\t\t\t\t:label=\"__('Select a discussion activity')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tv-model=\"assignment\"\n\t\t\t\t\t\tdoctype=\"Assignment Activity\"\n\t\t\t\t\t\t:label=\"__('Select an assignment')\"\n\t\t\t\t\t\t:onCreate=\"(value, close) => redirectToForm()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex justify-end space-x-2\">\n\t\t\t\t\t<Button variant=\"solid\" @click=\"addAssessment()\">\n\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, Button } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\nimport Link from '@/components/Controls/Link.vue'\n\nconst show = ref(false)\nconst quiz = ref(null)\nconst assignment = ref(null)\nconst exam = ref(null)\nconst discussionactivity = ref(null)\n\nconst props = defineProps({\n\ttype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tonAddition: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\n\nonMounted(async () => {\n\tawait nextTick()\n\tshow.value = true\n})\n\nconst addAssessment = () => {\n\tif (props.type == 'quiz') {\n\t\tprops.onAddition(quiz.value)\n\t} else if (props.type == 'exam') {\n\t\tprops.onAddition(exam.value)\n\t} else if (props.type == 'discussionactivity') {\n\t\tprops.onAddition(discussionactivity.value)\n\t} else {\n\t\tprops.onAddition(assignment.value)\n\t}\n\tshow.value = false\n}\n\nconst redirectToForm = () => {\n\tif (props.type == 'quiz') window.open('/seminary/quizzes/new', '_blank')\n\telse if (props.type == 'exam') window.open('/seminary/exams/new', '_blank')\n\telse if (props.type == 'discussionactivity') window.open('/seminary/discussion-activity/new', '_blank')\n\telse window.open('/seminary/assignments/new', '_blank')\n}\n</script>","import QuizBlock from '@/components/QuizBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { CircleHelp } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Quiz {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CircleHelp, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Quiz'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderQuiz(this.data.quiz)\n\t\t} else {\n\t\t\tthis.renderQuizModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderQuiz(quiz) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(QuizBlock, {\n\t\t\t\tquiz: quiz,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Quiz: ${quiz}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderQuizModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'quiz',\n\t\t\tonAddition: (quiz) => {\n\t\t\t\tthis.data.quiz = quiz\n\t\t\t\tthis.renderQuiz(quiz)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tquiz: this.data.quiz,\n\t\t}\n\t}\n}","<template>\n\t<div\n\t\tv-if=\"assignment.data\"\n\t\tclass=\"grid grid-cols-[65%,35%] h-full\"\n\t\t:class=\"{ 'border rounded-lg': !showTitle }\"\n\t>\n\t\t<div class=\"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t<div v-if=\"showTitle\" class=\"text-lg font-semibold mb-5 text-ink-gray-9\">\n\t\t\t\t<div v-if=\"submissionName === 'new'\">\n\t\t\t\t\t{{ __('Submission by') }} {{ user.data?.full_name }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('Submission by') }} {{ submissionResource.doc?.member_name }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"text-sm text-ink-gray-7 font-medium mb-2\">\n\t\t\t\t{{ __('Question') }}:\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-html=\"assignment.data.question\"\n\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal\"\n\t\t\t></div>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col\">\n\t\t\t<div class=\"p-5\">\n\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t<div class=\"font-semibold text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Submission') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t<Badge v-if=\"isDirty\" theme=\"orange\">\n\t\t\t\t\t\t\t{{ __('Not Saved') }} \n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tv-else-if=\"submissionResource.doc?.status\"\n\t\t\t\t\t\t\t:theme=\"statusTheme\"\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ submissionResource.doc?.status }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Button variant=\"solid\" @click=\"submitAssignment()\">\n\t\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"\n\t\t\t\t\t\tsubmissionName != 'new' &&\n\t\t\t\t\t\t!['Pass', 'Fail', 'Graded'].includes(submissionResource.doc?.status) &&\n\t\t\t\t\t\tsubmissionResource.doc?.owner == user.data?.name\n\t\t\t\t\t\"\n\t\t\t\t\tclass=\"bg-blue-200 p-3 rounded-md leading-5 text-sm mb-4\"\n\t\t\t\t>\n\t\t\t\t\t{{ __(\"You've successfully submitted the assignment.\") }}\n\t\t\t\t\t{{\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\"Once the moderator grades your submission, you'll find the details here.\"\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t\t{{ __('Feel free to make edits to your submission if needed, until it is graded.') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showUploader()\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t{{ __('Add your assignment as {0}').format(assignment.data.type) }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FileUploader\n\t\t\t\t\t\tv-if=\"!submissionFile\"\n\t\t\t\t\t\t:fileTypes=\"getType()\"\n\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t@success=\"(file) => saveSubmission(file)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t: __('Upload File')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FileUploader>\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<div class=\"flex text-ink-gray-7\">\n\t\t\t\t\t\t\t<div class=\"border self-start rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t:href=\"submissionFile.file_url\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\tclass=\"flex flex-col cursor-pointer !no-underline\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t{{ submissionFile.file_name }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-5 mt-1\">\n\t\t\t\t\t\t\t\t\t{{ getFileSize(submissionFile.file_size) }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<X\n\t\t\t\t\t\t\t\tv-if=\"canModifyAssignment\"\n\t\t\t\t\t\t\t\t@click=\"removeSubmission()\"\n\t\t\t\t\t\t\t\tclass=\"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"assignment.data.type == 'URL'\">\n\t\t\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t{{ __('Enter a URL') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"answer\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:readonly=\"!canModifyAssignment\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<div class=\"text-sm mb-4\">\n\t\t\t\t\t\t{{ __('Write your answer here') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t:content=\"answer\"\n\t\t\t\t\t\t@change=\"(val) => (answer = val)\"\n\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"\n\t\t\t\t\t\tuser.data?.name == submissionResource.doc?.owner &&\n\t\t\t\t\t\tsubmissionResource.doc?.comments\n\t\t\t\t\t\"\n\t\t\t\t\tclass=\"mt-8 p-3 bg-blue-200 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2\">\n\t\t\t\t\t\t{{ __('Comments by') }}: {{ submissionResource.doc?.evaluator || __('Evaluator') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"leading-5\">\n\t\t\t\t\t\t<div v-html=\"submissionResource.doc.comments\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Grading -->\n\t\t\t\t<div v-if=\"canGradeSubmission\" class=\"mt-8 space-y-4\">\n\t\t\t\t\t<div class=\"font-semibold mb-2 text-ink-gray-9\">\n\t\t\t\t\t\t{{ __('Grading') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-if=\"submissionResource.doc\"\n\t\t\t\t\t\tv-model=\"submissionResource.doc.status\"\n\t\t\t\t\t\t:label=\"__('Grading Status')\"\n\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t:options=\"submissionStatusOptions\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-if=\"submissionResource.doc\"\n\t\t\t\t\t\tv-model=\"submissionResource.doc.grade\"\n\t\t\t\t\t\t:label=\"__('Score')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t{{ __('Comments') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t\t:content=\"comments\"\n\t\t\t\t\t\t\t@change=\"\n\t\t\t\t\t\t\t\t(val) => {\n\t\t\t\t\t\t\t\t\tcomments = val\n\t\t\t\t\t\t\t\t\tisDirty = true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tcall,\n\tcreateResource,\n\tcreateDocumentResource,\n\tFileUploader,\n\tFormControl,\n\tTextEditor,\n\ttoast\n} from 'frappe-ui'\nimport { computed, inject, onMounted, onBeforeUnmount, ref, watch } from 'vue'\nimport { FileText, X } from 'lucide-vue-next'\nimport { getFileSize } from '@/utils'\nimport { useRouter } from 'vue-router'\n\nconst submissionFile = ref(null)\nconst answer = ref(null)\nconst comments = ref(null)\nconst router = useRouter()\nconst user = inject('$user')\nconst showTitle = router.currentRoute.value.name == 'AssignmentSubmission'\nconst isDirty = ref(false)\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tsubmissionName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n})\n\nonMounted(() => {\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tconsole.log('User: ', user.data)\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitAssignment()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst assignment = createResource({\n\turl: 'frappe.client.get',\n\tparams: {\n\t\tdoctype: 'Assignment Activity',\n\t\tname: props.assignmentID,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (props.submissionName != 'new') {\n\t\t\tsubmissionResource.reload()\n\t\t}\n\t},\n})\n\nconst newSubmission = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tlet doc = {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tassignment: props.assignmentID,\n\t\t\tmember: user.data?.name,\n\t\t\tcourse: router.currentRoute.value.params.courseName\n\t\t}\n\t\tif (showUploader()) {\n\t\t\tdoc.assignment_attachment = submissionFile.value.file_url\n\t\t} else {\n\t\t\tdoc.answer = answer.value\n\t\t}\n\t\treturn {\n\t\t\tdoc: doc,\n\t\t}\n\t},\n})\n\nconst imageResource = createResource({\n\turl: 'seminary.seminary.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tsubmissionFile.value = data\n\t},\n})\n\nconst submissionResource = createDocumentResource({\n\tdoctype: 'Assignment Submission',\n\tname: props.submissionName,\n\tonError(err) {\n\t\ttoast.error(err.messages?.[0] || err)\n\t},\n\tauto: false,\n\tcache: [user.data?.name, props.assignmentID],\n})\n\nwatch(submissionResource, () => {\n\tif (submissionResource.doc) {\n\t\tif (submissionResource.doc.assignment_attachment) {\n\t\t\timageResource.reload({\n\t\t\t\timage: submissionResource.doc.assignment_attachment,\n\t\t\t})\n\t\t}\n\t\tif (submissionResource.doc.answer) {\n\t\t\tanswer.value = submissionResource.doc.answer\n\t\t}\n\t\tif (submissionResource.doc.comments) {\n\t\t\tcomments.value = submissionResource.doc.comments\n\t\t}\n\t\tif (submissionResource.isDirty) {\n\t\t\tisDirty.value = true\n\t\t} else if (showUploader() && !submissionFile.value) {\n\t\t\tisDirty.value = true\n\t\t} else if (!showUploader() && !answer.value) {\n\t\t\tisDirty.value = true\n\t\t} else {\n\t\t\tisDirty.value = false\n\t\t}\n\t}\n})\n\nwatch(submissionFile, () => {\n\tif (props.submissionName == 'new' && submissionFile.value) {\n\t\tisDirty.value = true\n\t}\n})\n\nwatch(\n  () => submissionResource.doc?.grade,\n  (newGrade, oldGrade) => {\n    if (newGrade !== oldGrade && submissionResource.doc) {\n      submissionResource.doc.status = 'Graded'; // Automatically set status to \"Graded\"\n      isDirty.value = true; // Mark the form as dirty to indicate unsaved changes\n    }\n  }\n);\n\nconst submitAssignment = () => {\n\tif (props.submissionName != 'new') {\n\t\tlet evaluator =\n\t\t\tsubmissionResource.doc && submissionResource.doc.owner != user.data?.name\n\t\t\t\t? user.data?.name\n\t\t\t\t: null\n\n\t\tsubmissionResource.setValue.submit(\n\t\t\t{\n\t\t\t\t...submissionResource.doc,\n\t\t\t\tassignment_attachment: submissionFile.value?.file_url,\n\t\t\t\tevaluator: evaluator,\n\t\t\t\tcomments: comments.value,\n\t\t\t\tanswer: answer.value,\n\t\t\t\t\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(__('Changed successfully'))\n\t\t\t\t\tisDirty.value = false;\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t} else {\n\t\taddNewSubmission()\n\t}\n}\n\nconst addNewSubmission = () => {\n\tnewSubmission.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Assignment submitted successfully'))\n\t\t\t\tif (router.currentRoute.value.name == 'AssignmentSubmission') {\n\t\t\t\t\trouter.push({\n\t\t\t\t\t\tname: 'AssignmentSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tassignmentID: props.assignmentID,\n\t\t\t\t\t\t\tsubmissionName: data.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tmarkLessonProgress()\n\t\t\t\t\trouter.go()\n\t\t\t\t}\n\t\t\t\tsubmissionResource.name = data.name\n\t\t\t\tisDirty.value = false;\n\t\t\t\tsubmissionResource.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveSubmission = (file) => {\n\tisDirty.value = true\n\tsubmissionFile.value = file\n}\n\nconst markLessonProgress = () => {\n\tif (router.currentRoute.value.name == 'Lesson') {\n\t\tlet courseName = router.currentRoute.value.params.courseName\n\t\tlet chapterNumber = router.currentRoute.value.params.chapterNumber\n\t\tlet lessonNumber = router.currentRoute.value.params.lessonNumber\n\t\tconsole.log(\"Chapter Number: \", chapterNumber)\n\t\tconsole.log(\"Lesson Number: \", lessonNumber)\n\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: courseName,\n\t\t\tchapter_number: chapterNumber,\n\t\t\tlesson_number: lessonNumber,\n\t\t})\n\t}\n}\n\nconst getType = () => {\n\tconst type = assignment.data?.type\n\tif (type == 'Image') {\n\t\treturn ['image/*']\n\t} else if (type == 'Document') {\n\t\treturn [\n\t\t\t'.doc',\n\t\t\t'.docx',\n\t\t\t'.xml',\n\t\t\t'application/msword',\n\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t]\n\t} else if (type == 'PDF') {\n\t\treturn ['.pdf']\n\t}\n}\n\nconst validateFile = (file) => {\n\tlet type = assignment.data?.type\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (type == 'Image' && !['jpg', 'jpeg', 'png'].includes(extension)) {\n\t\treturn 'Only image file is allowed.'\n\t} else if (\n\t\ttype == 'Document' &&\n\t\t!['doc', 'docx', 'xml'].includes(extension)\n\t) {\n\t\treturn 'Only document file is allowed.'\n\t} else if (type == 'PDF' && !['pdf'].includes(extension)) {\n\t\treturn 'Only PDF file is allowed.'\n\t}\n}\n\nconst removeSubmission = () => {\n\tisDirty.value = true\n\tsubmissionFile.value = null\n}\n\nconst canGradeSubmission = computed(() => {\n\treturn (\n\t\t(user.data?.is_moderator ||\n\t\t\tuser.data?.is_evaluator ||\n\t\t\tuser.data?.is_instructor) &&\n\t\tprops.submissionName != 'new' &&\n\t\trouter.currentRoute.value.name == 'AssignmentSubmission'\n\t)\n})\n\nconst canModifyAssignment = computed(() => {\n\treturn (\n\t\t!submissionResource.doc ||\n\t\t(submissionResource.doc?.owner == user.data?.name &&\n\t\t\tsubmissionResource.doc?.status == 'Not Graded')\n\t)\n})\n\nconst submissionStatusOptions = computed(() => {\n\treturn [\n\t\t{ label: 'Not Graded', value: 'Not Graded' },\n\t\t{ label: 'Graded', value: 'Graded' },\n\t\t{ label: 'Pass', value: 'Pass' },\n\t\t{ label: 'Fail', value: 'Fail' },\n\t]\n})\n\nconst statusTheme = computed(() => {\n\tif (!submissionResource.doc) {\n\t\treturn 'orange'\n\t} else if (submissionResource.doc.status == 'Pass' || submissionResource.doc.status == 'Graded') {\n\t\treturn 'green'\n\t} else if (submissionResource.doc.status == 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n})\n\nconst showUploader = () => {\n\treturn ['PDF', 'Image', 'Document'].includes(assignment.data?.type)\n}\n</script>\n","<template>\n\t<Assignment\n\t\tv-if=\"user.data && submission.data\"\n\t\t:assignmentID=\"assignmentID\"\n\t\t:submissionName=\"submission.data?.name || 'new'\"\n\t/>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the assignment.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject, watch } from 'vue'\nimport { Button, createResource } from 'frappe-ui'\nimport Assignment from '@/components/Assignment.vue'\n\nconst user = inject('$user')\n\nconst props = defineProps({\n\tassignmentID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst submission = createResource({\n\turl: 'frappe.client.get_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Assignment Submission',\n\t\t\tfieldname: 'name',\n\t\t\tfilters: {\n\t\t\t\tassignment: props.assignmentID,\n\t\t\t\tmember: user.data?.name,\n\t\t\t},\n\t\t}\n\t},\n\tauto: true,\n})\n</script>\n","import { Pencil } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport AssignmentBlock from '@/components/AssignmentBlock.vue'\nimport translationPlugin from '../translation'\nimport { usersStore } from '@/stores/user'\nimport router from '../router'\n\nexport class Assignment {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(Pencil, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Assignment'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderAssignment(this.data.assignment)\n\t\t} else {\n\t\t\tthis.renderAssignmentModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderAssignment(assignment) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(AssignmentBlock, {\n\t\t\t\tassignmentID: assignment,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Assignment: ${assignment}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderAssignmentModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'assignment',\n\t\t\tonAddition: (assignment) => {\n\t\t\t\tthis.data.assignment = assignment\n\t\t\t\tthis.renderAssignment(assignment)\n\t\t\t},\n\t\t\t\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tassignment: this.data.assignment,\n\t\t}\n\t}\n}\n","<template>\n  <div v-if=\"submisisonDetails.loading\" class=\"text-center py-5\">\n    <p>Loading submission details...</p>\n  </div>\n  <div v-else-if=\"submisisonDetails.doc\" class=\"space-y-5\">\n    <div class=\"grid grid-cols-3 gap-3\">\n      <!-- Left Section (3/3 width) -->\n      <div class=\"col-span-3 space-y-4\">\n        <div class=\"space-y-4 border p-2 rounded-md\">\n          <div class=\"flex items-center justify-between py-4\">\n            <!-- Exam Percentage -->\n            <div class=\"text-center ml-5\">\n              <div class=\"text-3xl font-bold text-ink-gray-9\">\n                {{ submisisonDetails.doc.percentage || 0 }}%\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Score</div>\n            </div>\n\n            <!-- Score and Time Taken -->\n            <div class=\"text-center\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9\">\n                {{ submisisonDetails.doc.score }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">\n                Out of {{ submisisonDetails.doc.score_out_of }} Points\n              </div>\n            </div>\n            <div class=\"text-center mr-5\">\n              <div class=\"text-3xl font-semibold text-ink-gray-9 mt-2\">\n                {{ formatTime(submisisonDetails.doc.time_taken) }}\n              </div>\n              <div class=\"text-sm text-ink-gray-5\">Time taken</div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Questions Section -->\n        <div v-for=\"(row, index) in submisisonDetails.doc.result\" :key=\"index\" class=\"border p-5 rounded-md space-y-4 \">\n          <!-- Question Title -->\n          <div class=\"space-y-1\">\n            <div class=\"font-semibold text-ink-gray-9 text-left\">\n              {{ __('Question') }} {{ index + 1 }}:\n            </div>\n            <div class=\"leading-5 text-ink-gray-9 text-left\" v-html=\"row.question_name\"></div>\n          </div>\n          <!-- Answer -->\n          <div class=\"leading-5 text-ink-gray-7 space-x-1 text-left\">\n            <span> {{ __('Your Answer') }}: </span>\n            <span v-html=\"row.answer\"></span>\n          </div>\n          <!-- Points -->\n          <div class=\"flex justify-end items-center space-x-2\">\n            <span class=\"text-sm text-ink-gray-7 text-xl\">\n              {{ row.points }} / {{ parseInt(row.points_out_of, 10) }} {{ __('Points') }}\n            </span>\n          </div>\n          <!-- Comments -->\n          <div v-if=\"row.comments\" class=\"leading-5 text-ink-gray-7 text-xl space-x-1 text-left\">\n            <span> {{ __('Comments') }}: </span>\n            <span v-html=\"row.comments\"></span>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  </div>\n  <div v-else>\n    <p>Debug: No submission details found.</p>\n  </div>\n</template>\n\n<script setup>\nimport { createDocumentResource } from 'frappe-ui';\nimport { watch, inject } from 'vue';\n\n\n// const socket = inject('$socket')\n// if (socket) {\n\n//     console.log('ExamGraded socket :', socket); // Debugging log\n\n//   } else {\n//     console.log('ExamGraded socket is not available'); // Debugging log\n//   }\n\nconst props = defineProps({\n  submission: {\n    type: String,\n    required: true,\n  },\n});\n\nconsole.log('ExamGraded received submission:', props.submission); // Debugging log\n\nconst submisisonDetails = createDocumentResource({\n  doctype: 'Exam Submission',\n  name: props.submission,\n  auto: true,\n});\nconsole.log('ExamGraded submisisonDetails:', submisisonDetails); // Debugging log\n\nwatch(\n  () => submisisonDetails.doc,\n  (newDoc) => {\n    submisisonDetails.loading = false;\n    console.log('ExamGraded updated with new submission details:', newDoc); // Debugging log\n  }\n);\n\nconst formatTime = (seconds) => {\n  if (!seconds) return '00:00:00'; // Handle null or undefined values\n  const hrs = Math.floor(seconds / 3600).toString().padStart(2, '0');\n  const mins = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${hrs}:${mins}:${secs}`;\n};\n</script>","<template>\n\t<Tooltip :text=\"user.full_name\">\n\t\t<Avatar\n\t\t\tclass=\"avatar border border-outline-gray-2 cursor-auto\"\n\t\t\tv-if=\"user\"\n\t\t\t:label=\"user.full_name\"\n\t\t\t:image=\"user.user_image\"\n\t\t\t:size=\"size\"\n\t\t\tv-bind=\"$attrs\"\n\t\t/>\n\t</Tooltip>\n</template>\n<script setup>\nimport { Avatar, Tooltip } from 'frappe-ui'\nconst props = defineProps({\n\tuser: {\n\t\ttype: Object,\n\t\tdefault: null,\n\t},\n\tsize: {\n\t\ttype: String,\n\t},\n})\n</script>\n","<template>\n\t<div class=\"mt-6\">\n\t\t<div v-if=\"!singleThread\" class=\"flex items-center mb-5\">\n\t\t\t<Button variant=\"outline\" @click=\"showTopics = true\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ChevronLeft class=\"w-5 h-5 stroke-1.5 text-ink-gray-7\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<span class=\"text-lg font-semibold ml-2 text-ink-gray-9\">\n\t\t\t\t{{ topic.title }}\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div v-for=\"(reply, index) in replies.data\">\n\t\t\t<div class=\"py-3\" :class=\"{ 'border-b': index + 1 != replies.data.length }\">\n\t\t\t\t<div class=\"flex items-center justify-between mb-2\">\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<UserAvatar :user=\"reply.user\" class=\"mr-2\" />\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ reply.user.full_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-2\">\n\t\t\t\t\t\t\t{{ timeAgo(reply.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Dropdown v-if=\"\n\t\t\t\t\t\tuser.data.name == reply.owner && !reply.editable && !readOnlyMode\n\t\t\t\t\t\" :options=\"[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: __('Edit'),\n\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\treply.editable = true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: __('Delete'),\n\t\t\t\t\t\t\tonClick() {\n\t\t\t\t\t\t\t\tdeleteReply(reply)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t]\">\n\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t<MoreHorizontal class=\"w-4 h-4 stroke-1.5 cursor-pointer\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t\t<div v-if=\"reply.editable\">\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"postEdited(reply)\">\n\t\t\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button variant=\"ghost\" @click=\"reply.editable = false\">\n\t\t\t\t\t\t\t{{ __('Discard') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<TextEditor :content=\"reply.reply\" @change=\"(val) => (reply.reply = val)\"\n\t\t\t\t\t:editable=\"reply.editable || false\" :fixedMenu=\"reply.editable || false\" :editorClass=\"reply.editable\n\t\t\t\t\t\t? 'ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none'\n\t\t\t\t\t\t: 'prose-sm'\n\t\t\t\t\t\t\" />\n\t\t\t</div>\n\t\t</div>\n\n\t\t<TextEditor v-if=\"renderEditor && !readOnlyMode\" class=\"mt-5\" :content=\"newReply\" :mentions=\"mentionUsers\"\n\t\t\t@change=\"(val) => (newReply = val)\" placeholder=\"Type your reply here...\" :fixedMenu=\"true\"\n\t\t\teditorClass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none border border-outline-gray-2 rounded-b-md min-h-[7rem] py-1 px-2\" />\n\t\t<div v-if=\"!readOnlyMode\" class=\"flex justify-between mt-2\">\n\t\t\t<span> </span>\n\t\t\t<Button @click=\"postReply()\">\n\t\t\t\t<span>\n\t\t\t\t\t{{ __('Post') }}\n\t\t\t\t</span>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { createResource, TextEditor, Button, Dropdown, toast } from 'frappe-ui'\nimport { timeAgo } from '@/utils'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { ChevronLeft, MoreHorizontal } from 'lucide-vue-next'\nimport { ref, inject, onMounted, onUnmounted } from 'vue'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst showTopics = defineModel('showTopics')\nconst newReply = ref('')\nconst user = inject('$user')\nconst allUsers = inject('$allUsers')\nconst mentionUsers = ref([])\nconst renderEditor = ref(false)\nconst readOnlyMode = window.read_only_mode\n\nconst socketConnected = ref(false); // Track socket connection status\n\n// Initialize the socket directly\nconst socket = initSocket(); // Use the default namespace or specify one if needed\n\nif (!socket) {\n\tconsole.error('Socket connection not initialized in Discussions.vue.');\n} else {\n\tconsole.log('Socket connection initialized in Discussions.vue:', socket);\n\n\t// Add event listeners for debugging and connection tracking\n\tsocket.on('connect', () => {\n\t\tconsole.log('Socket connected:', socket.id);\n\t\tsocketConnected.value = true; // Mark socket as connected\n\t});\n\n\tsocket.on('connect_error', (error) => {\n\t\tconsole.error('Socket connection error:', error);\n\t});\n\n\tsocket.on('disconnect', (reason) => {\n\t\tconsole.warn('Socket disconnected:', reason);\n\t\tsocketConnected.value = false; // Mark socket as disconnected\n\t});\n}\n\nconst props = defineProps({\n\ttopic: {\n\t\ttype: Object,\n\t\trequired: true,\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n})\n\nonMounted(() => {\n\tsocket.on('publish_message', (data) => {\n\t\treplies.reload()\n\t})\n\tsocket.on('update_message', (data) => {\n\t\treplies.reload()\n\t})\n\tsocket.on('delete_message', (data) => {\n\t\treplies.reload()\n\t})\n\tfetchMentionUsers()\n})\n\nconst replies = createResource({\n\turl: 'seminary.seminary.utils.get_discussion_replies',\n\tcache: ['replies', props.topic],\n\tmakeParams(values) {\n\t\treturn {\n\t\t\ttopic: props.topic.name,\n\t\t}\n\t},\n\tauto: true,\n})\n\nconst newReplyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Reply',\n\t\t\t\treply: newReply.value,\n\t\t\t\ttopic: props.topic.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst fetchMentionUsers = () => {\n\tif (user.data?.is_student) {\n\t\trenderEditor.value = true\n\t} else {\n\t\tallUsers.reload(\n\t\t\t{},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tmentionUsers.value = Object.values(data).map((user) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tvalue: user.name,\n\t\t\t\t\t\t\tlabel: user.full_name,\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\trenderEditor.value = true\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t}\n}\n\nconst postReply = () => {\n\tnewReplyResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!newReply.value) {\n\t\t\t\t\treturn 'Reply cannot be empty'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\tnewReply.value = ''\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editReplyResource = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t\tfieldname: 'reply',\n\t\t\tvalue: values.reply,\n\t\t}\n\t},\n})\n\nconst postEdited = (reply) => {\n\teditReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t\treply: reply.reply,\n\t\t},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!reply.reply) {\n\t\t\t\t\treturn 'Reply cannot be empty'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\treply.editable = false\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst deleteReplyResource = createResource({\n\turl: 'frappe.client.delete',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Discussion Reply',\n\t\t\tname: values.name,\n\t\t}\n\t},\n})\n\nconst deleteReply = (reply) => {\n\tdeleteReplyResource.submit(\n\t\t{\n\t\t\tname: reply.name,\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\treplies.reload()\n\t\t\t},\n\t\t}\n\t)\n}\n\nonUnmounted(() => {\n\tsocket.off('publish_message')\n\tsocket.off('update_message')\n\tsocket.off('delete_message')\n})\n</script>","<template>\n\t<Dialog v-model=\"show\" :disableOutsideClickToClose=\"true\" :options=\"dialogOptions\">\n\t\t<template #body-content>\n\t\t\t<div class=\"discussion-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto\">\n\t\t\t\t<div>\n\t\t\t\t\t<FormControl v-model=\"topic.title\" :label=\"__('Title')\" type=\"text\" />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"mb-1.5 text-sm text-ink-gray-5\">\n\t\t\t\t\t\t{{ __('Details') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<TextEditor :content=\"topic.reply\" @change=\"(val) => (topic.reply = val)\" :editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FormControl, TextEditor, createResource, toast } from 'frappe-ui'\nimport { computed, reactive, watch } from 'vue'\nimport { singularize } from '@/utils'\n\nconst show = defineModel()\nconst topics = defineModel('reloadTopics')\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst topic = reactive({\n\ttitle: '',\n\treply: '',\n})\n\nconst resetTopic = () => {\n\ttopic.title = ''\n\ttopic.reply = ''\n}\n\nconst topicResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Topic',\n\t\t\t\treference_doctype: props.doctype,\n\t\t\t\treference_docname: props.docname,\n\t\t\t\ttitle: topic.title,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst replyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Reply',\n\t\t\t\ttopic: values.topic,\n\t\t\t\treply: topic.reply,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitTopic = (close) => {\n\ttopicResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!topic.title) {\n\t\t\t\t\treturn 'Title cannot be empty.'\n\t\t\t\t}\n\t\t\t\tif (!topic.reply) {\n\t\t\t\t\treturn 'Reply cannot be empty.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess(data) {\n\t\t\t\treplyResource.submit(\n\t\t\t\t\t{\n\t\t\t\t\t\ttopic: data.name,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\tshow.value = false\n\t\t\t\t\t\t\ttopics.value.reload()\n\t\t\t\t\t\t\tresetTopic()\n\t\t\t\t\t\t\tclose()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst handleCancel = (close) => {\n\tshow.value = false\n\tresetTopic()\n\tclose?.()\n}\n\nwatch(show, (value) => {\n\tif (!value) {\n\t\tresetTopic()\n\t}\n})\n\nconst dialogOptions = computed(() => ({\n\ttitle: singularize(props.title),\n\tsize: '2xl',\n\tactions: [\n\t\t{\n\t\t\tlabel: __('Post'),\n\t\t\tvariant: 'solid',\n\t\t\tonClick: (close) => submitTopic(close),\n\t\t},\n\t\t{\n\t\t\tlabel: __('Cancel'),\n\t\t\tvariant: 'text',\n\t\t\tonClick: (close) => handleCancel(close),\n\t\t},\n\t],\n}))\n</script>\n","export function scrollTo(...options) {\n\tif (!options || options.length === 0) return\n\tconst container = getScrollContainer()\n\tif (!container) return\n\tcontainer.scrollTo(...options)\n}\n\nexport function getScrollContainer() {\n\t// window.scrollContainer is reference to the scroll container in DesktopLayout.vue and MobileLayout.vue\n\treturn window.scrollContainer\n}\n","<template>\n\t<div>\n\t\t<Button v-if=\"!singleThread && props.type === 'multi'\" class=\"float-right\" @click=\"openTopicModal()\">\n\t\t\t{{ __('New {0}').format(singularize(title)) }}\n\t\t</Button>\n\t\t<div class=\"text-xl font-semibold text-ink-gray-9\">\n\t\t\t{{ __(title) }}\n\t\t</div>\n\t</div>\n\t<div v-if=\"loading && props.type === 'single'\">\n\t\t<div class=\"text-center py-10\">\n\t\t\t<span>Loading discussion...</span>\n\t\t</div>\n\t</div>\n\t<div v-if=\"props.type === 'single' && !loading\">\n\n\t\t<div class=\"flex flex-col items-center justify-center\">\n\n\t\t</div>\n\t\t<DiscussionModal v-model=\"showTopicModal\" :title=\"title\" :doctype=\"props.doctype\" :docname=\"props.docname\" />\n\t\t<DiscussionReplies v-if=\"currentTopic.value\" :topic=\"currentTopic.value\" :singleThread=\"true\"\n\t\t\tv-model:showTopics=\"showTopics\" />\n\t</div>\n\t<div v-if=\"topics.data?.length && !singleThread\">\n\t\t<div v-if=\"showTopics\" v-for=\"(topic, index) in topics.data\" :key=\"index\">\n\t\t\t<div @click=\"showReplies(topic)\" class=\"flex items-center cursor-pointer py-5 w-full\"\n\t\t\t\t:class=\"{ 'border-b': index + 1 != topics.data.length }\">\n\t\t\t\t<UserAvatar :user=\"topic.user\" size=\"2xl\" class=\"mr-4\" />\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"text-lg font-semibold mb-1 text-ink-gray-7\">\n\t\t\t\t\t\t{{ topic.title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center text-ink-gray-5\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ topic.user.full_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm ml-3\">\n\t\t\t\t\t\t\t{{ timeAgo(topic.creation) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else>\n\t\t\t<DiscussionReplies :topic=\"currentTopic\" v-model:showTopics=\"showTopics\" />\n\t\t</div>\n\t</div>\n\t<div v-else class=\"flex flex-col items-center justify-center border-2 border-dashed mt-5 py-8 rounded-md\">\n\t\t<MessageSquareText class=\"w-7 h-7 text-ink-gray-4 stroke-1.5 mr-2\" />\n\t\t<div class=\"\">\n\t\t\t<div v-if=\"emptyStateTitle\" class=\"font-medium mb-2\">\n\t\t\t\t{{ __(emptyStateTitle) }}\n\t\t\t</div>\n\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t{{ __(emptyStateText) }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<DiscussionModal v-model=\"showTopicModal\" :title=\"__('New {0}').format(title)\" :doctype=\"props.doctype\"\n\t\t:docname=\"props.docname\" v-model:reloadTopics=\"topics\" />\n</template>\n<script setup>\nconsole.log('Discussions.vue script setup executed'); // Debugging: Ensure script is running\n\nimport { createResource, Button } from 'frappe-ui'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { singularize, timeAgo } from '../utils'\nimport { ref, onMounted, inject, watch } from 'vue'\nimport DiscussionReplies from '@/components/DiscussionReplies.vue'\nimport DiscussionModal from '@/components/Modals/DiscussionModal.vue'\nimport { MessageSquareText } from 'lucide-vue-next'\nimport { getScrollContainer } from '@/utils/scrollContainer'\nimport { initSocket } from '@/socket'; // Import the socket initializer\n\nconst showTopics = ref(true)\nconst currentTopic = ref(null)\nconst user = inject('$user')\nconst showTopicModal = ref(false)\nconst loading = ref(true); // Add a loading state\nconst socketConnected = ref(false); // Track socket connection status\n\n// Initialize the socket directly\nconst socket = initSocket(); // Use the default namespace or specify one if needed\n\nif (!socket) {\n\tconsole.error('Socket connection not initialized in Discussions.vue.');\n} else {\n\tconsole.log('Socket connection initialized in Discussions.vue:', socket);\n\n\t// Add event listeners for debugging and connection tracking\n\tsocket.on('connect', () => {\n\t\tconsole.log('Socket connected:', socket.id);\n\t\tsocketConnected.value = true; // Mark socket as connected\n\t});\n\n\tsocket.on('connect_error', (error) => {\n\t\tconsole.error('Socket connection error:', error);\n\t});\n\n\tsocket.on('disconnect', (reason) => {\n\t\tconsole.warn('Socket disconnected:', reason);\n\t\tsocketConnected.value = false; // Mark socket as disconnected\n\t});\n}\n\nconst props = defineProps({\n\ttitle: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tdocname: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\temptyStateTitle: {\n\t\ttype: String,\n\t\tdefault: '',\n\t},\n\temptyStateText: {\n\t\ttype: String,\n\t\tdefault: 'Start a discussion',\n\t},\n\tsingleThread: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\tscrollToBottom: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\ttype: {\n\t\ttype: String,\n\t\tdefault: 'multi', // Default to multi-topic mode but can be single for assignment feedback\n\t},\n})\n\n// Watch for socket connection and execute onMounted logic once connected\nwatch(socketConnected, (isConnected) => {\n\tif (isConnected) {\n\t\tconsole.log('Socket is connected, proceeding with onMounted logic.');\n\t\texecuteOnMountedLogic();\n\t}\n});\n\nconst executeOnMountedLogic = () => {\n\tconsole.log('onMounted logic executed'); // Debugging: Ensure this is called\n\tconsole.log('Props:', props); // Debugging: Log props\n\n\tif (user.data) {\n\t\tif (props.type === 'single') {\n\t\t\tconsole.log('Single-topic mode detected'); // Debugging\n\t\t\tsingleTopicResource.reload(); // Trigger the resource to fetch the single topic\n\t\t\tconsole.log('Topic', currentTopic.value)\n\t\t} else {\n\t\t\tloading.value = false; // Immediately stop loading for multi-topic mode\n\t\t}\n\t\ttopics.reload();\n\t}\n\n\tsocket.on('new_discussion_topic', (data) => {\n\t\ttopics.refresh();\n\t});\n\n\tif (props.scrollToBottom) {\n\t\tsetTimeout(() => {\n\t\t\tscrollToEnd();\n\t\t}, 100);\n\t}\n};\n\nconst scrollToEnd = () => {\n\tlet scrollContainer = getScrollContainer()\n\tscrollContainer.scrollTop = scrollContainer.scrollHeight\n}\n\nconst singleTopicResource = createResource({\n\turl: 'seminary.seminary.utils.ensure_single_topic',\n\tcache: false, // No need to cache this since it's a one-time call\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: props.doctype,\n\t\t\tdocname: props.docname,\n\t\t\ttitle: props.title,\n\t\t};\n\t},\n\tonSuccess(data) {\n\t\tconsole.log('Ensure single topic response:', data); // Debugging\n\t\tif (data) {\n\t\t\tcurrentTopic.value = data; // Set the single topic as the current topic\n\t\t\tconsole.log('Current topic set:', currentTopic.value); // Debugging\n\t\t\tshowTopics.value = false; // Automatically show replies for the single topic\n\t\t\tloading.value = false; // Mark loading as complete\n\t\t}\n\t\tconsole.log('Changed loading to:', loading.value); // Debugging\n\t},\n\tonError(error) {\n\t\tconsole.error('Error ensuring single topic:', error); // Log the error\n\t\tloading.value = false; // Ensure loading is stopped even on error\n\t},\n});\n\n\nconst topics = createResource({\n\turl: 'seminary.seminary.utils.get_discussion_topics',\n\tcache: ['topics', props.doctype, props.docname],\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: props.doctype,\n\t\t\tdocname: props.docname,\n\t\t\tsingle_thread: props.singleThread,\n\t\t}\n\t},\n})\n\nconst showReplies = (topic) => {\n\tshowTopics.value = false\n\tcurrentTopic.value = topic\n}\n\nconst openTopicModal = () => {\n\tshowTopicModal.value = true\n}\n</script>\n","<template>\n  <div v-if=\"isExamLoaded\">\n    <!-- Exam Header -->\n    <div  v-if=\"!hasSubmittedExam\" class=\"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900\">\n      <div class=\"leading-5\">\n        {{ `This exam consists of ${exam.data.questions.length}` }}\n        {{ exam.data.questions.length === 1 ? 'question' : 'questions' }}.\n      </div>\n      <div v-if=\"exam.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t`Please ensure that you complete all the questions in ${exam.data.duration} minutes.`\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div v-if=\"exam.data?.duration\" class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t(\n\t\t\t\t\t\t'If you fail to do so, the exam will be automatically submitted when the timer ends.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n    </div>\n    \t      \n        <div v-if=\"hasSubmittedExam && (submission_anystatus?.data || attempts.data?.[0])\" class=\"space-y-4 border p-5 rounded-md\">\n          <Discussions\n            :title=\"'Exam Comments'\"\n            :doctype=\"'Exam Submission'\"\n            :docname=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\"\n            :key=\"submission_anystatus?.data?.name || attempts.data?.[0]?.name\"\n            type=\"single\"\n          />\n        </div>\n      \n    <div v-if=\"exam.data.duration && !hasSubmittedExam\" class=\"flex flex-col space-x-1 my-4\">\n\t\t\t<div class=\"mb-2\">\n\t\t\t\t<span class=\"\"> {{ ('Time') }}: </span>\n\t\t\t\t<span class=\"font-semibold\">\n\t\t\t\t\t{{ formatTimer(timer) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ProgressBar :progress=\"timerProgress\" />\n\t\t</div>\n  \t\t<!-- Start Screen -->\n<div v-if=\"!fullExamMode && !is_instructor()\">\n  <div class=\"border text-center p-20 rounded-md\">\n    <div class=\"font-semibold text-lg\">\n      {{ exam.data.title }}\n    </div>\n    <Button\n      v-if=\"exam.data.qbyquestion && !hasSubmittedExam\"\n      @click=\"startExam\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start') }}</span>\n    </Button>\n    <Button\n      v-else-if=\"!hasSubmittedExam\"\n      @click=\"startExam2\"\n      class=\"mt-2\"\n    >\n      <span>{{ ('Start Exam') }}</span>\n    </Button>\n    <div v-else-if=\"hasSubmittedExam && submission?.data?.name\" class=\"w-full max-w-4xl mx-auto py-5\">\n      <ExamGraded :submission=\"submission.data.name\" />\n    </div>\n    <div v-else >\n      {{ 'You have already submitted this exam. As soon as it is graded, you will see the feedback here.' }}\n    </div>\n  </div>\n</div>\n\n    <!-- Full Exam Mode -->\n    <div v-if=\"fullExamMode || is_instructor()\">\n      <div class=\"border text-center p-20 rounded-md\">\n  <div class=\"font-semibold text-lg text-ink-gray-9 mt-3 mb-3\">\n    {{ exam.data.title }}\n  </div>\n  <router-link\n    v-if=\"is_instructor()\"\n    :to=\"{\n      name: 'ExamForm',\n      params: {\n        examID: exam.data.name,\n      },\n    }\"\n    class=\"flex items-center text-gray-400 mb-3 mr-4 hover:text-gray-600\"\n  >\n    <SquarePen class=\"w-5 h-5 mr-2\" />\n    <span class=\"tooltip\" data-tooltip=\"Edit this exam\">Edit</span>\n  </router-link>\n  \n      <div v-for=\"(question, index) in exam.data.questions\" :key=\"question.name\" class=\"relative border rounded-md p-5 mb-4\">\n        <div class=\"absolute -top-3 -left-3 bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm\">\n            {{ index + 1 }}\n        </div>\n        \n            \n          <div class=\"text-ink-gray-9 text-sm font-semibold text-right\">\n            {{ question.points }} {{ question.points === 1 ? 'Point' : 'Points' }}\n          </div>\n        \n        <div class=\"text-ink-gray-9 text-left font-semibold mt-2 leading-5\">\n          <div v-html=\"question.question_detail || 'No question detail provided.'\"></div>\n        </div>\n        <div class=\"mt-4\">\n          <textarea\n            v-if=\"answers && answers[question.name] !== undefined\"\n            v-model=\"answers[question.name]\"\n            rows=\"7\"\n            class=\"border rounded-md p-2 w-full resize-y\"\n            placeholder=\"Type your answer here\"\n            @input=\"(event) => updateAnswer(question.name, event.target.value)\"\n          />\n        </div>\n      </div>\n      <div class=\"text-center mt-4\">\n        <Button @click=\"submitExam\">\n          <span>{{ 'Submit Your Exam' }}</span>\n        </Button>\n      </div>\n    </div>\n  </div>\n  </div>\n</template>\n\n<script setup>\nimport { Button, call, createResource, toast } from 'frappe-ui'\nimport { ref, watch, inject, computed, toRaw, onMounted, onBeforeUnmount } from 'vue'\nimport { CheckCircle, XCircle, MinusCircle, SquarePen } from 'lucide-vue-next'\nimport { timeAgo } from '@/utils'\nimport { useRouter } from 'vue-router'\nimport ProgressBar from '@/components/ProgressBar.vue'\nimport ExamGraded from '@/components/ExamGraded.vue'\nimport Discussions from '@/components/Discussions.vue'\nconst user = inject('$user')\nconst timer = ref(0);\nlet timerInterval = null;\nconst elapsedTime = ref(0);\nconst answer = ref('');\nconst answers = ref({}); // Use ref instead of reactive\nconst questions = ref([]);\nconst fullExamMode = ref(false); // Always in full exam mode\nconst router = useRouter()\nlet user_is_instructor = false\n\nconst ensureAnswersInitialized = (questionsList = []) => {\n  const existingAnswers = { ...answers.value };\n  const initialized = {};\n\n  questionsList.forEach((question) => {\n    const current = existingAnswers[question.name];\n    initialized[question.name] = typeof current === 'string' ? current : '';\n  });\n\n  answers.value = initialized;\n};\n// const socket = inject('$socket')\n\n// if (!socket) {\n//   console.error('Socket connection not found in Exam.vue. Ensure $socket is provided.');\n// } else {\n//   console.log('Socket connection established in Exam.vue:', socket);\n\n//   socket.on('new_discussion_topic', (data) => {\n//     console.log('New discussion topic received:', data);\n//   });\n// }\n// Props\nconst props = defineProps({\nexamName: {\n  type: String,\n  required: true,\n},\n\n});\nconsole.log('Exam Name (PROPS):', props.examName); // Debugging log\n\n// Exam resource\nconst exam = createResource({\nurl: 'frappe.client.get',\nmakeParams(values) {\n  return {\n    doctype: 'Exam Activity',\n    name: props.examName,\n  };\n},\ncache: ['exam', props.examName],\nauto: true,\ntransform(data) {\n  if (!data) {\n    console.error('Exam data is null or undefined.');\n    return null;\n  }\n  data.duration = parseInt(data.duration) || 0;\n  return data;\n},\nonSuccess(data) {\n      if (data) {\n        // console.log('Loaded exam data:', data); // Debugging\n        // console.log('Exam Name:', exam.data?.name); // Debugging log\n        // console.log('User Name:', user.data?.name); // Debugging log\n        data.questions = data.questions || []; // Ensure questions is always an array\n        ensureAnswersInitialized(data.questions);\n        \n          // populateQuestions();\n          // setupTimer();\n      } else {\n          console.error(\"Failed to load exam data.\"); // Debugging\n      }\n  },\n  onError(err) {\n      console.error(\"Error loading exam data:\", err); // Debugging\n  },\n});\n\n// Check if exam data is loaded\nconst isExamLoaded = computed(() => {\n// console.log('Exam data on isExamLoaded:', exam.data); // Debugging\nreturn !!exam.data;\n});\n\nconst hasSubmittedExam = computed(() => {\n  return attempts.data?.length > 0;\n});\n\nconst instructors = createResource({\n  url: 'seminary.seminary.utils.get_instructors',\n  makeParams(values) {\n    const courseName = router.currentRoute.value.params.courseName;\n    if (!courseName) {\n      console.error('Course name is undefined in route parameters.');\n      return {};\n    }\n    return {\n      course: courseName,\n    };\n  },\n  auto: true,\n});\n\nwatch(\n  () => instructors.data,\n  (list) => {\n    if (!Array.isArray(list)) {\n      return;\n    }\n    const wasInstructor = user_is_instructor;\n    user_is_instructor = list.some((instructor) => instructor.user === user.data?.name);\n    if (!wasInstructor && user_is_instructor && exam.data?.questions?.length) {\n      ensureAnswersInitialized(exam.data.questions);\n    }\n  },\n);\n\nconst is_instructor = () => {\n // console.log('Fetching instructors of course:', router.currentRoute.value.params.courseName); // Debugging\n  if (instructors.data) {\n    instructors.data.forEach((instructor) => {\n      if (instructor.user === user.data?.name) {\n        user_is_instructor = true;\n      }\n    });\n  }\n  return user_is_instructor;\n};\n\n// // Populate questions (shuffle and limit)\n// const populateQuestions = () => {\n//   if (!exam.data || !exam.data.questions) {\n//     console.warn('No questions found in exam data.'); // Debugging\n//     return;\n//   }\n\n//   const data = exam.data;\n//   if (data.shuffle_questions) {\n//         // Shuffle the questions\n//         const shuffledQuestions = shuffleArray([...data.questions]); // Use a copy of the array\n//         // Limit the number of questions if required\n//         questions.value = data.limit_questions_to\n//             ? shuffledQuestions.slice(0, data.limit_questions_to)\n//             : shuffledQuestions;\n//     } else {\n//         // Use the original questions if no shuffle is required\n//         questions.value = data.questions;\n//     }\n  \n// \tconsole.log(\"Populated questions:\", questions)\n// };\n\n// Timer setup\nlet timerStartTime = null; // Store the start time\nconst startTimer = () => {\n  if (exam.data.duration) {\n    // If duration is set, initialize the timer with the duration\n    timer.value = exam.data.duration * 60; // Total duration in seconds\n    timerStartTime = Date.now(); // Record the start time\n    const endTime = timerStartTime + timer.value * 1000; // Calculate the end time\n\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      const remainingTime = Math.max(0, Math.floor((endTime - currentTime) / 1000)); // Calculate remaining time\n\n      timer.value = remainingTime; // Update the timer value\n      elapsedTime.value = exam.data.duration * 60 - remainingTime; // Calculate elapsed time\n\n      if (remainingTime <= 0) {\n        clearInterval(timerInterval);\n        submitExam(); // Automatically submit the exam when the timer ends\n      }\n    }, 1000);\n  } else {\n    // If duration is null, track elapsed time only\n    timerStartTime = Date.now(); // Record the start time\n    timerInterval = setInterval(() => {\n      const currentTime = Date.now();\n      elapsedTime.value = Math.floor((currentTime - timerStartTime) / 1000); // Calculate elapsed time in seconds\n    }, 1000);\n  }\n};\n\n// Format timer\nconst formatTimer = (seconds) => {\n  const mins = Math.floor(seconds / 60).toString().padStart(2, '0');\n  const secs = (seconds % 60).toString().padStart(2, '0');\n  return `${mins}:${secs}`;\n};\n\n// Timer progress\nconst timerProgress = computed(() => {\n  return (timer.value / (exam.data.duration * 60)) * 100;\n});\n\n// Shuffle array utility\nconst shuffleArray = (array) => {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n  return array;\n};\n\nwatch(answers, (newAnswers) => {\n//console.log('Answers updated:', newAnswers);\n}, { deep: true });\n\nconst get_answers = () => {\n\nconst rawAnswers = toRaw(answers.value); // Extract plain data from the reactive object\nreturn Object.entries(rawAnswers).map(([questionName, answer]) => ({\n  question: questionName,\n  answer: answer,\n}));\n};\n\nconst updateAnswer = (questionName, value) => {\n  answers.value[questionName] = value;\n};\n\nconst attempts = createResource({\n  url: 'frappe.client.get_list',\n  makeParams(values) {\n    return {\n      doctype: 'Exam Submission',\n      filters: {\n        member: user.data?.name,\n        exam: props.examName,\n      },\n      fields: ['name', 'creation'],\n      order_by: 'creation desc',\n    };\n  },\n  auto: true,\n  transform(data) {\n   \n    //console.log('Fetched attempts:', data); // Debugging log\n    data.forEach((submission, index) => {\n      submission.creation = timeAgo(submission.creation);\n      submission.idx = index + 1;\n    });\n  },\n});\n\nwatch(\n  () => attempts.data,\n  (newData) => {\n    console.log('Attempts data updated:', newData); // Debugging log\n  }\n);\n\n// Submit exam\nconst submitExam = async () => {\ntry {\n  const submittedAnswers = get_answers();\n  //console.log('Submitting exam with answers:', submittedAnswers);\n  //console.log(\"Course Name:\", router.currentRoute.value.params.courseName);\n  const timeTaken = exam.data.duration\n            ? exam.data.duration * 60 - (timer.value || 0) // Use timer when duration is set\n            : elapsedTime.value || 0; // Use elapsedTime when duration is not set\n\n  //  API call\n  await call('seminary.seminary.doctype.exam_submission.exam_submission.create_exam_submission', {\n    exam: props.examName,\n    course: router.currentRoute.value.params.courseName,\n    member: user.data?.name,\n    answers: submittedAnswers,\n    time_taken: timeTaken,\n  });\n\n  toast.success(__('Your exam was submitted successfully.')) ;\n  clearInterval(timerInterval);\n} catch (error) {\n  console.error('Error during exam submission:', error);\n  toast.error(err.messages?.[0] || err)\n}\n};\n\nconst startExam = () => {\n\tactiveQuestion.value = 1\n\tlocalStorage.removeItem(exam.data.title)\n\tstartTimer()\n  ensureAnswersInitialized(exam.data?.questions || []);\n}\n\nconst startExam2 = () => {\n    localStorage.removeItem(exam.data.title);\n    fullExamMode.value = true; // Set full exam mode flag\n    startTimer();\n    ensureAnswersInitialized(exam.data?.questions || []);\n    // all_questions_details.reload(); // Ensure the resource is reloaded\n    \n}\n\nconst submission = createResource({\n\turl: 'frappe.client.get_value',\n\tparams: {\n\t\tdoctype: 'Exam Submission',\n\t\tfieldname: 'name',\n\t\tfilters: {\n\t\t\texam: props.examName,\n\t\t\tmember: user.data?.name,\n\t\t\tstatus: 'Graded',\n\t\t},\n\t},\n\tauto: false, // Disable auto-fetch\n\ttransform(data) {\n\t\tconsole.log('Fetched submission data:', data); // Debugging log\n\t\treturn data;\n\t},\n\tonError(err) {\n\t\tconsole.error('Error fetching submission:', err); // Debugging log\n\t},\n});\n\n\nconst submission_anystatus = createResource({\n\turl: 'frappe.client.get_value',\n\tparams: {\n\t\tdoctype: 'Exam Submission',\n\t\tfieldname: 'name',\n\t\tfilters: {\n\t\t\texam: props.examName,\n\t\t\tmember: user.data?.name,\n\t\t},\n\t},\n\tauto: false, // Disable auto-fetch\n\ttransform(data) {\n\t\tconsole.log('Fetched submission AnyStatus:', data.name); // Debugging log\n\t\treturn data;\n\t},\n\tonError(err) {\n\t\tconsole.error('Error fetching submission:', err); // Debugging log\n\t},\n});\n\n\nonMounted(() => {\n\n\t// Load submission resources on mount\n\tsubmission.reload();\n\tsubmission_anystatus.reload();\n});\n\nonBeforeUnmount(() => {\n  if (timerInterval) {\n    clearInterval(timerInterval);\n  }\n});\n\t\n</script>\n\n<style>\n/* Tooltip styling */\n.tooltip {\n  position: relative;\n  cursor: pointer;\n}\n\n.tooltip::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background-color: #333;\n  color: #fff;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 0.75rem;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity 0.2s ease-in-out;\n}\n\n.tooltip:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n</style>","<template>\n\t<Exam v-if=\"user.data\" :examName=\"exam\" ></Exam>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the exam.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button } from 'frappe-ui'\nimport Exam from '@/components/Exam.vue'\n\nconst user = inject('$user')\n\n\nconst props = defineProps({\n\texam: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\t\n})\n\n\nconst redirectToLogin = () => {\n\twindow.location.href = `/login`\n}\n</script>\n","import ExamBlock from '@/components/ExamBlock.vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport { createApp, h } from 'vue'\nimport { usersStore } from '../stores/user'\nimport translationPlugin from '../translation'\nimport { BookOpenCheck } from 'lucide-vue-next'\nimport router from '@/router'\n\nexport class Exam {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(BookOpenCheck, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Exam'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tif (Object.keys(this.data).length) {\n\t\t\tthis.renderExam(this.data.exam)\n\t\t} else {\n\t\t\tthis.renderExamModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderExam(exam) {\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(ExamBlock, {\n\t\t\t\texam: exam,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Exam: ${exam}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderExamModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'exam',\n\t\t\tonAddition: (exam) => {\n\t\t\t\tthis.data.exam = exam\n\t\t\t\tthis.renderExam(exam)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router); // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\texam: this.data.exam,\n\t\t}\n\t}\n}","<template v-if=\"discussionReady\">\n\t<div v-if=\"discussion.data\" class=\"grid grid-cols-[65%,35%] h-full\" :class=\"{ 'border rounded-lg': !showTitle }\">\n\t\t<div class=\"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t<div v-if=\"showTitle\" class=\"text-lg font-semibold mb-5 text-ink-gray-9\">\n\t\t\t\t<div v-if=\"submissionName === 'new'\">\n\t\t\t\t\t{{ __('Submission by') }} {{ user.data?.full_name }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t{{ __('Submission by') }} {{ submissionResource.doc?.member_name }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"text-lg text-ink-gray-7 font-medium mb-2\">\n\t\t\t\t{{ __('Discussion Prompt') }}:\n\t\t\t</div>\n\t\t\t<div v-html=\"discussion.data.prompt\"\n\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal\"\n\t\t\t\t</div>\n\n\t\t\t\t<div v-if=\"\n\t\t\t\t\tall_discussions.data && (hasSavedSubmission || (!hasSavedSubmission && !post_before) || !isStudent)\n\t\t\t\t\" class=\"flex-1 border-l p-5 overflow-y-auto h-[calc(100vh-3.2rem)]\">\n\t\t\t\t\t<div v-if=\"!isStudent\" class=\"mb-4 mt-4\">\n\t\t\t\t\t\t<label for=\"groupFilter\" class=\"block text-sm font-medium text-gray-700\">\n\t\t\t\t\t\t\t{{ __('Filter by Group') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<select id=\"groupFilter\" v-model=\"selectedGroupFilter\"\n\t\t\t\t\t\t\tclass=\"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\">\n\t\t\t\t\t\t\t<option value=\"all\">{{ __('All Groups') }}</option>\n\t\t\t\t\t\t\t<option v-for=\"group in studentGroups\" :key=\"group.student_group\"\n\t\t\t\t\t\t\t\t:value=\"group.student_group\">\n\t\t\t\t\t\t\t\t{{ group.student_group || 'No group' }}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<div v-for=\"discussion in filteredDiscussions\" :key=\"discussion.name\"\n\t\t\t\t\t\tclass=\"mb-6 border-round border-gray-300 p-4 bg-surface-white shadow-sm\">\n\t\t\t\t\t\t<div class=\"original-post mb-4\">\n\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ discussion.student_name }}</div>\n\t\t\t\t\t\t\t<div v-html=\"discussion.original_post\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ formatDate(discussion.creation) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a v-if=\"discussion.original_attachment\" :href=\"discussion.original_attachment\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\" class=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"replies pl-4 border-l border-gray-300\">\n\t\t\t\t\t\t\t<div v-for=\"reply in discussion.replies\" :key=\"reply.creation\" class=\"mb-2\">\n\t\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ reply.member_name || reply.owner }}</div>\n\t\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t\t{{ formatDate(reply.reply_dt) }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-html=\"reply.reply\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t\t<a v-if=\"reply.reply_attach\" :href=\"reply.reply_attach\" target=\"_blank\"\n\t\t\t\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"new-reply mt-4 space-y-2\">\n\t\t\t\t\t\t\t<textarea v-model=\"discussion.new_reply\" :placeholder=\"__('Write a reply...')\"\n\t\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t\t<FileUploader v-if=\"!replyFiles[discussion.name]\" :fileTypes=\"getType()\"\n\t\t\t\t\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t\t\t@success=\"(file) => saveReplyAttachment(discussion.name, file)\">\n\t\t\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\" variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: __('Attach File')\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t\t\t<div v-else class=\"flex items-center space-x-2 text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"border rounded-md p-2\">\n\t\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col leading-5\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm\">{{ replyFiles[discussion.name].file_name }}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(replyFiles[discussion.name].file_size) }}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Button variant=\"subtle\" size=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t@click=\"removeReplyAttachment(discussion.name)\">\n\t\t\t\t\t\t\t\t\t\t\t{{ __('Remove') }}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Button variant=\"solid\" :disabled=\"!canSubmitReply(discussion)\"\n\t\t\t\t\t\t\t\t\t@click=\"handleReplySubmit(discussion)\">\n\t\t\t\t\t\t\t\t\t{{ __('Post Reply') }}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"!hasSavedSubmission && post_before && isStudent\" class=\"text-ink-gray-5 mt-5\">\n\t\t\t\t\t{{ __('You have to make your original post before seeing other posts.') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"text-ink-gray-5 mt-5\">\n\t\t\t\t\t{{ __('No discussions available yet.') }}\n\t\t\t\t\t{{ 'All discussions', all_discussions.data }}\n\t\t\t\t\t{{ 'hasSavedSubmission', hasSavedSubmission }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"canGradeSubmission\" class=\"mt-8 space-y-4\">\n\t\t\t\t<div class=\"font-semibold mb-2 text-ink-gray-9\">\n\t\t\t\t\t{{ __('Grading') }}\n\t\t\t\t</div>\n\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.status\"\n\t\t\t\t\t:label=\"__('Grading Status')\" type=\"select\" :options=\"submissionStatusOptions\" />\n\t\t\t\t<FormControl v-if=\"submissionResource.doc\" v-model=\"submissionResource.doc.grade\" :label=\"__('Score')\"\n\t\t\t\t\ttype=\"number\" />\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t{{ __('Comments') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<textarea v-model=\"comments\" @input=\"isDirty = true\"\n\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"!hasSavedSubmission\" class=\"text-md mb-4\">\n\t\t\t\t<div class=\"flex flex-col\">\n\n\t\t\t\t\t<div class=\"p-5\">\n\t\t\t\t\t\t<div class=\"flex items-center justify-between mb-4\">\n\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<Badge v-if=\"isDirty\" theme=\"orange\">\n\t\t\t\t\t\t\t\t\t{{ __('Not Saved') }}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t<Badge v-else-if=\"submissionResource.doc?.status\" :theme=\"statusTheme\" size=\"lg\">\n\t\t\t\t\t\t\t\t\t{{ submissionResource.doc?.status }}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t<Button variant=\"solid\" @click=\"submitDiscussion()\">\n\t\t\t\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div v-if=\"!hasSavedSubmission\" class=\"text-md mb-4\">\n\t\t\t\t\t\t\t{{ __('Write your main post here') }}\n\t\t\t\t\t\t\t<textarea v-model=\"original_post\" @input=\"isDirty = true\"\n\t\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none\"></textarea>\n\n\t\t\t\t\t\t\t<div class=\"text-md text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ __('You may also add an attachment') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<FileUploader v-if=\"!submissionFile\" :fileTypes=\"getType()\" :validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t@success=\"(file) => saveSubmission(file)\">\n\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t: __('Upload File')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t<div class=\"flex text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t<div class=\"border self-start rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<a :href=\"submissionFile.file_url\" target=\"_blank\"\n\t\t\t\t\t\t\t\t\t\tclass=\"flex flex-col cursor-pointer !no-underline\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t\t\t{{ submissionFile.file_name }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-5 mt-1\">\n\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(submissionFile.file_size) }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t<X v-if=\"canModifyDiscussion\" @click=\"removeSubmission()\"\n\t\t\t\t\t\t\t\t\t\tclass=\"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"text-md mb-4 ml-2\">\n\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2 mt-4\">\n\t\t\t\t\t{{ __('Your submission has been saved:') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-for=\"submission in savedsubmission.data\" :key=\"submission.name || submission.creation\">\n\t\t\t\t\t<div class=\"font-semibold mb-1\">\n\t\t\t\t\t\t{{ formatDate(submission.creation) }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>{{ submission.original_post }}</div>\n\t\t\t\t\t<a v-if=\"submission.original_attachment\" :href=\"submission.original_attachment\" target=\"_blank\"\n\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t</a>\n\t\t\t\t\t<div class=\"replies pl-4 border-l border-gray-300\">\n\t\t\t\t\t\t<div v-for=\"reply in submission.replies\" :key=\"reply.creation\" class=\"mb-2\">\n\t\t\t\t\t\t\t<div class=\"font-semibold\">{{ reply.member_name || reply.owner }}</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 mt-1 mb-2\">\n\t\t\t\t\t\t\t\t{{ formatDate(reply.reply_dt) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-html=\"reply.reply\" class=\"text-sm\"></div>\n\t\t\t\t\t\t\t<a v-if=\"reply.reply_attach\" :href=\"reply.reply_attach\" target=\"_blank\"\n\t\t\t\t\t\t\t\tclass=\"text-blue-500 underline\">\n\t\t\t\t\t\t\t\t{{ __('View Attachment') }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"new-reply mt-4 space-y-2\">\n\t\t\t\t\t\t<textarea v-model=\"submission.new_reply\" :placeholder=\"__('Write a reply...')\"\n\t\t\t\t\t\t\tclass=\"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none\"></textarea>\n\t\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-3\">\n\t\t\t\t\t\t\t\t<FileUploader v-if=\"!replyFiles[submission.name]\" :fileTypes=\"getType()\"\n\t\t\t\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t\t\t\t@success=\"(file) => saveReplyAttachment(submission.name, file)\">\n\t\t\t\t\t\t\t\t\t<template #default=\"{ uploading, progress, openFileSelector }\">\n\t\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\" variant=\"outline\">\n\t\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: __('Attach File')\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t\t\t<div v-else class=\"flex items-center space-x-2 text-ink-gray-7\">\n\t\t\t\t\t\t\t\t\t<div class=\"border rounded-md p-2\">\n\t\t\t\t\t\t\t\t\t\t<FileText class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col leading-5\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm\">{{ replyFiles[submission.name].file_name }}</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t\t{{ getFileSize(replyFiles[submission.name].file_size) }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Button variant=\"subtle\" size=\"sm\" @click=\"removeReplyAttachment(submission.name)\">\n\t\t\t\t\t\t\t\t\t\t{{ __('Remove') }}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button variant=\"solid\" :disabled=\"!canSubmitReply(submission)\"\n\t\t\t\t\t\t\t\t@click=\"handleReplySubmit(submission)\">\n\t\t\t\t\t\t\t\t{{ __('Post Reply') }}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div v-if=\"\n\t\t\t\tuser.data?.name == submissionResource.doc?.owner &&\n\t\t\t\tsubmissionResource.doc?.comments\n\t\t\t\" class=\"mt-8 p-3 bg-blue-200 rounded-md\">\n\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-medium mb-2\">\n\t\t\t\t\t{{ __('Comments by') }}: {{ submissionResource.doc?.evaluator || __('Evaluator') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"leading-5\">\n\t\t\t\t\t<div v-html=\"submissionResource.doc.comments\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t</div>\n\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tcall,\n\tcreateResource,\n\tcreateDocumentResource,\n\tFileUploader,\n\tFormControl,\n\ttoast\n} from 'frappe-ui'\nimport { computed, inject, onMounted, onBeforeUnmount, ref, watch, toRaw } from 'vue'\nimport dayjsModule from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport { FileText, X } from 'lucide-vue-next'\nimport { getFileSize } from '@/utils'\nimport { useRouter } from 'vue-router'\n\n\n\nconst dayjs = typeof dayjsModule === 'function' ? dayjsModule : dayjsModule.default\ndayjs.extend(relativeTime)\n\nconst submissionFile = ref(null)\nconst original_post = ref('')\nconst comments = ref('')\nconst router = useRouter()\nconst user = inject('$user')\nconst showTitle = router.currentRoute.value.name == 'DiscussionActivitySubmission'\nconst isDirty = ref(false)\nconst replyFiles = ref({})\nconst isStudent = computed(() => user.data?.is_student || false)\nconst studentGroups = ref([]);\nconst selectedGroupFilter = ref('all')\nconst Student = ref('');\nconst courseName = computed(() => router.currentRoute.value.params.courseName)\nconst discussionID = computed(() => props.discussionID)\nconst owner = computed(() => user.data?.name)\n\n\nconst saveReplyAttachment = (itemName, file) => {\n\treplyFiles.value = {\n\t\t...replyFiles.value,\n\t\t[itemName]: file,\n\t}\n}\n\nconst discussionReady = computed(() => {\n\tcourseName.value && discussionID.value && owner.value\n})\n\nconst removeReplyAttachment = (itemName) => {\n\tconst { [itemName]: _removed, ...rest } = replyFiles.value\n\treplyFiles.value = rest\n}\n\nconst canSubmitReply = (item) => {\n\treturn Boolean(item?.new_reply && item.new_reply.toString().trim().length)\n}\n\nconst props = defineProps({\n\tdiscussionID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tsubmissionName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n\tcanGradeSubmission: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t\trequired: false,\n\t},\n})\n\nonMounted(() => {\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tconsole.log('User: ', user.data?.name)\n\tconsole.log('Discussion ID: ', props.discussionID)\n\tconsole.log(\"Course Name: \", router.currentRoute.value.params.courseName)\n\treloadDiscussionLists()\n\tStudentData.reload().then(() => {\n\t\tconsole.log('Student data after reload:', Student.value)\n\t\tconsole.log('Student group:', Student.value?.student_group)\n\t})\n\tconsole.log('Saved Submission Data on Mount:', savedsubmission.data)\n\tconsole.log('hasSavedSubmission:', hasSavedSubmission.value)\n\tfetchStudentGroups()\n\tfilteredDiscussions.value; // Trigger initial computation\n\n\n})\n\nconst keyboardShortcut = (e) => {\n\tif (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n\t\tsubmitDiscussion()\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst discussion = createResource({\n\turl: 'frappe.client.get',\n\tparams: {\n\t\tdoctype: 'Discussion Activity',\n\t\tname: props.discussionID,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (props.submissionName != 'new') {\n\t\t\tsubmissionResource.reload()\n\t\t}\n\t},\n})\n\nconsole.log(\"Submission Name: \", props.submissionName)\nconst post_before = computed(() => {\n\treturn discussion.data?.post_before\n})\n\nconst formatDate = (dateString) => {\n\tif (dateString && dateString.includes('.')) {\n\t\treturn dayjs(dateString.split('.')[0]).fromNow();\n\t}\n\treturn dayjs(dateString).fromNow();\n};\n\nfunction getFrappeDateTime() {\n\tconst now = new Date();\n\t// Get microseconds (JavaScript only provides milliseconds, so we multiply by 1000)\n\tconst microseconds = Math.floor(now.getMilliseconds() * 1000);\n\n\t// Format with padStart for proper zero-padding\n\tconst formatted = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}.${String(microseconds).padStart(6, '0')}`;\n\n\treturn formatted;\n}\nconst handleReplySubmit = (item) => {\n\tif (!canSubmitReply(item)) {\n\t\treturn\n\t}\n\n\tconst attachment = replyFiles.value[item.name]\n\tconst studentid = Student.value?.student || null\n\tconst member_name = Student.value?.student_name || user.data?.full_name\n\tconst reply_dt = getFrappeDateTime()\n\treplyResource.submit(\n\t\t{\n\t\t\tname: item.name,\n\t\t\treply: item.new_reply,\n\t\t\treply_attach: attachment,\n\t\t\tstudent: studentid,\n\t\t\tmember_name: member_name,\n\t\t\tparent: item.name,\n\t\t\treply_dt: reply_dt,\n\t\t\tparentfield: 'replies',\n\t\t\tparenttype: 'Discussion Submission'\n\t\t},\n\t\t{\n\t\t\tonSuccess() {\n\t\t\t\ttoast.success(__('Reply posted successfully'))\n\t\t\t\titem.new_reply = ''\n\t\t\t\tif (attachment) {\n\t\t\t\t\tremoveReplyAttachment(item.name)\n\t\t\t\t}\n\t\t\t\trefreshDiscussionLists()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\n//Logic for fetching all discussions and their replies\nconst all_discussions = createResource({\n\turl: 'seminary.seminary.api.get_discussion_submissions',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tdiscussion_id: props.discussionID,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tdata?.forEach((discussion) => {\n\t\t\tif (discussion && typeof discussion.new_reply === 'undefined') {\n\t\t\t\tdiscussion.new_reply = ''\n\t\t\t}\n\t\t})\n\t\tconsole.log(\"All Discussions Data Fetched: \", data)\n\n\t},\n})\n\n//Get student data from user to avoid errors with instructor and get other fields\n\nconst StudentData = createResource({\n\turl: 'seminary.seminary.api.get_student_group',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tuser: user.data?.name,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tStudent.value = data\n\t\tconsole.log('Student fetched:', Student.value)\n\t}\n})\n\n\n\n// Fetch the saved discussion by the user if it exists\nconst savedsubmission = createResource({\n\turl: 'seminary.seminary.api.get_user_discussion_submission',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t\t\tdiscussion_id: props.discussionID,\n\t\t\towner: user.data?.name,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tconsole.log('Saved submission fetched:', data)\n\t}\n})\n\nconst hasSavedSubmission = computed(() =>\n\tArray.isArray(savedsubmission.data) && savedsubmission.data.length > 0\n)\n\n\n// Watch for when all required data becomes available\nwatch(discussionReady, async (hasData) => {\n\tif (hasData) {\n\t\tawait reloadDiscussionLists()\n\t}\n})\n\nconst reloadDiscussionLists = async () => {\n\ttry {\n\t\t// No need for null checks since we know data exists\n\t\tawait all_discussions.reload({\n\t\t\tcourse_name: courseName.value,\n\t\t\tdiscussion_id: discussionID.value,\n\t\t})\n\n\t\tawait savedsubmission.reload({\n\t\t\tcourse_name: courseName.value,\n\t\t\tdiscussion_id: discussionID.value,\n\t\t\towner: owner.value,\n\t\t})\n\t} catch (error) {\n\t\tconsole.error(\"Error reloading discussion lists:\", error)\n\t}\n}\n\n\n\nconst filteredDiscussions = computed(() => {\n\n\tlet filter_discussions = toRaw(all_discussions.data)\n\tconsole.log(\"Discussions before filtering: \", filter_discussions)\n\t// For students - show only their group if use_studentgroup is enabled\n\n\tif (isStudent.value) {\n\t\tif (discussion.data?.use_studentgroup) {\n\t\t\tlet selectedGroupFilter = studentGroup\n\t\t\treturn filter_discussions.filter(discussion =>\n\t\t\t\tdiscussion.student_group === selectedGroupFilter.value\n\t\t\t)\n\t\t} else {\n\t\t\treturn filter_discussions\n\t\t}\n\t} else {\n\t\t// For instructors - apply group filter\n\t\tif (!isStudent.value && selectedGroupFilter.value !== 'all') {\n\t\t\treturn filter_discussions.filter(discussion =>\n\t\t\t\tdiscussion.student_group === selectedGroupFilter.value\n\t\t\t)\n\t\t}\n\t\treturn filter_discussions\n\t}\n})\n\n\nconst refreshDiscussionLists = () => {\n\treloadDiscussionLists()\n}\n\n\n\nconst newSubmission = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tlet doc = {\n\t\t\tdoctype: 'Discussion Submission',\n\t\t\tdisc_activity: props.discussionID,\n\t\t\tdisc_title: discussion.data?.discussion_name,\n\t\t\tmember: user.data?.name,\n\t\t\tcoursesc: router.currentRoute.value.params.courseName,\n\t\t\toriginal_post: original_post.value,\n\t\t\toriginal_attachment: submissionFile.value?.file_url || null,\n\t\t\tstudent_name: Student.value?.student_name || user.data?.full_name,\n\t\t\tstudent: Student.value?.student || null,\n\t\t}\n\t\treturn {\n\t\t\tdoc: doc,\n\t\t}\n\t},\n})\n\nconst replyResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\tconst attachment = values.reply_attach\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Discussion Submission Replies',\n\t\t\t\tmember: user.data?.name,\n\t\t\t\treply: values.reply,\n\t\t\t\tstudent: values.student,\n\t\t\t\tmember_name: values.member_name || user.data?.full_name,\n\t\t\t\treply_dt: values.reply_dt,\n\t\t\t\tparent: values.name,\n\t\t\t\tparentfield: 'replies',\n\t\t\t\tparenttype: 'Discussion Submission',\n\t\t\t\treply_attach: attachment?.file_url || null,\n\t\t\t},\n\t\t}\n\t},\n\tauto: false,\n})\n\nconst imageResource = createResource({\n\turl: 'seminary.seminary.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tsubmissionFile.value = data\n\t},\n})\n\nconst submissionResource = createDocumentResource({\n\tdoctype: 'Discussion Submission',\n\tname: props.submissionName,\n\tonError(err) {\n\t\ttoast.error(err.messages?.[0] || err)\n\t},\n\tauto: false,\n\tcache: [user.data?.name, props.discussionID],\n})\n\nwatch(submissionResource, () => {\n\tif (submissionResource.doc) {\n\t\tif (submissionResource.doc.original_attachment) {\n\t\t\timageResource.reload({\n\t\t\t\timage: submissionResource.doc.original_attachment,\n\t\t\t})\n\t\t}\n\t\toriginal_post.value = submissionResource.doc.original_post || ''\n\t\tconsole.log(\"Original Post: \", original_post.value)\n\t\tcomments.value = submissionResource.doc.comments || ''\n\t\tconst hasFile = Boolean(submissionFile.value)\n\t\tconst hasOriginalPost = Boolean(original_post.value)\n\n\t\tif (submissionResource.isDirty) {\n\t\t\tisDirty.value = true\n\t\t} else if (!hasFile && !hasOriginalPost) {\n\t\t\tisDirty.value = true\n\t\t} else {\n\t\t\tisDirty.value = false\n\t\t}\n\t}\n})\n\n\nwatch(submissionFile, () => {\n\tif (props.submissionName == 'new' && submissionFile.value) {\n\t\tisDirty.value = true\n\t}\n})\n\nwatch(\n\t() => submissionResource.doc?.grade,\n\t(newGrade, oldGrade) => {\n\t\tif (newGrade !== oldGrade && submissionResource.doc) {\n\t\t\tsubmissionResource.doc.status = 'Graded'; // Automatically set status to \"Graded\"\n\t\t\tisDirty.value = true; // Mark the form as dirty to indicate unsaved changes\n\t\t}\n\t}\n);\n\nconst submitDiscussion = () => {\n\tif (props.submissionName != 'new') {\n\t\tlet evaluator =\n\t\t\tsubmissionResource.doc && submissionResource.doc.owner != user.data?.name\n\t\t\t\t? user.data?.name\n\t\t\t\t: null\n\n\t\tsubmissionResource.setValue.submit(\n\t\t\t{\n\t\t\t\t...submissionResource.doc,\n\t\t\t\toriginal_attachment: submissionFile.value?.file_url,\n\t\t\t\tevaluator: evaluator,\n\t\t\t\tcomments: comments.value,\n\t\t\t\toriginal_post: original_post.value,\n\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(__('Changed successfully'))\n\t\t\t\t\tisDirty.value = false;\n\t\t\t\t\trefreshDiscussionLists()\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t} else {\n\t\taddNewSubmission()\n\t}\n}\n\nconst addNewSubmission = () => {\n\tnewSubmission.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Discussion submitted successfully'))\n\t\t\t\tif (router.currentRoute.value.name == 'DiscussionSubmission') {\n\t\t\t\t\trouter.push({\n\t\t\t\t\t\tname: 'DiscussionSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tdiscussionID: props.discussionID,\n\t\t\t\t\t\t\tsubmissionName: data.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tmarkLessonProgress()\n\t\t\t\t\trouter.go()\n\t\t\t\t}\n\t\t\t\tsubmissionResource.name = data.name\n\t\t\t\tisDirty.value = false;\n\t\t\t\tsubmissionResource.reload()\n\t\t\t\trefreshDiscussionLists()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveSubmission = (file) => {\n\tisDirty.value = true\n\tsubmissionFile.value = file\n}\n\nconst markLessonProgress = () => {\n\tif (router.currentRoute.value.name == 'Lesson') {\n\t\tlet courseName = router.currentRoute.value.params.courseName\n\t\tlet chapterNumber = router.currentRoute.value.params.chapterNumber\n\t\tlet lessonNumber = router.currentRoute.value.params.lessonNumber\n\t\tconsole.log(\"Chapter Number: \", chapterNumber)\n\t\tconsole.log(\"Lesson Number: \", lessonNumber)\n\n\t\tcall('seminary.seminary.api.mark_lesson_progress', {\n\t\t\tcourse: courseName,\n\t\t\tchapter_number: chapterNumber,\n\t\t\tlesson_number: lessonNumber,\n\t\t})\n\t}\n}\n\nconst getType = () => {\n\treturn [\n\t\t'image/*',\n\t\t'.pdf',\n\t\t'.doc',\n\t\t'.docx',\n\t\t'.xml',\n\t\t'application/msword',\n\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t]\n}\n\nconst validateFile = (file) => {\n\tconst extension = file.name.split('.').pop()?.toLowerCase()\n\tconst allowedExtensions = ['jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'xml']\n\tconst isImage = file.type?.startsWith('image/')\n\tif (isImage) {\n\t\treturn\n\t}\n\tif (!extension || !allowedExtensions.includes(extension)) {\n\t\treturn 'Only images, PDF, or Word documents are allowed.'\n\t}\n}\n\nconst removeSubmission = () => {\n\tisDirty.value = true\n\tsubmissionFile.value = null\n}\n\nconst canGradeSubmission = computed(() => {\n\treturn (\n\t\t(user.data?.is_moderator ||\n\t\t\tuser.data?.is_evaluator ||\n\t\t\tuser.data?.is_instructor) &&\n\t\tprops.submissionName != 'new' &&\n\t\trouter.currentRoute.value.name == 'DiscussionActivitySubmission'\n\t)\n})\n\nconst canModifyDiscussion = computed(() => {\n\treturn (\n\t\t!submissionResource.doc ||\n\t\t(submissionResource.doc?.owner == user.data?.name &&\n\t\t\tsubmissionResource.doc?.status == 'Not Graded')\n\t)\n})\n\nconst submissionStatusOptions = computed(() => {\n\treturn [\n\t\t{ label: 'Not Graded', value: 'Not Graded' },\n\t\t{ label: 'Graded', value: 'Graded' },\n\t\t{ label: 'Pass', value: 'Pass' },\n\t\t{ label: 'Fail', value: 'Fail' },\n\t]\n})\n\nconst statusTheme = computed(() => {\n\tif (!submissionResource.doc) {\n\t\treturn 'orange'\n\t} else if (submissionResource.doc.status == 'Pass' || submissionResource.doc.status == 'Graded') {\n\t\treturn 'green'\n\t} else if (submissionResource.doc.status == 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n})\n\nconst fetchStudentGroups = () => {\n\tif (!router.currentRoute.value.params.courseName) {\n\t\tconsole.warn('Cannot fetch student groups: Missing course name.');\n\t\treturn;\n\t}\n\n\tcall('seminary.seminary.api.get_student_groups_simple', {\n\t\tcourse_name: router.currentRoute.value.params.courseName,\n\t})\n\t\t.then((response) => {\n\t\t\tstudentGroups.value = response || [];\n\t\t\tconsole.log('Student groups fetched:', studentGroups.value);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error('Error fetching student groups:', error);\n\t\t});\n};\n\nconst studentGroup = computed(() => {\n\tif (StudentData.loading) {\n\t\treturn __('Loading...');\n\t}\n\treturn Student.value?.student_group || __('No group assigned');\n});\n\nwatch(\n\t() => StudentData.loading,\n\t(loading) => {\n\t\tif (!loading) {\n\t\t\tconsole.log('Student data loaded on watch:', StudentData.data);\n\t\t}\n\t}\n);\n\nwatch(\n\t() => selectedGroupFilter.value,\n\t(newGroup) => {\n\t\tconsole.log('Selected group changed to:', newGroup);\n\t\tfilteredDiscussions.value; // Trigger recomputation\n\t}\n);\n\n//watch for changes in all_discussions to recalculate filteredDiscussions\n// watch(\n//   () => all_discussions.data,\n//   (newData) => {\n// \tconsole.log('All discussions data changed:', newData);\n// \tfilteredDiscussions.value; // Trigger recomputation\n//   }\n// );\n\n</script>\n","<template>\n\t<DiscussionActivity\n\t\tv-if=\"user.data\"\n\t\t:discussionID=\"discussionID\"\n\t\t\n\t/>\n\t<div v-else class=\"border rounded-md text-center py-20\">\n\t\t<div>\n\t\t\t{{ __('Please login to access the Discussion Activity.') }}\n\t\t</div>\n\t\t<Button @click=\"redirectToLogin()\" class=\"mt-2\">\n\t\t\t<span>\n\t\t\t\t{{ __('Login') }}\n\t\t\t</span>\n\t\t</Button>\n\t</div>\n</template>\n<script setup>\nimport { inject } from 'vue'\nimport { Button, createResource } from 'frappe-ui'\nimport DiscussionActivity from '@/components/DiscussionActivity.vue'\n\nconst user = inject('$user')\n\nconst props = defineProps({\n\tdiscussionID: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconsole.log('Discussion ID in Block: ', props.discussionID)\n\n// const submission = createResource({\n// \turl: 'frappe.client.get_value',\n// \tmakeParams(values) {\n// \t\treturn {\n// \t\t\tdoctype: 'Discussion Submission',\n// \t\t\tfieldname: 'name',\n// \t\t\tfilters: {\n// \t\t\t\tdisc_activity: props.discussionID,\n// \t\t\t\tmember: user.data?.name,\n// \t\t\t},\n// \t\t}\n// \t},\n// \tauto: true,\n// })\n// console.log(submission)\n\n</script>\n","import { MessagesSquare } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\nimport AssessmentPlugin from '@/components/AssessmentPlugin.vue'\nimport DiscussionActivityBlock from '@/components/DiscussionActivityBlock.vue'\nimport translationPlugin from '../translation'\nimport { usersStore } from '@/stores/user'\nimport router from '../router'\n\nexport class DiscussionActivity {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(MessagesSquare, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: __('Discussion Activity'),\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tconst discussionId = this.data.discussion || this.data.discussionID\n\t\tif (discussionId) {\n\t\t\tthis.renderDiscussionActivity(discussionId)\n\t\t} else {\n\t\t\tthis.renderDiscussionActivityModal()\n\t\t}\n\t\treturn this.wrapper\n\t}\n\n\trenderDiscussionActivity(discussion) {\n\t\tif (!discussion) {\n\t\t\tconsole.warn('[DiscussionActivity] Missing discussion id; falling back to selector')\n\t\t\tthis.renderDiscussionActivityModal()\n\t\t\treturn\n\t\t}\n\t\tif (this.readOnly) {\n\t\t\tconst app = createApp(DiscussionActivityBlock, {\n\t\t\t\tdiscussionID: discussion,\n\t\t\t})\n\t\t\tapp.use(translationPlugin)\n\t\t\tapp.use(router)\n\t\t\tconst { userResource } = usersStore()\n\t\t\tapp.provide('$user', userResource)\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t}\n\t\tthis.wrapper.innerHTML = `<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>\n            <span class=\"font-medium\">\n                Discussion Activity: ${discussion}\n            </span>\n        </div>`\n\t\treturn\n\t}\n\n\trenderDiscussionActivityModal() {\n\t\tif (this.readOnly) {\n\t\t\treturn\n\t\t}\n\t\tconst app = createApp(AssessmentPlugin, {\n\t\t\ttype: 'discussionactivity',\n\t\t\tonAddition: (discussion) => {\n\t\t\t\tthis.data.discussion = discussion\n\t\t\t\tthis.data.discussionID = discussion\n\t\t\t\tthis.renderDiscussionActivity(discussion)\n\t\t\t},\n\t\t\t\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.use(router) // Explicitly provide the router\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tsave(blockContent) {\n\tconst discussionId = this.data.discussion || this.data.discussionID\n\tif (!discussionId) {\n\t\treturn {}\n\t}\n\treturn {\n\t\tdiscussion: discussionId,\n\t\tdiscussionID: discussionId,\n\t}\n\t}\n}\n","<template>\n\t<div>\n\t\t<!-- <audio width=\"100%\" controls controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio> -->\n\t\t<audio @ended=\"handleAudioEnd\" controlsList=\"nodownload\" class=\"mb-4\">\n\t\t\t<source :src=\"encodeURI(file)\" type=\"audio/mp3\" />\n\t\t</audio>\n\t\t<div class=\"flex items-center space-x-2 shadow rounded-lg p-1 w-1/2\">\n\t\t\t<Button variant=\"ghost\" @click=\"togglePlay\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play v-if=\"!isPlaying\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<Pause v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs text-ink-gray-9 font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!isMuted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch } from 'vue'\nimport { Play, Pause, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst isPlaying = ref(false)\nconst audio = ref(null)\nlet isMuted = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\taudio.value = document.querySelector('audio')\n\t\taudio.value.onloadedmetadata = () => {\n\t\t\tduration.value = audio.value.duration\n\t\t}\n\t\taudio.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = audio.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst togglePlay = () => {\n\tif (audio.value.paused) {\n\t\taudio.value.play()\n\t\tisPlaying.value = true\n\t} else {\n\t\taudio.value.pause()\n\t\tisPlaying.value = false\n\t}\n}\n\nconst toggleMute = () => {\n\taudio.value.muted = !audio.value.muted\n\tisMuted.value = audio.value.muted\n}\n\nconst changeCurrentTime = () => {\n\taudio.value.currentTime = currentTime.value\n}\n\nconst handleAudioEnd = () => {\n\tisPlaying.value = false\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nwatch(isPlaying, (newVal) => {\n\tif (newVal) {\n\t\taudio.value.play()\n\t} else {\n\t\taudio.value.pause()\n\t}\n})\n</script>\n<style>\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\tappearance: none;\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -150px 0 0 150px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<div ref=\"videoContainer\" class=\"video-block group relative\">\n\t\t<video\n\t\t\t@timeupdate=\"updateTime\"\n\t\t\t@ended=\"videoEnded\"\n\t\t\t@click=\"togglePlay\"\n\t\t\toncontextmenu=\"return false\"\n\t\t\tclass=\"rounded-lg border border-gray-100 group cursor-pointer\"\n\t\t\tref=\"videoRef\"\n\t\t>\n\t\t\t<source :src=\"fileURL\" :type=\"type\" />\n\t\t</video>\n\t\t<div\n\t\t\tclass=\"flex items-center space-x-2 bg-surface-gray-3 rounded-md p-0.5 absolute bottom-3 w-[98%] left-0 right-0 mx-auto invisible group-hover:visible\"\n\t\t>\n\t\t\t<Button variant=\"ghost\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Play\n\t\t\t\t\t\tv-if=\"!playing\"\n\t\t\t\t\t\t@click=\"playVideo\"\n\t\t\t\t\t\tclass=\"w-4 h-4 text-ink-gray-9\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Pause v-else @click=\"pauseVideo\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleMute\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Volume2 v-if=\"!muted\" class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t\t<VolumeX v-else class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<input\n\t\t\t\ttype=\"range\"\n\t\t\t\tmin=\"0\"\n\t\t\t\t:max=\"duration\"\n\t\t\t\tstep=\"0.1\"\n\t\t\t\tv-model=\"currentTime\"\n\t\t\t\t@input=\"changeCurrentTime\"\n\t\t\t\tclass=\"duration-slider w-full h-1\"\n\t\t\t/>\n\t\t\t<span class=\"text-xs font-medium\">\n\t\t\t\t{{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n\t\t\t</span>\n\t\t\t<Button variant=\"ghost\" @click=\"toggleFullscreen\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Maximize class=\"w-4 h-4 text-ink-gray-9\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { ref, onMounted, computed } from 'vue'\nimport { Play, Pause, Maximize, Volume2, VolumeX } from 'lucide-vue-next'\nimport { Button } from 'frappe-ui'\n\nconst videoRef = ref(null)\nconst videoContainer = ref(null)\nlet playing = ref(false)\nlet currentTime = ref(0)\nlet duration = ref(0)\nlet muted = ref(false)\n\nconst props = defineProps({\n\tfile: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\ttype: {\n\t\ttype: String,\n\t\tdefault: 'video/mp4',\n\t},\n})\n\nonMounted(() => {\n\tsetTimeout(() => {\n\t\tvideoRef.value.onloadedmetadata = () => {\n\t\t\tduration.value = videoRef.value.duration\n\t\t}\n\t\tvideoRef.value.ontimeupdate = () => {\n\t\t\tcurrentTime.value = videoRef.value.currentTime\n\t\t}\n\t}, 0)\n})\n\nconst fileURL = computed(() => {\n\tif (isYoutube) {\n\t\tlet url = props.file\n\t\tif (url.includes('watch?v=')) {\n\t\t\turl = url.replace('watch?v=', 'embed/')\n\t\t}\n\t\treturn `${url}?autoplay=0&controls=0&disablekb=1&playsinline=1&cc_load_policy=1&cc_lang_pref=auto`\n\t}\n\treturn props.file\n})\n\nconst isYoutube = computed(() => {\n\treturn props.type == 'video/youtube'\n})\n\nconst playVideo = () => {\n\tvideoRef.value.play()\n\tplaying.value = true\n}\n\nconst pauseVideo = () => {\n\tvideoRef.value.pause()\n\tplaying.value = false\n}\n\nconst togglePlay = () => {\n\tif (playing.value) {\n\t\tpauseVideo()\n\t} else {\n\t\tplayVideo()\n\t}\n}\n\nconst videoEnded = () => {\n\tplaying.value = false\n}\n\nconst toggleMute = () => {\n\tvideoRef.value.muted = !videoRef.value.muted\n\tmuted.value = videoRef.value.muted\n}\n\nconst changeCurrentTime = () => {\n\tvideoRef.value.currentTime = currentTime.value\n}\n\nconst formatTime = (time) => {\n\tconst minutes = Math.floor(time / 60)\n\tconst seconds = Math.floor(time % 60)\n\treturn `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`\n}\n\nconst toggleFullscreen = () => {\n\tif (document.fullscreenElement) {\n\t\tdocument.exitFullscreen()\n\t} else {\n\t\tvideoContainer.value.requestFullscreen()\n\t}\n}\n</script>\n\n<style scoped>\n.video-block {\n\twidth: 100%;\n\tmax-width: 900px;\n\tmargin: 0 auto;\n}\n\n.video-block video {\n\twidth: 100%;\n\theight: auto;\n}\n\niframe {\n\twidth: 100%;\n\tmin-height: 500px;\n}\n\n.duration-slider {\n\tflex: 1;\n\t-webkit-appearance: none;\n\tappearance: none;\n\tbackground-color: theme('colors.gray.400');\n\tcursor: pointer;\n}\n\n.duration-slider::-webkit-slider-thumb {\n\theight: 10px;\n\twidth: 10px;\n\t-webkit-appearance: none;\n\tbackground-color: theme('colors.gray.900');\n}\n\n@media screen and (-webkit-min-device-pixel-ratio: 0) {\n\tinput[type='range'] {\n\t\toverflow: hidden;\n\t\twidth: 150px;\n\t\t-webkit-appearance: none;\n\t}\n\n\tinput[type='range']::-webkit-slider-thumb {\n\t\t-webkit-appearance: none;\n\t\tcursor: pointer;\n\t\tbox-shadow: -500px 0 0 500px theme('colors.gray.900');\n\t}\n}\n</style>\n","<template>\n\t<FileUploader\n\t\t:fileTypes=\"['image/*', 'video/*', 'audio/*', '.pdf']\"\n\t\t:validateFile=\"validateFile\"\n\t\t@success=\"(data) => addFile(data)\"\n\t\tref=\"fileUploader\"\n\t\tclass=\"hide\"\n\t/>\n</template>\n<script setup>\nimport { FileUploader } from 'frappe-ui'\nimport { onMounted, ref, nextTick } from 'vue'\n\nconst fileUploader = ref(null)\nconst emit = defineEmits(['fileUploaded'])\n\nconst props = defineProps({\n\tonFileUploaded: {\n\t\ttype: Function,\n\t\trequired: true,\n\t},\n})\n\nonMounted(async () => {\n\tawait nextTick()\n\tconst fileInput = fileUploader.value.$el.querySelector('input[type=\"file\"]')\n\tif (fileInput) {\n\t\tfileInput.click()\n\t}\n})\n\nconst addFile = (file) => {\n\tprops.onFileUploaded({\n\t\tfile_url: file.file_url,\n\t\tfile_type: file.file_type,\n\t})\n}\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'mp4', 'mov', 'mp3', 'pdf'].includes(extension)) {\n\t\treturn 'Only image and video files are allowed.'\n\t}\n}\n\nconst isVideo = (type) => {\n\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n}\n\nconst isAudio = (type) => {\n\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n}\n</script>\n","import AudioBlock from '@/components/AudioBlock.vue'\nimport VideoBlock from '@/components/VideoBlock.vue'\nimport UploadPlugin from '@/components/UploadPlugin.vue'\nimport { h, createApp } from 'vue'\nimport { Upload as UploadIcon } from 'lucide-vue-next'\nimport translationPlugin from '../translation'\n\nexport class Upload {\n\tconstructor({ data, api, readOnly }) {\n\t\tthis.data = data\n\t\tthis.readOnly = readOnly\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(UploadIcon, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\n\t\treturn {\n\t\t\ttitle: 'Upload',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\n\t\tif (this.data && this.data.file_url) {\n\t\t\tthis.renderFile(this.data)\n\t\t} else {\n\t\t\tthis.renderFileUploader()\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\trenderFile(file) {\n\t\tif (this.isVideo(file.file_type)) {\n\t\t\tconst app = createApp(VideoBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (this.isAudio(file.file_type)) {\n\t\t\tconst app = createApp(AudioBlock, {\n\t\t\t\tfile: file.file_url,\n\t\t\t})\n\t\t\tapp.mount(this.wrapper)\n\t\t\treturn\n\t\t} else if (file.file_type == 'PDF') {\n\t\t\tthis.wrapper.innerHTML = `<iframe src=\"https://docs.google.com/viewer?url=${\n\t\t\t\twindow.location.origin\n\t\t\t}${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)}&embedded=true\" width='100%' height='700px' class=\"mb-4\" type=\"application/pdf\"></iframe>`\n\t\t\treturn\n\t\t} else {\n\t\t\tthis.wrapper.innerHTML = `<img class=\"mb-4\" src=${encodeURI(\n\t\t\t\tfile.file_url\n\t\t\t)} width='100%'>`\n\t\t\treturn\n\t\t}\n\t}\n\n\trenderFileUploader() {\n\t\tconst app = createApp(UploadPlugin, {\n\t\t\tonFileUploaded: (file) => {\n\t\t\t\tthis.data.file_url = file.file_url\n\t\t\t\tthis.data.file_type = file.file_type\n\t\t\t\tthis.renderFile(file)\n\t\t\t},\n\t\t})\n\t\tapp.use(translationPlugin)\n\t\tapp.mount(this.wrapper)\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.file_url || !savedData.file_type) {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\tfile_url: this.data.file_url,\n\t\t\tfile_type: this.data.file_type,\n\t\t}\n\t}\n\n\tisVideo(type) {\n\t\treturn ['mov', 'mp4', 'avi', 'mkv', 'webm'].includes(type.toLowerCase())\n\t}\n\n\tisAudio(type) {\n\t\treturn ['mp3', 'wav', 'ogg'].includes(type.toLowerCase())\n\t}\n}\n","import { CodeXml } from 'lucide-vue-next'\nimport { createApp, h } from 'vue'\n\nexport class Markdown {\n\tconstructor({ data, api, readOnly, config }) {\n\t\tthis.api = api\n\t\tthis.data = data || {}\n\t\tthis.config = config || {}\n\t\tthis.text = data.text || ''\n\t\tthis.readOnly = readOnly\n\t\tthis.placeholder = __(\"Type '/' for commands or select text to format\")\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get conversionConfig() {\n\t\treturn {\n\t\t\texport: 'text',\n\t\t\timport: 'text',\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () =>\n\t\t\t\th(CodeXml, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t})\n\n\t\tconst div = document.createElement('div')\n\t\tapp.mount(div)\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\ticon: div.innerHTML,\n\t\t}\n\t}\n\n\tonPaste(event) {\n\t\tconst data = {\n\t\t\ttext: event.detail.data.innerHTML,\n\t\t}\n\n\t\tthis.data = data\n\t\twindow.requestAnimationFrame(() => {\n\t\t\tif (!this.wrapper) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.wrapper.innerHTML = this.data.text || ''\n\t\t})\n\t}\n\n\tstatic get pasteConfig() {\n\t\treturn {\n\t\t\ttags: ['P'],\n\t\t}\n\t}\n\n\trender() {\n\t\tthis.wrapper = document.createElement('div')\n\t\tthis.wrapper.classList.add('cdx-block', 'ce-paragraph')\n\t\tthis.wrapper.innerHTML = this.text\n\n\t\tif (!this.readOnly) {\n\t\t\tthis.wrapper.contentEditable = true\n\t\t\tthis.wrapper.innerHTML = this.text\n\n\t\t\tthis.wrapper.addEventListener('input', (event) => {\n\t\t\t\tlet value = event.target.textContent\n\t\t\t\tif (event.keyCode === 32 && value.startsWith('#')) {\n\t\t\t\t\tthis.convertToHeader(event, value)\n\t\t\t\t} else if (event.keyCode == 189) {\n\t\t\t\t\tthis.convertBlock('list', {\n\t\t\t\t\t\tstyle: 'unordered',\n\t\t\t\t\t})\n\t\t\t\t} else if (/^[a-zA-Z]/.test(event.key)) {\n\t\t\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t})\n\t\t\t\t} else if (event.keyCode === 13 || event.keyCode === 190) {\n\t\t\t\t\tthis.parseContent(event)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn this.wrapper\n\t}\n\n\t_togglePlaceholder() {\n\t\tconst blocks = document.querySelectorAll(\n\t\t\t'.cdx-block.ce-paragraph[data-placeholder]'\n\t\t)\n\t\tblocks.forEach((block) => {\n\t\t\tif (block !== this.wrapper) {\n\t\t\t\tdelete block.dataset.placeholder\n\t\t\t}\n\t\t})\n\t\tif (this.wrapper.innerHTML.trim() === '') {\n\t\t\tthis.wrapper.dataset.placeholder = this.placeholder\n\t\t} else {\n\t\t\tdelete this.wrapper.dataset.placeholder\n\t\t}\n\t}\n\n\tconvertToHeader(event, value) {\n\t\tevent.preventDefault()\n\t\tif (['#', '##', '###', '####', '#####', '######'].includes(value)) {\n\t\t\tlet level = value.length\n\t\t\tevent.target.textContent = ''\n\t\t\tthis.convertBlock('header', {\n\t\t\t\tlevel: level,\n\t\t\t})\n\t\t}\n\t}\n\n\tparseContent(event) {\n\t\tevent.preventDefault()\n\t\tlet previousLine = this.wrapper.textContent\n\t\tif (event.keyCode === 190) {\n\t\t\tpreviousLine = previousLine + '.'\n\t\t}\n\n\t\tif (previousLine && this.hasImage(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('image')\n\t\t} else if (previousLine && this.hasLink(previousLine)) {\n\t\t\tconst { text, url } = this.extractLink(previousLine)\n\t\t\tconst anchorTag = `<a href=\"${url}\" target=\"_blank\">${text}</a>`\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine.replace(/\\[.+?\\]\\(.+?\\)/, anchorTag),\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('- ')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'unordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('- ', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && previousLine.startsWith('1.')) {\n\t\t\tthis.convertBlock('list', {\n\t\t\t\tstyle: 'ordered',\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: previousLine.replace('1.', ''),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t})\n\t\t} else if (previousLine && this.canBeEmbed(previousLine)) {\n\t\t\tthis.wrapper.textContent = ''\n\t\t\tthis.convertBlock('embed', {\n\t\t\t\tsource: previousLine,\n\t\t\t})\n\t\t} else {\n\t\t\tthis.convertBlock('paragraph', {\n\t\t\t\ttext: previousLine,\n\t\t\t})\n\t\t}\n\t}\n\n\tasync convertBlock(type, data, index = null) {\n\t\tconst currentIndex = this.api.blocks.getCurrentBlockIndex()\n\t\tconst currentBlock = this.api.blocks.getBlockByIndex(currentIndex)\n\t\tawait this.api.blocks.convert(currentBlock.id, type, data)\n\t\tthis.api.caret.focus(true)\n\t}\n\n\tsave(blockContent) {\n\t\treturn {\n\t\t\ttext: blockContent.innerHTML,\n\t\t}\n\t}\n\n\thasImage(line) {\n\t\treturn /!\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractImage(line) {\n\t\tconst match = line.match(/!\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { alt: match[1], url: match[2] }\n\t\t}\n\t\treturn { alt: '', url: '' }\n\t}\n\n\thasLink(line) {\n\t\treturn /\\[.+?\\]\\(.+?\\)/.test(line)\n\t}\n\n\textractLink(line) {\n\t\tconst match = line.match(/\\[(.+?)\\]\\((.+?)\\)/)\n\t\tif (match) {\n\t\t\treturn { text: match[1], url: match[2] }\n\t\t}\n\t\treturn { text: '', url: '' }\n\t}\n\n\tcanBeEmbed(line) {\n\t\treturn /^https?:\\/\\/.+/.test(line.trim())\n\t}\n}\n\nexport default Markdown","import { Code } from \"lucide-vue-next\"\nimport { h, createApp } from \"vue\"\nimport hljs from 'highlight.js/lib/core';\n\n\nconst DEFAULT_THEMES = ['light', 'dark'];\nconst COMMON_LANGUAGES = {\n\tnone: 'Auto-detect', apache: 'Apache', bash: 'Bash', cs: 'C#', cpp: 'C++', css: 'CSS', coffeescript: 'CoffeeScript', diff: 'Diff',\n\tgo: 'Go', html: 'HTML, XML', http: 'HTTP', json: 'JSON', java: 'Java', javascript: 'JavaScript', kotlin: 'Kotlin',\n\tless: 'Less', lua: 'Lua', makefile: 'Makefile', markdown: 'Markdown', nginx: 'Nginx', objectivec: 'Objective-C',\n\tphp: 'PHP', perl: 'Perl', properties: 'Properties', python: 'Python', ruby: 'Ruby', rust: 'Rust', scss: 'SCSS',\n\tsql: 'SQL', shell: 'Shell Session', swift: 'Swift', toml: 'TOML, also INI', typescript: 'TypeScript', yaml: 'YAML',\n\tplaintext: 'Plaintext'\n};\n\nexport class CodeBox {\n\tapi: any;\n\tconfig: { themeName: any; themeURL: any; useDefaultTheme: any; };\n\treadOnly: boolean;\n\tdata: { code: any; language: any; theme: any; };\n\thighlightScriptID: string;\n\thighlightCSSID: string;\n\tcodeArea: HTMLDivElement;\n\tselectInput: HTMLInputElement;\n\tselectDropIcon: HTMLElement;\n\n\tconstructor({ data, api, config, readOnly }) {\n\t\tthis.api = api;\n\t\tthis.readOnly = readOnly;\n\t\tthis.config = {\n\t\t\tthemeName: config.themeName && typeof config.themeName === 'string' ? config.themeName : '',\n\t\t\tthemeURL: config.themeURL && typeof config.themeURL === 'string' ? config.themeURL : '',\n\t\t\tuseDefaultTheme: (config.useDefaultTheme && typeof config.useDefaultTheme === 'string'\n\t\t\t\t&& DEFAULT_THEMES.includes(config.useDefaultTheme.toLowerCase())) ? config.useDefaultTheme : 'dark',\n\t\t};\n\t\tthis.data = {\n\t\t\tcode: data.code && typeof data.code === 'string' ? data.code : '',\n\t\t\tlanguage: data.language && typeof data.language === 'string' ? data.language : 'Auto-detect',\n\t\t\ttheme: data.theme && typeof data.theme === 'string' ? data.theme : this._getThemeURLFromConfig(),\n\t\t};\n\t\tthis.highlightScriptID = 'highlightJSScriptElement';\n\t\tthis.highlightCSSID = 'highlightJSCSSElement';\n\t\tthis.codeArea = document.createElement('div');\n\t\tthis.selectInput = document.createElement('input');\n\t\tthis.selectDropIcon = document.createElement('i');\n\n\t\tthis._injectHighlightJSCSSElement();\n\n\t\tthis.api.listeners.on(window, 'click', this._closeAllLanguageSelects, true);\n\t}\n\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n\tstatic get sanitize() {\n\t\treturn {\n\t\t\tcode: true,\n\t\t\tlanguage: false,\n\t\t\ttheme: false,\n\t\t}\n\t}\n\n\tstatic get toolbox() {\n\t\tconst app = createApp({\n\t\t\trender: () => h(Code, { size: 18, strokeWidth: 1.5, color: 'black' }),\n\t\t});\n\n\t\tconst div = document.createElement('div');\n\t\tapp.mount(div);\n\n\t\treturn {\n\t\t\ttitle: 'CodeBox',\n\t\t\ticon: div.innerHTML\n\t\t};\n\t}\n\n\tstatic get displayInToolbox() {\n\t\treturn true;\n\t}\n\n\tstatic get enableLineBreaks() {\n\t\treturn true;\n\t}\n\n\trender() {\n\t\tconst codeAreaHolder = document.createElement('pre');\n\t\tconst languageSelect = this._createLanguageSelectElement();\n\n\t\tcodeAreaHolder.setAttribute('class', 'codeBoxHolder');\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\t\tthis.codeArea.setAttribute('contenteditable', 'true');\n\t\tthis.codeArea.innerHTML = this.data.code;\n\t\tthis.api.listeners.on(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.on(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\n\t\tcodeAreaHolder.appendChild(this.codeArea);\n\t\t!this.readOnly && codeAreaHolder.appendChild(languageSelect);\n\n\t\treturn codeAreaHolder;\n\t}\n\n\tsave(blockContent) {\n\t\treturn Object.assign(this.data, { code: this.codeArea.innerHTML, theme: this._getThemeURLFromConfig() });\n\t}\n\n\tvalidate(savedData) {\n\t\tif (!savedData.code.trim()) return false;\n\t\treturn true;\n\t}\n\n\tdestroy() {\n\t\tthis.api.listeners.off(window, 'click', this._closeAllLanguageSelects, true);\n\t\tthis.api.listeners.off(this.codeArea, 'blur', event => this._highlightCodeArea(event), false);\n\t\tthis.api.listeners.off(this.codeArea, 'paste', event => this._handleCodeAreaPaste(event), false);\n\t\tthis.api.listeners.off(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\t}\n\n\t_createLanguageSelectElement() {\n\t\tconst selectHolder = document.createElement('div');\n\t\tconst selectPreview = document.createElement('div');\n\t\tconst languages = Object.entries(COMMON_LANGUAGES);\n\n\t\tselectHolder.setAttribute('class', 'codeBoxSelectDiv');\n\n\t\tthis.selectDropIcon.setAttribute('class', `codeBoxSelectDropIcon ${this.config.useDefaultTheme}`);\n\t\tthis.selectDropIcon.innerHTML = '&#8595;';\n\t\tthis.selectInput.setAttribute('class', `codeBoxSelectInput ${this.config.useDefaultTheme}`);\n\t\tthis.selectInput.setAttribute('type', 'text');\n\t\tthis.selectInput.setAttribute('readonly', 'true');\n\t\tthis.selectInput.value = this.data.language;\n\t\tthis.api.listeners.on(this.selectInput, 'click', event => this._handleSelectInputClick(event), false);\n\n\t\tselectPreview.setAttribute('class', 'codeBoxSelectPreview');\n\n\t\tlanguages.forEach(language => {\n\t\t\tconst selectItem = document.createElement('p');\n\t\t\tselectItem.setAttribute('class', `codeBoxSelectItem ${this.config.useDefaultTheme}`);\n\t\t\tselectItem.setAttribute('data-key', language[0]);\n\t\t\tselectItem.textContent = language[1];\n\t\t\tthis.api.listeners.on(selectItem, 'click', event => this._handleSelectItemClick(event, language), false);\n\n\t\t\tselectPreview.appendChild(selectItem);\n\t\t});\n\n\t\tselectHolder.appendChild(this.selectDropIcon);\n\t\tselectHolder.appendChild(this.selectInput);\n\t\tselectHolder.appendChild(selectPreview);\n\n\t\treturn selectHolder;\n\t}\n\n\t_highlightCodeArea(event) {\n\t\thljs.highlightBlock(this.codeArea);\n\t}\n\n\t_handleCodeAreaPaste(event) {\n\t\tevent.stopPropagation();\n\t}\n\n\t_handleSelectInputClick(event) {\n\t\tevent.target.nextSibling.classList.toggle('codeBoxShow');\n\t}\n\n\t_handleSelectItemClick(event, language) {\n\t\tevent.target.parentNode.parentNode.querySelector('.codeBoxSelectInput').value = language[1];\n\t\tevent.target.parentNode.classList.remove('codeBoxShow');\n\t\tthis.codeArea.removeAttribute('class');\n\t\tthis.data.language = language[0];\n\t\tthis.codeArea.setAttribute('class', `codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`);\n\t\n\t\thljs.highlightElement(this.codeArea);\n\t}\n\n\t_closeAllLanguageSelects() {\n\t\tconst selectPreviews = document.querySelectorAll('.codeBoxSelectPreview');\n\t\tfor (let i = 0, len = selectPreviews.length; i < len; i++) selectPreviews[i].classList.remove('codeBoxShow');\n\t}\n\n\t_injectHighlightJSCSSElement() {\n\t\tconst highlightJSCSSElement = document.querySelector(`#${this.highlightCSSID}`);\n\t\tlet highlightJSCSSURL = this._getThemeURLFromConfig();\n\t\tif (!highlightJSCSSElement) {\n\t\t\tconst link = document.createElement('link');\n\t\t\tconst head = document.querySelector('head');\n\t\t\tlink.setAttribute('rel', 'stylesheet');\n\t\t\tlink.setAttribute('href', highlightJSCSSURL);\n\t\t\tlink.setAttribute('id', this.highlightCSSID);\n\n\t\t\tif (head) head.appendChild(link);\n\t\t}\n\t\telse highlightJSCSSElement.setAttribute('href', highlightJSCSSURL);\n\t}\n\n\t_getThemeURLFromConfig() {\n\t\tlet themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-${this.config.useDefaultTheme}.min.css`;\n\n\t\tif (this.config.themeName) themeURL = `https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/${this.config.themeName}.min.css`;\n\t\tif (this.config.themeURL) themeURL = this.config.themeURL;\n\n\t\treturn themeURL;\n\t}\n}\n\n\nexport default CodeBox;","<template>\n  <div class=\"Folder\">\n    <h3>Manage Course Folders</h3>\n    <div>\n      <label>\n        <input type=\"radio\" v-model=\"folderAction\" value=\"select\" />\n        Select Existing Folder    \n      </label>\n      <label class=\"ml-4\">\n        <input type=\"radio\" v-model=\"folderAction\" value=\"create\" />\n        Create New Folder\n      </label>\n    </div>\n    \n    <div v-if=\"folderAction === 'select'\" class=\"mt-4 mb-4\">\n      <Link \n        v-model=\"selectedFolder\"\n        doctype=\"Course Folder\"\n        options=\"foldername\"\n        :label=\"__('Select a folder')\"\n        \n            \n        />\n    </div>\n\n    <div v-if=\"folderAction === 'create'\">\n      <input type=\"text\" v-model=\"newFolderName\" placeholder=\"Enter folder name\" />\n      <Link\n        v-model=\"course\"\n        doctype=\"Course\"\n        :label=\"__('Select a course')\"\n        />\n      <button @click=\"createFolder\">Create Folder</button>\n    </div>\n\n    <div v-if=\"selectedFolder\" class=\"block mt-6 space-y-6\">\n      <div>\n        <div class=\"text-sm font-medium text-ink-gray-9\">{{ __('Current Folder') }}</div>\n        <div class=\"mt-1 flex flex-wrap items-center gap-1 text-sm text-ink-gray-6\">\n          <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n            <button\n              type=\"button\"\n              class=\"rounded px-1.5 py-0.5 text-ink-gray-7 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n              @click=\"navigateToBreadcrumb(index)\"\n            >\n              {{ crumb.label }}\n            </button>\n            <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n          </template>\n        </div>\n      </div>\n\n      <div class=\"flex flex-wrap items-center gap-2\">\n        <input\n          type=\"text\"\n          v-model=\"newSubfolderName\"\n          :placeholder=\"__('New sub-folder name')\"\n          class=\"flex-1 rounded border border-outline-gray-3 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none\"\n        />\n        <Button size=\"sm\" @click=\"createSubfolder\">\n          {{ __('Create Sub-folder') }}\n        </Button>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders yet.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"folder in subfolders\"\n            :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <button\n              type=\"button\"\n              class=\"flex-1 text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\"\n            >\n              {{ folder.file_name }}\n            </button>\n          </li>\n        </ul>\n      </div>\n\n      <div>\n        <h5 class=\"mb-2 text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files found in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"file in files\"\n            :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <a\n              :href=\"file.file_url\"\n              download\n              class=\"flex-1 truncate text-sm text-blue-600 hover:underline\"\n            >\n              {{ file.file_name }}\n            </a>\n            <Tooltip :text=\"__('Delete File')\" placement=\"bottom\">\n              <Trash2\n                @click.prevent=\"removeFile(file.file_url)\"\n                class=\"h-4 w-4 cursor-pointer text-red-500\"\n              />\n            </Tooltip>\n          </li>\n        </ul>\n      </div>\n\n      <div\n        class=\"rounded-md border-2 border-dashed border-outline-gray-3 p-6 text-center text-sm transition-colors duration-200 hover:border-outline-gray-4\"\n        :class=\"{ 'bg-blue-50 border-blue-500 text-blue-700': isDragActive }\"\n        @dragenter.prevent.stop=\"onDragEnter\"\n        @dragover.prevent.stop=\"onDragOver\"\n        @dragleave.prevent.stop=\"onDragLeave\"\n        @drop.prevent.stop=\"onDrop\"\n        @click=\"triggerFileSelect\"\n      >\n        <p class=\"font-medium\">{{ __('Drop files here or click to upload') }}</p>\n        <p class=\"mt-1 text-ink-gray-6\">\n          {{ __('Files will be added to') }} {{ currentFolderName }}\n        </p>\n        <input ref=\"fileInputRef\" type=\"file\" class=\"hidden\" multiple @change=\"uploadFiles\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { createResource, Button, Tooltip } from 'frappe-ui';\nimport { onMounted, ref, watch } from 'vue';\nimport Link from '@/components/Controls/Link.vue';\nimport { FolderTool } from '@/utils/foldertool'; // Corrected to named import\nimport { useRoute } from 'vue-router';\nimport { Trash2 } from 'lucide-vue-next';\n\nconst route = useRoute();\n\nconst folderAction = ref('select');\nconst selectedFolder = ref(null);\nconst foldername = ref(''); // Declare foldername globally\nconst newFolderName = ref('');\nconst files = ref([]);\nconst folders = ref([]);\nconst course = ref(null);\nconst currentFolderId = ref(null);\nconst currentFolderName = ref('');\nconst breadcrumbStack = ref([]);\nconst subfolders = ref([]);\nconst isDragActive = ref(false);\nconst newSubfolderName = ref('');\nconst fileInputRef = ref(null);\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  );\n};\n\nconst fetchCourse = async () => {\n  const courseName = route.params.courseName;\n  console.log(\"Course Name: \", courseName);\n  if (courseName) {\n    const resource = createResource({\n      url: 'frappe.client.get_value',\n      makeParams(values) {\n        return {\n          doctype: 'Course Schedule',\n          fieldname: 'course',\n          filters: {\n            name: courseName,\n          },\n        };\n      },\n    });\n    const result = await resource.fetch(); // Wait for the resource to fetch data\n    course.value = result.course; // Assign the fetched course value\n    console.log(\"Fetched Course: \", course.value);\n  } else {\n    console.error(\"Course name not found in route params\");\n  return null;\n}};\n\nconst props = defineProps({\n  onAddition: {\n    type: Function,\n    required: false,\n  },\n  initialFolder: {\n    type: String,\n    default: null,\n  },\n})\n\nconst addFolder = () => {\n  if (!foldername.value) {\n    return;\n  }\n\n  const folder = foldername.value;\n  if (typeof props.onAddition === 'function') {\n    props.onAddition(folder);\n  }\n};\n\nconst initializeFromFolder = async (folderLabel, { refreshFolders = true } = {}) => {\n  const targetFolder = folderLabel?.trim();\n  if (!targetFolder) {\n    return;\n  }\n\n  if (refreshFolders || !folders.value.length) {\n    await fetchFolders();\n  }\n\n  const matchingFolder = folders.value.find(\n    (folder) => folder.foldername === targetFolder || folder.name === targetFolder\n  );\n\n  if (matchingFolder) {\n    if (selectedFolder.value !== matchingFolder.name) {\n      selectedFolder.value = matchingFolder.name;\n    }\n    return;\n  }\n\n  foldername.value = targetFolder;\n  currentFolderName.value = targetFolder;\n  breadcrumbStack.value = [\n    {\n      id: null,\n      label: targetFolder,\n      folderName: targetFolder,\n    },\n  ];\n  await fetchFiles({ folderLabel: targetFolder });\n  breadcrumbStack.value = [\n    {\n      id: currentFolderId.value,\n      label: currentFolderName.value || targetFolder,\n      folderName: foldername.value || targetFolder,\n    },\n  ];\n};\n\nconst fetchFolders = async () => {\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    return [];\n  }\n\n  const foldersResource = createResource({\n    url: 'frappe.client.get_list',\n    makeParams() {\n      return {\n        doctype: 'Course Folder',\n        filters: {\n          course: course.value,\n        },\n        fields: ['name', 'foldername', 'file_reference', 'parent_folder'],\n      };\n    },\n  });\n\n  const result = await foldersResource.fetch();\n  folders.value = result;\n  return folders.value;\n};\n\nconst createFolder = async () => {\n  if (!newFolderName.value) {\n    alert('Folder name is required');\n    return;\n  }\n\n  if (!course.value) {\n    await fetchCourse();\n  }\n\n  if (!course.value) {\n    alert('Please select a course before creating a folder.');\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    const folder = await tool.createCourseFolder(course.value, newFolderName.value);\n\n    folders.value.push({\n      name: folder.name,\n      foldername: folder.foldername,\n      file_reference: folder.file_reference,\n      parent_folder: folder.parent_folder,\n    });\n    foldername.value = folder.foldername;\n    currentFolderId.value = folder.file_reference;\n    currentFolderName.value = folder.foldername;\n    selectedFolder.value = folder.name;\n    breadcrumbStack.value = [\n      {\n        id: currentFolderId.value,\n        label: currentFolderName.value,\n        folderName: folder.foldername,\n      },\n    ];\n    folderAction.value = 'select';\n    newFolderName.value = '';\n    await fetchFiles({ folderId: currentFolderId.value, folderLabel: currentFolderName.value });\n  } catch (error) {\n    console.error('Error creating folder:', error);\n    alert(error.message || 'Failed to create folder.');\n  }\n};\n\nconst fetchFiles = async ({ folderId, folderLabel } = {}) => {\n  const targetFolderId = folderId ?? currentFolderId.value;\n  const targetFolderLabel = folderLabel ?? currentFolderName.value ?? foldername.value;\n\n  if (!targetFolderId && !targetFolderLabel) {\n    console.warn('No folder selected for fetching files.');\n    return;\n  }\n\n  try {\n    const FilesInFolder = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params: {\n        folder_id: targetFolderId,\n        foldername: targetFolderLabel,\n      },\n      auto: true,\n    });\n    const result = await FilesInFolder.fetch();\n    const entries = result?.entries || [];\n\n    subfolders.value = entries.filter((entry) => entry.is_folder);\n    files.value = entries.filter((entry) => !entry.is_folder);\n\n    currentFolderId.value = result?.folder_id || targetFolderId;\n    currentFolderName.value = result?.folder_name || targetFolderLabel;\n  foldername.value = currentFolderName.value;\n\n  } catch (error) {\n    console.error('Error fetching files:', error);\n    subfolders.value = [];\n    files.value = [];\n  }\n};\n\nconst uploadFiles = async (event, droppedFiles = null) => {\n  const fileList = droppedFiles || event?.target?.files;\n  if (!fileList || !fileList.length) {\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n\n  try {\n    const formData = new FormData();\n    for (const file of fileList) {\n      formData.append('files', file);\n    }\n    if (currentFolderId.value) {\n      formData.append('folder_id', currentFolderId.value);\n    }\n    if (currentFolderName.value) {\n      formData.append('foldername', currentFolderName.value);\n    }\n\n    const csrfToken = getCsrfToken();\n    if (!csrfToken) {\n      alert('Session expired. Refresh the page and try again.');\n      return;\n    }\n\n    const response = await fetch('/api/method/seminary.api.folder_upload.upload_folder', {\n      method: 'POST',\n      body: formData,\n      headers: {\n        'X-Frappe-CSRF-Token': csrfToken,\n      },\n      credentials: 'include',\n    });\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({}));\n      console.error('Error uploading files:', error);\n      alert(`Error: ${error.message || 'Failed to upload files.'}`);\n      return;\n    }\n\n    console.log('Files uploaded successfully.');\n    if (event?.target) {\n      event.target.value = '';\n    }\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error uploading files:', error);\n    alert('An error occurred while uploading files.');\n  } finally {\n    isDragActive.value = false;\n  }\n};\n\nconst removeFile = async (fileUrl) => {\n  const csrfToken = getCsrfToken();\n  if (!csrfToken) {\n    alert('Session expired. Refresh the page and try again.');\n    return;\n  }\n  await fetch('/api/method/seminary.api.folder_upload.delete_file', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Frappe-CSRF-Token': csrfToken,\n      },\n      body: JSON.stringify({ file_url: fileUrl }),\n      credentials: 'include',\n    }).then((response) => response.json());\n\n  await fetchFiles();\n};\n\nconst onDragEnter = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  isDragActive.value = true;\n};\n\nconst onDragOver = (event) => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    return;\n  }\n  event.preventDefault();\n  event.stopPropagation();\n  event.dataTransfer.dropEffect = 'copy';\n  isDragActive.value = true;\n};\n\nconst onDragLeave = (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  isDragActive.value = false;\n};\n\nconst onDrop = async (event) => {\n  event.preventDefault();\n  event.stopPropagation();\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder before uploading.');\n    return;\n  }\n  const droppedFiles = event.dataTransfer?.files;\n  if (droppedFiles?.length) {\n    await uploadFiles(null, droppedFiles);\n  }\n  isDragActive.value = false;\n};\n\nconst triggerFileSelect = () => {\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n  fileInputRef.value?.click();\n};\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return;\n  }\n  breadcrumbStack.value = [\n    ...breadcrumbStack.value,\n    {\n      id: folder.name,\n      label: folder.file_name,\n      folderName: folder.file_name,\n    },\n  ];\n  currentFolderId.value = folder.name;\n  currentFolderName.value = folder.file_name;\n  await fetchFiles({ folderId: folder.name, folderLabel: folder.file_name });\n};\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return;\n  }\n  const target = breadcrumbStack.value[index];\n  breadcrumbStack.value = breadcrumbStack.value.slice(0, index + 1);\n  currentFolderId.value = target.id;\n  currentFolderName.value = target.label;\n  foldername.value = target.folderName || target.label;\n  await fetchFiles({ folderId: target.id, folderLabel: target.folderName || target.label });\n};\n\nconst createSubfolder = async () => {\n  if (!newSubfolderName.value) {\n    alert('Sub-folder name is required.');\n    return;\n  }\n\n  if (!currentFolderId.value && !currentFolderName.value) {\n    alert('Please select a folder first.');\n    return;\n  }\n\n  try {\n    const tool = new FolderTool({ data: {}, readOnly: false });\n    await tool.createSubfolder({\n      parentFolderId: currentFolderId.value,\n      parentFolderName: currentFolderName.value,\n      subfolderName: newSubfolderName.value,\n    });\n\n    newSubfolderName.value = '';\n    await fetchFiles();\n  } catch (error) {\n    console.error('Error creating sub-folder:', error);\n    alert(error.message || 'Failed to create sub-folder.');\n  }\n};\n\n// Watch selectedFolder and update folder state\nwatch(selectedFolder, async (newFolder) => {\n  if (newFolder) {\n    try {\n      const resource = createResource({\n        url: 'frappe.client.get_value',\n        makeParams() {\n          return {\n            doctype: 'Course Folder',\n            fieldname: ['foldername', 'file_reference', 'parent_folder'],\n            filters: {\n              name: newFolder,\n            },\n          };\n        },\n      });\n      const result = await resource.fetch();\n      foldername.value = result?.foldername || '';\n      currentFolderId.value = result?.file_reference || null;\n      currentFolderName.value = result?.foldername || '';\n      breadcrumbStack.value = [\n        {\n          id: currentFolderId.value,\n          label: currentFolderName.value,\n          folderName: foldername.value,\n        },\n      ];\n      addFolder();\n      await fetchFiles({\n        folderId: currentFolderId.value,\n        folderLabel: currentFolderName.value,\n      });\n    } catch (error) {\n      console.error('Error fetching foldername:', error);\n    }\n  } else {\n    foldername.value = '';\n    currentFolderId.value = null;\n    currentFolderName.value = '';\n    breadcrumbStack.value = [];\n    subfolders.value = [];\n    files.value = [];\n  }\n});\n\nlet hasMounted = false;\n\nonMounted(async () => {\n  hasMounted = true;\n  await fetchCourse();\n  await fetchFolders();\n  if (props.initialFolder) {\n    await initializeFromFolder(props.initialFolder, { refreshFolders: false });\n  }\n});\n\nwatch(\n  () => props.initialFolder,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return;\n    }\n    const trimmedValue = newValue?.trim();\n    const previous = oldValue?.trim();\n    if (!trimmedValue || trimmedValue === previous) {\n      return;\n    }\n    await initializeFromFolder(trimmedValue);\n  }\n);\n</script>\n\n<style scoped>\n.Folder {\n  margin: 20px;\n  border: 2px solid #ccc;\n  padding: 10px;\n  border-radius: 5px;\n}\n</style>\n","<template>\n  <div class=\"flex flex-col gap-4 rounded-lg border-2 border-gray-200 p-4 mb-4\">\n    <div class=\"flex flex-col gap-1\">\n      <h4 class=\"text-lg font-semibold text-ink-gray-9\">{{ currentFolderName || folderName }}</h4>\n      <div class=\"text-sm text-ink-gray-6 flex flex-wrap items-center gap-1\" v-if=\"breadcrumbStack.length\">\n        <template v-for=\"(crumb, index) in breadcrumbStack\" :key=\"crumb.id || `${crumb.label}-${index}`\">\n          <button\n            type=\"button\"\n            class=\"rounded px-1.5 py-0.5 transition hover:bg-ink-gray-2 hover:text-ink-gray-9\"\n            :class=\"index === breadcrumbStack.length - 1 ? 'font-medium text-ink-gray-8 cursor-default' : 'text-ink-gray-7'\"\n            @click=\"index === breadcrumbStack.length - 1 ? null : navigateToBreadcrumb(index)\"\n          >\n            {{ crumb.label }}\n          </button>\n          <span v-if=\"index < breadcrumbStack.length - 1\">/</span>\n        </template>\n      </div>\n    </div>\n\n    <div v-if=\"errorMessage\" class=\"rounded border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700\">\n      {{ errorMessage }}\n    </div>\n    <div v-else-if=\"isLoading\" class=\"text-sm text-ink-gray-6\">\n      {{ __('Loading folder contents') }}\n    </div>\n    <template v-else>\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Sub-folders') }}</h5>\n        <div v-if=\"!subfolders.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No sub-folders in this location.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"folder in subfolders\"\n            :key=\"folder.name\"\n            class=\"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <button\n              type=\"button\"\n              class=\"text-left text-sm font-medium text-blue-600 hover:underline\"\n              @click=\"openSubfolder(folder)\"\n            >\n              {{ folder.file_name }}\n            </button>\n            <span class=\"text-xs text-ink-gray-5\">{{ __('Folder') }}</span>\n          </li>\n        </ul>\n      </section>\n\n      <section class=\"space-y-2\">\n        <h5 class=\"text-sm font-semibold text-ink-gray-9\">{{ __('Files') }}</h5>\n        <div v-if=\"!files.length\" class=\"text-sm text-ink-gray-5\">\n          {{ __('No files available in this folder.') }}\n        </div>\n        <ul v-else class=\"space-y-2\">\n          <li\n            v-for=\"file in files\"\n            :key=\"file.file_url || file.name\"\n            class=\"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3\"\n          >\n            <a :href=\"file.file_url\" download class=\"flex-1 truncate text-sm text-blue-600 hover:underline\">\n              {{ file.file_name }}\n            </a>\n            <span class=\"text-xs text-ink-gray-5\">{{ humanFileSize(file.file_size) }}</span>\n          </li>\n        </ul>\n      </section>\n    </template>\n  </div>\n</template>\n\n<script setup>\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { createResource } from 'frappe-ui'\n\nconst props = defineProps({\n  folder: {\n    type: [Object, String],\n    required: true,\n  },\n})\n\nconst folderName = computed(() => {\n  if (typeof props.folder === 'string') {\n    return props.folder\n  }\n  if (props.folder && typeof props.folder === 'object') {\n    return props.folder.folder || props.folder.foldername || ''\n  }\n  return ''\n})\n\nconst isLoading = ref(false)\nconst errorMessage = ref('')\nconst files = ref([])\nconst subfolders = ref([])\nconst currentFolderId = ref(null)\nconst currentFolderName = ref('')\nconst breadcrumbStack = ref([])\nlet hasMounted = false\n\nconst humanFileSize = (value) => {\n  if (!value && value !== 0) {\n    return ''\n  }\n  const size = Number(value)\n  if (Number.isNaN(size)) {\n    return ''\n  }\n  if (size >= 1048576) {\n    return `${(size / 1048576).toFixed(2)} MB`\n  }\n  if (size >= 1024) {\n    return `${(size / 1024).toFixed(2)} KB`\n  }\n  return `${size} B`\n}\n\nconst buildParams = ({ folderId = null, folderLabel = null }) => {\n  const params = {}\n  if (folderId) {\n    params.folder_id = folderId\n  }\n  const labelCandidate = folderLabel ?? folderName.value\n  if (!folderId && labelCandidate) {\n    params.foldername = labelCandidate\n  }\n  return params\n}\n\nconst loadFolder = async ({ folderId = null, folderLabel = null } = {}) => {\n  const params = buildParams({ folderId, folderLabel })\n  if (!params.folder_id && !params.foldername) {\n    return null\n  }\n  isLoading.value = true\n  errorMessage.value = ''\n\n  try {\n    const resource = createResource({\n      url: 'seminary.api.folder_upload.get_files_in_folder',\n      params,\n      auto: true,\n    })\n    const result = await resource.fetch()\n    const entries = result?.entries || []\n    subfolders.value = entries.filter((entry) => entry.is_folder)\n    files.value = entries.filter((entry) => !entry.is_folder)\n    currentFolderId.value = result?.folder_id || folderId || null\n    currentFolderName.value = result?.folder_name || folderLabel || folderName.value || ''\n    return {\n      id: currentFolderId.value,\n      label: currentFolderName.value,\n    }\n  } catch (error) {\n    console.error('Error fetching folder contents:', error)\n    errorMessage.value = error?.message || __('Unable to load folder contents.')\n    subfolders.value = []\n    files.value = []\n    return null\n  } finally {\n    isLoading.value = false\n  }\n}\n\nconst openRootFolder = async () => {\n  const root = await loadFolder({ folderLabel: folderName.value })\n  if (root) {\n    breadcrumbStack.value = [root]\n  }\n}\n\nconst openSubfolder = async (folder) => {\n  if (!folder?.name) {\n    return\n  }\n  const crumb = await loadFolder({ folderId: folder.name, folderLabel: folder.file_name })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value, crumb]\n  }\n}\n\nconst navigateToBreadcrumb = async (index) => {\n  if (index < 0 || index >= breadcrumbStack.value.length) {\n    return\n  }\n  const target = breadcrumbStack.value[index]\n  const crumb = await loadFolder({ folderId: target.id, folderLabel: target.label })\n  if (crumb) {\n    breadcrumbStack.value = [...breadcrumbStack.value.slice(0, index), crumb]\n  }\n}\n\nonMounted(async () => {\n  hasMounted = true\n  await openRootFolder()\n})\n\nwatch(\n  () => folderName.value,\n  async (newValue, oldValue) => {\n    if (!hasMounted) {\n      return\n    }\n    const trimmed = (newValue || '').trim()\n    const previous = (oldValue || '').trim()\n    if (!trimmed || trimmed === previous) {\n      return\n    }\n    await openRootFolder()\n  },\n)\n</script>\n","import { h, createApp } from 'vue';\nimport FolderPlugin from '@/components/FolderPlugin.vue';\nimport FolderBlock from '@/components/FolderBlock.vue';\nimport { FolderOpen } from 'lucide-vue-next';\nimport translationPlugin from '../translation'\nimport router from '@/router'\n\nconst getCsrfToken = () => {\n  if (typeof window === 'undefined') {\n    return null\n  }\n  return (\n    window.csrf_token ||\n    window.frappe?.csrf_token ||\n    document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') ||\n    null\n  )\n}\n\nexport class FolderTool {\n  constructor({ data, api, readOnly }) {\n    this.data = data;\n    this.readOnly = readOnly\n    this.api = api;\n    this.wrapper = undefined;\n    this.vueApp = null;\n  }\n\n  static get toolbox() {\n    const app = createApp({\n      render: () =>\n        h(FolderOpen, { size: 18, strokeWidth: 1.5, color: 'black' }),\n    });\n\n    const div = document.createElement('div');\n    app.mount(div);\n\n    return {\n      title: 'Folder',\n      icon: div.innerHTML,\n    };\n  }\n\tstatic get isReadOnlySupported() {\n\t\treturn true\n\t}\n\n  render() {\n    this.wrapper = document.createElement('div')\n    if (this.data && this.data.folder) {\n      this.renderFolder(this.data.folder)\n    } else {\n      this.renderFolderModal()\n    }\n    return this.wrapper\n  }\n\n  destroyApp() {\n    if (this.vueApp) {\n      this.vueApp.unmount()\n      this.vueApp = null\n    }\n    if (this.wrapper) {\n      this.wrapper.innerHTML = ''\n    }\n  }\n\n  renderFolder(folderName) {\n    if (this.readOnly) {\n      this.destroyApp()\n      this.vueApp = createApp(FolderBlock, {\n        folder: folderName,\n      })\n      this.vueApp.use(translationPlugin)\n      this.vueApp.use(router)\n      this.vueApp.mount(this.wrapper)\n      return\n    }\n    this.renderFolderModal(folderName)\n  }\n\n  renderFolderModal(initialFolder = null) {\n    if (this.readOnly) {\n      return\n    }\n    this.destroyApp()\n    this.vueApp = createApp(FolderPlugin, {\n      initialFolder,\n      onAddition: (folder) => {\n        if (!this.data) {\n          this.data = {}\n        }\n        this.data.folder = folder\n      },\n    })\n    this.vueApp.use(translationPlugin)\n    this.vueApp.use(router)\n    this.vueApp.mount(this.wrapper)\n  }\n  \n    save(blockContent) {\n      return {\n        folder: this.data?.folder,\n      }\n    }\n\n    destroy() {\n      this.destroyApp()\n    }\n\n    async createCourseFolder(courseName, folderName) {\n      const trimmedFolderName = folderName?.trim()\n      if (!trimmedFolderName) {\n        throw new Error('Folder name is required to create a course folder')\n      }\n      if (!courseName) {\n        throw new Error('Course is required to create a course folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/resource/Course Folder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          course: courseName,\n          foldername: trimmedFolderName,\n        }),\n      })\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create course folder')\n      }\n\n      const data = responseData?.data || responseData\n      if (!this.data) {\n        this.data = {}\n      }\n      this.data.folder = data?.foldername || trimmedFolderName\n      return data\n    }\n\n    async createSubfolder({ parentFolderId, parentFolderName, subfolderName }) {\n      const trimmedSubfolderName = subfolderName?.trim()\n      if (!trimmedSubfolderName) {\n        throw new Error('Sub-folder name is required')\n      }\n\n      if (!parentFolderId && !parentFolderName) {\n        throw new Error('Parent folder information is required to create a sub-folder')\n      }\n\n      const csrfToken = getCsrfToken()\n      if (!csrfToken) {\n        throw new Error('CSRF token not found. Please refresh the page and try again.')\n      }\n\n      let responseData\n      const response = await fetch('/api/method/seminary.api.folder_upload.create_subfolder', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n          'X-Frappe-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          parent_folder_id: parentFolderId,\n          parent_foldername: parentFolderName,\n          subfoldername: trimmedSubfolderName,\n        }),\n      })\n\n      try {\n        responseData = await response.json()\n      } catch (error) {\n        responseData = null\n      }\n\n      if (!response.ok) {\n        const serverMessage = responseData?.message || responseData?.exc || response.statusText\n        throw new Error(serverMessage || 'Failed to create sub-folder')\n      }\n\n      return responseData?.message || responseData?.data || responseData\n    }\n  }","import { toast } from 'frappe-ui'\nimport { useTimeAgo } from '@vueuse/core'\nimport { Quiz } from '@/utils/quiz'\nimport { Assignment } from '@/utils/assignment'\nimport { Exam} from '@/utils/exam'\nimport { DiscussionActivity } from '@/utils/discussionactivity'\nimport { Upload } from '@/utils/upload'\nimport { Markdown } from '@/utils/markdownParser'\nimport Header from '@editorjs/header'\nimport Paragraph from '@editorjs/paragraph'\nimport { CodeBox } from '@/utils/code'\nimport NestedList from '@editorjs/nested-list'\nimport InlineCode from '@editorjs/inline-code'\nimport { watch } from 'vue'\nimport dayjs from '@/utils/dayjs'\nimport Embed from '@editorjs/embed'\nimport SimpleImage from '@editorjs/simple-image'\nimport Table from '@editorjs/table'\nimport { FolderTool } from '@/utils/foldertool'\n\nexport function createToast(options) {\n\ttoast({\n\t\tposition: 'bottom-right',\n\t\t...options,\n\t})\n}\n\nexport function timeAgo(date) {\n\treturn useTimeAgo(date).value\n}\n\nexport function formatTime(timeString) {\n\tif (!timeString) return ''\n\tconst [hour, minute] = timeString.split(':').map(Number)\n\n\t// Create a Date object with dummy values for day, month, and year\n\tconst dummyDate = new Date(0, 0, 0, hour, minute)\n\n\t// Use Intl.DateTimeFormat to format the time in 12-hour format\n\tconst formattedTime = new Intl.DateTimeFormat('en-US', {\n\t\thour: 'numeric',\n\t\tminute: 'numeric',\n\t\thour12: true,\n\t}).format(dummyDate)\n\n\treturn formattedTime\n}\n\nexport function formatNumber(number) {\n\treturn number.toLocaleString('en-IN', {\n\t\tmaximumFractionDigits: 0,\n\t})\n}\n\nexport function formatNumberIntoCurrency(number, currency) {\n\tif (number) {\n\t\treturn number.toLocaleString('en-IN', {\n\t\t\tmaximumFractionDigits: 0,\n\t\t\tstyle: 'currency',\n\t\t\tcurrency: currency,\n\t\t})\n\t}\n\treturn ''\n}\n\n// create a function that formats numbers in thousands to k\n\nexport function formatAmount(amount) {\n\tif (amount > 999) {\n\t\treturn (amount / 1000).toFixed(1) + 'k'\n\t}\n\treturn amount\n}\n\nexport function convertToTitleCase(str) {\n\tif (!str) {\n\t\treturn ''\n\t}\n\n\treturn str\n\t\t.toLowerCase()\n\t\t.split(' ')\n\t\t.map(function (word) {\n\t\t\treturn word.charAt(0).toUpperCase().concat(word.substr(1))\n\t\t})\n\t\t.join(' ')\n}\nexport function getFileSize(file_size) {\n\tlet value = parseInt(file_size)\n\tif (value > 1048576) {\n\t\treturn (value / 1048576).toFixed(2) + 'M'\n\t} else if (value > 1024) {\n\t\treturn (value / 1024).toFixed(2) + 'K'\n\t}\n\treturn value\n}\n\nexport function showToast(title, text, icon, iconClasses = null) {\n\tif (!iconClasses) {\n\t\tif (icon == 'check') {\n\t\t\ticonClasses = 'bg-surface-green-3 text-ink-white rounded-md p-px'\n\t\t} else if (icon == 'alert-circle') {\n\t\t\ticonClasses = 'bg-yellow-600 text-ink-white rounded-md p-px'\n\t\t} else {\n\t\t\ticonClasses = 'bg-surface-red-5 text-ink-white rounded-md p-px'\n\t\t}\n\t}\n\tcreateToast({\n\t\ttitle: title,\n\t\ttext: htmlToText(text),\n\t\ticon: icon,\n\t\ticonClasses: iconClasses,\n\t\tposition: icon == 'check' ? 'bottom-right' : 'top-center',\n\t\ttimeout: 5,\n\t})\n}\n\nexport function getImgDimensions(imgSrc) {\n\treturn new Promise((resolve) => {\n\t\tlet img = new Image()\n\t\timg.onload = function () {\n\t\t\tlet { width, height } = img\n\t\t\tresolve({ width, height, ratio: width / height })\n\t\t}\n\t\timg.src = imgSrc\n\t})\n}\n\nexport function updateDocumentTitle(meta) {\n\twatch(\n\t\t() => meta,\n\t\t(meta) => {\n\t\t\tif (!meta.value.title) return\n\t\t\tif (meta.value.title && meta.value.subtitle) {\n\t\t\t\tdocument.title = `${meta.value.title} | ${meta.value.subtitle}`\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (meta.value.title) {\n\t\t\t\tdocument.title = `${meta.value.title}`\n\t\t\t\treturn\n\t\t\t}\n\t\t},\n\t\t{ immediate: true, deep: true }\n\t)\n}\n\nexport function htmlToText(html) {\n\tconst div = document.createElement('div')\n\tdiv.innerHTML = html\n\treturn div.textContent || div.innerText || ''\n}\n\nexport function getEditorTools() {\n\treturn {\n\t\theader: {\n\t\t\tclass: Header,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Header',\n\t\t\t},\n\t\t},\n\t\tassignment: Assignment,\n\t\tquiz: Quiz,\n\t\texam: Exam,\n\t\tdiscussionActivity: DiscussionActivity,\n\t\tupload: Upload,\n\t\tmarkdown: {\n\t\t\tclass: Markdown,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\timage: SimpleImage,\n\t\ttable: {\n\t\t\tclass: Table,\n\t\t\tinlineToolbar: true,\n\t\t},\n\t\tparagraph: {\n\t\t\tclass: Paragraph,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tpreserveBlank: true,\n\t\t\t},\n\t\t},\n\t\tcodeBox: {\n\t\t\tclass: CodeBox,\n\t\t\tconfig: {\n\t\t\t\tthemeURL:\n\t\t\t\t\t'https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-dark.min.css',\n\t\t\t\tthemeName: 'atom-one-dark',\n\t\t\t\tuseDefaultTheme: 'dark',\n\t\t\t},\n\t\t},\n\t\tlist: {\n\t\t\tclass: NestedList,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tdefaultStyle: 'ordered',\n\t\t\t},\n\t\t},\n\t\tinlineCode: {\n\t\t\tclass: InlineCode,\n\t\t\tshortcut: 'CMD+SHIFT+M',\n\t\t},\n\t\tembed: {\n\t\t\tclass: Embed,\n\t\t\tinlineToolbar: true,\n\t\t\tconfig: {\n\t\t\t\tservices: {\n\t\t\t\t\tyoutube: {\n\t\t\t\t\t\tregex: /(?:https?:\\/\\/)?(?:www\\.)?(?:(?:youtu\\.be\\/)|(?:youtube\\.com)\\/(?:v\\/|u\\/\\w\\/|embed\\/|watch))(?:(?:\\?v=)?([^#&?=]*))?((?:[?&]\\w*=\\w*)*)/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.youtube.com/embed/<%= remote_id %>',\n\t\t\t\t\t\thtml: '<iframe style=\"width:100%; height: 30rem;\" frameborder=\"0\" allowfullscreen></iframe>',\n\t\t\t\t\t\theight: 320,\n\t\t\t\t\t\twidth: 580,\n\t\t\t\t\t\tid: ([id, params]) => {\n\t\t\t\t\t\t\tif (!params && id) {\n\t\t\t\t\t\t\t\treturn id\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst paramsMap = {\n\t\t\t\t\t\t\t\tstart: 'start',\n\t\t\t\t\t\t\t\tend: 'end',\n\t\t\t\t\t\t\t\tt: 'start',\n\t\t\t\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\t\t\t\ttime_continue: 'start',\n\t\t\t\t\t\t\t\tlist: 'list',\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet newParams = params\n\t\t\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t\t\t.split('&')\n\t\t\t\t\t\t\t\t.map((param) => {\n\t\t\t\t\t\t\t\t\tconst [name, value] = param.split('=')\n\n\t\t\t\t\t\t\t\t\tif (!id && name === 'v') {\n\t\t\t\t\t\t\t\t\t\tid = value\n\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (!paramsMap[name]) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tvalue === 'LL' ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('RDMM') ||\n\t\t\t\t\t\t\t\t\t\tvalue.startsWith('FL')\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn `${paramsMap[name]}=${value}`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.filter((param) => !!param)\n\n\t\t\t\t\t\t\treturn id + '?' + newParams.join('&')\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tvimeo: true,\n\t\t\t\t\tcodepen: true,\n\t\t\t\t\taparat: {\n\t\t\t\t\t\tregex: /(?:http[s]?:\\/\\/)?(?:www.)?aparat\\.com\\/v\\/([^\\/\\?\\&]+)\\/?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame',\n\t\t\t\t\t\thtml: '<iframe style=\"margin: 0 auto; width: 100%; height: 25rem;\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe>',\n\t\t\t\t\t\theight: 300,\n\t\t\t\t\t\twidth: 600,\n\t\t\t\t\t},\n\t\t\t\t\tgithub: true,\n\t\t\t\t\tslides: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/pub/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdrive: {\n\t\t\t\t\t\tregex: /https:\\/\\/drive\\.google\\.com\\/file\\/d\\/([A-Za-z0-9_-]+)\\/view(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://drive.google.com/file/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 25rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tdocsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/document\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/document/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tsheetsPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/spreadsheets\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/spreadsheets/d/<%= remote_id %>/preview',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tslidesPublic: {\n\t\t\t\t\t\tregex: /https:\\/\\/docs\\.google\\.com\\/presentation\\/d\\/([A-Za-z0-9_-]+)\\/edit(\\?.+)?/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://docs.google.com/presentation/d/<%= remote_id %>/embed',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0;' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t\tcodesandbox: {\n\t\t\t\t\t\tregex: /^https:\\/\\/codesandbox\\.io\\/(?:embed\\/)?([A-Za-z0-9_-]+)(?:\\?[^\\/]*)?$/,\n\t\t\t\t\t\tembedUrl:\n\t\t\t\t\t\t\t'https://codesandbox.io/embed/<%= remote_id %>?view=editor+%2B+preview&module=%2Findex.html',\n\t\t\t\t\t\thtml: \"<iframe style='width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;' sandbox='allow-mods allow-forms allow-popups allow-scripts allow-same-origin' frameborder='0' allowfullscreen='true'></iframe>\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tfolder: {\n\t\t\tclass: FolderTool,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: 'Add a folder with files',\n\t\t\t\tuploadEndpoint: '/api/upload-folder', // Example endpoint for folder uploads\n\t\t\t\trenderFiles: (files) => {\n\t\t\t\t\treturn files.map(file => `<a href=\"${file.url}\" download>${file.name}</a>`).join('<br>');\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t}\n}\n\nexport function getTimezones() {\n\treturn [\n\t\t'Pacific/Midway',\n\t\t'Pacific/Pago_Pago',\n\t\t'Pacific/Honolulu',\n\t\t'America/Anchorage',\n\t\t'America/Vancouver',\n\t\t'America/Los_Angeles',\n\t\t'America/Tijuana',\n\t\t'America/Edmonton',\n\t\t'America/Denver',\n\t\t'America/Phoenix',\n\t\t'America/Mazatlan',\n\t\t'America/Winnipeg',\n\t\t'America/Regina',\n\t\t'America/Chicago',\n\t\t'America/Mexico_City',\n\t\t'America/Guatemala',\n\t\t'America/El_Salvador',\n\t\t'America/Managua',\n\t\t'America/Costa_Rica',\n\t\t'America/Montreal',\n\t\t'America/New_York',\n\t\t'America/Indianapolis',\n\t\t'America/Panama',\n\t\t'America/Bogota',\n\t\t'America/Lima',\n\t\t'America/Halifax',\n\t\t'America/Puerto_Rico',\n\t\t'America/Caracas',\n\t\t'America/Santiago',\n\t\t'America/St_Johns',\n\t\t'America/Montevideo',\n\t\t'America/Araguaina',\n\t\t'America/Argentina/Buenos_Aires',\n\t\t'America/Godthab',\n\t\t'America/Sao_Paulo',\n\t\t'Atlantic/Azores',\n\t\t'Canada/Atlantic',\n\t\t'Atlantic/Cape_Verde',\n\t\t'UTC',\n\t\t'Etc/Greenwich',\n\t\t'Europe/Belgrade',\n\t\t'CET',\n\t\t'Atlantic/Reykjavik',\n\t\t'Europe/Dublin',\n\t\t'Europe/London',\n\t\t'Europe/Lisbon',\n\t\t'Africa/Casablanca',\n\t\t'Africa/Nouakchott',\n\t\t'Europe/Oslo',\n\t\t'Europe/Copenhagen',\n\t\t'Europe/Brussels',\n\t\t'Europe/Berlin',\n\t\t'Europe/Helsinki',\n\t\t'Europe/Amsterdam',\n\t\t'Europe/Rome',\n\t\t'Europe/Stockholm',\n\t\t'Europe/Vienna',\n\t\t'Europe/Luxembourg',\n\t\t'Europe/Paris',\n\t\t'Europe/Zurich',\n\t\t'Europe/Madrid',\n\t\t'Africa/Bangui',\n\t\t'Africa/Algiers',\n\t\t'Africa/Tunis',\n\t\t'Africa/Harare',\n\t\t'Africa/Nairobi',\n\t\t'Europe/Warsaw',\n\t\t'Europe/Prague',\n\t\t'Europe/Budapest',\n\t\t'Europe/Sofia',\n\t\t'Europe/Istanbul',\n\t\t'Europe/Athens',\n\t\t'Europe/Bucharest',\n\t\t'Asia/Nicosia',\n\t\t'Asia/Beirut',\n\t\t'Asia/Damascus',\n\t\t'Asia/Jerusalem',\n\t\t'Asia/Amman',\n\t\t'Africa/Tripoli',\n\t\t'Africa/Cairo',\n\t\t'Africa/Johannesburg',\n\t\t'Europe/Moscow',\n\t\t'Asia/Baghdad',\n\t\t'Asia/Kuwait',\n\t\t'Asia/Riyadh',\n\t\t'Asia/Bahrain',\n\t\t'Asia/Qatar',\n\t\t'Asia/Aden',\n\t\t'Asia/Tehran',\n\t\t'Africa/Khartoum',\n\t\t'Africa/Djibouti',\n\t\t'Africa/Mogadishu',\n\t\t'Asia/Dubai',\n\t\t'Asia/Muscat',\n\t\t'Asia/Baku',\n\t\t'Asia/Kabul',\n\t\t'Asia/Yekaterinburg',\n\t\t'Asia/Tashkent',\n\t\t'Asia/Calcutta',\n\t\t'Asia/Kathmandu',\n\t\t'Asia/Novosibirsk',\n\t\t'Asia/Almaty',\n\t\t'Asia/Dacca',\n\t\t'Asia/Krasnoyarsk',\n\t\t'Asia/Dhaka',\n\t\t'Asia/Bangkok',\n\t\t'Asia/Saigon',\n\t\t'Asia/Jakarta',\n\t\t'Asia/Irkutsk',\n\t\t'Asia/Shanghai',\n\t\t'Asia/Hong_Kong',\n\t\t'Asia/Taipei',\n\t\t'Asia/Kuala_Lumpur',\n\t\t'Asia/Singapore',\n\t\t'Australia/Perth',\n\t\t'Asia/Yakutsk',\n\t\t'Asia/Seoul',\n\t\t'Asia/Tokyo',\n\t\t'Australia/Darwin',\n\t\t'Australia/Adelaide',\n\t\t'Asia/Vladivostok',\n\t\t'Pacific/Port_Moresby',\n\t\t'Australia/Brisbane',\n\t\t'Australia/Sydney',\n\t\t'Australia/Hobart',\n\t\t'Asia/Magadan',\n\t\t'SST',\n\t\t'Pacific/Noumea',\n\t\t'Asia/Kamchatka',\n\t\t'Pacific/Fiji',\n\t\t'Pacific/Auckland',\n\t\t'Asia/Kolkata',\n\t\t'Europe/Kiev',\n\t\t'America/Tegucigalpa',\n\t\t'Pacific/Apia',\n\t]\n}\n\nexport function getUserTimezone() {\n\ttry {\n\t\tconst timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\t\tconst supportedTimezones = getTimezones()\n\n\t\tif (supportedTimezones.includes(timezone)) {\n\t\t\treturn timezone // e.g., 'Asia/Calcutta', 'America/New_York', etc.\n\t\t} else {\n\t\t\tthrow Error('unsupported timezone')\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('Error getting timezone:', error)\n\t\treturn null\n\t}\n}\n\nexport function getSidebarLinks() {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Courses',\n\t\t\ticon: 'BookOpen',\n\t\t\tto: 'Courses',\n\t\t\tactiveFor: [\n\t\t\t\t'Courses',\n\t\t\t\t'CourseDetail',\n\t\t\t\t'Lesson',\n\t\t\t\t'CourseForm',\n\t\t\t\t'LessonForm',\n\t\t\t],\n\t\t},\n\t\n\t\t{\n\t\t\tlabel: 'Statistics',\n\t\t\ticon: 'TrendingUp',\n\t\t\tto: 'Statistics',\n\t\t\tactiveFor: ['Statistics'],\n\t\t},\n\t]\n}\n\nexport function getFormattedDateRange(\n\tstartDate,\n\tendDate,\n\tformat = 'DD MMM YYYY'\n) {\n\tif (startDate === endDate) {\n\t\treturn dayjs(startDate).format(format)\n\t}\n\treturn `${dayjs(startDate).format(format)} - ${dayjs(endDate).format(\n\t\tformat\n\t)}`\n}\n\nexport function getLineStartPosition(string, position) {\n\tconst charLength = 1\n\tlet char = ''\n\n\twhile (char !== '\\n' && position > 0) {\n\t\tposition = position - charLength\n\t\tchar = string.substr(position, charLength)\n\t}\n\n\tif (char === '\\n') {\n\t\tposition += 1\n\t}\n\n\treturn position\n}\n\nexport function singularize(word) {\n\tconst endings = {\n\t\tves: 'fe',\n\t\ties: 'y',\n\t\ti: 'us',\n\t\tzes: 'ze',\n\t\tses: 's',\n\t\tes: 'e',\n\t\ts: '',\n\t}\n\treturn word.replace(\n\t\tnew RegExp(`(${Object.keys(endings).join('|')})$`),\n\t\t(r) => endings[r]\n\t)\n}\n\nexport const validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'webp'].includes(extension)) {\n\t\treturn __('Only image file is allowed.')\n\t}\n}\n\nexport const escapeHTML = (text) => {\n\tif (!text) return ''\n\tlet escape_html_mapping = {\n\t\t'&': '&amp;',\n\t\t'<': '&lt;',\n\t\t'>': '&gt;',\n\t\t'\"': '&quot;',\n\t\t\"'\": '&#39;',\n\t\t'`': '&#x60;',\n\t\t'=': '&#x3D;',\n\t}\n\n\treturn String(text).replace(\n\t\t/[&<>\"'`=]/g,\n\t\t(char) => escape_html_mapping[char] || char\n\t)\n}\n"],"names":["props","__props","progressBarWidth","computed","progressBarHeight","_createBlock","_unref","Tooltip","_createElementVNode","_hoisted_1","_normalizeClass","user","inject","fullQuizMode","ref","activeQuestion","currentQuestion","selectedOptions","reactive","showAnswers","questions","possibleAnswer","timer","timerInterval","router","useRouter","elapsedTime","answers","quiz","createResource","values","data","populateQuestions","setupTimer","err","isQuizLoaded","shuffledQuestions","shuffleArray","startTimer","submitQuiz","formatTimer","seconds","hrs","mins","secs","timerProgress","array","i","attempts","_a","_b","submission","index","timeAgo","watch","newData","resetQuiz","quizSubmission","timeTaken","all_questions_details","question","__spreadProps","__spreadValues","questionDetails","value","newName","q","startQuiz","startQuiz2","markAnswer","getAnswers","checkAnswer","createToast","option","addToLocalStorage","resetQuestion","quizData","questionData","answer","existingIndex","item","nextQuestion","createSubmission","submitQuizComplete","__async","results","detailedQuestions","response","call","is_correct","val","correctAnswers","correctAnswer","markLessonProgress","toast","getInstructions","recordAnswer","qtidx","toggleAnswer","quizResults","_createElementBlock","_hoisted_2","_hoisted_3","_toDisplayString","_openBlock","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_cache","_hoisted_10","_createVNode","ProgressBar","_hoisted_11","_hoisted_12","_hoisted_13","Button","_hoisted_15","_Fragment","_renderList","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_22","$event","idx","_hoisted_25","CheckCircle","MinusCircle","XCircle","_vShow","_hoisted_27","FormControl","_hoisted_28","Badge","_hoisted_29","TextEditor","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_38","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","redirectToLogin","Quiz","__","show","assignment","exam","discussionactivity","onMounted","nextTick","addAssessment","redirectToForm","Dialog","Link","close","api","readOnly","app","createApp","h","CircleHelp","div","QuizBlock","translationPlugin","userResource","usersStore","AssessmentPlugin","blockContent","submissionFile","comments","showTitle","isDirty","keyboardShortcut","e","submitAssignment","onBeforeUnmount","submissionResource","newSubmission","doc","showUploader","imageResource","createDocumentResource","newGrade","oldGrade","evaluator","_c","addNewSubmission","saveSubmission","file","courseName","chapterNumber","lessonNumber","getType","type","validateFile","extension","removeSubmission","canGradeSubmission","canModifyAssignment","submissionStatusOptions","statusTheme","_hoisted_14","FileText","X","FileUploader","uploading","progress","openFileSelector","_hoisted_21","_hoisted_23","_hoisted_24","_hoisted_26","Assignment","Pencil","AssignmentBlock","submisisonDetails","newDoc","formatTime","row","_mergeProps","$attrs","showTopics","_useModel","newReply","allUsers","mentionUsers","renderEditor","readOnlyMode","socketConnected","socket","initSocket","error","reason","replies","fetchMentionUsers","newReplyResource","postReply","editReplyResource","postEdited","reply","deleteReplyResource","deleteReply","onUnmounted","ChevronLeft","UserAvatar","Dropdown","_withCtx","open","MoreHorizontal","topics","topic","resetTopic","topicResource","replyResource","submitTopic","handleCancel","dialogOptions","singularize","getScrollContainer","currentTopic","showTopicModal","loading","isConnected","executeOnMountedLogic","singleTopicResource","scrollToEnd","scrollContainer","showReplies","openTopicModal","DiscussionModal","DiscussionReplies","MessageSquareText","fullExamMode","user_is_instructor","ensureAnswersInitialized","questionsList","existingAnswers","initialized","current","isExamLoaded","hasSubmittedExam","instructors","list","wasInstructor","instructor","is_instructor","timerStartTime","endTime","currentTime","remainingTime","submitExam","newAnswers","get_answers","rawAnswers","toRaw","questionName","updateAnswer","submittedAnswers","startExam","startExam2","submission_anystatus","Discussions","ExamGraded","_component_router_link","SquarePen","event","Exam","BookOpenCheck","ExamBlock","dayjs","dayjsModule","relativeTime","original_post","replyFiles","isStudent","studentGroups","selectedGroupFilter","Student","discussionID","owner","saveReplyAttachment","itemName","discussionReady","removeReplyAttachment","_removed","rest","__objRest","__restKey","canSubmitReply","reloadDiscussionLists","StudentData","savedsubmission","hasSavedSubmission","fetchStudentGroups","filteredDiscussions","submitDiscussion","discussion","post_before","formatDate","dateString","getFrappeDateTime","now","microseconds","handleReplySubmit","attachment","studentid","member_name","reply_dt","refreshDiscussionLists","all_discussions","hasData","filter_discussions","studentGroup","_d","_e","_f","hasFile","hasOriginalPost","allowedExtensions","canModifyDiscussion","newGroup","group","_vModelText","getFileSize","_hoisted_50","_hoisted_57","_hoisted_58","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_37","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_67","_hoisted_68","_hoisted_69","DiscussionActivity","MessagesSquare","discussionId","DiscussionActivityBlock","isPlaying","audio","isMuted","duration","togglePlay","toggleMute","changeCurrentTime","handleAudioEnd","time","minutes","newVal","Pause","Play","VolumeX","Volume2","videoRef","videoContainer","playing","muted","fileURL","isYoutube","url","playVideo","pauseVideo","videoEnded","toggleFullscreen","_ctx","args","Maximize","fileUploader","fileInput","addFile","Upload","UploadIcon","VideoBlock","AudioBlock","UploadPlugin","savedData","Markdown","config","CodeXml","block","level","previousLine","text","anchorTag","currentIndex","currentBlock","line","match","DEFAULT_THEMES","COMMON_LANGUAGES","CodeBox","__publicField","Code","codeAreaHolder","languageSelect","selectHolder","selectPreview","languages","language","selectItem","hljs","selectPreviews","len","highlightJSCSSElement","highlightJSCSSURL","link","head","themeURL","route","useRoute","folderAction","selectedFolder","foldername","newFolderName","files","folders","course","currentFolderId","currentFolderName","breadcrumbStack","subfolders","isDragActive","newSubfolderName","fileInputRef","getCsrfToken","fetchCourse","result","addFolder","folder","initializeFromFolder","_0","_1","folderLabel","refreshFolders","targetFolder","fetchFolders","matchingFolder","fetchFiles","createFolder","FolderTool","folderId","targetFolderId","targetFolderLabel","entries","entry","uploadFiles","droppedFiles","fileList","formData","csrfToken","removeFile","fileUrl","onDragEnter","onDragOver","onDragLeave","onDrop","triggerFileSelect","openSubfolder","navigateToBreadcrumb","target","createSubfolder","newFolder","hasMounted","newValue","oldValue","trimmedValue","previous","crumb","Trash2","_withModifiers","folderName","isLoading","errorMessage","humanFileSize","size","buildParams","params","labelCandidate","loadFolder","openRootFolder","root","trimmed","FolderOpen","FolderBlock","initialFolder","FolderPlugin","trimmedFolderName","responseData","serverMessage","parentFolderId","parentFolderName","subfolderName","trimmedSubfolderName","options","date","useTimeAgo","formatAmount","amount","file_size","updateDocumentTitle","meta","getEditorTools","Header","SimpleImage","Table","Paragraph","NestedList","InlineCode","Embed","id","paramsMap","newParams","param","name","word","endings","r"],"mappings":"2gEAgBA,MAAMA,EAAQC,EAWRC,EAAmBC,GAAS,IAE1B,GADqB,KAAK,IAAI,KAAK,KAAKH,EAAM,QAAQ,EAAG,GAAG,CACtC,GAC7B,EAEKI,EAAoBD,GAAS,IAAM,CACxC,GAAIH,EAAM,OAAS,KAClB,MAAO,MAER,GAAIA,EAAM,OAAS,KAClB,MAAO,MAER,GAAIA,EAAM,OAAS,KAClB,MAAO,KAET,CAAC,oBAzCAK,EAQUC,EAAAC,EAAA,EAAA,CARA,KAAI,GAAKP,EAAM,QAAQ,gBAChC,IAMM,CANNQ,EAMM,MANNC,GAMM,CALLD,EAIO,MAAA,CAHN,MAAKE,GAAA,CAAC,iCACEN,EAAA,KAAiB,CAAA,EACxB,gBAAgBF,EAAA,KAAgB,CAAA,o2DCmUrC,MAAMS,EAAOC,GAAO,OAAO,EACrBC,EAAeC,EAAI,EAAK,EACxBC,EAAiBD,EAAI,CAAC,EACtBE,EAAkBF,EAAI,EAAE,EACxBG,EAAkBC,GAAS,CAAC,EAAG,EAAG,EAAG,CAAC,CAAC,EACvCC,EAAcD,GAAS,CAAA,CAAE,EAC/B,IAAIE,EAAYF,GAAS,CAAA,CAAE,EAC3B,MAAMG,EAAiBP,EAAI,IAAI,EACzBQ,EAAQR,EAAI,CAAC,EACnB,IAAIS,EAAgB,KACpB,MAAMC,EAASC,GAAS,EAClBC,EAAcZ,EAAI,CAAC,EACnBa,EAAUT,GAAS,CAAA,CAAE,EAGrBlB,GAAQC,EAQR2B,EAAOC,EAAe,CACxB,IAAK,oBACL,WAAWC,EAAQ,CACf,MAAO,CACH,QAAS,OACT,KAAM9B,GAAM,QACxB,CACI,EACA,MAAO,CAAC,OAAQA,GAAM,QAAQ,EAC9B,KAAM,GACN,UAAU+B,EAAM,CACZ,OAAKA,GAILA,EAAK,SAAW,SAASA,EAAK,QAAQ,GAAK,EACpCA,IAJH,QAAQ,MAAM,iCAAiC,EACxC,KAIf,EACA,UAAUA,EAAM,CACRA,GACAC,EAAiB,EACjBC,EAAU,GAEV,QAAQ,MAAM,2BAA2B,CAEjD,EACA,QAAQC,EAAK,CACT,QAAQ,MAAM,2BAA4BA,CAAG,CACjD,CACJ,CAAC,EAGKC,EAAehC,GAAS,IAAM,CAAC,CAACyB,EAAK,IAAI,EAEzCI,EAAoB,IAAM,CAC5B,IAAID,EAAOH,EAAK,KAChB,GAAIG,EAAK,kBAAmB,CAExB,MAAMK,EAAoBC,GAAa,CAAC,GAAGN,EAAK,SAAS,CAAC,EAE1DX,EAAYW,EAAK,mBACXK,EAAkB,MAAM,EAAGL,EAAK,kBAAkB,EAClDK,CACV,MAEIhB,EAAYW,EAAK,SAGzB,EAEME,EAAa,IAAM,CACpBL,EAAK,KAAK,WACbN,EAAM,MAAQM,EAAK,KAAK,SAAW,GAErC,EAEMU,EAAa,IAAM,CACrBf,EAAgB,YAAY,IAAM,CAC1BK,EAAK,KAAK,WACVN,EAAM,QACFA,EAAM,OAAS,IACf,cAAcC,CAAa,EAC3BgB,EAAU,IAGlBb,EAAY,OAChB,EAAG,GAAI,CACX,EAEMc,EAAeC,GAAY,CAChC,MAAMC,EAAM,KAAK,MAAMD,EAAU,IAAI,EACnC,SAAQ,EACR,SAAS,EAAG,GAAG,EACXE,EAAO,KAAK,MAAOF,EAAU,KAAQ,EAAE,EAC3C,SAAQ,EACR,SAAS,EAAG,GAAG,EACXG,IAAQH,EAAU,IAAI,WAAW,SAAS,EAAG,GAAG,EACtD,OAAOC,GAAO,KAAO,GAAGA,CAAG,IAAIC,CAAI,IAAIC,EAAI,GAAK,GAAGD,CAAI,IAAIC,EAAI,EAChE,EAEMC,EAAgB1C,GAAS,IACtBmB,EAAM,OAASM,EAAK,KAAK,SAAW,IAAO,GACnD,EAEKS,GAAgBS,GAAU,CAC/B,QAASC,EAAID,EAAM,OAAS,EAAGC,EAAI,EAAGA,IAAK,CAC1C,MAAM,EAAI,KAAK,MAAM,KAAK,OAAM,GAAMA,EAAI,EAAE,EAC3C,CAACD,EAAMC,CAAC,EAAGD,EAAM,CAAC,CAAC,EAAI,CAACA,EAAM,CAAC,EAAGA,EAAMC,CAAC,CAAC,CAC5C,CACA,OAAOD,CACR,EAEME,GAAWnB,EAAe,CAC/B,IAAK,yBACL,WAAWC,EAAQ,SAClB,MAAO,CACN,QAAS,kBACT,QAAS,CACR,QAAQmB,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,MAAMC,EAAAtB,EAAK,OAAL,YAAAsB,EAAW,IACrB,EACG,OAAQ,CACP,OACA,WACA,QACA,eACA,aACA,oBACJ,EACG,SAAU,eACb,CACC,EACA,UAAUnB,EAAM,CACfA,EAAK,QAAQ,CAACoB,EAAYC,IAAU,CACnCD,EAAW,SAAWE,GAAQF,EAAW,QAAQ,EACjDA,EAAW,IAAMC,EAAQ,CAC1B,CAAC,CACF,CACD,CAAC,EAEDE,GACC,IAAM1B,EAAK,KACV2B,GAAY,CACRA,GACHvB,EAAiB,EAGduB,GAAW3B,EAAK,KAAK,eACxBoB,GAAS,OAAM,EACfQ,EAAS,EAEX,CACD,EAEA,MAAMC,GAAiB5B,EAAe,CAClC,IAAK,mDACL,WAAWC,EAAQ,CAEf,GAAI,CAACF,EAAK,KACN,MAAO,GAEX,MAAM8B,EAAY9B,EAAK,KAAK,SACtBA,EAAK,KAAK,SAAW,IAAMN,EAAM,OAAS,GAC1CI,EAAY,OAAS,EAI3B,MAAO,CACH,KAAME,EAAK,KAAK,KAChB,OAAQJ,EAAO,aAAa,MAAM,OAAO,WACzC,SAASM,GAAA,YAAAA,EAAQ,UAAW,aAAa,QAAQ,GAAGF,EAAK,KAAK,IAAI,UAAU,EAC5E,WAAY8B,CACxB,CACI,EACA,UAAU3B,EAAM,CAERA,EAAK,oBACL4B,GAAsB,KAAO5B,EAAK,kBAAkB,IAAK6B,GAAcC,GAAAC,GAAA,GAChEF,GADgE,CAEnE,YAAaA,EAAS,aAAe,KACrC,eAAgBA,EAAS,gBAAkB,IAC3D,EAAc,EAEV,EACA,QAAQ1B,EAAK,CACT,QAAQ,MAAM,8BAA+BA,CAAG,CACpD,EACA,KAAM,EACV,CAAC,EAEK6B,EAAkBlC,EAAe,CACtC,IAAK,+CACL,WAAWC,EAAQ,CAClB,MAAO,CACN,SAAUd,EAAgB,KAC7B,CACC,CAED,CAAC,EAEDsC,GAAMvC,EAAiBiD,GAAU,CAC5BA,EAAQ,IACXhD,EAAgB,MAAQY,EAAK,KAAK,UAAUoC,EAAQ,CAAC,EAAE,SACvDD,EAAgB,OAAM,EAExB,CAAC,EAEDT,GACC,IAAMtD,GAAM,SACXiE,GAAY,CACRA,GACHrC,EAAK,OAAM,CAEb,CACD,EAEA,MAAM+B,GAAwB9B,EAAe,CAC5C,IAAK,oDACL,WAAWC,EAAQ,CAClB,MAAO,CACN,UAAWV,EAAU,IAAK8C,GAAMA,EAAE,IAAI,CACzC,CACC,CACD,CAAC,EAIKC,EAAY,IAAM,CACvBpD,EAAe,MAAQ,EACvB,aAAa,WAAWa,EAAK,KAAK,KAAK,EACvCU,EAAU,CACX,EAEM8B,EAAa,IAAM,CACrB,aAAa,WAAWxC,EAAK,KAAK,KAAK,EACvCf,EAAa,MAAQ,GACrByB,EAAU,EACVqB,GAAsB,OAAM,CAEhC,EAGMU,EAAcjB,GAAU,CACxBW,EAAgB,KAAK,UACzB9C,EAAgB,OAAO,EAAGA,EAAgB,OAAY,EAAG,EAAG,EAAG,CAAE,EAClEA,EAAgBmC,EAAQ,CAAC,EAAInC,EAAgBmC,EAAQ,CAAC,EAAI,EAAI,CAC/D,EAEMkB,EAAa,IAAM,CACxB,IAAI3C,EAAU,CAAA,EAGd,OAFaoC,EAAgB,KAAK,MAEtB,UACX9C,EAAgB,QAAQ,CAAC+C,EAAOZ,KAAU,CACrCnC,EAAgBmC,EAAK,GACxBzB,EAAQ,KAAKoC,EAAgB,KAAK,UAAUX,GAAQ,CAAC,EAAE,CAAC,CAC1D,CAAC,EAEDzB,EAAQ,KAAKN,EAAe,KAAK,EAG3BM,CACR,EAEM4C,EAAc,IAAM,CACtB,IAAI5C,EAAU2C,EAAU,EACxB,GAAI,CAAC3C,EAAQ,OAAQ,CACjB6C,GAAY,CACR,MAAO,0BACP,KAAM,eACN,YAAa,6CACb,SAAU,YACtB,CAAS,EACD,MACJ,CAEA3C,EAAe,CACX,IAAK,mDACL,OAAQ,CACJ,SAAUb,EAAgB,MAC1B,KAAM+C,EAAgB,KAAK,KAC3B,QAAS,KAAK,UAAUpC,CAAO,CAC3C,EACQ,KAAM,GACN,UAAUI,EAAM,CACDgC,EAAgB,KAAK,OACnB,UACT9C,EAAgB,QAAQ,CAACwD,GAAQrB,KAAU,CACnCqB,GACAtD,EAAYiC,EAAK,EAAIqB,IAAU1C,EAAKqB,EAAK,EAClCrB,EAAKqB,EAAK,IAAM,EACvBjC,EAAYiC,EAAK,EAAI,EAErBjC,EAAYiC,EAAK,EAAI,MAE7B,CAAC,EAEDjC,EAAY,KAAKY,CAAI,EAEzB2C,EAAiB,EACZ9C,EAAK,KAAK,cACX+C,GAAa,CAErB,CACR,CAAK,CACL,EAEMD,EAAoB,IAAM,CAC5B,IAAIE,EAAW,KAAK,MAAM,aAAa,QAAQhD,EAAK,KAAK,KAAK,CAAC,GAAK,CAAA,EAChEiD,EAAe,CACf,cAAe7D,EAAgB,MAC/B,OAAQsD,EAAU,EAAG,KAAI,EACzB,WAAYnD,EAAY,OAAQ2D,IAC9BA,IAAU,IACjB,CACH,EAGI,MAAMC,EAAgBH,EAAS,UAC1BI,IAASA,GAAK,gBAAkBH,EAAa,aACtD,EAEQE,IAAkB,GAElBH,EAASG,CAAa,EAAIF,EAG1BD,EAAWA,EAAS,KAAKC,CAAY,EAAKD,EAAW,CAACC,CAAY,EAIxE,aAAa,QAAQjD,EAAK,KAAK,MAAO,KAAK,UAAUgD,CAAQ,CAAC,EAC9D,aAAa,QAAQ,GAAGhD,EAAK,KAAK,IAAI,WAAY,KAAK,UAAUgD,CAAQ,CAAC,CAE5E,EAEMK,GAAe,IAAM,CACrBrD,EAAK,KAAK,cAGd8C,EAAiB,EACjBC,GAAa,GAHbJ,EAAW,CAKb,EAEMI,GAAgB,IAAM,CACvB5D,EAAe,OAASa,EAAK,KAAK,UAAU,SAChDb,EAAe,MAAQA,EAAe,MAAQ,EAC9CE,EAAgB,OAAO,EAAGA,EAAgB,OAAY,EAAG,EAAG,EAAG,CAAE,EACjEE,EAAY,OAAS,EACrBE,EAAe,MAAQ,KACxB,EAEMkB,EAAa,IAAM,CAExB,GAAI,CAACX,EAAK,KAAK,aAAc,CAC5B2C,EAAW,EACX,WAAW,IAAM,CAChBW,EAAgB,CACjB,EAAG,GAAG,EACN,MACD,CACAA,EAAgB,EAChB,QAAQ,IAAI,0DAA0D,CACvE,EAEMC,EAAqB,IAAYC,GAAA,4BACtC,MAAMC,EAAU,CAAA,EACVC,EAAoB,CAAA,EAG1B,QAASvC,GAAI,EAAGA,GAAIY,GAAsB,KAAK,OAAQZ,KAAK,CAC3D,MAAMa,GAAWD,GAAsB,KAAKZ,EAAC,EACvC+B,KAAS7B,EAAAtB,EAAQoB,EAAC,IAAT,YAAAE,EAAa,KAAM,GAK5BsC,EAAW,MAAMC,GAAK,mDAAoD,CAC/E,SAAU5B,GAAS,SACnB,KAAMA,GAAS,KACf,QAAS,KAAK,UAAU,CAACkB,EAAM,CAAC,CACnC,CAAG,EAGKW,GAAa,MAAM,QAAQF,CAAQ,EAAI,CAACA,EAAS,KAAMG,GAAQA,IAAQ,CAAC,GAAK,CAAC,EAAI,CAACH,CAAQ,EAEjGF,EAAQ,KAAK,CACZ,cAAezB,GAAS,SACxB,OAAQkB,GACR,WAAYW,EACf,CAAG,EAGDH,EAAkB,KAAK,CACtB,cAAe1B,GAAS,SACxB,gBAAiBA,GAAS,gBAC1B,YAAakB,GACb,eAAgB,KAChB,YAAalB,GAAS,aAAe,IACxC,CAAG,CACF,CAIAH,GAAe,OACd,CAAE,QAAS,KAAK,UAAU4B,CAAO,CAAC,EAClC,CACC,UAAkBtD,IAASqD,GAAA,sBAI1B,MAAMO,GAAiB,MAAMH,GAAK,+DAAgE,CACjG,UAAWpE,EAAU,IAAI8C,IAAKA,GAAE,QAAQ,CAC7C,CAAK,EAGDoB,EAAkB,QAAS1B,IAAa,CACvC,MAAMgC,EAAgBD,GAAe,KAAMX,IAASA,GAAK,OAASpB,GAAS,aAAa,EACpFgC,IACHhC,GAAS,eAAiBgC,EAAc,eACxChC,GAAS,YAAcgC,EAAc,qBAAuBhC,GAAS,YAEvE,CAAC,EAGD,aAAa,QAAQ,GAAGhC,EAAK,KAAK,IAAI,aAAc,KAAK,UAAU0D,CAAiB,CAAC,EAIrF,aAAa,QAAQ,GAAG1D,EAAK,KAAK,IAAI,WAAY,KAAK,UAAUyD,CAAO,CAAC,EAGzE,aAAa,QAAQ,GAAGzD,EAAK,KAAK,IAAI,WAAY,KAAK,UAAUG,EAAI,CAAC,EAGtE0B,GAAe,OAAM,EACrB5C,EAAa,MAAQ,EACtB,GACA,QAAQqB,GAAK,CACZ,QAAQ,MAAM,yBAA0BA,EAAG,CAC5C,CACH,CACA,CACA,GAEMgD,EAAmB,IAAM,CAC9B,MAAMG,EAAU,aAAa,QAAQ,GAAGzD,EAAK,KAAK,IAAI,UAAU,EAC/D,GAAI,CAACyD,EAAS,CACZ,QAAQ,MAAM,6BAA6B,EAC3C,MACF,CAEA5B,GAAe,OACb,CAAE,QAAA4B,CAAO,EACX,CACC,UAAUtD,EAAM,CACf8D,GAAkB,EACdjE,EAAK,MAAQA,EAAK,KAAK,cAAcoB,GAAS,OAAM,EACpDpB,EAAK,KAAK,UAAU,cAAcL,CAAa,CACpD,EACA,QAAQW,EAAK,aACOA,GAAA,YAAAA,EAAK,UAAW,IACpB,SAAS,8BAA8B,KAChCe,GAAAf,EAAI,WAAJ,MAAAe,GAAe,GACpC6C,GAAM,QAAM5C,GAAAhB,EAAI,WAAJ,YAAAgB,GAAe,KAAMhB,CAAG,EACpC,WAAW,IAAM,CAChB,OAAO,SAAS,OAAM,CACvB,EAAG,GAAI,EAET,CACH,CACA,CACA,EAEMsB,EAAY,IAAM,CACvBzC,EAAe,MAAQ,EACvBE,EAAgB,OAAO,EAAGA,EAAgB,OAAY,EAAG,EAAG,EAAG,CAAE,EACjEE,EAAY,OAAS,EACrBsC,GAAe,MAAK,EACpBzB,EAAiB,EACjBC,EAAU,EACVP,EAAY,MAAQ,CACrB,EAEMqE,EAAmBnC,GACpBA,EAAS,MAAQ,UAChBA,EAAS,SAAkB,gCAClB,oBACD,mBAGRiC,GAAqB,IAAM,CAE5BrE,EAAO,aAAa,MAAM,OAAS,UACtCgE,GAAK,6CAA8C,CAClD,OAAQhE,EAAO,aAAa,MAAM,OAAO,WACzC,eAAgBA,EAAO,aAAa,MAAM,OAAO,cACjD,cAAeA,EAAO,aAAa,MAAM,OAAO,YACnD,CAAG,EAAE,KAAK,IAAM,CACTX,EAAa,OAChB4C,GAAe,OAAM,CAEvB,CAAC,CAEH,EA8BMuC,GAAe,CAACC,EAAOnB,IAAW,CAEvCnD,EAAQsE,CAAK,EAAI,CAACnB,CAAM,CAEzB,EAEMoB,GAAe,CAACD,EAAOnB,IAAW,CAElCnD,EAAQsE,CAAK,IACjBtE,EAAQsE,CAAK,EAAI,CAAA,GAElB,MAAM7C,EAAQzB,EAAQsE,CAAK,EAAE,QAAQnB,CAAM,EACvC1B,IAAU,GACbzB,EAAQsE,CAAK,EAAE,KAAKnB,CAAM,EAE1BnD,EAAQsE,CAAK,EAAE,OAAO7C,EAAO,CAAC,CAGhC,EAEAE,GACC,IAAMK,GAAsB,KAC3BJ,GAAY,CACRA,EACH,QAAQ,IAAI,+BAA+B,EAE3C,QAAQ,KAAK,6CAA6C,CAE5D,CACD,EAGA,MAAM+B,GAAoBxE,EAAI,EAAE,EAC1BqF,GAAcrF,EAAI,EAAE,EAE1B,OAAAwC,GACE,IAAMG,GAAe,KACrB,IAAM,CACJ,GAAIA,GAAe,KAAM,CACvB,MAAMrC,EAAY,aAAa,QAAQ,GAAGQ,EAAK,KAAK,IAAI,YAAY,EAC9DyD,EAAU,aAAa,QAAQ,GAAGzD,EAAK,KAAK,IAAI,UAAU,EAChE0D,GAAkB,MAAQlE,EAAY,KAAK,MAAMA,CAAS,EAAI,CAAA,EAC9D+E,GAAY,MAAQd,EAAU,KAAK,MAAMA,CAAO,EAAI,CAAA,CACtD,CACF,CACF,gCA/4BYlD,EAAA,WAAXiE,EA0TM,MAAA3F,GAAA,CAxTLD,EAgCM,MAhCN6F,GAgCM,CA7BL7F,EAIM,MAJN8F,GAIMC,EAAA,yBAFqBjG,EAAAc,CAAA,EAAU,MAAM,aAAA,EAAA,CAAA,GAGhCd,EAAAA,EAAAsB,CAAA,EAAK,OAALtB,MAAAA,EAAW,UAAtBkG,EAAA,EAAAJ,EAIM,MAJNK,GAIMF,EAAA,wDAFoDjG,KAAK,KAAK,QAAQ,WAAA,EAAA,CAAA,aAGjEA,GAAAA,EAAAsB,CAAA,EAAK,OAALtB,MAAAA,GAAW,cAAtB8F,EAMM,MANNM,GAMMH,uFAFH,CAAA,YAGQjG,EAAAsB,CAAA,EAAK,KAAK,oBAArB4E,EAAA,EAAAJ,EAIM,MAJNO,GAIMJ,EAAA,wBAFoBjG,KAAK,KAAK,kBAAkB,8CAAA,EAAA,CAAA,YAG3CA,EAAAsB,CAAA,EAAK,KAAK,cAArB4E,EAAA,EAAAJ,EAMM,MANNQ,GAMML,EAAA,6BAJgCjG,EAAAsB,CAAA,EAAK,KAAK,6BAAmCtB,EAAAsB,CAAA,EAAK,KAAK,YAAY,4BAO/FtB,EAAAsB,CAAA,EAAK,KAAK,UAArB4E,IAAAJ,EAQM,MARNS,GAQM,CAPLrG,EAKM,MALNsG,GAKM,CAJLC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAAuC,QAAjC,MAAM,EAAE,EAAA+F,EAAK,MAAA,EAAW,KAAE,EAAA,GAChC/F,EAEO,OAFPwG,GAEOT,EADH/D,EAAYlB,EAAA,KAAK,CAAA,EAAA,CAAA,IAGtB2F,EAAyCC,GAAA,CAA3B,SAAUrE,EAAA,KAAa,EAAA,KAAA,EAAA,CAAA,UAAA,CAAA,cAI5BhC,EAAA,oBAAZuF,EAuBM,MAAAe,GAAA,CAtBJ3G,EAqBM,MArBN4G,GAqBM,CApBJ5G,EAEM,MAFN6G,GAEMd,EADDjG,KAAK,KAAK,KAAK,EAAA,CAAA,IAGVA,EAAAsB,CAAA,EAAK,KAAK,gBAAgBtB,GAAAA,EAAA0C,EAAA,EAAS,OAAT1C,YAAAA,GAAe,QAASA,EAAAsB,CAAA,EAAK,KAAK,eAAiBtB,EAAAsB,CAAA,EAAK,KAAK,iBADjGvB,EAMSC,EAAAgH,CAAA,EAAA,OAJN,QAAOnD,EACR,MAAM,mBAEN,IAA4B,CAAA,GAAA4C,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAA5BvG,EAA4B,cAAnB,OAAA,EAAS,EAAA,aAGL,CAAAF,EAAAsB,CAAA,EAAK,KAAK,gBAAgBtB,GAAAA,EAAA0C,EAAA,EAAS,OAAT1C,YAAAA,GAAe,QAASA,EAAAsB,CAAA,EAAK,KAAK,kBAD3EvB,EAMSC,EAAAgH,CAAA,EAAA,OAJN,QAAOlD,EACR,MAAM,mBAEN,IAAsC,CAAA,GAAA2C,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAtCvG,EAAsC,cAA7B,iBAAA,EAAmB,EAAA,cAE9BgG,EAAA,EAAAJ,EAEM,WADD,iFAAiF,CAAA,QAM/EvF,EAAA,QAAY,IAAcE,EAAA,QAAc,GAAA,CAAWT,EAAAmD,EAAA,EAAe,MAAQnD,EAAAsB,CAAA,EAAK,KAAK,iBAA/FwE,EA2IQ,MAAAmB,GAAA,EA1IPf,EAAA,EAAA,EAAAJ,EAyIQoB,GAAA,KAAAC,GAzIyBnH,EAAAc,CAAA,EAAS,CAA7BwC,EAAUqC,UAAvBG,EAyIQ,MAAA,KAAA,CAvIEH,IAASlF,EAAA,MAAc,GAAQT,EAAAyD,CAAA,EAAgB,MADtDyC,IAAAJ,EAuIM,MAvINsB,GAuIM,CAnILlH,EAaM,MAbNmH,GAaM,CAZLnH,EAOM,MAPNoH,GAOM,CANLpH,EAEO,OAFPqH,GAEOtB,EAAA,YADSxF,EAAA,KAAc,IAAK,KACnC,CAAA,EACAP,EAEO,OAAA,KAAA+F,EADHR,EAAgBzF,EAAAyD,CAAA,EAAgB,IAAI,CAAA,EAAA,CAAA,IAGzCvD,EAGM,MAHNsH,GAGMvB,EAFF3C,EAAS,MAAM,EAAG,IACrB2C,EAAG3C,EAAS,QAAM,EAAA,QAAA,QAAA,EAAA,CAAA,IAGpBpD,EAGO,MAAA,CAFN,MAAM,+CACN,UAAQF,EAAAyD,CAAA,EAAgB,KAAK,qBAEnBzD,EAAAyD,CAAA,EAAgB,KAAK,MAAI,eAApCqC,EAqDMoB,GAAA,CAAA,IAAA,CAAA,EAAAC,GArD6D,EAATrE,GAA1D5C,EAqDM,MAAA,KAAA,CAnDEF,EAAAyD,CAAA,EAAgB,KAAI,UAAWX,CAAK,EAAA,GAD3CoD,IAAAJ,EA4CQ,QA5CR2B,GA4CQ,CAvCC,CAAA5G,EAAY,QAAM,CAAKb,KAAgB,KAAK,cADpD8F,EAME,QAAA,OAJD,KAAK,QACJ,KAAM,mBAAmB9F,KAAgB,KAAK,QAAQ,EACvD,MAAM,6DACL,SAAM0H,GAAE3D,EAAWjB,CAAK,gBAIb,CAAAjC,EAAY,QAAUb,KAAgB,KAAK,cADxD8F,EAME,QAAA,OAJD,KAAK,WACJ,KAAM,mBAAmB9F,KAAgB,KAAK,QAAQ,EACvD,MAAM,wEACL,SAAM0H,GAAE3D,EAAWjB,CAAK,gBAGd9C,EAAAsB,CAAA,EAAK,KAAK,cADtB4E,EAAA,EAAA,EAAAJ,EAmBMoB,GAAA,CAAA,IAAA,CAAA,EAAAC,GAjBmBtG,EAAW,CAA3B2D,EAAQmD,SAFjB7B,EAmBM,MAAA,KAAA,CAfMhD,KAAa6E,OAAxB7B,EAcM,MAAA8B,GAAA,CAZEpD,GAAM,OADbzE,EAGEC,EAAA6H,EAAA,EAAA,OADD,MAAM,4BAGKrD,GAAM,OADlBzE,EAGEC,EAAA8H,EAAA,EAAA,OADD,MAAM,8BAGKtD,GAAM,OADlBzE,EAGEC,EAAA+H,EAAA,EAAA,OADD,MAAM,+BAEPhI,EAAsCC,EAAA8H,EAAA,EAAA,OAAlB,MAAM,4CAG5B5H,EAIO,OAAA,CAHN,MAAM,OACN,UAAQF,EAAAyD,CAAA,EAAgB,eAAeX,CAAK,EAAA,0BAKvC9C,EAAAyD,CAAA,EAAgB,KAAI,eAAgBX,CAAK,EAAA,UADhDgD,EAMM,MAAA,OAJL,MAAM,kBAGH9F,EAAAyD,CAAA,EAAgB,KAAI,eAAgBX,CAAK,EAAA,CAAA,EAAA,GAAA,GAAA,CAFpC,CAAAkF,GAAAnH,EAAY,MAAM,qBAKZb,EAAAyD,CAAA,EAAgB,KAAK,MAAI,kBAAzCqC,EAmBM,MAAAmC,GAAA,CAlBLtB,EAKE3G,EAAAkI,EAAA,EAAA,YAJQnH,EAAA,2CAAAA,EAAc,MAAA2G,GACvB,KAAK,WACJ,SAAU,EAAA7G,EAAY,OACvB,MAAM,0CAEIA,EAAY,YAAvBiF,EAWM,MAAAqC,GAAA,CAVQtH,EAAW,CAAA,OAAxBd,EAIQC,EAAAoI,EAAA,EAAA,OAJsB,MAAO,UAAa,MAAM,UAC5C,SACV,IAAqD,CAArDzB,EAAqD3G,EAAA6H,EAAA,EAAA,CAAxC,MAAM,+BAA+B,CAAA,gBAGpD9H,EAIQC,EAAAoI,EAAA,EAAA,OAJM,MAAM,MAAO,MAAO,cACtB,SACV,IAA+C,CAA/CzB,EAA+C3G,EAAA+H,EAAA,EAAA,CAAtC,MAAM,6BAA6B,CAAA,+BAKhDjC,EASM,MAAAuC,GAAA,CARL1B,EAOE3G,EAAAsI,EAAA,EAAA,CAND,MAAM,OACL,QAASvH,EAAA,MACT,SAAM0F,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGrB,GAASrE,EAAA,MAAiBqE,GACnC,SAAU,GACV,UAAW,GACZ,YAAY,sHAGdlF,EA4BM,MA5BNqI,GA4BM,CA3BLrI,EAEM,MAFNsI,GAEMvC,EAAA,YADUxF,OAAc,OAAOT,EAAAc,CAAA,EAAU,MAAM,EAAA,EAAA,CAAA,EAGrCd,EAAAsB,CAAA,EAAK,KAAK,cAAyB,CAAAT,EAAY,YAD/Dd,EAUSC,EAAAgH,CAAA,EAAA,OALP,uBAAO/C,iBAER,IAEO,CAAA,GAAAwC,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAFPvG,EAEO,cADH,OAAA,EAAS,EAAA,aAIFO,EAAA,OAAkBT,EAAAc,CAAA,EAAU,YADxCf,EAOSC,EAAAgH,CAAA,EAAA,OALP,uBAAOrC,kBAER,IAEO,CAAA,GAAA8B,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAFPvG,EAEO,cADH,MAAA,EAAQ,EAAA,kBAGbH,EAISC,EAAAgH,CAAA,EAAA,OAJO,uBAAO/E,iBACtB,IAEO,CAAA,GAAAwE,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAFPvG,EAEO,cADH,QAAA,EAAU,EAAA,iDASVK,EAAA,OAAgBP,MAAsB,MAAQA,EAAAqD,EAAA,EAAsB,KAAK,OAAM,OAA1FyC,EA+CM,MAAA2C,GAAA,EA9CJvC,EAAA,EAAA,EAAAJ,EAuCMoB,WAvC2BlH,EAAAqD,EAAA,EAAsB,KAAI,CAA9CC,EAAUqC,UAAvBG,EAuCM,MAAA,CAvCwD,IAAKxC,EAAS,KAAM,MAAM,+BAEtFpD,EAQM,MARNwI,GAQM,CAPJxI,EAGM,MAHNyI,GAGM,CAFJzI,EAAwD,OAAxD0I,GAAwD3C,EAAA,YAAtBN,QAAc,IAAC,CAAA,EACjDzF,EAA4C,OAAA,KAAA+F,EAAnCR,EAAgBnC,CAAQ,CAAA,EAAA,CAAA,IAEnCpD,EAEM,MAFN2I,GAEM5C,EADD3C,EAAS,QAAM,CAAA,EAAQ,IAAC2C,EAAG3C,EAAS,QAAM,EAAA,QAAA,QAAA,EAAA,CAAA,IAGjDpD,EAAkG,MAAA,CAA7F,MAAM,+CAA+C,UAAQoD,EAAS,4BAEhEA,EAAS,MAAI,eAAxBwC,EAqBMoB,GAAA,CAAA,IAAA,CAAA,EAAAC,GArBiD,EAATrE,GAA9C5C,EAqBM,MAAA,KAAA,CAnBIoD,YAAmBR,CAAK,EAAA,GADhCoD,IAAAJ,EAmBQ,QAnBRgD,GAmBQ,CAdGxF,EAAS,SAOLA,EAAS,cADtBwC,EAME,QAAA,OAJA,KAAK,WACJ,iBAAkBH,EAAK,GACxB,MAAM,wEACL,YAAQC,GAAaD,GAAOrC,YAAmBR,CAAK,EAAA,CAAA,8BAZvDgD,EAME,QAAA,OAJA,KAAK,QACJ,iBAAkBH,EAAK,GACxB,MAAM,6DACL,YAAQD,GAAaC,GAAOrC,YAAmBR,CAAK,EAAA,CAAA,gBASvD5C,EAA+D,OAAA,CAAzD,MAAM,OAAO,UAAQoD,EAAQ,UAAWR,CAAK,EAAA,kCAIvCQ,EAAS,MAAI,kBAA7BwC,EAEM,MAAAiD,GAAA,CADJpC,EAAqE3G,EAAAkI,EAAA,EAAA,CAA/C,WAAA7G,EAAQsE,EAAK,EAAb,sBAAA+B,GAAArG,EAAQsE,EAAK,EAAA+B,EAAG,KAAK,WAAW,MAAM,2EAIhExH,EAIM,MAJN8I,GAIM,CAHJrC,EAES3G,EAAAgH,CAAA,EAAA,CAFA,uBAAOnC,iBACd,IAAuC,CAAA,GAAA4B,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAAvCvG,EAAuC,cAA9B,kBAAA,EAAoB,EAAA,iBAMnBF,EAAAmD,EAAA,EAAe,MAA/B+C,IAAAJ,EAgDM,MAhDNmD,GAgDM,CA/CJxC,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAvG,EAA+D,MAAA,CAA1D,MAAM,uBAAuB,IAAI,cAAA,EAAgB,EAAA,GACtDA,EAEM,MAFNgJ,GAEMjD,EAAA,WADU,KAAK,KAAKjG,EAAAmD,EAAA,EAAe,KAAK,UAAU,CAAA,qCAAsCnD,EAAAmD,EAAA,EAAe,KAAK,KAAK,WAAWnD,EAAAmD,EAAA,EAAe,KAAK,YAAY,EAAA,EAAA,CAAA,EAElKjD,EAuCM,MAvCNiJ,GAuCM,EAtCJjD,EAAA,EAAA,EAAAJ,EAqCMoB,GAAA,KAAAC,GArC2BnC,GAAA,MAAiB,CAArC1B,EAAUqC,KAAK,oBAA5BG,EAqCM,MAAA,CArC+C,IAAKxC,EAAS,cAAe,MAAM,+BAEtFpD,EAKM,MALNkJ,GAKM,CAJJlJ,EAGM,MAHNmJ,GAGM,CAFJnJ,EAAwD,OAAxDoJ,GAAwDrD,EAAA,YAAtBN,QAAc,IAAC,CAAA,EACvDzF,EAA+C,OAAA,CAAzC,UAAQoD,EAAS,gCAKrBpD,EAEM,MAFNqJ,GAEM,CADJ9C,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAvG,EAAuC,gBAA5B,cAAA,EAAgB,EAAA,MAAY,IAAC+F,EAAG3C,EAAS,aAAW,WAAA,EAAA,CAAA,IAIjEpD,EAEM,MAFNsJ,GAEM,CADJ/C,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAvG,EAA0C,gBAA/B,iBAAA,EAAmB,EAAA,MAAY,IAAC+F,EAAG3C,EAAS,gBAAc,mBAAA,EAAA,CAAA,IAI5DA,EAAS,aAApB4C,IAAAJ,EAEM,MAFN2D,GAEM,CADJhD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAvG,EAAuC,gBAA5B,cAAA,EAAgB,EAAA,MAAY,IAAC+F,EAAG3C,EAAS,WAAW,EAAA,CAAA,cAIjEpD,EAWM,MAXNwJ,GAWM,GAVS9G,GAAAD,EAAAkD,GAAA,MAAYF,EAAK,IAAjB,YAAAhD,EAAoB,aAApB,YAAAC,EAA8B,MAAA,OAA3C7C,EAIQC,EAAAoI,EAAA,EAAA,OAJiD,MAAO,UAAa,MAAM,UACtE,SACT,IAAqD,CAArDzB,EAAqD3G,EAAA6H,EAAA,EAAA,CAAxC,MAAM,+BAA+B,CAAA,gBAGtD9H,EAIQC,EAAAoI,EAAA,EAAA,OAJO,MAAO,YAAe,MAAM,QAC9B,SACT,IAA+C,CAA/CzB,EAA+C3G,EAAA+H,EAAA,EAAA,CAAtC,MAAM,6BAA6B,CAAA,yBAMtDpB,EAES3G,EAAAgH,CAAA,EAAA,CAFA,uBAAO9D,EAAS,GAAI,MAAM,mBACjC,IAAgC,CAAA,GAAAuD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAAhCvG,EAAgC,cAAvB,WAAA,EAAa,EAAA,gCAIzB4F,EAEM,MAAA6D,GAAA,CAAA,GAAAlD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CADLvG,EAA2B,SAAxB,uBAAoB,EAAA,wIC3SzB,MAAMG,EAAOC,GAAO,OAAO,EAQrBsJ,EAAkB,IAAM,CAC7B,OAAO,SAAS,KAAO,QACxB,eA3Ba5J,EAAAK,CAAA,EAAK,UAAjBN,EAA+C8J,GAAA,OAAvB,SAAUlK,EAAA,6BAClCuG,IAAAJ,EASM,MATN3F,GASM,CARLD,EAEM,aADF4J,EAAAA,GAAE,kCAAA,CAAA,EAAA,CAAA,EAENnD,EAIS3G,EAAAgH,CAAA,EAAA,CAJA,uBAAO4C,EAAe,GAAI,MAAM,mBACxC,IAEO,CAFP1J,EAEO,cADH4J,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,2WC0DT,MAAMC,EAAOvJ,EAAI,EAAK,EAChBc,EAAOd,EAAI,IAAI,EACfwJ,EAAaxJ,EAAI,IAAI,EACrByJ,EAAOzJ,EAAI,IAAI,EACf0J,EAAqB1J,EAAI,IAAI,EAE7Bd,EAAQC,EAYdwK,GAAU,IAAYrF,GAAA,sBACrB,MAAMsF,GAAQ,EACdL,EAAK,MAAQ,EACd,EAAC,EAED,MAAMM,EAAgB,IAAM,CACvB3K,EAAM,MAAQ,OACjBA,EAAM,WAAW4B,EAAK,KAAK,EACjB5B,EAAM,MAAQ,OACxBA,EAAM,WAAWuK,EAAK,KAAK,EACjBvK,EAAM,MAAQ,qBACxBA,EAAM,WAAWwK,EAAmB,KAAK,EAEzCxK,EAAM,WAAWsK,EAAW,KAAK,EAElCD,EAAK,MAAQ,EACd,EAEMO,EAAiB,IAAM,CACxB5K,EAAM,MAAQ,OAAQ,OAAO,KAAK,wBAAyB,QAAQ,EAC9DA,EAAM,MAAQ,OAAQ,OAAO,KAAK,sBAAuB,QAAQ,EACjEA,EAAM,MAAQ,qBAAsB,OAAO,KAAK,oCAAqC,QAAQ,EACjG,OAAO,KAAK,4BAA6B,QAAQ,CACvD,oBA1GCK,EA0DSC,EAAAuK,EAAA,EAAA,YAzDCR,EAAA,2CAAAA,EAAI,MAAArC,GACZ,QAAS,UAET,IAEU,OACV,IAAuE,CAAvEjB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAAuE,SAAA,CAA/D,MAAA,CAAA,QAAA,IAAA,SAAA,UAAA,CAAuC,EAAC,iBAAc,EAAA,GAC9DA,EAgDM,MAhDNC,GAgDM,CA/CMR,EAAA,MAAI,YAAfmG,EAEM,MAFNC,GAEME,EADF6D,EAAAA,GAAE,2BAAA,CAAA,EAAA,CAAA,GAEUnK,EAAA,MAAI,YAApBmG,EAEM,MAFNE,GAEMC,EADF6D,EAAAA,GAAE,4BAAA,CAAA,EAAA,CAAA,GAEUnK,EAAA,MAAI,0BAApBmG,EAEM,MAFNK,GAEMF,EADF6D,EAAAA,GAAE,0CAAA,CAAA,EAAA,CAAA,QAENhE,EAEM,MAFNM,GAEMH,EADF6D,EAAAA,GAAE,kCAAA,CAAA,EAAA,CAAA,GAEN5J,EA6BM,MAAA,KAAA,CA3BEP,EAAA,MAAI,YADXI,EAMEyK,GAAA,kBAJQlJ,EAAA,2CAAAA,EAAI,MAAAoG,GACb,QAAQ,OACP,MAAOoC,EAAAA,GAAE,eAAA,EACT,SAAQ,CAAGpG,EAAO+G,IAAUH,EAAc,8CAGhC3K,EAAA,MAAI,YADhBI,EAMEyK,GAAA,kBAJQP,EAAA,2CAAAA,EAAI,MAAAvC,GACb,QAAQ,gBACP,MAAOoC,EAAAA,GAAE,gBAAA,EACT,SAAQ,CAAGpG,EAAO+G,IAAUH,EAAc,8CAGhC3K,EAAA,MAAI,0BADhBI,EAMEyK,GAAA,kBAJQN,EAAA,2CAAAA,EAAkB,MAAAxC,GAC3B,QAAQ,sBACP,MAAOoC,EAAAA,GAAE,8BAAA,EACT,SAAQ,CAAGpG,EAAO+G,IAAUH,EAAc,mDAE5CvK,EAMEyK,GAAA,kBAJQR,EAAA,2CAAAA,EAAU,MAAAtC,GACnB,QAAQ,sBACP,MAAOoC,EAAAA,GAAE,sBAAA,EACT,SAAQ,CAAGpG,EAAO+G,IAAUH,EAAc,gDAG7CpK,EAIM,MAJNmG,GAIM,CAHLM,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,QAAS,uBAAOqD,iBAC/B,IAAgB,MAAbP,EAAAA,GAAE,MAAA,CAAA,EAAA,CAAA,0CC9CJ,MAAMD,EAAK,CACjB,YAAY,CAAE,KAAApI,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACpC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,CACjB,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAEC,GAAY,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CAChE,CAAG,EAEKC,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,GAAG,MAAM,EAChB,KAAMA,EAAI,SACb,CACC,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,QAAS,CACR,YAAK,QAAU,SAAS,cAAc,KAAK,EACvC,OAAO,KAAK,KAAK,IAAI,EAAE,OAC1B,KAAK,WAAW,KAAK,KAAK,IAAI,EAE9B,KAAK,gBAAe,EAEd,KAAK,OACb,CAEA,WAAW1J,EAAM,CAChB,GAAI,KAAK,SAAU,CAClB,MAAMsJ,EAAMC,GAAUI,GAAW,CAChC,KAAM3J,CACV,CAAI,EACDsJ,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd,KAAM,CAAE,aAAAiK,CAAY,EAAKC,GAAU,EACnCR,EAAI,QAAQ,QAASO,CAAY,EACjCP,EAAI,MAAM,KAAK,OAAO,EACtB,MACD,CACA,KAAK,QAAQ,UAAY;AAAA;AAAA,wBAEHtJ,CAAI;AAAA;AAAA,eAI3B,CAEA,iBAAkB,CACjB,GAAI,KAAK,SACR,OAED,MAAMsJ,EAAMC,GAAUQ,GAAkB,CACvC,KAAM,OACN,WAAa/J,GAAS,CACrB,KAAK,KAAK,KAAOA,EACjB,KAAK,WAAWA,CAAI,CACrB,CACH,CAAG,EACDsJ,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd0J,EAAI,MAAM,KAAK,OAAO,CACvB,CAEA,KAAKU,EAAc,CAClB,MAAO,CACN,KAAM,KAAK,KAAK,IACnB,CACC,CACD,orCCsHA,MAAMC,EAAiB/K,EAAI,IAAI,EACzBgE,EAAShE,EAAI,IAAI,EACjBgL,EAAWhL,EAAI,IAAI,EACnBU,EAASC,GAAS,EAClBd,EAAOC,GAAO,OAAO,EACrBmL,EAAYvK,EAAO,aAAa,MAAM,MAAQ,uBAC9CwK,EAAUlL,EAAI,EAAK,EAEnBd,EAAQC,EAWdwK,GAAU,IAAM,CACf,OAAO,iBAAiB,UAAWwB,CAAgB,EACnD,QAAQ,IAAI,SAAUtL,EAAK,IAAI,CAChC,CAAC,EAED,MAAMsL,EAAoBC,GAAM,CAC3BA,EAAE,MAAQ,MAAQA,EAAE,SAAWA,EAAE,WACpCC,GAAgB,EAChBD,EAAE,eAAc,EAElB,EAEAE,GAAgB,IAAM,CACrB,OAAO,oBAAoB,UAAWH,CAAgB,CACvD,CAAC,EAED,MAAM3B,EAAazI,EAAe,CACjC,IAAK,oBACL,OAAQ,CACP,QAAS,sBACT,KAAM7B,EAAM,YACd,EACC,KAAM,GACN,UAAU+B,EAAM,CACX/B,EAAM,gBAAkB,OAC3BqM,EAAmB,OAAM,CAE3B,CACD,CAAC,EAEKC,EAAgBzK,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,OAClB,IAAIyK,EAAM,CACT,QAAS,wBACT,WAAYvM,EAAM,aAClB,QAAQiD,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,OAAQzB,EAAO,aAAa,MAAM,OAAO,UAC5C,EACE,OAAIgL,EAAY,EACfD,EAAI,sBAAwBV,EAAe,MAAM,SAEjDU,EAAI,OAASzH,EAAO,MAEd,CACN,IAAKyH,CACR,CACC,CACD,CAAC,EAEKE,EAAgB5K,EAAe,CACpC,IAAK,sCACL,WAAWC,EAAQ,CAClB,MAAO,CACN,SAAUA,EAAO,KACpB,CACC,EACA,KAAM,GACN,UAAUC,EAAM,CACf8J,EAAe,MAAQ9J,CACxB,CACD,CAAC,EAEKsK,EAAqBK,GAAuB,CACjD,QAAS,wBACT,KAAM1M,EAAM,eACZ,QAAQkC,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,EACA,KAAM,GACN,MAAO,EAACe,GAAAtC,EAAK,OAAL,YAAAsC,GAAW,KAAMjD,EAAM,YAAY,CAC5C,CAAC,EAEDsD,GAAM+I,EAAoB,IAAM,CAC3BA,EAAmB,MAClBA,EAAmB,IAAI,uBAC1BI,EAAc,OAAO,CACpB,MAAOJ,EAAmB,IAAI,qBAClC,CAAI,EAEEA,EAAmB,IAAI,SAC1BvH,EAAO,MAAQuH,EAAmB,IAAI,QAEnCA,EAAmB,IAAI,WAC1BP,EAAS,MAAQO,EAAmB,IAAI,UAErCA,EAAmB,SAEZG,EAAY,GAAM,CAACX,EAAe,OAElC,CAACW,EAAY,GAAM,CAAC1H,EAAO,MAHrCkH,EAAQ,MAAQ,GAMhBA,EAAQ,MAAQ,GAGnB,CAAC,EAED1I,GAAMuI,EAAgB,IAAM,CACvB7L,EAAM,gBAAkB,OAAS6L,EAAe,QACnDG,EAAQ,MAAQ,GAElB,CAAC,EAED1I,GACE,IAAA,OAAM,OAAAL,EAAAoJ,EAAmB,MAAnB,YAAApJ,EAAwB,OAC9B,CAAC0J,EAAUC,IAAa,CAClBD,IAAaC,GAAYP,EAAmB,MAC9CA,EAAmB,IAAI,OAAS,SAChCL,EAAQ,MAAQ,GAEpB,CACF,EAEA,MAAMG,GAAmB,IAAM,WAC9B,GAAInM,EAAM,gBAAkB,MAAO,CAClC,IAAI6M,EACHR,EAAmB,KAAOA,EAAmB,IAAI,SAASpJ,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,OAClEC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,KACX,KAEJmJ,EAAmB,SAAS,OAC3BxI,GAAAC,GAAA,GACIuI,EAAmB,KADvB,CAEC,uBAAuBS,EAAAjB,EAAe,QAAf,YAAAiB,EAAsB,SAC7C,UAAWD,EACX,SAAUf,EAAS,MACnB,OAAQhH,EAAO,KAEnB,GACG,CACC,UAAU/C,EAAM,CACf+D,GAAM,QAAQ,GAAG,sBAAsB,CAAC,EACxCkG,EAAQ,MAAQ,EACjB,CACJ,CACA,CACC,MACCe,EAAgB,CAElB,EAEMA,EAAmB,IAAM,CAC9BT,EAAc,OACb,CAAA,EACA,CACC,UAAUvK,EAAM,CACf+D,GAAM,QAAQ,GAAG,mCAAmC,CAAC,EACjDtE,EAAO,aAAa,MAAM,MAAQ,uBACrCA,EAAO,KAAK,CACX,KAAM,uBACN,OAAQ,CACP,aAAcxB,EAAM,aACpB,eAAgB+B,EAAK,IAC5B,CACA,CAAM,GAED8D,EAAkB,EAClBrE,EAAO,GAAE,GAEV6K,EAAmB,KAAOtK,EAAK,KAC/BiK,EAAQ,MAAQ,GAChBK,EAAmB,OAAM,CAC1B,EACA,QAAQnK,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,CACH,CACA,CACA,EAEM8K,EAAkBC,GAAS,CAChCjB,EAAQ,MAAQ,GAChBH,EAAe,MAAQoB,CACxB,EAEMpH,EAAqB,IAAM,CAChC,GAAIrE,EAAO,aAAa,MAAM,MAAQ,SAAU,CAC/C,IAAI0L,EAAa1L,EAAO,aAAa,MAAM,OAAO,WAC9C2L,EAAgB3L,EAAO,aAAa,MAAM,OAAO,cACjD4L,EAAe5L,EAAO,aAAa,MAAM,OAAO,aACpD,QAAQ,IAAI,mBAAoB2L,CAAa,EAC7C,QAAQ,IAAI,kBAAmBC,CAAY,EAE3C5H,GAAK,6CAA8C,CAClD,OAAQ0H,EACR,eAAgBC,EAChB,cAAeC,CAClB,CAAG,CACF,CACD,EAEMC,EAAU,IAAM,OACrB,MAAMC,GAAOrK,EAAAqH,EAAW,OAAX,YAAArH,EAAiB,KAC9B,GAAIqK,GAAQ,QACX,MAAO,CAAC,SAAS,EACX,GAAIA,GAAQ,WAClB,MAAO,CACN,OACA,QACA,OACA,qBACA,yEACH,EACQ,GAAIA,GAAQ,MAClB,MAAO,CAAC,MAAM,CAEhB,EAEMC,EAAgBN,GAAS,OAC9B,IAAIK,GAAOrK,EAAAqH,EAAW,OAAX,YAAArH,EAAiB,KACxBuK,EAAYP,EAAK,KAAK,MAAM,GAAG,EAAE,IAAG,EAAG,YAAW,EACtD,GAAIK,GAAQ,SAAW,CAAC,CAAC,MAAO,OAAQ,KAAK,EAAE,SAASE,CAAS,EAChE,MAAO,8BACD,GACNF,GAAQ,YACR,CAAC,CAAC,MAAO,OAAQ,KAAK,EAAE,SAASE,CAAS,EAE1C,MAAO,iCACD,GAAIF,GAAQ,OAAS,CAAC,CAAC,KAAK,EAAE,SAASE,CAAS,EACtD,MAAO,2BAET,EAEMC,EAAmB,IAAM,CAC9BzB,EAAQ,MAAQ,GAChBH,EAAe,MAAQ,IACxB,EAEM6B,EAAqBvN,GAAS,IAAM,WACzC,SACE8C,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,iBACXC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,iBACX4J,EAAAnM,EAAK,OAAL,YAAAmM,EAAW,iBACZ9M,EAAM,gBAAkB,OACxBwB,EAAO,aAAa,MAAM,MAAQ,sBAEpC,CAAC,EAEKmM,GAAsBxN,GAAS,IAAM,WAC1C,MACC,CAACkM,EAAmB,OACnBpJ,EAAAoJ,EAAmB,MAAnB,YAAApJ,EAAwB,UAASC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,SAC5C4J,EAAAT,EAAmB,MAAnB,YAAAS,EAAwB,SAAU,YAErC,CAAC,EAEKc,GAA0BzN,GAAS,IACjC,CACN,CAAE,MAAO,aAAc,MAAO,YAAY,EAC1C,CAAE,MAAO,SAAU,MAAO,QAAQ,EAClC,CAAE,MAAO,OAAQ,MAAO,MAAM,EAC9B,CAAE,MAAO,OAAQ,MAAO,MAAM,CAChC,CACC,EAEK0N,GAAc1N,GAAS,IACvBkM,EAAmB,IAEbA,EAAmB,IAAI,QAAU,QAAUA,EAAmB,IAAI,QAAU,SAC/E,QACGA,EAAmB,IAAI,QAAU,aACpC,OAEA,MANA,QAQR,EAEKG,EAAe,IAAM,OAC1B,MAAO,CAAC,MAAO,QAAS,UAAU,EAAE,UAASvJ,EAAAqH,EAAW,OAAX,YAAArH,EAAiB,IAAI,CACnE,0CAzeQ,OAAA3C,EAAAgK,CAAA,EAAW,UADlBlE,EAsLM,MAAA,OApLL,MAAK1F,GAAA,CAAC,kCAAiC,CAAA,oBAAA,CACPqL,EAAS,CAAA,IAEzCvL,EAgBM,MAhBNC,GAgBM,CAfMsL,GAAXvF,IAAAJ,EAOM,MAPNC,GAOM,CANMpG,EAAA,iBAAc,WAAzBmG,EAEM,MAAAE,GAAAC,EADF6D,KAAE,eAAA,CAAA,EAAoB,OAAI9J,EAAAA,EAAAK,CAAA,EAAK,OAALL,YAAAA,EAAW,SAAS,EAAA,CAAA,QAElD8F,EAEM,MAAAK,GAAAF,EADF6D,KAAE,eAAA,CAAA,EAAoB,OAAI9J,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,WAAW,EAAA,CAAA,eAGlEE,EAEM,MAFNkG,GAEMH,EADF6D,EAAAA,gBAAiB,KACrB,CAAA,EACA5J,EAGO,MAAA,CAFN,UAAQF,EAAAgK,CAAA,EAAW,KAAK,SACxB,MAAM,wRAIR9J,EA8JM,MA9JNoG,GA8JM,CA7JLpG,EA4JM,MA5JNqG,GA4JM,CA3JLrG,EAmBM,MAnBNsG,GAmBM,CAlBLtG,EAEM,MAFNwG,GAEMT,EADF6D,EAAAA,GAAE,YAAA,CAAA,EAAA,CAAA,EAEN5J,EAcM,MAdN2G,GAcM,CAbQ6E,EAAA,WAAb3L,EAEQC,EAAAoI,EAAA,EAAA,OAFc,MAAM,qBAC3B,IAAqB,MAAlB0B,EAAAA,GAAE,WAAA,CAAA,EAAA,CAAA,YAGM9J,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,MAAAA,EAAwB,YADpCD,EAMQC,EAAAoI,EAAA,EAAA,OAJN,MAAOmF,GAAA,MACR,KAAK,iBAEL,IAAA,OAAoC,aAAjCvN,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,MAAM,EAAA,CAAA,iCAElC2G,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,QAAS,uBAAO6E,kBAC/B,IAAgB,MAAb/B,EAAAA,GAAE,MAAA,CAAA,EAAA,CAAA,cAKMnK,EAAA,gBAAc,OAA+C,CAAA,CAAA,OAAA,OAAA,QAAA,EAAA,UAASK,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,MAAM,KAAWA,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,GAAwB,UAASA,GAAAA,EAAAK,CAAA,EAAK,OAALL,YAAAA,GAAW,OADzKkG,EAAA,EAAAJ,EAeM,MAfNgB,GAeMb,EAPF6D,KAAE,+CAAA,CAAA,EAAoD,MAExDA,EAAAA,6EAGC,CAAA,EAAA,MACCA,EAAAA,GAAE,2EAAA,CAAA,EAAA,CAAA,YAEKoC,EAAY,OAAvBpG,EA4CM,MAAAiB,GAAA,CA3CL7G,EAEM,MAFNsN,GAEMvH,EADF6D,EAAAA,GAAE,4BAAA,EAA+B,OAAO9J,EAAAgK,CAAA,EAAW,KAAK,IAAI,CAAA,EAAA,CAAA,EAGxDuB,EAAA,WAeRzF,EAuBM,MAAAmB,GAAA,CAtBL/G,EAqBM,MArBNkH,GAqBM,CApBLlH,EAEM,MAFNmH,GAEM,CADLV,EAAuC3G,EAAAyN,EAAA,EAAA,CAA7B,MAAM,oBAAoB,CAAA,IAErCvN,EAWI,IAAA,CAVF,KAAMqL,EAAA,MAAe,SACtB,OAAO,SACP,MAAM,+CAENrL,EAEO,OAFPqH,GAEOtB,EADHsF,EAAA,MAAe,SAAS,EAAA,CAAA,EAE5BrL,EAEO,OAFPsH,GAEOvB,EADHjG,MAAYuL,EAAA,MAAe,SAAS,CAAA,EAAA,CAAA,SAIlC8B,GAAA,WADPtN,EAIEC,EAAA0N,EAAA,EAAA,OAFA,uBAAOP,EAAgB,GACxB,MAAM,gGApCTpN,EAeeC,EAAA2N,EAAA,EAAA,OAbb,UAAWZ,EAAO,EAClB,aAAcE,EACd,UAAOxG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGkG,GAASD,EAAeC,CAAI,KAE5B,UACV,CAMS,CAPY,UAAAiB,EAAW,SAAAC,GAAU,iBAAAC,EAAgB,IAAA,CAC1DnH,EAMS3G,EAAAgH,CAAA,EAAA,CANA,QAAO8G,GAAmB,QAASF,cAC3C,IAIE,MAHDA,EAAsB9D,EAAAA,GAAE,gBAAA,EAAmB,OAAO+D,EAAQ,EAAc/D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,iEAgC/D9J,EAAAgK,CAAA,EAAW,KAAK,MAAI,WAApClE,EASM,MAAAiI,GAAA,CARL7N,EAEM,MAFNuH,GAEMxB,EADF6D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,EAENnD,EAIE3G,EAAAkI,EAAA,EAAA,YAHQ1D,EAAA,2CAAAA,EAAM,MAAAkD,GACf,KAAK,OACJ,UAAW2F,GAAA,iDAGdvH,EAWM,MAAAkI,GAAA,CAVL9N,EAEM,MAFN+N,GAEMhI,EADF6D,EAAAA,GAAE,wBAAA,CAAA,EAAA,CAAA,EAENnD,EAME3G,EAAAsI,EAAA,EAAA,CALA,QAAS9D,EAAA,MACT,SAAMiC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGrB,GAASZ,EAAA,MAASY,GAC3B,SAAU,GACV,UAAW,GACZ,YAAY,wHAKApF,EAAAA,EAAAK,CAAA,EAAK,OAALL,YAAAA,EAAW,SAAQA,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,UAAeA,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,MAAAA,EAAwB,WADhGkG,IAAAJ,EAaM,MAbN8B,GAaM,CANL1H,EAEM,MAFNgO,GAEMjI,EADF6D,EAAAA,GAAE,aAAA,CAAA,EAAkB,KAAE7D,IAAGjG,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,YAAa8J,EAAAA,GAAE,WAAA,CAAA,EAAA,CAAA,EAEpE5J,EAEM,MAFN+H,GAEM,CADL/H,EAAoD,MAAA,CAA/C,UAAQF,EAAA+L,CAAA,EAAmB,IAAI,mCAK3BqB,EAAA,OAAXlH,IAAAJ,EAkCM,MAlCNuC,GAkCM,CAjCLnI,EAEM,MAFNqI,GAEMtC,EADF6D,EAAAA,GAAE,SAAA,CAAA,EAAA,CAAA,EAGC9J,EAAA+L,CAAA,EAAmB,SAD1BhM,EAMEC,EAAAkI,EAAA,EAAA,kBAJQlI,EAAA+L,CAAA,EAAmB,IAAI,4CAAvB/L,EAAA+L,CAAA,EAAmB,IAAI,OAAMrE,GACrC,MAAOoC,EAAAA,GAAE,gBAAA,EACV,KAAK,SACJ,QAASwD,GAAA,0DAGJtN,EAAA+L,CAAA,EAAmB,SAD1BhM,EAKEC,EAAAkI,EAAA,EAAA,kBAHQlI,EAAA+L,CAAA,EAAmB,IAAI,2CAAvB/L,EAAA+L,CAAA,EAAmB,IAAI,MAAKrE,GACpC,MAAOoC,EAAAA,GAAE,OAAA,EACV,KAAK,mDAEN5J,EAgBM,MAAA,KAAA,CAfLA,EAEM,MAFNsI,GAEMvC,EADF6D,EAAAA,GAAE,UAAA,CAAA,EAAA,CAAA,EAENnD,EAWE3G,EAAAsI,EAAA,EAAA,CAVA,QAASkD,EAAA,MACT,SAAM/E,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAYrB,GAAG,CAAgBoG,EAAA,MAAWpG,EAAasG,EAAA,MAAO,KAMpE,SAAU,GACV,UAAW,GACZ,YAAY,kSC3JnB,MAAMrL,EAAOC,GAAO,OAAO,EAErBZ,EAAQC,EAORkD,EAAatB,EAAe,CACjC,IAAK,0BACL,WAAWC,EAAQ,OAClB,MAAO,CACN,QAAS,wBACT,UAAW,OACX,QAAS,CACR,WAAY9B,EAAM,aAClB,QAAQiD,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,IACvB,CACA,CACC,EACA,KAAM,EACP,CAAC,sBA1CO,OAAA3C,EAAAK,CAAA,EAAK,MAAQL,EAAA6C,CAAA,EAAW,UAD/B9C,EAIEoO,GAAA,OAFA,aAAcxO,EAAA,aACd,iBAAgBK,EAAAA,EAAA6C,CAAA,EAAW,OAAX7C,YAAAA,EAAiB,OAAI,mDAEvCkG,IAAAJ,EASM,MATN3F,GASM,CARLD,EAEM,aADF4J,EAAAA,GAAE,wCAAA,CAAA,EAAA,CAAA,EAENnD,EAIS3G,EAAAgH,CAAA,EAAA,CAJA,uBAAO4C,EAAAA,gBAAe,GAAI,MAAM,mBACxC,IAEO,CAFP1J,EAEO,cADH4J,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,gBCJF,MAAMqE,EAAW,CACvB,YAAY,CAAE,KAAA1M,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACpC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,CACjB,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAEsD,GAAQ,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CAC5D,CAAG,EAEKpD,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,GAAG,YAAY,EACtB,KAAMA,EAAI,SACb,CACC,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,QAAS,CACR,YAAK,QAAU,SAAS,cAAc,KAAK,EACvC,OAAO,KAAK,KAAK,IAAI,EAAE,OAC1B,KAAK,iBAAiB,KAAK,KAAK,UAAU,EAE1C,KAAK,sBAAqB,EAEpB,KAAK,OACb,CAEA,iBAAiBhB,EAAY,CAC5B,GAAI,KAAK,SAAU,CAClB,MAAMY,EAAMC,GAAUwD,GAAiB,CACtC,aAAcrE,CAClB,CAAI,EACDY,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd,KAAM,CAAE,aAAAiK,CAAY,EAAKC,GAAU,EACnCR,EAAI,QAAQ,QAASO,CAAY,EACjCP,EAAI,MAAM,KAAK,OAAO,EACtB,MACD,CACA,KAAK,QAAQ,UAAY;AAAA;AAAA,8BAEGZ,CAAU;AAAA;AAAA,eAIvC,CAEA,uBAAwB,CACvB,GAAI,KAAK,SACR,OAED,MAAMY,EAAMC,GAAUQ,GAAkB,CACvC,KAAM,aACN,WAAarB,GAAe,CAC3B,KAAK,KAAK,WAAaA,EACvB,KAAK,iBAAiBA,CAAU,CACjC,CAEH,CAAG,EACDY,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd0J,EAAI,MAAM,KAAK,OAAO,CACvB,CAEA,KAAKU,EAAc,CAClB,MAAO,CACN,WAAY,KAAK,KAAK,UACzB,CACC,CACD,o8BCAA,MAAM5L,EAAQC,EAOd,QAAQ,IAAI,kCAAmCD,EAAM,UAAU,EAE/D,MAAM4O,EAAoBlC,GAAuB,CAC/C,QAAS,kBACT,KAAM1M,EAAM,WACZ,KAAM,EACR,CAAC,EACD,QAAQ,IAAI,gCAAiC4O,CAAiB,EAE9DtL,GACE,IAAMsL,EAAkB,IACvBC,GAAW,CACVD,EAAkB,QAAU,GAC5B,QAAQ,IAAI,kDAAmDC,CAAM,CACvE,CACF,EAEA,MAAMC,EAAcrM,GAAY,CAC9B,GAAI,CAACA,EAAS,MAAO,WACrB,MAAMC,EAAM,KAAK,MAAMD,EAAU,IAAI,EAAE,WAAW,SAAS,EAAG,GAAG,EAC3DE,EAAO,KAAK,MAAOF,EAAU,KAAQ,EAAE,EAAE,SAAQ,EAAG,SAAS,EAAG,GAAG,EACnEG,GAAQH,EAAU,IAAI,SAAQ,EAAG,SAAS,EAAG,GAAG,EACtD,MAAO,GAAGC,CAAG,IAAIC,CAAI,IAAIC,CAAI,EAC/B,eAlHatC,EAAAsO,CAAA,EAAkB,SAA7BpI,IAAAJ,EAEM,MAFN3F,GAEM,CAAA,GAAAsG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CADJvG,EAAoC,SAAjC,gCAA6B,EAAA,OAElBF,EAAAsO,CAAA,EAAkB,KAAlCpI,IAAAJ,EA6DM,MA7DNC,GA6DM,CA5DJ7F,EA2DM,MA3DN8F,GA2DM,CAzDJ9F,EAuDM,MAvDNiG,GAuDM,CAtDJjG,EA0BM,MA1BNkG,GA0BM,CAzBJlG,EAwBM,MAxBNmG,GAwBM,CAtBJnG,EAKM,MALNoG,GAKM,CAJJpG,EAEM,MAFNqG,GAEMN,EADDjG,EAAAsO,CAAA,EAAkB,IAAI,YAAU,CAAA,EAAQ,KAC7C,CAAA,EACA7H,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAAgD,MAAA,CAA3C,MAAM,2BAA0B,QAAK,EAAA,KAI5CA,EAOM,MAPNsG,GAOM,CANJtG,EAEM,MAFNwG,GAEMT,EADDjG,KAAkB,IAAI,KAAK,EAAA,CAAA,EAEhCE,EAEM,MAFN2G,GAAqC,WAC5BZ,EAAGjG,EAAAsO,CAAA,EAAkB,IAAI,YAAY,EAAG,WACjD,CAAA,IAEFpO,EAKM,MALN4G,GAKM,CAJJ5G,EAEM,MAFN6G,GAEMd,EADDuI,EAAWxO,EAAAsO,CAAA,EAAkB,IAAI,UAAU,CAAA,EAAA,CAAA,EAEhD7H,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAAqD,MAAA,CAAhD,MAAM,2BAA0B,aAAU,EAAA,gBAMrD4F,EAwBMoB,GAAA,KAAAC,GAxBsBnH,KAAkB,IAAI,OAAM,CAA3CyO,EAAK3L,SAAlBgD,EAwBM,MAAA,CAxBqD,IAAKhD,EAAO,MAAM,oCAE3E5C,EAKM,MALNsN,GAKM,CAJJtN,EAEM,MAFN+G,GAEMhB,EADD6D,EAAAA,gBAAiB,IAAC7D,EAAGnD,EAAK,CAAA,EAAO,KACtC,CAAA,EACA5C,EAAkF,MAAA,CAA7E,MAAM,sCAAsC,UAAQuO,EAAI,4BAG/DvO,EAGM,MAHNmH,GAGM,CAFJnH,EAAuC,OAAA,KAAA+F,EAA7B6D,EAAAA,GAAE,aAAA,CAAA,EAAkB,KAAE,CAAA,EAChC5J,EAAiC,OAAA,CAA3B,UAAQuO,EAAI,qBAGpBvO,EAIM,MAJNqH,GAIM,CAHJrH,EAEO,OAFPsH,GAEOvB,EADFwI,EAAI,MAAM,EAAG,MAAGxI,EAAG,SAASwI,EAAI,cAAa,EAAA,CAAA,EAAQ,MAAI3E,EAAAA,GAAE,QAAA,CAAA,EAAA,CAAA,IAIvD2E,EAAI,UAAfvI,IAAAJ,EAGM,MAHNiI,GAGM,CAFJ7N,EAAoC,OAAA,KAAA+F,EAA1B6D,EAAAA,GAAE,UAAA,CAAA,EAAe,KAAE,CAAA,EAC7B5J,EAAmC,OAAA,CAA7B,UAAQuO,EAAI,uDAO5B3I,EAEM,MAAAkI,GAAA,CAAA,GAAAvH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CADJvG,EAA0C,SAAvC,sCAAmC,EAAA,uHClEzCH,EASUC,EAAAC,EAAA,EAAA,CATA,KAAMN,EAAA,KAAK,sBACpB,IAOE,CALKA,EAAA,MAFPuG,EAAA,EAAAnG,EAOEC,MAPF0O,GAOE,OAND,MAAM,kDAEL,MAAO/O,EAAA,KAAK,UACZ,MAAOA,EAAA,KAAK,WACZ,KAAMA,EAAA,MACCgP,EAAAA,MAAM,EAAA,KAAA,GAAA,CAAA,QAAA,QAAA,MAAA,CAAA,ygBC2EjB,MAAMC,EAAaC,GAAWlP,EAAC,YAAY,EACrCmP,EAAWtO,EAAI,EAAE,EACjBH,EAAOC,GAAO,OAAO,EACrByO,EAAWzO,GAAO,WAAW,EAC7B0O,EAAexO,EAAI,CAAA,CAAE,EACrByO,EAAezO,EAAI,EAAK,EACxB0O,EAAe,OAAO,eAEtBC,EAAkB3O,EAAI,EAAK,EAG3B4O,EAASC,GAAU,EAEpBD,GAGJ,QAAQ,IAAI,oDAAqDA,CAAM,EAGvEA,EAAO,GAAG,UAAW,IAAM,CAC1B,QAAQ,IAAI,oBAAqBA,EAAO,EAAE,EAC1CD,EAAgB,MAAQ,EACzB,CAAC,EAEDC,EAAO,GAAG,gBAAkBE,GAAU,CACrC,QAAQ,MAAM,2BAA4BA,CAAK,CAChD,CAAC,EAEDF,EAAO,GAAG,aAAeG,GAAW,CACnC,QAAQ,KAAK,uBAAwBA,CAAM,EAC3CJ,EAAgB,MAAQ,EACzB,CAAC,GAjBD,QAAQ,MAAM,uDAAuD,EAoBtE,MAAMzP,EAAQC,EAWdwK,GAAU,IAAM,CACfiF,EAAO,GAAG,kBAAoB3N,GAAS,CACtC+N,EAAQ,OAAM,CACf,CAAC,EACDJ,EAAO,GAAG,iBAAmB3N,GAAS,CACrC+N,EAAQ,OAAM,CACf,CAAC,EACDJ,EAAO,GAAG,iBAAmB3N,GAAS,CACrC+N,EAAQ,OAAM,CACf,CAAC,EACDC,EAAiB,CAClB,CAAC,EAED,MAAMD,EAAUjO,EAAe,CAC9B,IAAK,iDACL,MAAO,CAAC,UAAW7B,EAAM,KAAK,EAC9B,WAAW8B,EAAQ,CAClB,MAAO,CACN,MAAO9B,EAAM,MAAM,IACtB,CACC,EACA,KAAM,EACP,CAAC,EAEKgQ,EAAmBnO,EAAe,CACvC,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,IAAK,CACJ,QAAS,mBACT,MAAOsN,EAAS,MAChB,MAAOpP,EAAM,MAAM,IACvB,CACA,CACC,CACD,CAAC,EAEK+P,EAAoB,IAAM,QAC3B9M,EAAAtC,EAAK,OAAL,MAAAsC,EAAW,WACdsM,EAAa,MAAQ,GAErBF,EAAS,OACR,CAAA,EACA,CACC,UAAUtN,EAAM,CACfuN,EAAa,MAAQ,OAAO,OAAOvN,CAAI,EAAE,IAAKpB,IACtC,CACN,MAAOA,EAAK,KACZ,MAAOA,EAAK,SACnB,EACM,EACD4O,EAAa,MAAQ,EACtB,CACJ,CACA,CAEA,EAEMU,GAAY,IAAM,CACvBD,EAAiB,OAChB,CAAA,EACA,CACC,UAAW,CACV,GAAI,CAACZ,EAAS,MACb,MAAO,uBAET,EACA,WAAY,CACXA,EAAS,MAAQ,GACjBU,EAAQ,OAAM,CACf,EACA,QAAQ5N,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,CACH,CACA,CACA,EAEMgO,EAAoBrO,EAAe,CACxC,IAAK,0BACL,WAAWC,EAAQ,CAClB,MAAO,CACN,QAAS,mBACT,KAAMA,EAAO,KACb,UAAW,QACX,MAAOA,EAAO,KACjB,CACC,CACD,CAAC,EAEKqO,EAAcC,GAAU,CAC7BF,EAAkB,OACjB,CACC,KAAME,EAAM,KACZ,MAAOA,EAAM,KAChB,EACE,CACC,UAAW,CACV,GAAI,CAACA,EAAM,MACV,MAAO,uBAET,EACA,WAAY,CACXA,EAAM,SAAW,GACjBN,EAAQ,OAAM,CACf,CACH,CACA,CACA,EAEMO,EAAsBxO,EAAe,CAC1C,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,QAAS,mBACT,KAAMA,EAAO,IAChB,CACC,CACD,CAAC,EAEKwO,EAAeF,GAAU,CAC9BC,EAAoB,OACnB,CACC,KAAMD,EAAM,IACf,EACE,CACC,WAAY,CACXN,EAAQ,OAAM,CACf,CACH,CACA,CACA,EAEA,OAAAS,GAAY,IAAM,CACjBb,EAAO,IAAI,iBAAiB,EAC5BA,EAAO,IAAI,gBAAgB,EAC3BA,EAAO,IAAI,gBAAgB,CAC5B,CAAC,UAxQAlJ,EAAA,EAAAJ,EAwEM,MAxEN3F,GAwEM,CAvEOR,EAAA,uBAAZuG,IAAAJ,EASM,MATNC,GASM,CARLY,EAIS3G,EAAAgH,CAAA,EAAA,CAJD,QAAQ,UAAW,uBAAO4H,EAAA,MAAU,MAChC,OACV,IAA0D,CAA1DjI,EAA0D3G,EAAAkQ,EAAA,EAAA,CAA7C,MAAM,oCAAoC,CAAA,UAGzDhQ,EAEO,OAFP8F,GAEOC,EADHtG,EAAA,MAAM,KAAK,EAAA,CAAA,MAIhBuG,EAAA,EAAA,EAAAJ,EA+CMoB,WA/CwBlH,EAAAwP,CAAA,EAAQ,KAAI,CAA7BM,EAAOhN,UAApBgD,EA+CM,MAAA,KAAA,CA9CL5F,EA6CM,MAAA,CA7CD,MAAKE,GAAA,CAAC,OAAM,CAAA,WAAuB0C,MAAa9C,EAAAwP,CAAA,EAAQ,KAAK,MAAM,CAAA,CAAA,IACvEtP,EAsCM,MAtCNiG,GAsCM,CArCLjG,EAQM,MARNkG,GAQM,CAPLO,EAA8CwJ,GAAA,CAAjC,KAAML,EAAM,KAAM,MAAM,yBACrC5P,EAEO,OAAA,KAAA+F,EADH6J,EAAM,KAAK,SAAS,EAAA,CAAA,EAExB5P,EAEO,OAFPmG,GAEOJ,EADHjG,MAAQ8P,EAAM,QAAQ,CAAA,EAAA,CAAA,IAGJ9P,EAAAK,CAAA,EAAK,KAAK,MAAQyP,EAAM,OAAK,CAAKA,EAAM,WAAa9P,EAAAkP,CAAA,OAA5EnP,EAmBWC,EAAAoQ,EAAA,EAAA,OAjBR,QAAO,QAA0BtG,EAAAA,GAAE,MAAA,YAAqCgG,EAAM,SAAQ,YAAiDhG,EAAAA,GAAE,QAAA,YAAuCkG,EAAYF,CAAK,OAelM,QAAAO,EAAA,CAA4D,CADzC,KAAAC,MAAI,CACvB3J,EAA4D3G,EAAAuQ,EAAA,EAAA,CAA5C,MAAM,mCAAmC,CAAA,kCAGhDT,EAAM,cAAjBhK,EAOM,MAAAQ,GAAA,CANLK,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,QAAS,QAAKU,IAAEmI,EAAWC,CAAK,cAC/C,IAAgB,MAAbhG,EAAAA,GAAE,MAAA,CAAA,EAAA,CAAA,wBAENnD,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,QAAS,QAAKU,IAAEoI,EAAM,SAAQ,eAC7C,IAAmB,MAAhBhG,EAAAA,GAAE,SAAA,CAAA,EAAA,CAAA,sCAIRnD,EAIM3G,EAAAsI,EAAA,EAAA,CAJO,QAASwH,EAAM,MAAQ,SAAS1K,IAAS0K,EAAM,MAAQ1K,GAClE,SAAU0K,EAAM,UAAQ,GAAY,UAAWA,EAAM,UAAQ,GAAY,YAAaA,EAAM,8VAO9Eb,EAAA,QAAiBjP,EAAAkP,CAAA,OAAnCnP,EAEuUC,EAAAsI,EAAA,EAAA,OAFtR,MAAM,OAAQ,QAASwG,EAAA,MAAW,SAAUE,EAAA,MAC3F,SAAMvI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGrB,GAAS0J,EAAA,MAAW1J,GAAM,YAAY,0BAA2B,UAAW,GACtF,YAAY,kWACDpF,EAAAkP,CAAA,YAAZhJ,IAAAJ,EAOM,MAPNS,GAOM,aANLrG,EAAc,OAAA,KAAA,KAAA,EAAA,GACdyG,EAIS3G,EAAAgH,CAAA,EAAA,CAJA,uBAAO2I,kBACf,IAEO,CAFPzP,EAEO,cADH4J,EAAAA,GAAE,MAAA,CAAA,EAAA,CAAA,iaC7CV,MAAMC,EAAO8E,GAAWlP,EAAA,YAAC,EACnB6Q,EAAS3B,GAAWlP,EAAC,cAAc,EAEnCD,EAAQC,EAeR8Q,EAAQ7P,GAAS,CACtB,MAAO,GACP,MAAO,EACR,CAAC,EAEK8P,EAAa,IAAM,CACxBD,EAAM,MAAQ,GACdA,EAAM,MAAQ,EACf,EAEME,EAAgBpP,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,IAAK,CACJ,QAAS,mBACT,kBAAmB9B,EAAM,QACzB,kBAAmBA,EAAM,QACzB,MAAO+Q,EAAM,KACjB,CACA,CACC,CACD,CAAC,EAEKG,EAAgBrP,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,IAAK,CACJ,QAAS,mBACT,MAAOA,EAAO,MACd,MAAOiP,EAAM,KACjB,CACA,CACC,CACD,CAAC,EAEKI,EAAepG,GAAU,CAC9BkG,EAAc,OACb,CAAA,EACA,CACC,UAAW,CACV,GAAI,CAACF,EAAM,MACV,MAAO,yBAER,GAAI,CAACA,EAAM,MACV,MAAO,wBAET,EACA,UAAUhP,EAAM,CACfmP,EAAc,OACb,CACC,MAAOnP,EAAK,IAClB,EACK,CACC,WAAY,CACXsI,EAAK,MAAQ,GACbyG,EAAO,MAAM,OAAM,EACnBE,EAAU,EACVjG,EAAK,CACN,CACN,CACA,CACG,EACA,QAAQ7I,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,CACH,CACA,CACA,EAEMkP,EAAgBrG,GAAU,CAC/BV,EAAK,MAAQ,GACb2G,EAAU,EACVjG,GAAA,MAAAA,GACD,EAEAzH,GAAM+G,EAAOrG,GAAU,CACjBA,GACJgN,EAAU,CAEZ,CAAC,EAED,MAAMK,EAAgBlR,GAAS,KAAO,CACrC,MAAOmR,GAAYtR,EAAM,KAAK,EAC9B,KAAM,MACN,QAAS,CACR,CACC,MAAO,GAAG,MAAM,EAChB,QAAS,QACT,QAAU+K,GAAUoG,EAAYpG,CAAK,CACxC,EACE,CACC,MAAO,GAAG,QAAQ,EAClB,QAAS,OACT,QAAUA,GAAUqG,EAAarG,CAAK,CACzC,CACA,CACA,EAAE,oBA3ID1K,EAgBSC,EAAAuK,EAAA,EAAA,YAhBQR,EAAA,2CAAAA,EAAI,MAAArC,GAAG,2BAA4B,GAAO,QAASqJ,EAAA,QACxD,iBACV,IAYM,CAZN7Q,EAYM,MAZNC,GAYM,CAXLD,EAEM,MAAA,KAAA,CADLyG,EAAsE3G,EAAAkI,EAAA,EAAA,CAAhD,WAAAuI,EAAM,MAAN,sBAAAhK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAiB,GAAA+I,EAAM,MAAK/I,GAAG,MAAOoC,EAAAA,GAAE,OAAA,EAAW,KAAK,yCAE9D5J,EAOM,MAAA,KAAA,CANLA,EAEM,MAFN6F,GAEME,EADF6D,EAAAA,GAAE,SAAA,CAAA,EAAA,CAAA,EAENnD,EAE6G3G,EAAAsI,EAAA,EAAA,CAFhG,QAASmI,EAAM,MAAQ,qBAASrL,GAASqL,EAAM,MAAQrL,GAAO,SAAU,GACnF,UAAW,GACZ,YAAY,6JCNX,SAAS6L,IAAqB,CAEpC,OAAO,OAAO,eACf,kxBCoDA,QAAQ,IAAI,uCAAuC,EAYnD,MAAMrC,EAAapO,EAAI,EAAI,EACrB0Q,EAAe1Q,EAAI,IAAI,EACvBH,EAAOC,GAAO,OAAO,EACrB6Q,EAAiB3Q,EAAI,EAAK,EAC1B4Q,EAAU5Q,EAAI,EAAI,EAClB2O,EAAkB3O,EAAI,EAAK,EAG3B4O,EAASC,GAAU,EAEpBD,GAGJ,QAAQ,IAAI,oDAAqDA,CAAM,EAGvEA,EAAO,GAAG,UAAW,IAAM,CAC1B,QAAQ,IAAI,oBAAqBA,EAAO,EAAE,EAC1CD,EAAgB,MAAQ,EACzB,CAAC,EAEDC,EAAO,GAAG,gBAAkBE,GAAU,CACrC,QAAQ,MAAM,2BAA4BA,CAAK,CAChD,CAAC,EAEDF,EAAO,GAAG,aAAeG,GAAW,CACnC,QAAQ,KAAK,uBAAwBA,CAAM,EAC3CJ,EAAgB,MAAQ,EACzB,CAAC,GAjBD,QAAQ,MAAM,uDAAuD,EAoBtE,MAAMzP,EAAQC,EAoCdqD,GAAMmM,EAAkBkC,GAAgB,CACnCA,IACH,QAAQ,IAAI,uDAAuD,EACnEC,EAAqB,EAEvB,CAAC,EAED,MAAMA,EAAwB,IAAM,CACnC,QAAQ,IAAI,0BAA0B,EACtC,QAAQ,IAAI,SAAU5R,CAAK,EAEvBW,EAAK,OACJX,EAAM,OAAS,UAClB,QAAQ,IAAI,4BAA4B,EACxC6R,EAAoB,OAAM,EAC1B,QAAQ,IAAI,QAASL,EAAa,KAAK,GAEvCE,EAAQ,MAAQ,GAEjBZ,EAAO,OAAM,GAGdpB,EAAO,GAAG,uBAAyB3N,GAAS,CAC3C+O,EAAO,QAAO,CACf,CAAC,EAEG9Q,EAAM,gBACT,WAAW,IAAM,CAChB8R,EAAW,CACZ,EAAG,GAAG,CAER,EAEMA,EAAc,IAAM,CACzB,IAAIC,EAAkBR,GAAkB,EACxCQ,EAAgB,UAAYA,EAAgB,YAC7C,EAEMF,EAAsBhQ,EAAe,CAC1C,IAAK,8CACL,MAAO,GACP,YAAa,CACZ,MAAO,CACN,QAAS7B,EAAM,QACf,QAASA,EAAM,QACf,MAAOA,EAAM,KAChB,CACC,EACA,UAAU+B,EAAM,CACf,QAAQ,IAAI,gCAAiCA,CAAI,EAC7CA,IACHyP,EAAa,MAAQzP,EACrB,QAAQ,IAAI,qBAAsByP,EAAa,KAAK,EACpDtC,EAAW,MAAQ,GACnBwC,EAAQ,MAAQ,IAEjB,QAAQ,IAAI,sBAAuBA,EAAQ,KAAK,CACjD,EACA,QAAQ9B,EAAO,CACd,QAAQ,MAAM,+BAAgCA,CAAK,EACnD8B,EAAQ,MAAQ,EACjB,CACD,CAAC,EAGKZ,EAASjP,EAAe,CAC7B,IAAK,gDACL,MAAO,CAAC,SAAU7B,EAAM,QAASA,EAAM,OAAO,EAC9C,YAAa,CACZ,MAAO,CACN,QAASA,EAAM,QACf,QAASA,EAAM,QACf,cAAeA,EAAM,YACxB,CACC,CACD,CAAC,EAEKgS,EAAejB,GAAU,CAC9B7B,EAAW,MAAQ,GACnBsC,EAAa,MAAQT,CACtB,EAEMkB,GAAiB,IAAM,CAC5BR,EAAe,MAAQ,EACxB,4CAhOCjR,EAOM,MAAA,KAAA,EANUP,EAAA,cAAgBD,EAAM,OAAI,aAAzCK,EAESC,EAAAgH,CAAA,EAAA,OAF8C,MAAM,cAAe,uBAAO2K,kBAClF,IAA8C,CAA3C7H,GAAAA,EAAAA,EAAAA,GAAE,SAAA,EAAY,OAAO9J,EAAAgR,EAAA,EAAYrR,EAAA,KAAK,CAAA,CAAA,EAAA,CAAA,oBAE1CO,EAEM,MAFNC,GAEM8F,EADF6D,EAAAA,GAAGnK,EAAA,KAAK,CAAA,EAAA,CAAA,IAGFyR,EAAA,OAAW1R,EAAM,OAAI,cAAhCoG,EAIM,MAAAC,GAAA,CAAA,GAAAU,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAHLvG,EAEM,MAAA,CAFD,MAAM,mBAAmB,EAAA,CAC7BA,EAAkC,YAA5B,uBAAqB,qBAGlBR,EAAM,OAAI,UAAA,CAAkB0R,EAAA,WAAvCtL,EAQM,MAAAE,GAAA,aANL9F,EAEM,MAAA,CAFD,MAAM,2CAA2C,EAAA,KAAA,EAAA,GAGtDyG,EAA6GiL,GAAA,YAAnFT,EAAA,2CAAAA,EAAc,MAAAzJ,GAAG,MAAO/H,EAAA,MAAQ,QAASD,EAAM,QAAU,QAASA,EAAM,4DACzEwR,EAAA,MAAa,WAAtCnR,EACmC8R,GAAA,OADW,MAAOX,EAAA,MAAa,MAAQ,aAAc,GAC/E,WAAYtC,EAAA,2CAAAA,EAAU,MAAAlH,0DAErB1H,EAAAA,EAAAwQ,CAAA,EAAO,OAAPxQ,MAAAA,EAAa,SAAWL,EAAA,kBAAnCmG,EAuBM,MAAAK,GAAA,CAtBMyI,EAAA,OAAX1I,EAAA,EAAA,EAAAJ,EAkBMoB,cAlB0ClH,EAAAwQ,CAAA,EAAO,KAAI,CAA5BC,EAAO3N,SAAtCgD,EAkBM,MAAA,CAlBwD,IAAKhD,GAAK,CACvE5C,EAgBM,MAAA,CAhBA,QAAKwH,GAAEgK,EAAYjB,CAAK,EAAG,MAAKrQ,GAAA,CAAC,+CAA8C,CAAA,WAC9D0C,KAAa9C,EAAAwQ,CAAA,EAAO,KAAK,MAAM,CAAA,CAAA,IACrD7J,EAAyDwJ,GAAA,CAA5C,KAAMM,EAAM,KAAM,KAAK,MAAM,MAAM,yBAChDvQ,EAYM,MAAA,KAAA,CAXLA,EAEM,MAFNmG,GAEMJ,EADFwK,EAAM,KAAK,EAAA,CAAA,EAEfvQ,EAOM,MAPNoG,GAOM,CANLpG,EAEO,OAAA,KAAA+F,EADHwK,EAAM,KAAK,SAAS,EAAA,CAAA,EAExBvQ,EAEO,OAFPqG,GAEON,EADHjG,MAAQyQ,EAAM,QAAQ,CAAA,EAAA,CAAA,6BAM9B3K,EAEM,MAAAU,GAAA,CADLG,EAA2EkL,GAAA,CAAvD,MAAOX,EAAA,MAAsB,WAAYtC,EAAA,2CAAAA,EAAU,MAAAlH,0CAGzExB,IAAAJ,EAUM,MAVNY,GAUM,CATLC,EAAqE3G,EAAA8R,EAAA,EAAA,CAAlD,MAAM,yCAAyC,CAAA,EAClE5R,EAOM,MAPN2G,GAOM,CANMlH,EAAA,iBAAXuG,IAAAJ,EAEM,MAFNgB,GAEMb,EADF6D,EAAAA,GAAGnK,EAAA,eAAe,CAAA,EAAA,CAAA,YAEtBO,EAEM,MAFN6G,GAEMd,EADF6D,EAAAA,GAAGnK,EAAA,cAAc,CAAA,EAAA,CAAA,OAIvBgH,EAC0DiL,GAAA,YADhCT,EAAA,2CAAAA,EAAc,MAAAzJ,GAAG,MAAOoC,EAAAA,GAAE,SAAA,EAAY,OAAOnK,EAAA,KAAK,EAAI,QAASD,EAAM,QAC7F,QAASA,EAAM,QAAiB,aAAcM,EAAAwQ,CAAA,+CAAAA,EAAM,MAAA9I,EAAA,4lCC0EvD,MAAMrH,EAAOC,GAAO,OAAO,EACrBU,EAAQR,EAAI,CAAC,EACnB,IAAIS,EAAgB,KACpB,MAAMG,EAAcZ,EAAI,CAAC,EACVA,EAAI,EAAE,EACrB,MAAMa,EAAUb,EAAI,CAAA,CAAE,EACJA,EAAI,CAAA,CAAE,EACxB,MAAMuR,EAAevR,EAAI,EAAK,EACxBU,EAASC,GAAS,EACxB,IAAI6Q,EAAqB,GAEzB,MAAMC,EAA2B,CAACC,EAAgB,KAAO,CACvD,MAAMC,EAAkB3O,GAAA,GAAKnC,EAAQ,OAC/B+Q,EAAc,CAAA,EAEpBF,EAAc,QAAS5O,IAAa,CAClC,MAAM+O,GAAUF,EAAgB7O,GAAS,IAAI,EAC7C8O,EAAY9O,GAAS,IAAI,EAAI,OAAO+O,IAAY,SAAWA,GAAU,EACvE,CAAC,EAEDhR,EAAQ,MAAQ+Q,CAClB,EAaM1S,EAAQC,EAOd,QAAQ,IAAI,qBAAsBD,EAAM,QAAQ,EAGhD,MAAMuK,EAAO1I,EAAe,CAC5B,IAAK,oBACL,WAAWC,EAAQ,CACjB,MAAO,CACL,QAAS,gBACT,KAAM9B,EAAM,QAChB,CACA,EACA,MAAO,CAAC,OAAQA,EAAM,QAAQ,EAC9B,KAAM,GACN,UAAU+B,EAAM,CACd,OAAKA,GAILA,EAAK,SAAW,SAASA,EAAK,QAAQ,GAAK,EACpCA,IAJL,QAAQ,MAAM,iCAAiC,EACxC,KAIX,EACA,UAAUA,EAAM,CACNA,GAIFA,EAAK,UAAYA,EAAK,WAAa,CAAA,EACnCwQ,EAAyBxQ,EAAK,SAAS,GAKrC,QAAQ,MAAM,2BAA2B,CAEjD,EACA,QAAQG,EAAK,CACT,QAAQ,MAAM,2BAA4BA,CAAG,CACjD,CACF,CAAC,EAGK0Q,EAAezS,GAAS,IAEvB,CAAC,CAACoK,EAAK,IACb,EAEKsI,EAAmB1S,GAAS,IAAM,OACtC,QAAO8C,EAAAD,GAAS,OAAT,YAAAC,EAAe,QAAS,CACjC,CAAC,EAEK6P,GAAcjR,EAAe,CACjC,IAAK,0CACL,WAAWC,EAAQ,CACjB,MAAMoL,EAAa1L,EAAO,aAAa,MAAM,OAAO,WACpD,OAAK0L,EAIE,CACL,OAAQA,CACd,GALM,QAAQ,MAAM,+CAA+C,EACtD,CAAA,EAKX,EACA,KAAM,EACR,CAAC,EAED5J,GACE,IAAMwP,GAAY,KACjBC,GAAS,UACR,GAAI,CAAC,MAAM,QAAQA,CAAI,EACrB,OAEF,MAAMC,EAAgBV,EACtBA,EAAqBS,EAAK,KAAME,IAAU,OAAK,OAAAA,GAAW,SAAShQ,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,MAAI,EAC9E,CAAC+P,GAAiBV,KAAsBpP,IAAAD,EAAAsH,EAAK,OAAL,YAAAtH,EAAW,YAAX,MAAAC,GAAsB,SAChEqP,EAAyBhI,EAAK,KAAK,SAAS,CAEhD,CACF,EAEA,MAAM2I,EAAgB,KAEhBJ,GAAY,MACdA,GAAY,KAAK,QAASG,GAAe,OACnCA,EAAW,SAAShQ,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,QACjCqP,EAAqB,GAEzB,CAAC,EAEIA,GA2BT,IAAIa,EAAiB,KACrB,MAAM7Q,EAAa,IAAM,CACvB,GAAIiI,EAAK,KAAK,SAAU,CAEtBjJ,EAAM,MAAQiJ,EAAK,KAAK,SAAW,GACnC4I,EAAiB,KAAK,MACtB,MAAMC,EAAUD,EAAiB7R,EAAM,MAAQ,IAE/CC,EAAgB,YAAY,IAAM,CAChC,MAAM8R,EAAc,KAAK,IAAG,EACtBC,EAAgB,KAAK,IAAI,EAAG,KAAK,OAAOF,EAAUC,GAAe,GAAI,CAAC,EAE5E/R,EAAM,MAAQgS,EACd5R,EAAY,MAAQ6I,EAAK,KAAK,SAAW,GAAK+I,EAE1CA,GAAiB,IACnB,cAAc/R,CAAa,EAC3BgS,KAEJ,EAAG,GAAI,CACT,MAEEJ,EAAiB,KAAK,MACtB5R,EAAgB,YAAY,IAAM,CAChC,MAAM8R,EAAc,KAAK,IAAG,EAC5B3R,EAAY,MAAQ,KAAK,OAAO2R,EAAcF,GAAkB,GAAI,CACtE,EAAG,GAAI,CAEX,EAGM3Q,EAAeC,GAAY,CAC/B,MAAME,EAAO,KAAK,MAAMF,EAAU,EAAE,EAAE,WAAW,SAAS,EAAG,GAAG,EAC1DG,GAAQH,EAAU,IAAI,SAAQ,EAAG,SAAS,EAAG,GAAG,EACtD,MAAO,GAAGE,CAAI,IAAIC,CAAI,EACxB,EAGMC,EAAgB1C,GAAS,IACrBmB,EAAM,OAASiJ,EAAK,KAAK,SAAW,IAAO,GACpD,EAWDjH,GAAM3B,EAAU6R,GAAe,CAE/B,EAAG,CAAE,KAAM,GAAM,EAEjB,MAAMC,EAAc,IAAM,CAE1B,MAAMC,EAAaC,GAAMhS,EAAQ,KAAK,EACtC,OAAO,OAAO,QAAQ+R,CAAU,EAAE,IAAI,CAAC,CAACE,EAAc9O,CAAM,KAAO,CACjE,SAAU8O,EACV,OAAQ9O,CACV,EAAE,CACF,EAEM+O,EAAe,CAACD,EAAc5P,IAAU,CAC5CrC,EAAQ,MAAMiS,CAAY,EAAI5P,CAChC,EAEMhB,GAAWnB,EAAe,CAC9B,IAAK,yBACL,WAAWC,EAAQ,OACjB,MAAO,CACL,QAAS,kBACT,QAAS,CACP,QAAQmB,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,KAAMjD,EAAM,QACpB,EACM,OAAQ,CAAC,OAAQ,UAAU,EAC3B,SAAU,eAChB,CACE,EACA,KAAM,GACN,UAAU+B,EAAM,CAGdA,EAAK,QAAQ,CAACoB,EAAYC,IAAU,CAClCD,EAAW,SAAWE,GAAQF,EAAW,QAAQ,EACjDA,EAAW,IAAMC,EAAQ,CAC3B,CAAC,CACH,CACF,CAAC,EAEDE,GACE,IAAMN,GAAS,KACdO,GAAY,CACX,QAAQ,IAAI,yBAA0BA,CAAO,CAC/C,CACF,EAGA,MAAMgQ,GAAa,IAAYnO,GAAA,8BAC/B,GAAI,CACF,MAAM0O,EAAmBL,EAAW,EAG9B/P,GAAY6G,EAAK,KAAK,SAChBA,EAAK,KAAK,SAAW,IAAMjJ,EAAM,OAAS,GAC1CI,EAAY,OAAS,EAGjC,MAAM8D,GAAK,mFAAoF,CAC7F,KAAMxF,EAAM,SACZ,OAAQwB,EAAO,aAAa,MAAM,OAAO,WACzC,QAAQyB,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,QAAS6Q,EACT,WAAYpQ,EAChB,CAAG,EAEDoC,GAAM,QAAQ,GAAG,uCAAuC,CAAC,EACzD,cAAcvE,CAAa,CAC7B,OAASqO,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,EACpD9J,GAAM,QAAM5C,EAAA,IAAI,WAAJ,YAAAA,EAAe,KAAM,GAAG,CACtC,CACA,GAEM6Q,GAAY,IAAM,OACvB,eAAe,MAAQ,EACvB,aAAa,WAAWxJ,EAAK,KAAK,KAAK,EACvCjI,EAAU,EACTiQ,IAAyBtP,EAAAsH,EAAK,OAAL,YAAAtH,EAAW,YAAa,CAAA,CAAE,CACrD,EAEM+Q,EAAa,IAAM,OACrB,aAAa,WAAWzJ,EAAK,KAAK,KAAK,EACvC8H,EAAa,MAAQ,GACrB/P,EAAU,EACViQ,IAAyBtP,EAAAsH,EAAK,OAAL,YAAAtH,EAAW,YAAa,CAAA,CAAE,CAGvD,EAEME,GAAatB,EAAe,CACjC,IAAK,0BACL,OAAQ,CACP,QAAS,kBACT,UAAW,OACX,QAAS,CACR,KAAM7B,EAAM,SACZ,QAAQiD,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,OAAQ,QACX,CACA,EACC,KAAM,GACN,UAAUlB,EAAM,CACf,eAAQ,IAAI,2BAA4BA,CAAI,EACrCA,CACR,EACA,QAAQG,EAAK,CACZ,QAAQ,MAAM,6BAA8BA,CAAG,CAChD,CACD,CAAC,EAGK+R,EAAuBpS,EAAe,CAC3C,IAAK,0BACL,OAAQ,CACP,QAAS,kBACT,UAAW,OACX,QAAS,CACR,KAAM7B,EAAM,SACZ,QAAQkD,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,IACtB,CACA,EACC,KAAM,GACN,UAAUnB,EAAM,CACf,eAAQ,IAAI,gCAAiCA,EAAK,IAAI,EAC/CA,CACR,EACA,QAAQG,EAAK,CACZ,QAAQ,MAAM,6BAA8BA,CAAG,CAChD,CACD,CAAC,EAGD,OAAAuI,GAAU,IAAM,CAGftH,GAAW,OAAM,EACjB8Q,EAAqB,OAAM,CAC5B,CAAC,EAED7H,GAAgB,IAAM,CAChB7K,GACF,cAAcA,CAAa,CAE/B,CAAC,kFApeYqR,EAAA,WAAXxM,EAwHM,MAAA3F,GAAA,CAtHSoS,EAAA,gBAAbrM,IAAAJ,EAiBM,MAjBNC,GAiBM,CAhBJ7F,EAGM,MAHN8F,GAGMC,EAAA,yBAFwBjG,EAAAiK,CAAA,EAAK,KAAK,UAAU,MAAM,IAAK,IAC3DhE,EAAGjG,KAAK,KAAK,UAAU,SAAM,EAAA,WAAA,WAAA,EAAoC,KACnE,CAAA,GACWA,GAAAA,EAAAiK,CAAA,EAAK,OAALjK,MAAAA,GAAW,UAAtBkG,EAAA,EAAAJ,EAIG,MAJHK,GAIGF,EAAA,wDAFoDjG,KAAK,KAAK,QAAQ,WAAA,EAAA,CAAA,aAGjEA,GAAAA,EAAAiK,CAAA,EAAK,OAALjK,MAAAA,GAAW,cAAtB8F,EAMM,MANNM,GAMMH,uFAFH,CAAA,eAKasM,EAAA,SAAqBvS,EAAAA,EAAA2T,CAAA,IAAA3T,MAAAA,EAAsB,OAAQA,EAAAA,EAAA0C,EAAA,EAAS,OAAT1C,MAAAA,EAAa,KAA3EkG,IAAAJ,EAQM,MARNO,GAQM,MAPJtG,EAME6T,GAAA,CALC,MAAO,gBACP,QAAS,kBACT,UAAS5T,GAAAA,EAAAA,EAAA2T,CAAA,IAAA3T,YAAAA,EAAsB,OAAtBA,YAAAA,EAA4B,SAAQA,IAAAA,EAAAA,EAAA0C,EAAA,EAAS,OAAT1C,YAAAA,EAAa,KAAbA,YAAAA,GAAoB,MACjE,MAAKA,IAAAA,GAAAA,EAAA2T,CAAA,IAAA3T,YAAAA,GAAsB,OAAtBA,YAAAA,GAA4B,SAAQA,IAAAA,GAAAA,EAAA0C,EAAA,EAAS,OAAT1C,YAAAA,GAAa,KAAbA,YAAAA,GAAoB,MAC9D,KAAK,2CAIFA,EAAAiK,CAAA,EAAK,KAAK,WAAasI,EAAA,OAAlCrM,IAAAJ,EAQI,MARJQ,GAQI,CAPLpG,EAKM,MALNqG,GAKM,CAJLE,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAAuC,QAAjC,MAAM,EAAE,EAAA+F,EAAK,MAAA,EAAW,KAAE,EAAA,GAChC/F,EAEO,OAFPsG,GAEOP,EADH/D,EAAYlB,EAAA,KAAK,CAAA,EAAA,CAAA,IAGtB2F,EAAyCC,GAAA,CAA3B,SAAUrE,EAAA,KAAa,EAAA,KAAA,EAAA,CAAA,UAAA,CAAA,cAG5B,CAAAwP,EAAA,QAAiBa,EAAa,OAA1C9M,EA0BM,MAAAY,GAAA,CAzBJxG,EAwBM,MAxBN2G,GAwBM,CAvBJ3G,EAEM,MAFN4G,GAEMb,EADDjG,KAAK,KAAK,KAAK,EAAA,CAAA,EAGZA,EAAAiK,CAAA,EAAK,KAAK,cAAgBsI,EAAA,WADlCxS,EAMSC,EAAAgH,CAAA,EAAA,OAJN,QAAOyM,GACR,MAAM,mBAEN,IAA4B,CAAA,GAAAhN,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAA5BvG,EAA4B,cAAnB,OAAA,EAAS,EAAA,aAGNqS,EAAA,MAMEA,EAAA,SAAoBvS,GAAAA,EAAAA,EAAA6C,EAAA,IAAA7C,YAAAA,EAAY,OAAZA,MAAAA,EAAkB,OAAtDkG,IAAAJ,EAEM,MAFNiB,GAEM,CADJJ,EAAiDkN,GAAA,CAApC,WAAY7T,EAAA6C,EAAA,EAAW,KAAK,iCAE3CqD,EAAA,EAAAJ,EAEM,WADD,gGAAgG,CAAA,QAXrG/F,EAMSC,EAAAgH,CAAA,EAAA,OAJN,QAAO0M,EACR,MAAM,mBAEN,IAAiC,CAAA,GAAAjN,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAjCvG,EAAiC,cAAxB,YAAA,EAAc,EAAA,2BAYd6R,EAAA,OAAgBa,EAAa,OAAxC9M,EAiDI,MAAAmB,GAAA,CAhDF/G,EA+CI,MA/CJkH,GA+CI,CA9CRlH,EAEM,MAFNmH,GAEMpB,EADDjG,KAAK,KAAK,KAAK,EAAA,CAAA,EAGZ4S,EAAa,OADrB7S,EAYc+T,EAAA,OAVX,GAAE,gCAA4D9T,EAAAiK,CAAA,EAAK,KAAK,OAMzE,MAAM,4EAEN,IAAkC,CAAlCtD,EAAkC3G,EAAA+T,EAAA,EAAA,CAAvB,MAAM,cAAc,CAAA,cAC/B7T,EAA+D,OAAA,CAAzD,MAAM,UAAU,eAAa,kBAAiB,OAAI,EAAA,qCAGtD4F,EAuBMoB,GAAA,KAAAC,GAvB2BnH,KAAK,KAAK,UAAS,CAAvCsD,EAAUR,UAAvBgD,EAuBM,MAAA,CAvBiD,IAAKxC,EAAS,KAAM,MAAM,wCAC/EpD,EAEM,MAFNoH,GAEMrB,EADCnD,GAAK,CAAA,EAAA,CAAA,EAIV5C,EAEM,MAFNqH,GAEMtB,EADD3C,EAAS,MAAM,EAAG,IAAC2C,EAAG3C,EAAS,SAAM,EAAA,QAAA,QAAA,EAAA,CAAA,EAG5CpD,EAEM,MAFNsH,GAEM,CADJtH,EAA+E,MAAA,CAA1E,UAAQoD,EAAS,iBAAe,6CAEvCpD,EASM,MATNuH,GASM,CAPIpG,EAAA,OAAWA,EAAA,MAAQiC,EAAS,IAAI,IAAM,eAD9CwC,EAOE,WAAA,iCALSzE,EAAA,MAAQiC,EAAS,IAAI,EAAAoE,GAC9B,KAAK,IACL,MAAM,wCACN,YAAY,wBACX,QAAQsM,IAAUT,EAAajQ,EAAS,KAAM0Q,GAAM,OAAO,KAAK,qBAJxD3S,EAAA,MAAQiC,EAAS,IAAI,CAAA,yBAQpCpD,EAIM,MAJN+N,GAIM,CAHJtH,EAES3G,EAAAgH,CAAA,EAAA,CAFA,QAAOiM,EAAU,EAAA,WACxB,IAAqC,CAAA,GAAAxM,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAArCvG,EAAqC,cAA5B,kBAAkB,EAAA,EAAA,yKClGrC,MAAMG,EAAOC,GAAO,OAAO,EAYrBsJ,EAAkB,IAAM,CAC7B,OAAO,SAAS,KAAO,QACxB,eA/Ba5J,EAAAK,CAAA,EAAK,UAAjBN,EAAgDkU,GAAA,OAAxB,SAAUtU,EAAA,6BAClCuG,IAAAJ,EASM,MATN3F,GASM,CARLD,EAEM,aADF4J,EAAAA,GAAE,kCAAA,CAAA,EAAA,CAAA,EAENnD,EAIS3G,EAAAgH,CAAA,EAAA,CAJA,uBAAO4C,EAAe,GAAI,MAAM,mBACxC,IAEO,CAFP1J,EAEO,cADH4J,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,eCAF,MAAMmK,EAAK,CACjB,YAAY,CAAE,KAAAxS,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACpC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,CACjB,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAEoJ,GAAe,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CACnE,CAAG,EAEKlJ,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,GAAG,MAAM,EAChB,KAAMA,EAAI,SACb,CACC,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,QAAS,CACR,YAAK,QAAU,SAAS,cAAc,KAAK,EACvC,OAAO,KAAK,KAAK,IAAI,EAAE,OAC1B,KAAK,WAAW,KAAK,KAAK,IAAI,EAE9B,KAAK,gBAAe,EAEd,KAAK,OACb,CAEA,WAAWf,EAAM,CAChB,GAAI,KAAK,SAAU,CAClB,MAAMW,EAAMC,GAAUsJ,GAAW,CAChC,KAAMlK,CACV,CAAI,EACDW,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd,KAAM,CAAE,aAAAiK,CAAY,EAAKC,GAAU,EACnCR,EAAI,QAAQ,QAASO,CAAY,EACjCP,EAAI,MAAM,KAAK,OAAO,EACtB,MACD,CACA,KAAK,QAAQ,UAAY;AAAA;AAAA,wBAEHX,CAAI;AAAA;AAAA,eAI3B,CAEA,iBAAkB,CACjB,GAAI,KAAK,SACR,OAED,MAAMW,EAAMC,GAAUQ,GAAkB,CACvC,KAAM,OACN,WAAapB,GAAS,CACrB,KAAK,KAAK,KAAOA,EACjB,KAAK,WAAWA,CAAI,CACrB,CACH,CAAG,EACDW,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd0J,EAAI,MAAM,KAAK,OAAO,CACvB,CAEA,KAAKU,EAAc,CAClB,MAAO,CACN,KAAM,KAAK,KAAK,IACnB,CACC,CACD,upFCkNA,MAAM8I,EAAQ,OAAOC,IAAgB,WAAaA,GAAcA,GAAY,QAC5ED,EAAM,OAAOE,EAAY,EAEzB,MAAM/I,EAAiB/K,EAAI,IAAI,EACzB+T,EAAgB/T,EAAI,EAAE,EACtBgL,EAAWhL,EAAI,EAAE,EACjBU,EAASC,GAAS,EAClBd,EAAOC,GAAO,OAAO,EACrBmL,EAAYvK,EAAO,aAAa,MAAM,MAAQ,+BAC9CwK,EAAUlL,EAAI,EAAK,EACnBgU,EAAahU,EAAI,CAAA,CAAE,EACnBiU,EAAY5U,GAAS,IAAA,OAAM,QAAA8C,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,aAAc,GAAK,EACzD+R,EAAgBlU,EAAI,EAAE,EACtBmU,EAAsBnU,EAAI,KAAK,EAC/BoU,EAAUpU,EAAI,EAAE,EAChBoM,GAAa/M,GAAS,IAAMqB,EAAO,aAAa,MAAM,OAAO,UAAU,EACvE2T,EAAehV,GAAS,IAAMH,EAAM,YAAY,EAChDoV,EAAQjV,GAAS,WAAM,OAAA8C,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KAAI,EAGtCoS,EAAsB,CAACC,EAAUrI,IAAS,CAC/C6H,EAAW,MAAQjR,GAAAC,GAAA,GACfgR,EAAW,OADI,CAElB,CAACQ,CAAQ,EAAGrI,CACd,EACA,EAEMsI,EAAkBpV,GAAS,IAAM,CACtC+M,GAAW,OAASiI,EAAa,OAASC,EAAM,KACjD,CAAC,EAEKI,EAAyBF,GAAa,CAC3C,MAA0CrS,GAAA6R,EAAW,MAA5C,EAAAQ,GAAWG,GAAsBxS,GAATyS,EAAAC,GAAS1S,GAAT,CAAxB2S,GAAAN,KACTR,EAAW,MAAQY,CACpB,EAEMG,EAAkB7Q,GAChB,GAAQA,GAAA,MAAAA,EAAM,WAAaA,EAAK,UAAU,SAAQ,EAAG,KAAI,EAAG,QAG9DhF,EAAQC,EAgBdwK,GAAU,IAAM,OACf,OAAO,iBAAiB,UAAWwB,EAAgB,EACnD,QAAQ,IAAI,UAAUhJ,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,IAAI,EACrC,QAAQ,IAAI,kBAAmBjD,EAAM,YAAY,EACjD,QAAQ,IAAI,gBAAiBwB,EAAO,aAAa,MAAM,OAAO,UAAU,EACxEsU,EAAqB,EACrBC,EAAY,SAAS,KAAK,IAAM,OAC/B,QAAQ,IAAI,6BAA8Bb,EAAQ,KAAK,EACvD,QAAQ,IAAI,kBAAkBjS,EAAAiS,EAAQ,QAAR,YAAAjS,EAAe,aAAa,CAC3D,CAAC,EACD,QAAQ,IAAI,kCAAmC+S,EAAgB,IAAI,EACnE,QAAQ,IAAI,sBAAuBC,EAAmB,KAAK,EAC3DC,GAAkB,EAClBC,GAAoB,KAGrB,CAAC,EAED,MAAMlK,GAAoBC,GAAM,CAC3BA,EAAE,MAAQ,MAAQA,EAAE,SAAWA,EAAE,WACpCkK,EAAgB,EAChBlK,EAAE,eAAc,EAElB,EAEAE,GAAgB,IAAM,CACrB,OAAO,oBAAoB,UAAWH,EAAgB,CACvD,CAAC,EAED,MAAMoK,GAAaxU,EAAe,CACjC,IAAK,oBACL,OAAQ,CACP,QAAS,sBACT,KAAM7B,EAAM,YACd,EACC,KAAM,GACN,UAAU+B,EAAM,CACX/B,EAAM,gBAAkB,OAC3BqM,EAAmB,OAAM,CAE3B,CACD,CAAC,EAED,QAAQ,IAAI,oBAAqBrM,EAAM,cAAc,EACrD,MAAMsW,GAAcnW,GAAS,IAAM,OAClC,OAAO8C,EAAAoT,GAAW,OAAX,YAAApT,EAAiB,WACzB,CAAC,EAEKsT,EAAcC,GACfA,GAAcA,EAAW,SAAS,GAAG,EACjC9B,EAAM8B,EAAW,MAAM,GAAG,EAAE,CAAC,CAAC,EAAE,QAAO,EAExC9B,EAAM8B,CAAU,EAAE,QAAO,EAGjC,SAASC,IAAoB,CAC5B,MAAMC,EAAM,IAAI,KAEVC,EAAe,KAAK,MAAMD,EAAI,gBAAe,EAAK,GAAI,EAK5D,MAFkB,GAAGA,EAAI,YAAW,CAAE,IAAI,OAAOA,EAAI,SAAQ,EAAK,CAAC,EAAE,SAAS,EAAG,GAAG,CAAC,IAAI,OAAOA,EAAI,QAAO,CAAE,EAAE,SAAS,EAAG,GAAG,CAAC,IAAI,OAAOA,EAAI,SAAQ,CAAE,EAAE,SAAS,EAAG,GAAG,CAAC,IAAI,OAAOA,EAAI,WAAU,CAAE,EAAE,SAAS,EAAG,GAAG,CAAC,IAAI,OAAOA,EAAI,WAAU,CAAE,EAAE,SAAS,EAAG,GAAG,CAAC,IAAI,OAAOC,CAAY,EAAE,SAAS,EAAG,GAAG,CAAC,EAG9S,CACA,MAAMC,EAAqB5R,GAAS,cACnC,GAAI,CAAC6Q,EAAe7Q,CAAI,EACvB,OAGD,MAAM6R,EAAa/B,EAAW,MAAM9P,EAAK,IAAI,EACvC8R,IAAY7T,GAAAiS,EAAQ,QAAR,YAAAjS,GAAe,UAAW,KACtC8T,KAAc7T,GAAAgS,EAAQ,QAAR,YAAAhS,GAAe,iBAAgB4J,GAAAnM,EAAK,OAAL,YAAAmM,GAAW,WACxDkK,GAAWP,GAAiB,EAClCvF,EAAc,OACb,CACC,KAAMlM,EAAK,KACX,MAAOA,EAAK,UACZ,aAAc6R,EACd,QAASC,EACT,YAAaC,GACb,OAAQ/R,EAAK,KACb,SAAUgS,GACV,YAAa,UACb,WAAY,uBACf,EACE,CACC,WAAY,CACXlR,GAAM,QAAQ,GAAG,2BAA2B,CAAC,EAC7Cd,EAAK,UAAY,GACb6R,GACHrB,EAAsBxQ,EAAK,IAAI,EAEhCiS,GAAsB,CACvB,EACA,QAAQ/U,GAAK,OACZ4D,GAAM,QAAM7C,EAAAf,GAAI,WAAJ,YAAAe,EAAe,KAAMf,EAAG,CACrC,CACH,CACA,CACA,EAGMgV,EAAkBrV,EAAe,CACtC,IAAK,mDACL,WAAWC,EAAQ,CAClB,MAAO,CACN,YAAaN,EAAO,aAAa,MAAM,OAAO,WAC9C,cAAexB,EAAM,YACxB,CACC,EACA,KAAM,GACN,UAAU+B,EAAM,CACfA,GAAA,MAAAA,EAAM,QAASsU,GAAe,CACzBA,GAAc,OAAOA,EAAW,WAAc,cACjDA,EAAW,UAAY,GAEzB,GACA,QAAQ,IAAI,iCAAkCtU,CAAI,CAEnD,CACD,CAAC,EAIKgU,EAAclU,EAAe,CAClC,IAAK,0CACL,WAAWC,EAAQ,OAClB,MAAO,CACN,YAAaN,EAAO,aAAa,MAAM,OAAO,WAC9C,MAAMyB,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,IACpB,CACC,EACA,KAAM,GACN,UAAUlB,EAAM,CACfmT,EAAQ,MAAQnT,EAChB,QAAQ,IAAI,mBAAoBmT,EAAQ,KAAK,CAC9C,CACD,CAAC,EAKKc,EAAkBnU,EAAe,CACtC,IAAK,uDACL,WAAWC,EAAQ,OAClB,MAAO,CACN,YAAaN,EAAO,aAAa,MAAM,OAAO,WAC9C,cAAexB,EAAM,aACrB,OAAOiD,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,IACrB,CACC,EACA,KAAM,GACN,UAAUlB,EAAM,CACf,QAAQ,IAAI,4BAA6BA,CAAI,CAC9C,CACD,CAAC,EAEKkU,EAAqB9V,GAAS,IACnC,MAAM,QAAQ6V,EAAgB,IAAI,GAAKA,EAAgB,KAAK,OAAS,CACtE,EAIA1S,GAAMiS,EAAwB4B,GAAY/R,GAAA,sBACrC+R,IACH,MAAMrB,EAAqB,EAE7B,EAAC,EAED,MAAMA,EAAwB,IAAY1Q,GAAA,sBACzC,GAAI,CAEH,MAAM8R,EAAgB,OAAO,CAC5B,YAAahK,GAAW,MACxB,cAAeiI,EAAa,KAC/B,CAAG,EAED,MAAMa,EAAgB,OAAO,CAC5B,YAAa9I,GAAW,MACxB,cAAeiI,EAAa,MAC5B,MAAOC,EAAM,KAChB,CAAG,CACF,OAASxF,EAAO,CACf,QAAQ,MAAM,oCAAqCA,CAAK,CACzD,CACD,GAIMuG,GAAsBhW,GAAS,IAAM,OAE1C,IAAIiX,EAAqBzD,GAAMuD,EAAgB,IAAI,EAInD,GAHA,QAAQ,IAAI,iCAAkCE,CAAkB,EAG5DrC,EAAU,MACb,IAAI9R,EAAAoT,GAAW,OAAX,MAAApT,EAAiB,iBAAkB,CACtC,IAAIgS,EAAsBoC,EAC1B,OAAOD,EAAmB,OAAOf,IAChCA,GAAW,gBAAkBpB,EAAoB,KACrD,CACE,KACC,QAAOmC,MAIR,OAAI,CAACrC,EAAU,OAASE,EAAoB,QAAU,MAC9CmC,EAAmB,OAAOf,GAChCA,EAAW,gBAAkBpB,EAAoB,KACrD,EAESmC,CAET,CAAC,EAGKH,GAAyB,IAAM,CACpCnB,EAAqB,CACtB,EAIMxJ,EAAgBzK,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,sBAYlB,MAAO,CACN,IAZS,CACT,QAAS,wBACT,cAAe9B,EAAM,aACrB,YAAYiD,EAAAoT,GAAW,OAAX,YAAApT,EAAiB,gBAC7B,QAAQC,GAAAvC,EAAK,OAAL,YAAAuC,GAAW,KACnB,SAAU1B,EAAO,aAAa,MAAM,OAAO,WAC3C,cAAeqT,EAAc,MAC7B,sBAAqB/H,GAAAjB,EAAe,QAAf,YAAAiB,GAAsB,WAAY,KACvD,eAAcwK,GAAApC,EAAQ,QAAR,YAAAoC,GAAe,iBAAgBC,GAAA5W,EAAK,OAAL,YAAA4W,GAAW,WACxD,UAASC,GAAAtC,EAAQ,QAAR,YAAAsC,GAAe,UAAW,IACtC,CAGA,CACC,CACD,CAAC,EAEKtG,EAAgBrP,EAAe,CACpC,IAAK,uBACL,WAAWC,EAAQ,UAClB,MAAM+U,EAAa/U,EAAO,aAC1B,MAAO,CACN,IAAK,CACJ,QAAS,gCACT,QAAQmB,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,KACnB,MAAOnB,EAAO,MACd,QAASA,EAAO,QAChB,YAAaA,EAAO,eAAeoB,GAAAvC,EAAK,OAAL,YAAAuC,GAAW,WAC9C,SAAUpB,EAAO,SACjB,OAAQA,EAAO,KACf,YAAa,UACb,WAAY,wBACZ,cAAc+U,GAAA,YAAAA,EAAY,WAAY,IAC1C,CACA,CACC,EACA,KAAM,EACP,CAAC,EAEKpK,EAAgB5K,EAAe,CACpC,IAAK,sCACL,WAAWC,EAAQ,CAClB,MAAO,CACN,SAAUA,EAAO,KACpB,CACC,EACA,KAAM,GACN,UAAUC,EAAM,CACf8J,EAAe,MAAQ9J,CACxB,CACD,CAAC,EAEKsK,EAAqBK,GAAuB,CACjD,QAAS,wBACT,KAAM1M,EAAM,eACZ,QAAQkC,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,EACA,KAAM,GACN,MAAO,EAACe,GAAAtC,EAAK,OAAL,YAAAsC,GAAW,KAAMjD,EAAM,YAAY,CAC5C,CAAC,EAEDsD,GAAM+I,EAAoB,IAAM,CAC/B,GAAIA,EAAmB,IAAK,CACvBA,EAAmB,IAAI,qBAC1BI,EAAc,OAAO,CACpB,MAAOJ,EAAmB,IAAI,mBAClC,CAAI,EAEFwI,EAAc,MAAQxI,EAAmB,IAAI,eAAiB,GAC9D,QAAQ,IAAI,kBAAmBwI,EAAc,KAAK,EAClD/I,EAAS,MAAQO,EAAmB,IAAI,UAAY,GACpD,MAAMoL,EAAU,EAAQ5L,EAAe,MACjC6L,EAAkB,EAAQ7C,EAAc,MAE1CxI,EAAmB,SAEZ,CAACoL,GAAW,CAACC,EADvB1L,EAAQ,MAAQ,GAIhBA,EAAQ,MAAQ,EAElB,CACD,CAAC,EAGD1I,GAAMuI,EAAgB,IAAM,CACvB7L,EAAM,gBAAkB,OAAS6L,EAAe,QACnDG,EAAQ,MAAQ,GAElB,CAAC,EAED1I,GACC,IAAA,OAAM,OAAAL,EAAAoJ,EAAmB,MAAnB,YAAApJ,EAAwB,OAC9B,CAAC0J,EAAUC,IAAa,CACnBD,IAAaC,GAAYP,EAAmB,MAC/CA,EAAmB,IAAI,OAAS,SAChCL,EAAQ,MAAQ,GAElB,CACD,EAEA,MAAMoK,EAAmB,IAAM,WAC9B,GAAIpW,EAAM,gBAAkB,MAAO,CAClC,IAAI6M,GACHR,EAAmB,KAAOA,EAAmB,IAAI,SAASpJ,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,OAClEC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,KACX,KAEJmJ,EAAmB,SAAS,OAC3BxI,GAAAC,GAAA,GACIuI,EAAmB,KADvB,CAEC,qBAAqBS,EAAAjB,EAAe,QAAf,YAAAiB,EAAsB,SAC3C,UAAWD,GACX,SAAUf,EAAS,MACnB,cAAe+I,EAAc,KAEjC,GACG,CACC,UAAU9S,GAAM,CACf+D,GAAM,QAAQ,GAAG,sBAAsB,CAAC,EACxCkG,EAAQ,MAAQ,GAChBiL,GAAsB,CACvB,CACJ,CACA,CACC,MACClK,GAAgB,CAElB,EAEMA,GAAmB,IAAM,CAC9BT,EAAc,OACb,CAAA,EACA,CACC,UAAUvK,EAAM,CACf+D,GAAM,QAAQ,GAAG,mCAAmC,CAAC,EACjDtE,EAAO,aAAa,MAAM,MAAQ,uBACrCA,EAAO,KAAK,CACX,KAAM,uBACN,OAAQ,CACP,aAAcxB,EAAM,aACpB,eAAgB+B,EAAK,IAC5B,CACA,CAAM,GAED8D,GAAkB,EAClBrE,EAAO,GAAE,GAEV6K,EAAmB,KAAOtK,EAAK,KAC/BiK,EAAQ,MAAQ,GAChBK,EAAmB,OAAM,EACzB4K,GAAsB,CACvB,EACA,QAAQ/U,EAAK,OACZ4D,GAAM,QAAM7C,EAAAf,EAAI,WAAJ,YAAAe,EAAe,KAAMf,CAAG,CACrC,CACH,CACA,CACA,EAEM8K,GAAkBC,GAAS,CAChCjB,EAAQ,MAAQ,GAChBH,EAAe,MAAQoB,CACxB,EAEMpH,GAAqB,IAAM,CAChC,GAAIrE,EAAO,aAAa,MAAM,MAAQ,SAAU,CAC/C,IAAI0L,EAAa1L,EAAO,aAAa,MAAM,OAAO,WAC9C2L,EAAgB3L,EAAO,aAAa,MAAM,OAAO,cACjD4L,EAAe5L,EAAO,aAAa,MAAM,OAAO,aACpD,QAAQ,IAAI,mBAAoB2L,CAAa,EAC7C,QAAQ,IAAI,kBAAmBC,CAAY,EAE3C5H,GAAK,6CAA8C,CAClD,OAAQ0H,EACR,eAAgBC,EAChB,cAAeC,CAClB,CAAG,CACF,CACD,EAEMC,GAAU,IACR,CACN,UACA,OACA,OACA,QACA,OACA,qBACA,yEACF,EAGME,GAAgBN,GAAS,WAC9B,MAAMO,GAAYvK,GAAAgK,EAAK,KAAK,MAAM,GAAG,EAAE,IAAG,IAAxB,YAAAhK,GAA4B,cACxC0U,EAAoB,CAAC,MAAO,OAAQ,MAAO,MAAO,MAAO,MAAO,OAAQ,KAAK,EAEnF,GADgB,GAAAzU,GAAA+J,EAAK,OAAL,MAAA/J,GAAW,WAAW,aAIlC,CAACsK,GAAa,CAACmK,EAAkB,SAASnK,CAAS,GACtD,MAAO,kDAET,EAEMC,EAAmB,IAAM,CAC9BzB,EAAQ,MAAQ,GAChBH,EAAe,MAAQ,IACxB,EAEM6B,EAAqBvN,GAAS,IAAM,WACzC,SACE8C,EAAAtC,EAAK,OAAL,YAAAsC,EAAW,iBACXC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,iBACX4J,EAAAnM,EAAK,OAAL,YAAAmM,EAAW,iBACZ9M,EAAM,gBAAkB,OACxBwB,EAAO,aAAa,MAAM,MAAQ,8BAEpC,CAAC,EAEKoW,EAAsBzX,GAAS,IAAM,WAC1C,MACC,CAACkM,EAAmB,OACnBpJ,EAAAoJ,EAAmB,MAAnB,YAAApJ,EAAwB,UAASC,EAAAvC,EAAK,OAAL,YAAAuC,EAAW,SAC5C4J,EAAAT,EAAmB,MAAnB,YAAAS,EAAwB,SAAU,YAErC,CAAC,EAEKc,GAA0BzN,GAAS,IACjC,CACN,CAAE,MAAO,aAAc,MAAO,YAAY,EAC1C,CAAE,MAAO,SAAU,MAAO,QAAQ,EAClC,CAAE,MAAO,OAAQ,MAAO,MAAM,EAC9B,CAAE,MAAO,OAAQ,MAAO,MAAM,CAChC,CACC,EAEK0N,GAAc1N,GAAS,IACvBkM,EAAmB,IAEbA,EAAmB,IAAI,QAAU,QAAUA,EAAmB,IAAI,QAAU,SAC/E,QACGA,EAAmB,IAAI,QAAU,aACpC,OAEA,MANA,QAQR,EAEK6J,GAAqB,IAAM,CAChC,GAAI,CAAC1U,EAAO,aAAa,MAAM,OAAO,WAAY,CACjD,QAAQ,KAAK,mDAAmD,EAChE,MACD,CAEAgE,GAAK,kDAAmD,CACvD,YAAahE,EAAO,aAAa,MAAM,OAAO,UAChD,CAAE,EACC,KAAM+D,GAAa,CACnByP,EAAc,MAAQzP,GAAY,CAAA,EAClC,QAAQ,IAAI,0BAA2ByP,EAAc,KAAK,CAC3D,CAAC,EACA,MAAOpF,GAAU,CACjB,QAAQ,MAAM,iCAAkCA,CAAK,CACtD,CAAC,CACH,EAEMyH,EAAelX,GAAS,IAAM,OACnC,OAAI4V,EAAY,QACR,GAAG,YAAY,IAEhB9S,EAAAiS,EAAQ,QAAR,YAAAjS,EAAe,gBAAiB,GAAG,mBAAmB,CAC9D,CAAC,EAED,OAAAK,GACC,IAAMyS,EAAY,QACjBrE,GAAY,CACPA,GACJ,QAAQ,IAAI,gCAAiCqE,EAAY,IAAI,CAE/D,CACD,EAEAzS,GACC,IAAM2R,EAAoB,MACzB4C,GAAa,CACb,QAAQ,IAAI,6BAA8BA,CAAQ,EAClD1B,GAAoB,KACrB,CACD,kCAj2BY,OAAA7V,EAAA+V,EAAA,EAAW,UAAtBjQ,EA8QO,MAAA,OA9QqB,MAAK1F,GAAA,CAAC,kCAAiC,CAAA,oBAAA,CAAiCqL,EAAS,CAAA,IAC5GvL,EA8GO,MA9GPC,GA8GO,CA7GKsL,GAAXvF,IAAAJ,EAOM,MAPNC,GAOM,CANMpG,EAAA,iBAAc,WAAzBmG,EAEM,MAAAE,GAAAC,EADF6D,KAAE,eAAA,CAAA,EAAoB,OAAI9J,EAAAA,EAAAK,CAAA,EAAK,OAALL,YAAAA,EAAW,SAAS,EAAA,CAAA,QAElD8F,EAEM,MAAAK,GAAAF,EADF6D,KAAE,eAAA,CAAA,EAAoB,OAAI9J,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,GAAwB,WAAW,EAAA,CAAA,eAGlEE,EAEM,MAFNkG,GAEMH,EADF6D,EAAAA,yBAA0B,KAC9B,CAAA,EACA5J,EAEO,MAAA,CAFF,UAAQF,EAAA+V,EAAA,EAAW,KAAK,OAC5B,MAAM,sRAGW/V,EAAA4W,CAAA,EAAgB,OAASjB,EAAA,QAAwBA,EAAA,OAAkB,CAAKK,GAAA,OAAW,CAAMvB,EAAA,QAA1GvO,IAAAJ,EAqFM,MArFNQ,GAqFM,CAlFOmO,EAAA,gBAAZvO,IAAAJ,EAYM,MAZNS,GAYM,CAXLrG,EAEQ,QAFRsG,GAEQP,EADJ6D,EAAAA,GAAE,iBAAA,CAAA,EAAA,CAAA,KAEN5J,EAOS,SAAA,CAPD,GAAG,mDAAuByU,EAAmB,MAAAjN,GACpD,MAAM,uJACNxH,EAAmD,SAAnDwG,GAAmDT,EAA5B6D,EAAAA,GAAE,YAAA,CAAA,EAAA,CAAA,SACzBhE,EAGSoB,GAAA,KAAAC,GAHeuN,EAAA,MAAT8C,QAAf1R,EAGS,SAAA,CAH+B,IAAK0R,EAAM,cACjD,MAAOA,EAAM,aACX,EAAAvR,EAAAuR,EAAM,eAAa,UAAA,EAAA,EAAA3Q,EAAA,qBALU8N,EAAA,KAAmB,cAWtD7O,EAkEMoB,GAAA,KAAAC,GAlEoB0O,GAAA,MAAdE,QAAZjQ,EAkEM,MAAA,CAlE0C,IAAKiQ,EAAW,KAC/D,MAAM,qEACN7V,EAUM,MAVN4G,GAUM,CATL5G,EAA8D,MAA9D6G,GAA8Dd,EAAhC8P,EAAW,YAAY,EAAA,CAAA,EACrD7V,EAA6D,MAAA,CAAxD,UAAQ6V,EAAW,cAAe,MAAM,sBAC7C7V,EAEM,MAFN+G,GAEMhB,EADFgQ,EAAWF,EAAW,QAAQ,CAAA,EAAA,CAAA,EAEzBA,EAAW,yBAApBjQ,EAGI,IAAA,OAHsC,KAAMiQ,EAAW,oBAC1D,OAAO,SAAS,MAAM,6BACnBjM,EAAAA,GAAE,iBAAA,CAAA,EAAA,EAAA1C,EAAA,cAGPlH,EAYM,MAZNmH,GAYM,EAXLnB,EAAA,EAAA,EAAAJ,EAUMoB,GAAA,KAAAC,GAVe4O,EAAW,QAApBjG,QAAZhK,EAUM,MAAA,CAVoC,IAAKgK,EAAM,SAAU,MAAM,SACpE5P,EAAuE,MAAvEoH,GAAuErB,EAAzC6J,EAAM,aAAeA,EAAM,KAAK,EAAA,CAAA,EAC9D5P,EAEM,MAFNqH,GAEMtB,EADFgQ,EAAWnG,EAAM,QAAQ,CAAA,EAAA,CAAA,EAE7B5P,EAAgD,MAAA,CAA3C,UAAQ4P,EAAM,MAAO,MAAM,sBACvBA,EAAM,kBAAfhK,EAGI,IAAA,OAH0B,KAAMgK,EAAM,aAAc,OAAO,SAC9D,MAAM,6BACHhG,EAAAA,GAAE,iBAAA,CAAA,EAAA,EAAAiE,EAAA,wBAIR7N,EAuCM,MAvCNuH,GAuCM,IAtCLvH,EACmJ,WAAA,CADhI,sBAAAwH,GAAAqO,EAAW,UAASrO,EAAG,YAAaoC,EAAAA,GAAE,kBAAA,EACxD,MAAM,8IADY,CAAA2N,GAAA1B,EAAW,SAAS,IAEvC7V,EAmCM,MAnCN+N,GAmCM,CAlCL/N,EA6BM,MA7BN0H,GA6BM,CA5BgB4M,EAAA,MAAWuB,EAAW,IAAI,GAa/C7P,IAAAJ,EAcM,MAdNoI,GAcM,CAbLhO,EAEM,MAFN+H,GAEM,CADLtB,EAA4B3G,EAAAyN,EAAA,EAAA,CAAlB,MAAM,SAAS,CAAA,IAE1BvN,EAKM,MALNiI,GAKM,CAJLjI,EAAwE,OAAxEmI,GAAwEpC,EAA/CuO,EAAA,MAAWuB,EAAW,IAAI,EAAE,SAAS,EAAA,CAAA,EAC9D7V,EAEO,OAFPqI,GAEOtC,EADHjG,EAAA0X,EAAA,EAAYlD,EAAA,MAAWuB,EAAW,IAAI,EAAE,SAAS,CAAA,EAAA,CAAA,IAGtDpP,EAGS3G,EAAAgH,CAAA,EAAA,CAHD,QAAQ,SAAS,KAAK,KAC5B,QAAKU,GAAEwN,EAAsBa,EAAW,IAAI,cAC7C,IAAkB,MAAfjM,EAAAA,GAAE,QAAA,CAAA,EAAA,CAAA,gCAzBP/J,EAYeC,EAAA2N,EAAA,EAAA,OAZoC,UAAWZ,GAAO,EACnE,aAAcE,GACd,UAAUN,GAASoI,EAAoBgB,EAAW,KAAMpJ,CAAI,IAClD,UACV,CAMS,CAPY,UAAAiB,EAAW,SAAAC,GAAU,iBAAAC,EAAgB,IAAA,CAC1DnH,EAMS3G,EAAAgH,CAAA,EAAA,CANA,QAAO8G,GAAmB,QAASF,EAAW,QAAQ,sBAC9D,IAIE,MAHDA,EAA0B9D,EAAAA,GAAE,gBAAA,EAAmB,OAAO+D,EAAQ,EAAkB/D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,4EAuBvFnD,EAGS3G,EAAAgH,CAAA,EAAA,CAHD,QAAQ,QAAS,SAAQ,CAAGuO,EAAeQ,CAAU,EAC3D,QAAKrO,GAAE4O,EAAkBP,CAAU,cACpC,IAAsB,MAAnBjM,EAAAA,GAAE,YAAA,CAAA,EAAA,CAAA,qDAMO6L,EAAA,OAAsBK,GAAA,OAAevB,EAAA,WAAtD3O,EAEM,MAFN0C,GAEMvC,EADF6D,EAAAA,GAAE,gEAAA,CAAA,EAAA,CAAA,IAEN5D,IAAAJ,EAIM,MAJN2C,GAIMxC,EAHF6D,EAAAA,GAAE,+BAAA,CAAA,EAAoC,IACzC7D,EAAA,kBAAsBjG,EAAA4W,CAAA,EAAgB,IAAI,EAAG,2BACpBjB,EAAA,KAAkB,EAAA,CAAA,KAGlCvI,EAAA,OAAXlH,IAAAJ,EAeM,MAfN4C,GAeM,CAdLxI,EAEM,MAFNyI,GAEM1C,EADF6D,EAAAA,GAAE,SAAA,CAAA,EAAA,CAAA,EAEa9J,EAAA+L,CAAA,EAAmB,SAAtChM,EACkFC,EAAAkI,EAAA,EAAA,kBAD9BlI,EAAA+L,CAAA,EAAmB,IAAI,4CAAvB/L,EAAA+L,CAAA,EAAmB,IAAI,OAAMrE,GAC/E,MAAOoC,EAAAA,GAAE,gBAAA,EAAoB,KAAK,SAAU,QAASwD,GAAA,0DACpCtN,EAAA+L,CAAA,EAAmB,SAAtChM,EACiBC,EAAAkI,EAAA,EAAA,kBADmClI,EAAA+L,CAAA,EAAmB,IAAI,2CAAvB/L,EAAA+L,CAAA,EAAmB,IAAI,MAAKrE,GAAG,MAAOoC,EAAAA,GAAE,OAAA,EAC3F,KAAK,mDACN5J,EAMM,MAAA,KAAA,CALLA,EAEM,MAFN0I,GAEM3C,EADF6D,EAAAA,GAAE,UAAA,CAAA,EAAA,CAAA,KAEN5J,EACmJ,WAAA,sCADhIsL,EAAQ,MAAA9D,GAAG,uBAAOgE,EAAA,MAAO,IAC3C,MAAM,iJADYF,EAAA,KAAQ,kBAIjBmK,EAAA,OA6DZzP,IAAAJ,EAkEM,MAlENwD,GAkEM,CAjELpJ,EAEM,MAFNyX,GAEM1R,EADF6D,EAAAA,GAAE,iCAAA,CAAA,EAAA,CAAA,GAEN5D,EAAA,EAAA,EAAAJ,EA6DMoB,GAAA,KAAAC,GA7DoBnH,EAAA0V,CAAA,EAAgB,KAA9B7S,QAAZiD,EA6DM,MAAA,CA7D2C,IAAKjD,EAAW,MAAQA,EAAW,WACnF3C,EAEM,MAFNqJ,GAEMtD,EADFgQ,EAAWpT,EAAW,QAAQ,CAAA,EAAA,CAAA,EAElC3C,EAAyC,MAAA,KAAA+F,EAAjCpD,EAAW,aAAa,EAAA,CAAA,EACvBA,EAAW,yBAApBiD,EAGI,IAAA,OAHsC,KAAMjD,EAAW,oBAAqB,OAAO,SACtF,MAAM,6BACHiH,EAAAA,GAAE,iBAAA,CAAA,EAAA,EAAAN,EAAA,YAENtJ,EAYM,MAZNuJ,GAYM,EAXLvD,EAAA,EAAA,EAAAJ,EAUMoB,GAAA,KAAAC,GAVetE,EAAW,QAApBiN,QAAZhK,EAUM,MAAA,CAVoC,IAAKgK,EAAM,SAAU,MAAM,SACpE5P,EAAuE,MAAvEwJ,GAAuEzD,EAAzC6J,EAAM,aAAeA,EAAM,KAAK,EAAA,CAAA,EAC9D5P,EAEM,MAFNyJ,GAEM1D,EADFgQ,EAAWnG,EAAM,QAAQ,CAAA,EAAA,CAAA,EAE7B5P,EAAgD,MAAA,CAA3C,UAAQ4P,EAAM,MAAO,MAAM,sBACvBA,EAAM,kBAAfhK,EAGI,IAAA,OAH0B,KAAMgK,EAAM,aAAc,OAAO,SAC9D,MAAM,6BACHhG,EAAAA,GAAE,iBAAA,CAAA,EAAA,EAAA8N,EAAA,wBAIR1X,EAsCM,MAtCN2X,GAsCM,IArCL3X,EACmJ,WAAA,CADhI,sBAAAwH,GAAA7E,EAAW,UAAS6E,EAAG,YAAaoC,EAAAA,GAAE,kBAAA,EACxD,MAAM,8IADY,CAAA2N,GAAA5U,EAAW,SAAS,IAEvC3C,EAkCM,MAlCN4X,GAkCM,CAjCL5X,EA4BM,MA5BN6X,GA4BM,CA3BgBvD,EAAA,MAAW3R,EAAW,IAAI,GAa/CqD,IAAAJ,EAaM,MAbNkS,GAaM,CAZL9X,EAEM,MAFN+X,GAEM,CADLtR,EAA4B3G,EAAAyN,EAAA,EAAA,CAAlB,MAAM,SAAS,CAAA,IAE1BvN,EAKM,MALNgY,GAKM,CAJLhY,EAAwE,OAAxEiY,GAAwElS,EAA/CuO,EAAA,MAAW3R,EAAW,IAAI,EAAE,SAAS,EAAA,CAAA,EAC9D3C,EAEO,OAFPkY,GAEOnS,EADHjG,EAAA0X,EAAA,EAAYlD,EAAA,MAAW3R,EAAW,IAAI,EAAE,SAAS,CAAA,EAAA,CAAA,IAGtD8D,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,SAAS,KAAK,KAAM,QAAKU,GAAEwN,EAAsBrS,EAAW,IAAI,cAC/E,IAAkB,MAAfiH,EAAAA,GAAE,QAAA,CAAA,EAAA,CAAA,gCAxBP/J,EAYeC,EAAA2N,EAAA,EAAA,OAZoC,UAAWZ,GAAO,EACnE,aAAcE,GACd,UAAUN,GAASoI,EAAoBlS,EAAW,KAAM8J,CAAI,IAClD,UACV,CAMS,CAPY,UAAAiB,EAAW,SAAAC,GAAU,iBAAAC,EAAgB,IAAA,CAC1DnH,EAMS3G,EAAAgH,CAAA,EAAA,CANA,QAAO8G,GAAmB,QAASF,EAAW,QAAQ,sBAC9D,IAIE,MAHDA,EAAyB9D,EAAAA,GAAE,gBAAA,EAAmB,OAAO+D,EAAQ,EAAiB/D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,4EAsBrFnD,EAGS3G,EAAAgH,CAAA,EAAA,CAHD,QAAQ,QAAS,SAAQ,CAAGuO,EAAe1S,CAAU,EAC3D,QAAK6E,GAAE4O,EAAkBzT,CAAU,cACpC,IAAsB,MAAnBiH,EAAAA,GAAE,YAAA,CAAA,EAAA,CAAA,qDA1HV5D,IAAAJ,EA4DM,MA5DN+C,GA4DM,CA3DL3I,EA0DM,MA1DNmY,GA0DM,CAxDLnY,EAuDM,MAvDN4I,GAuDM,CAtDL5I,EAaM,MAbNoY,GAaM,CAXLpY,EAUM,MAVNqY,GAUM,CATQ7M,EAAA,WAAb3L,EAEQC,EAAAoI,EAAA,EAAA,OAFc,MAAM,qBAC3B,IAAqB,MAAlB0B,EAAAA,GAAE,WAAA,CAAA,EAAA,CAAA,YAEY9J,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,MAAAA,GAAwB,YAA1CD,EAEQC,EAAAoI,EAAA,EAAA,OAF2C,MAAOmF,GAAA,MAAa,KAAK,iBAC3E,IAAA,OAAoC,aAAjCvN,EAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,EAAwB,MAAM,EAAA,CAAA,iCAElC2G,EAES3G,EAAAgH,CAAA,EAAA,CAFD,QAAQ,QAAS,uBAAO8O,iBAC/B,IAAgB,MAAbhM,EAAAA,GAAE,MAAA,CAAA,EAAA,CAAA,cAKI6L,EAAA,gBAAZzP,IAAAJ,EAsCM,MAtCN0S,GAsCM,CArCF1O,GAAAA,EAAAA,EAAAA,iCAAkC,IACrC,CAAA,KAAA5J,EACmJ,WAAA,sCADhIqU,EAAa,MAAA7M,GAAG,uBAAOgE,EAAA,MAAO,IAChD,MAAM,iJADY6I,EAAA,KAAa,IAGhCrU,EAEM,MAFN6I,GAEM9C,EADF6D,EAAAA,GAAE,gCAAA,CAAA,EAAA,CAAA,EAEeyB,EAAA,WAYrBzF,EAiBM,MAAAkD,GAAA,CAhBL9I,EAeM,MAfN+I,GAeM,CAdL/I,EAEM,MAFNgJ,GAEM,CADLvC,EAAuC3G,EAAAyN,EAAA,EAAA,CAA7B,MAAM,oBAAoB,CAAA,IAErCvN,EAQI,IAAA,CARA,KAAMqL,EAAA,MAAe,SAAU,OAAO,SACzC,MAAM,+CACNrL,EAEO,OAFPkJ,GAEOnD,EADHsF,EAAA,MAAe,SAAS,EAAA,CAAA,EAE5BrL,EAEO,OAFPmJ,GAEOpD,EADHjG,MAAYuL,EAAA,MAAe,SAAS,CAAA,EAAA,CAAA,SAGhC+L,EAAA,WAATvX,EACmFC,EAAA0N,EAAA,EAAA,OADpD,uBAAOP,EAAgB,GACrD,MAAM,gGA3BTpN,EAWeC,EAAA2N,EAAA,EAAA,OAXuB,UAAWZ,GAAO,EAAK,aAAcE,GACzE,UAAOxG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGkG,GAASD,GAAeC,CAAI,KAC5B,UACV,CAMS,CAPY,UAAAiB,EAAW,SAAAC,EAAU,iBAAAC,EAAgB,IAAA,CAC1DnH,EAMS3G,EAAAgH,CAAA,EAAA,CANA,QAAO8G,GAAmB,QAASF,cAC3C,IAIE,MAHDA,EAAwB9D,EAAAA,GAAE,gBAAA,EAAmB,OAAO+D,CAAQ,EAAgB/D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,0EAiGtE9J,GAAAA,EAAAK,CAAA,EAAK,OAALL,YAAAA,GAAW,SAAQA,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,GAAwB,UAAaA,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,MAAAA,GAAwB,WAAhGkG,IAAAJ,EAUM,MAVN2S,GAUM,CANLvY,EAEM,MAFNwY,GAEMzS,EADF6D,EAAAA,GAAE,aAAA,CAAA,EAAkB,KAAE7D,IAAGjG,GAAAA,EAAA+L,CAAA,EAAmB,MAAnB/L,YAAAA,GAAwB,YAAa8J,EAAAA,GAAE,WAAA,CAAA,EAAA,CAAA,EAEpE5J,EAEM,MAFNyY,GAEM,CADLzY,EAAoD,MAAA,CAA/C,UAAQF,EAAA+L,CAAA,EAAmB,IAAI,wMCpPzC,MAAM1L,EAAOC,GAAO,OAAO,EAS3B,eAAQ,IAAI,2BAPEX,EAOgC,YAAY,SA7BlDK,EAAAK,CAAA,EAAK,UADZN,EAIE6Y,GAAA,OAFA,aAAcjZ,EAAA,yCAGhBuG,IAAAJ,EASM,MATN3F,GASM,CARLD,EAEM,aADF4J,EAAAA,GAAE,iDAAA,CAAA,EAAA,CAAA,EAENnD,EAIS3G,EAAAgH,CAAA,EAAA,CAJA,uBAAO4C,EAAAA,gBAAe,GAAI,MAAM,mBACxC,IAEO,CAFP1J,EAEO,cADH4J,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,eCJF,MAAM8O,EAAmB,CAC/B,YAAY,CAAE,KAAAnX,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACpC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,CACjB,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAE+N,GAAgB,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CACpE,CAAG,EAEK7N,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,GAAG,qBAAqB,EAC/B,KAAMA,EAAI,SACb,CACC,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,QAAS,CACR,KAAK,QAAU,SAAS,cAAc,KAAK,EAC3C,MAAM8N,EAAe,KAAK,KAAK,YAAc,KAAK,KAAK,aACvD,OAAIA,EACH,KAAK,yBAAyBA,CAAY,EAE1C,KAAK,8BAA6B,EAE5B,KAAK,OACb,CAEA,yBAAyB/C,EAAY,CACpC,GAAI,CAACA,EAAY,CAChB,QAAQ,KAAK,sEAAsE,EACnF,KAAK,8BAA6B,EAClC,MACD,CACA,GAAI,KAAK,SAAU,CAClB,MAAMnL,EAAMC,GAAUkO,GAAyB,CAC9C,aAAchD,CAClB,CAAI,EACDnL,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd,KAAM,CAAE,aAAAiK,CAAY,EAAKC,GAAU,EACnCR,EAAI,QAAQ,QAASO,CAAY,EACjCP,EAAI,MAAM,KAAK,OAAO,EACtB,MACD,CACA,KAAK,QAAQ,UAAY;AAAA;AAAA,uCAEYmL,CAAU;AAAA;AAAA,eAIhD,CAEA,+BAAgC,CAC/B,GAAI,KAAK,SACR,OAED,MAAMnL,EAAMC,GAAUQ,GAAkB,CACvC,KAAM,qBACN,WAAa0K,GAAe,CAC3B,KAAK,KAAK,WAAaA,EACvB,KAAK,KAAK,aAAeA,EACzB,KAAK,yBAAyBA,CAAU,CACzC,CAEH,CAAG,EACDnL,EAAI,IAAIM,EAAiB,EACzBN,EAAI,IAAI1J,EAAM,EACd0J,EAAI,MAAM,KAAK,OAAO,CACvB,CAEA,KAAKU,EAAc,CACnB,MAAMwN,EAAe,KAAK,KAAK,YAAc,KAAK,KAAK,aACvD,OAAKA,EAGE,CACN,WAAYA,EACZ,aAAcA,CAChB,EALS,CAAA,CAMR,CACD,2NCvDA,MAAME,EAAYxY,EAAI,EAAK,EACrByY,EAAQzY,EAAI,IAAI,EACtB,IAAI0Y,EAAU1Y,EAAI,EAAK,EACnBuS,EAAcvS,EAAI,CAAC,EACnB2Y,EAAW3Y,EAAI,CAAC,EASpB2J,GAAU,IAAM,CACf,WAAW,IAAM,CAChB8O,EAAM,MAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,MAAM,iBAAmB,IAAM,CACpCE,EAAS,MAAQF,EAAM,MAAM,QAC9B,EACAA,EAAM,MAAM,aAAe,IAAM,CAChClG,EAAY,MAAQkG,EAAM,MAAM,WACjC,CACD,EAAG,CAAC,CACL,CAAC,EAED,MAAMG,EAAa,IAAM,CACpBH,EAAM,MAAM,QACfA,EAAM,MAAM,KAAI,EAChBD,EAAU,MAAQ,KAElBC,EAAM,MAAM,MAAK,EACjBD,EAAU,MAAQ,GAEpB,EAEMK,EAAa,IAAM,CACxBJ,EAAM,MAAM,MAAQ,CAACA,EAAM,MAAM,MACjCC,EAAQ,MAAQD,EAAM,MAAM,KAC7B,EAEMK,EAAoB,IAAM,CAC/BL,EAAM,MAAM,YAAclG,EAAY,KACvC,EAEMwG,EAAiB,IAAM,CAC5BP,EAAU,MAAQ,EACnB,EAEMxK,EAAcgL,GAAS,CAC5B,MAAMC,EAAU,KAAK,MAAMD,EAAO,EAAE,EAC9BrX,EAAU,KAAK,MAAMqX,EAAO,EAAE,EACpC,MAAO,GAAGC,CAAO,IAAItX,EAAU,GAAK,IAAM,EAAE,GAAGA,CAAO,EACvD,EAEA,OAAAa,GAAMgW,EAAYU,GAAW,CACxBA,EACHT,EAAM,MAAM,KAAI,EAEhBA,EAAM,MAAM,MAAK,CAEnB,CAAC,cArGAnT,EAiCM,MAAA,KAAA,CA7BL5F,EAEQ,QAAA,CAFA,QAAOqZ,EAAgB,aAAa,aAAa,MAAM,SAC9DrZ,EAAkD,SAAA,CAAzC,IAAK,UAAUP,EAAA,IAAI,EAAG,KAAK,6BAErCO,EAyBM,MAzBN6F,GAyBM,CAxBLY,EAKS3G,EAAAgH,CAAA,EAAA,CALD,QAAQ,QAAS,QAAOoS,IACpB,OACV,IAA0D,CAA7CJ,EAAA,WACbjZ,EAAgDC,EAAA2Z,EAAA,EAAA,OAAlC,MAAM,kCADpB5Z,EAA0DC,EAAA4Z,EAAA,EAAA,OAAlC,MAAM,wCAIhC1Z,EAQE,QAAA,CAPD,KAAK,QACL,IAAI,IACH,IAAKF,EAAAmZ,CAAA,EACN,KAAK,iDACIpG,EAAW,MAAArL,EAAAqL,EAAArL,GACnB,QAAO4R,EACR,MAAM,+CAFGtZ,EAAA+S,CAAA,CAAW,IAIrB7S,EAEO,OAFPiG,GAEOF,EADHuI,EAAWxO,EAAA+S,CAAA,CAAW,CAAA,EAAI,MAAG9M,EAAGuI,EAAWxO,EAAAmZ,CAAA,CAAQ,CAAA,EAAA,CAAA,EAEvDxS,EAKS3G,EAAAgH,CAAA,EAAA,CALD,QAAQ,QAAS,QAAOqS,IACpB,OACV,IAA2D,CAA3CrZ,EAAAkZ,CAAA,OAChBnZ,EAAkDC,EAAA6Z,EAAA,EAAA,OAAlC,MAAM,kCADtB9Z,EAA2DC,EAAA8Z,EAAA,EAAA,OAAlC,MAAM,oXC2BpC,MAAMC,EAAWvZ,EAAI,IAAI,EACnBwZ,EAAiBxZ,EAAI,IAAI,EAC/B,IAAIyZ,EAAUzZ,EAAI,EAAK,EACnBuS,EAAcvS,EAAI,CAAC,EACnB2Y,EAAW3Y,EAAI,CAAC,EAChB0Z,EAAQ1Z,EAAI,EAAK,EAErB,MAAMd,EAAQC,EAWdwK,GAAU,IAAM,CACf,WAAW,IAAM,CAChB4P,EAAS,MAAM,iBAAmB,IAAM,CACvCZ,EAAS,MAAQY,EAAS,MAAM,QACjC,EACAA,EAAS,MAAM,aAAe,IAAM,CACnChH,EAAY,MAAQgH,EAAS,MAAM,WACpC,CACD,EAAG,CAAC,CACL,CAAC,EAED,MAAMI,EAAUta,GAAS,IAAM,CAC9B,GAAIua,EAAW,CACd,IAAIC,EAAM3a,EAAM,KAChB,OAAI2a,EAAI,SAAS,UAAU,IAC1BA,EAAMA,EAAI,QAAQ,WAAY,QAAQ,GAEhC,GAAGA,CAAG,qFACd,CACA,OAAO3a,EAAM,IACd,CAAC,EAEK0a,EAAYva,GAAS,IACnBH,EAAM,MAAQ,eACrB,EAEK4a,EAAY,IAAM,CACvBP,EAAS,MAAM,KAAI,EACnBE,EAAQ,MAAQ,EACjB,EAEMM,EAAa,IAAM,CACxBR,EAAS,MAAM,MAAK,EACpBE,EAAQ,MAAQ,EACjB,EAEMb,EAAa,IAAM,CACpBa,EAAQ,MACXM,EAAU,EAEVD,EAAS,CAEX,EAEME,EAAa,IAAM,CACxBP,EAAQ,MAAQ,EACjB,EAEMZ,GAAa,IAAM,CACxBU,EAAS,MAAM,MAAQ,CAACA,EAAS,MAAM,MACvCG,EAAM,MAAQH,EAAS,MAAM,KAC9B,EAEMT,EAAoB,IAAM,CAC/BS,EAAS,MAAM,YAAchH,EAAY,KAC1C,EAEMvE,EAAcgL,GAAS,CAC5B,MAAMC,EAAU,KAAK,MAAMD,EAAO,EAAE,EAC9BrX,EAAU,KAAK,MAAMqX,EAAO,EAAE,EACpC,MAAO,GAAGC,CAAO,IAAItX,EAAU,GAAK,IAAM,EAAE,GAAGA,CAAO,EACvD,EAEMsY,EAAmB,IAAM,CAC1B,SAAS,kBACZ,SAAS,eAAc,EAEvBT,EAAe,MAAM,kBAAiB,CAExC,oBA9IClU,EAgDM,MAAA,SAhDG,iBAAJ,IAAIkU,EAAiB,MAAM,+BAC/B9Z,EASQ,QAAA,CARN,iCAAYwa,EAAA,YAAAA,EAAA,WAAA,GAAAC,CAAA,GACZ,QAAOH,EACP,QAAOpB,EACR,cAAc,eACd,MAAM,iEACF,WAAJ,IAAIW,IAEJ7Z,EAAsC,SAAA,CAA7B,IAAKia,EAAA,MAAU,KAAMxa,EAAA,uBAE/BO,EAoCM,MApCN6F,GAoCM,CAjCLY,EASS3G,EAAAgH,CAAA,EAAA,CATD,QAAQ,OAAO,EAAA,CACX,OACV,IAIE,CAHMhH,EAAAia,CAAA,OAIRla,EAAoEC,EAAA2Z,EAAA,EAAA,OAArD,QAAOY,EAAY,MAAM,kCALxCxa,EAIEC,EAAA4Z,EAAA,EAAA,OAFA,QAAOU,EACR,MAAM,qCAKT3T,EAKS3G,EAAAgH,CAAA,EAAA,CALD,QAAQ,QAAS,QAAOqS,KACpB,OACV,IAAyD,CAAzCrZ,EAAAka,CAAA,OAChBna,EAAkDC,EAAA6Z,EAAA,EAAA,OAAlC,MAAM,kCADtB9Z,EAAyDC,EAAA8Z,EAAA,EAAA,OAAlC,MAAM,wCAI/B5Z,EAQE,QAAA,CAPD,KAAK,QACL,IAAI,IACH,IAAKF,EAAAmZ,CAAA,EACN,KAAK,iDACIpG,EAAW,MAAArL,EAAAqL,EAAArL,GACnB,QAAO4R,EACR,MAAM,+CAFGtZ,EAAA+S,CAAA,CAAW,IAIrB7S,EAEO,OAFPiG,GAEOF,EADHuI,EAAWxO,EAAA+S,CAAA,CAAW,CAAA,EAAI,MAAG9M,EAAGuI,EAAWxO,EAAAmZ,CAAA,CAAQ,CAAA,EAAA,CAAA,EAEvDxS,EAIS3G,EAAAgH,CAAA,EAAA,CAJD,QAAQ,QAAS,QAAOyT,IACpB,OACV,IAA4C,CAA5C9T,EAA4C3G,EAAA4a,EAAA,EAAA,CAAlC,MAAM,yBAAyB,CAAA,uLChC9C,MAAMC,EAAera,EAAI,IAAI,EAGvBd,EAAQC,EAOdwK,GAAU,IAAYrF,GAAA,sBACrB,MAAMsF,GAAQ,EACd,MAAM0Q,EAAYD,EAAa,MAAM,IAAI,cAAc,oBAAoB,EACvEC,GACHA,EAAU,MAAK,CAEjB,EAAC,EAED,MAAMC,EAAWpO,GAAS,CACzBjN,EAAM,eAAe,CACpB,SAAUiN,EAAK,SACf,UAAWA,EAAK,SAClB,CAAE,CACF,EAEMM,EAAgBN,GAAS,CAC9B,IAAIO,EAAYP,EAAK,KAAK,MAAM,GAAG,EAAE,IAAG,EAAG,YAAW,EACtD,GAAI,CAAC,CAAC,MAAO,OAAQ,MAAO,MAAO,MAAO,MAAO,KAAK,EAAE,SAASO,CAAS,EACzE,MAAO,yCAET,oBA1CCnN,EAMEC,EAAA2N,EAAA,EAAA,CALA,UAAW,CAAA,UAAA,UAAA,UAAA,MAAA,EACX,aAAcV,EACd,UAAOxG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGhF,GAASsZ,EAAQtZ,CAAI,WAC5B,eAAJ,IAAIoZ,EACJ,MAAM,qBCCD,MAAMG,EAAO,CACnB,YAAY,CAAE,KAAAvZ,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACpC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,CACjB,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAEmQ,GAAY,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CAChE,CAAG,EAEKjQ,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,SACP,KAAMA,EAAI,SACb,CACC,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,QAAS,CACR,YAAK,QAAU,SAAS,cAAc,KAAK,EAEvC,KAAK,MAAQ,KAAK,KAAK,SAC1B,KAAK,WAAW,KAAK,IAAI,EAEzB,KAAK,mBAAkB,EAGjB,KAAK,OACb,CAEA,WAAW2B,EAAM,CAChB,GAAI,KAAK,QAAQA,EAAK,SAAS,EAAG,CACrB9B,GAAUqQ,GAAY,CACjC,KAAMvO,EAAK,QACf,CAAI,EACG,MAAM,KAAK,OAAO,EACtB,MACD,SAAW,KAAK,QAAQA,EAAK,SAAS,EAAG,CAC5B9B,GAAUsQ,GAAY,CACjC,KAAMxO,EAAK,QACf,CAAI,EACG,MAAM,KAAK,OAAO,EACtB,MACD,SAAWA,EAAK,WAAa,MAAO,CACnC,KAAK,QAAQ,UAAY,mDACxB,OAAO,SAAS,MACpB,GAAM,UACFA,EAAK,QACT,CAAI,4FACD,MACD,KAAO,CACN,KAAK,QAAQ,UAAY,yBAAyB,UACjDA,EAAK,QACT,CAAI,iBACD,MACD,CACD,CAEA,oBAAqB,CACpB,MAAM/B,EAAMC,GAAUuQ,GAAc,CACnC,eAAiBzO,GAAS,CACzB,KAAK,KAAK,SAAWA,EAAK,SAC1B,KAAK,KAAK,UAAYA,EAAK,UAC3B,KAAK,WAAWA,CAAI,CACrB,CACH,CAAG,EACD/B,EAAI,IAAIM,EAAiB,EACzBN,EAAI,MAAM,KAAK,OAAO,CACvB,CAEA,SAASyQ,EAAW,CACnB,MAAI,GAACA,EAAU,UAAY,CAACA,EAAU,UAIvC,CAEA,KAAK/P,EAAc,CAClB,MAAO,CACN,SAAU,KAAK,KAAK,SACpB,UAAW,KAAK,KAAK,SACxB,CACC,CAEA,QAAQ0B,EAAM,CACb,MAAO,CAAC,MAAO,MAAO,MAAO,MAAO,MAAM,EAAE,SAASA,EAAK,YAAW,CAAE,CACxE,CAEA,QAAQA,EAAM,CACb,MAAO,CAAC,MAAO,MAAO,KAAK,EAAE,SAASA,EAAK,YAAW,CAAE,CACzD,CACD,CCtGO,MAAMsO,EAAS,CACrB,YAAY,CAAE,KAAA7Z,EAAM,IAAAiJ,EAAK,SAAAC,EAAU,OAAA4Q,CAAM,EAAI,CAC5C,KAAK,IAAM7Q,EACX,KAAK,KAAOjJ,GAAQ,CAAA,EACpB,KAAK,OAAS8Z,GAAU,CAAA,EACxB,KAAK,KAAO9Z,EAAK,MAAQ,GACzB,KAAK,SAAWkJ,EAChB,KAAK,YAAc,GAAG,gDAAgD,CACvE,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,WAAW,kBAAmB,CAC7B,MAAO,CACN,OAAQ,OACR,OAAQ,MACX,CACC,CAEA,WAAW,SAAU,CACpB,MAAMC,EAAMC,GAAU,CACrB,OAAQ,IACPC,GAAE0Q,GAAS,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CAC7D,CAAG,EAEKxQ,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EACN,CACN,MAAO,GACP,KAAMA,EAAI,SACb,CACC,CAEA,QAAQgJ,EAAO,CACd,MAAMvS,EAAO,CACZ,KAAMuS,EAAM,OAAO,KAAK,SAC3B,EAEE,KAAK,KAAOvS,EACZ,OAAO,sBAAsB,IAAM,CAC7B,KAAK,UAGV,KAAK,QAAQ,UAAY,KAAK,KAAK,MAAQ,GAC5C,CAAC,CACF,CAEA,WAAW,aAAc,CACxB,MAAO,CACN,KAAM,CAAC,GAAG,CACb,CACC,CAEA,QAAS,CACR,YAAK,QAAU,SAAS,cAAc,KAAK,EAC3C,KAAK,QAAQ,UAAU,IAAI,YAAa,cAAc,EACtD,KAAK,QAAQ,UAAY,KAAK,KAEzB,KAAK,WACT,KAAK,QAAQ,gBAAkB,GAC/B,KAAK,QAAQ,UAAY,KAAK,KAE9B,KAAK,QAAQ,iBAAiB,QAAUuS,GAAU,CACjD,IAAItQ,EAAQsQ,EAAM,OAAO,YACrBA,EAAM,UAAY,IAAMtQ,EAAM,WAAW,GAAG,EAC/C,KAAK,gBAAgBsQ,EAAOtQ,CAAK,EACvBsQ,EAAM,SAAW,IAC3B,KAAK,aAAa,OAAQ,CACzB,MAAO,WACb,CAAM,EACS,YAAY,KAAKA,EAAM,GAAG,EACpC,KAAK,aAAa,YAAa,CAC9B,KAAMtQ,CACZ,CAAM,GACSsQ,EAAM,UAAY,IAAMA,EAAM,UAAY,MACpD,KAAK,aAAaA,CAAK,CAEzB,CAAC,GAGK,KAAK,OACb,CAEA,oBAAqB,CACL,SAAS,iBACvB,2CACH,EACS,QAASyH,GAAU,CACrBA,IAAU,KAAK,SAClB,OAAOA,EAAM,QAAQ,WAEvB,CAAC,EACG,KAAK,QAAQ,UAAU,KAAI,IAAO,GACrC,KAAK,QAAQ,QAAQ,YAAc,KAAK,YAExC,OAAO,KAAK,QAAQ,QAAQ,WAE9B,CAEA,gBAAgBzH,EAAOtQ,EAAO,CAE7B,GADAsQ,EAAM,eAAc,EAChB,CAAC,IAAK,KAAM,MAAO,OAAQ,QAAS,QAAQ,EAAE,SAAStQ,CAAK,EAAG,CAClE,IAAIgY,EAAQhY,EAAM,OAClBsQ,EAAM,OAAO,YAAc,GAC3B,KAAK,aAAa,SAAU,CAC3B,MAAO0H,CACX,CAAI,CACF,CACD,CAEA,aAAa1H,EAAO,CACnBA,EAAM,eAAc,EACpB,IAAI2H,EAAe,KAAK,QAAQ,YAKhC,GAJI3H,EAAM,UAAY,MACrB2H,EAAeA,EAAe,KAG3BA,GAAgB,KAAK,SAASA,CAAY,EAC7C,KAAK,QAAQ,YAAc,GAC3B,KAAK,aAAa,OAAO,UACfA,GAAgB,KAAK,QAAQA,CAAY,EAAG,CACtD,KAAM,CAAE,KAAAC,EAAM,IAAAvB,CAAG,EAAK,KAAK,YAAYsB,CAAY,EAC7CE,EAAY,YAAYxB,CAAG,qBAAqBuB,CAAI,OAC1D,KAAK,aAAa,YAAa,CAC9B,KAAMD,EAAa,QAAQ,iBAAkBE,CAAS,CAC1D,CAAI,CACF,MAAWF,GAAgBA,EAAa,WAAW,IAAI,EACtD,KAAK,aAAa,OAAQ,CACzB,MAAO,YACP,MAAO,CACN,CACC,QAASA,EAAa,QAAQ,KAAM,EAAE,CAC5C,CACA,CACA,CAAI,EACSA,GAAgBA,EAAa,WAAW,IAAI,EACtD,KAAK,aAAa,OAAQ,CACzB,MAAO,UACP,MAAO,CACN,CACC,QAASA,EAAa,QAAQ,KAAM,EAAE,CAC5C,CACA,CACA,CAAI,EACSA,GAAgB,KAAK,WAAWA,CAAY,GACtD,KAAK,QAAQ,YAAc,GAC3B,KAAK,aAAa,QAAS,CAC1B,OAAQA,CACZ,CAAI,GAED,KAAK,aAAa,YAAa,CAC9B,KAAMA,CACV,CAAI,CAEH,CAEM,aAAa3O,EAAMvL,EAAMqB,EAAQ,KAAM,QAAAgC,GAAA,sBAC5C,MAAMgX,EAAe,KAAK,IAAI,OAAO,qBAAoB,EACnDC,EAAe,KAAK,IAAI,OAAO,gBAAgBD,CAAY,EACjE,MAAM,KAAK,IAAI,OAAO,QAAQC,EAAa,GAAI/O,EAAMvL,CAAI,EACzD,KAAK,IAAI,MAAM,MAAM,EAAI,CAC1B,GAEA,KAAK6J,EAAc,CAClB,MAAO,CACN,KAAMA,EAAa,SACtB,CACC,CAEA,SAAS0Q,EAAM,CACd,MAAO,kBAAkB,KAAKA,CAAI,CACnC,CAEA,aAAaA,EAAM,CAClB,MAAMC,EAAQD,EAAK,MAAM,qBAAqB,EAC9C,OAAIC,EACI,CAAE,IAAKA,EAAM,CAAC,EAAG,IAAKA,EAAM,CAAC,CAAC,EAE/B,CAAE,IAAK,GAAI,IAAK,EAAE,CAC1B,CAEA,QAAQD,EAAM,CACb,MAAO,iBAAiB,KAAKA,CAAI,CAClC,CAEA,YAAYA,EAAM,CACjB,MAAMC,EAAQD,EAAK,MAAM,oBAAoB,EAC7C,OAAIC,EACI,CAAE,KAAMA,EAAM,CAAC,EAAG,IAAKA,EAAM,CAAC,CAAC,EAEhC,CAAE,KAAM,GAAI,IAAK,EAAE,CAC3B,CAEA,WAAWD,EAAM,CAChB,MAAO,iBAAiB,KAAKA,EAAK,KAAI,CAAE,CACzC,CACD,CCpMA,MAAME,GAAiB,CAAC,QAAS,MAAM,EACjCC,GAAmB,CACxB,KAAM,cAAe,OAAQ,SAAU,KAAM,OAAQ,GAAI,KAAM,IAAK,MAAO,IAAK,MAAO,aAAc,eAAgB,KAAM,OAC3H,GAAI,KAAM,KAAM,YAAa,KAAM,OAAQ,KAAM,OAAQ,KAAM,OAAQ,WAAY,aAAc,OAAQ,SACzG,KAAM,OAAQ,IAAK,MAAO,SAAU,WAAY,SAAU,WAAY,MAAO,QAAS,WAAY,cAClG,IAAK,MAAO,KAAM,OAAQ,WAAY,aAAc,OAAQ,SAAU,KAAM,OAAQ,KAAM,OAAQ,KAAM,OACxG,IAAK,MAAO,MAAO,gBAAiB,MAAO,QAAS,KAAM,iBAAkB,WAAY,aAAc,KAAM,OAC5G,UAAW,WACZ,EAEO,MAAMC,EAAQ,CAWpB,YAAY,CAAE,KAAA3a,EAAM,IAAAiJ,EAAK,OAAA6Q,EAAQ,SAAA5Q,GAAY,CAV7C0R,GAAA,YACAA,GAAA,eACAA,GAAA,iBACAA,GAAA,aACAA,GAAA,0BACAA,GAAA,uBACAA,GAAA,iBACAA,GAAA,oBACAA,GAAA,uBAGC,KAAK,IAAM3R,EACX,KAAK,SAAWC,EAChB,KAAK,OAAS,CACb,UAAW4Q,EAAO,WAAa,OAAOA,EAAO,WAAc,SAAWA,EAAO,UAAY,GACzF,SAAUA,EAAO,UAAY,OAAOA,EAAO,UAAa,SAAWA,EAAO,SAAW,GACrF,gBAAkBA,EAAO,iBAAmB,OAAOA,EAAO,iBAAoB,UAC1EW,GAAe,SAASX,EAAO,gBAAgB,YAAA,CAAa,EAAKA,EAAO,gBAAkB,MAAA,EAE/F,KAAK,KAAO,CACX,KAAM9Z,EAAK,MAAQ,OAAOA,EAAK,MAAS,SAAWA,EAAK,KAAO,GAC/D,SAAUA,EAAK,UAAY,OAAOA,EAAK,UAAa,SAAWA,EAAK,SAAW,cAC/E,MAAOA,EAAK,OAAS,OAAOA,EAAK,OAAU,SAAWA,EAAK,MAAQ,KAAK,uBAAA,CAAuB,EAEhG,KAAK,kBAAoB,2BACzB,KAAK,eAAiB,wBACtB,KAAK,SAAW,SAAS,cAAc,KAAK,EAC5C,KAAK,YAAc,SAAS,cAAc,OAAO,EACjD,KAAK,eAAiB,SAAS,cAAc,GAAG,EAEhD,KAAK,6BAAA,EAEL,KAAK,IAAI,UAAU,GAAG,OAAQ,QAAS,KAAK,yBAA0B,EAAI,CAC3E,CAEA,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEA,WAAW,UAAW,CACrB,MAAO,CACN,KAAM,GACN,SAAU,GACV,MAAO,EAAA,CAET,CAEA,WAAW,SAAU,CACpB,MAAMmJ,EAAMC,GAAU,CACrB,OAAQ,IAAMC,GAAEwR,GAAM,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,OAAA,CAAS,CAAA,CACpE,EAEKtR,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACN,MAAO,UACP,KAAMA,EAAI,SAAA,CAEZ,CAEA,WAAW,kBAAmB,CAC7B,MAAO,EACR,CAEA,WAAW,kBAAmB,CAC7B,MAAO,EACR,CAEA,QAAS,CACR,MAAMuR,EAAiB,SAAS,cAAc,KAAK,EAC7CC,EAAiB,KAAK,6BAAA,EAE5B,OAAAD,EAAe,aAAa,QAAS,eAAe,EACpD,KAAK,SAAS,aAAa,QAAS,mBAAmB,KAAK,OAAO,eAAe,IAAI,KAAK,KAAK,QAAQ,EAAE,EAC1G,KAAK,SAAS,aAAa,kBAAmB,MAAM,EACpD,KAAK,SAAS,UAAY,KAAK,KAAK,KACpC,KAAK,IAAI,UAAU,GAAG,KAAK,SAAU,OAAQvI,GAAS,KAAK,mBAAmBA,CAAK,EAAG,EAAK,EAC3F,KAAK,IAAI,UAAU,GAAG,KAAK,SAAU,QAASA,GAAS,KAAK,qBAAqBA,CAAK,EAAG,EAAK,EAE9FuI,EAAe,YAAY,KAAK,QAAQ,EACxC,CAAC,KAAK,UAAYA,EAAe,YAAYC,CAAc,EAEpDD,CACR,CAEA,KAAKjR,EAAc,CAClB,OAAO,OAAO,OAAO,KAAK,KAAM,CAAE,KAAM,KAAK,SAAS,UAAW,MAAO,KAAK,uBAAA,EAA0B,CACxG,CAEA,SAAS+P,EAAW,CACnB,MAAK,EAAAA,EAAU,KAAK,KAAA,CAErB,CAEA,SAAU,CACT,KAAK,IAAI,UAAU,IAAI,OAAQ,QAAS,KAAK,yBAA0B,EAAI,EAC3E,KAAK,IAAI,UAAU,IAAI,KAAK,SAAU,OAAQrH,GAAS,KAAK,mBAAmBA,CAAK,EAAG,EAAK,EAC5F,KAAK,IAAI,UAAU,IAAI,KAAK,SAAU,QAASA,GAAS,KAAK,qBAAqBA,CAAK,EAAG,EAAK,EAC/F,KAAK,IAAI,UAAU,IAAI,KAAK,YAAa,QAASA,GAAS,KAAK,wBAAwBA,CAAK,EAAG,EAAK,CACtG,CAEA,8BAA+B,CAC9B,MAAMyI,EAAe,SAAS,cAAc,KAAK,EAC3CC,EAAgB,SAAS,cAAc,KAAK,EAC5CC,EAAY,OAAO,QAAQR,EAAgB,EAEjD,OAAAM,EAAa,aAAa,QAAS,kBAAkB,EAErD,KAAK,eAAe,aAAa,QAAS,yBAAyB,KAAK,OAAO,eAAe,EAAE,EAChG,KAAK,eAAe,UAAY,UAChC,KAAK,YAAY,aAAa,QAAS,sBAAsB,KAAK,OAAO,eAAe,EAAE,EAC1F,KAAK,YAAY,aAAa,OAAQ,MAAM,EAC5C,KAAK,YAAY,aAAa,WAAY,MAAM,EAChD,KAAK,YAAY,MAAQ,KAAK,KAAK,SACnC,KAAK,IAAI,UAAU,GAAG,KAAK,YAAa,QAASzI,GAAS,KAAK,wBAAwBA,CAAK,EAAG,EAAK,EAEpG0I,EAAc,aAAa,QAAS,sBAAsB,EAE1DC,EAAU,QAAQC,GAAY,CAC7B,MAAMC,EAAa,SAAS,cAAc,GAAG,EAC7CA,EAAW,aAAa,QAAS,qBAAqB,KAAK,OAAO,eAAe,EAAE,EACnFA,EAAW,aAAa,WAAYD,EAAS,CAAC,CAAC,EAC/CC,EAAW,YAAcD,EAAS,CAAC,EACnC,KAAK,IAAI,UAAU,GAAGC,EAAY,QAAS7I,GAAS,KAAK,uBAAuBA,EAAO4I,CAAQ,EAAG,EAAK,EAEvGF,EAAc,YAAYG,CAAU,CACrC,CAAC,EAEDJ,EAAa,YAAY,KAAK,cAAc,EAC5CA,EAAa,YAAY,KAAK,WAAW,EACzCA,EAAa,YAAYC,CAAa,EAE/BD,CACR,CAEA,mBAAmBzI,EAAO,CACzB8I,GAAK,eAAe,KAAK,QAAQ,CAClC,CAEA,qBAAqB9I,EAAO,CAC3BA,EAAM,gBAAA,CACP,CAEA,wBAAwBA,EAAO,CAC9BA,EAAM,OAAO,YAAY,UAAU,OAAO,aAAa,CACxD,CAEA,uBAAuBA,EAAO4I,EAAU,CACvC5I,EAAM,OAAO,WAAW,WAAW,cAAc,qBAAqB,EAAE,MAAQ4I,EAAS,CAAC,EAC1F5I,EAAM,OAAO,WAAW,UAAU,OAAO,aAAa,EACtD,KAAK,SAAS,gBAAgB,OAAO,EACrC,KAAK,KAAK,SAAW4I,EAAS,CAAC,EAC/B,KAAK,SAAS,aAAa,QAAS,mBAAmB,KAAK,OAAO,eAAe,IAAI,KAAK,KAAK,QAAQ,EAAE,EAE1GE,GAAK,iBAAiB,KAAK,QAAQ,CACpC,CAEA,0BAA2B,CAC1B,MAAMC,EAAiB,SAAS,iBAAiB,uBAAuB,EACxE,QAASta,EAAI,EAAGua,EAAMD,EAAe,OAAQta,EAAIua,EAAKva,IAAKsa,EAAeta,CAAC,EAAE,UAAU,OAAO,aAAa,CAC5G,CAEA,8BAA+B,CAC9B,MAAMwa,EAAwB,SAAS,cAAc,IAAI,KAAK,cAAc,EAAE,EAC9E,IAAIC,EAAoB,KAAK,uBAAA,EAC7B,GAAKD,EASAA,EAAsB,aAAa,OAAQC,CAAiB,MATrC,CAC3B,MAAMC,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAO,SAAS,cAAc,MAAM,EAC1CD,EAAK,aAAa,MAAO,YAAY,EACrCA,EAAK,aAAa,OAAQD,CAAiB,EAC3CC,EAAK,aAAa,KAAM,KAAK,cAAc,EAEvCC,GAAMA,EAAK,YAAYD,CAAI,CAChC,CAED,CAEA,wBAAyB,CACxB,IAAIE,EAAW,oFAAoF,KAAK,OAAO,eAAe,WAE9H,OAAI,KAAK,OAAO,cAAsB,2EAA2E,KAAK,OAAO,SAAS,YAClI,KAAK,OAAO,WAAUA,EAAW,KAAK,OAAO,UAE1CA,CACR,CACD,uyBC7DA,MAAMC,EAAQC,GAAQ,EAEhBC,EAAehd,EAAI,QAAQ,EAC3Bid,EAAiBjd,EAAI,IAAI,EACzBkd,EAAald,EAAI,EAAE,EACnBmd,EAAgBnd,EAAI,EAAE,EACtBod,EAAQpd,EAAI,EAAE,EACdqd,EAAUrd,EAAI,EAAE,EAChBsd,EAAStd,EAAI,IAAI,EACjBud,EAAkBvd,EAAI,IAAI,EAC1Bwd,EAAoBxd,EAAI,EAAE,EAC1Byd,EAAkBzd,EAAI,EAAE,EACxB0d,EAAa1d,EAAI,EAAE,EACnB2d,EAAe3d,EAAI,EAAK,EACxB4d,GAAmB5d,EAAI,EAAE,EACzB6d,EAAe7d,EAAI,IAAI,EAEvB8d,EAAe,IAAM,SACzB,OAAI,OAAO,QAAW,YACb,KAGP,OAAO,cACP3b,EAAA,OAAO,SAAP,YAAAA,EAAe,eACfC,EAAA,SAAS,cAAc,yBAAyB,IAAhD,YAAAA,EAAmD,aAAa,aAChE,IAEJ,EAEM2b,EAAc,IAAYzZ,GAAA,sBAC9B,MAAM8H,EAAa0Q,EAAM,OAAO,WAEhC,GADA,QAAQ,IAAI,gBAAiB1Q,CAAU,EACnCA,EAAY,CAad,MAAM4R,EAAS,MAZEjd,EAAe,CAC9B,IAAK,0BACL,WAAWC,EAAQ,CACjB,MAAO,CACL,QAAS,kBACT,UAAW,SACX,QAAS,CACP,KAAMoL,CAClB,CACA,CACM,CACN,CAAK,EAC6B,QAC9BkR,EAAO,MAAQU,EAAO,OACtB,QAAQ,IAAI,mBAAoBV,EAAO,KAAK,CAC9C,KACE,gBAAQ,MAAM,uCAAuC,EAChD,IACR,GAEKpe,EAAQC,EAWR8e,EAAY,IAAM,CACtB,GAAI,CAACf,EAAW,MACd,OAGF,MAAMgB,EAAShB,EAAW,MACtB,OAAOhe,EAAM,YAAe,YAC9BA,EAAM,WAAWgf,CAAM,CAE3B,EAEMC,EAAuB,CAAOC,KAAgDC,IAAA/Z,GAAA,MAAhD8Z,EAAgD,GAAAC,GAAA,UAAhDC,EAAa,CAAE,eAAAC,EAAiB,EAAI,EAAK,CAAA,EAAO,CAClF,MAAMC,EAAeF,GAAA,YAAAA,EAAa,OAClC,GAAI,CAACE,EACH,QAGED,GAAkB,CAAClB,EAAQ,MAAM,UACnC,MAAMoB,EAAY,GAGpB,MAAMC,GAAiBrB,EAAQ,MAAM,KAClCa,IAAWA,GAAO,aAAeM,GAAgBN,GAAO,OAASM,CACtE,EAEE,GAAIE,GAAgB,CACdzB,EAAe,QAAUyB,GAAe,OAC1CzB,EAAe,MAAQyB,GAAe,MAExC,MACF,CAEAxB,EAAW,MAAQsB,EACnBhB,EAAkB,MAAQgB,EAC1Bf,EAAgB,MAAQ,CACtB,CACE,GAAI,KACJ,MAAOe,EACP,WAAYA,CAClB,CACA,EACE,MAAMG,GAAW,CAAE,YAAaH,EAAc,EAC9Cf,EAAgB,MAAQ,CACtB,CACE,GAAIF,EAAgB,MACpB,MAAOC,EAAkB,OAASgB,EAClC,WAAYtB,EAAW,OAASsB,CACtC,CACA,CACA,GAEMC,EAAe,IAAYna,GAAA,sBAK/B,GAJKgZ,EAAO,QACV,MAAMS,EAAW,GAGf,CAACT,EAAO,MACV,MAAO,CAAA,EAgBT,MAAMU,EAAS,MAbSjd,EAAe,CACrC,IAAK,yBACL,YAAa,CACX,MAAO,CACL,QAAS,gBACT,QAAS,CACP,OAAQuc,EAAO,KACzB,EACQ,OAAQ,CAAC,OAAQ,aAAc,iBAAkB,eAAe,CACxE,CACI,CACJ,CAAG,EAEoC,MAAK,EAC1C,OAAAD,EAAQ,MAAQW,EACTX,EAAQ,KACjB,GAEMuB,GAAe,IAAYta,GAAA,sBAC/B,GAAI,CAAC6Y,EAAc,MAAO,CACxB,MAAM,yBAAyB,EAC/B,MACF,CAMA,GAJKG,EAAO,QACV,MAAMS,EAAW,GAGf,CAACT,EAAO,MAAO,CACjB,MAAM,kDAAkD,EACxD,MACF,CAEA,GAAI,CAEF,MAAMY,EAAS,MADF,IAAIW,GAAW,CAAE,KAAM,GAAI,SAAU,GAAO,EAC/B,mBAAmBvB,EAAO,MAAOH,EAAc,KAAK,EAE9EE,EAAQ,MAAM,KAAK,CACjB,KAAMa,EAAO,KACb,WAAYA,EAAO,WACnB,eAAgBA,EAAO,eACvB,cAAeA,EAAO,aAC5B,CAAK,EACDhB,EAAW,MAAQgB,EAAO,WAC1BX,EAAgB,MAAQW,EAAO,eAC/BV,EAAkB,MAAQU,EAAO,WACjCjB,EAAe,MAAQiB,EAAO,KAC9BT,EAAgB,MAAQ,CACtB,CACE,GAAIF,EAAgB,MACpB,MAAOC,EAAkB,MACzB,WAAYU,EAAO,UAC3B,CACA,EACIlB,EAAa,MAAQ,SACrBG,EAAc,MAAQ,GACtB,MAAMwB,GAAW,CAAE,SAAUpB,EAAgB,MAAO,YAAaC,EAAkB,MAAO,CAC5F,OAAS1O,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAC7C,MAAMA,EAAM,SAAW,0BAA0B,CACnD,CACF,GAEM6P,GAAa,IAA0CP,IAAA9Z,GAAA,SAAA8Z,GAAA,UAAnC,CAAE,SAAAU,EAAU,YAAAR,CAAW,EAAK,CAAA,EAAO,QAC3D,MAAMS,EAAiBD,GAAA,KAAAA,EAAYvB,EAAgB,MAC7CyB,GAAoB7c,GAAAmc,GAAA,KAAAA,EAAed,EAAkB,QAAjC,KAAArb,GAA0C+a,EAAW,MAE/E,GAAI,CAAC6B,GAAkB,CAACC,EAAmB,CACzC,QAAQ,KAAK,wCAAwC,EACrD,MACF,CAEA,GAAI,CASF,MAAMhB,GAAS,MAROjd,EAAe,CACnC,IAAK,iDACL,OAAQ,CACN,UAAWge,EACX,WAAYC,CACpB,EACM,KAAM,EACZ,CAAK,EACkC,MAAK,EAClCC,IAAUjB,IAAA,YAAAA,GAAQ,UAAW,CAAA,EAEnCN,EAAW,MAAQuB,GAAQ,OAAQC,IAAUA,GAAM,SAAS,EAC5D9B,EAAM,MAAQ6B,GAAQ,OAAQC,IAAU,CAACA,GAAM,SAAS,EAExD3B,EAAgB,OAAQS,IAAA,YAAAA,GAAQ,YAAae,EAC7CvB,EAAkB,OAAQQ,IAAA,YAAAA,GAAQ,cAAegB,EACnD9B,EAAW,MAAQM,EAAkB,KAErC,OAAS1O,GAAO,CACd,QAAQ,MAAM,wBAAyBA,EAAK,EAC5C4O,EAAW,MAAQ,CAAA,EACnBN,EAAM,MAAQ,CAAA,CAChB,CACF,GAEM+B,GAAc,CAAO3L,EAAO4L,EAAe,OAAS9a,GAAA,4BACxD,MAAM+a,EAAWD,KAAgBjd,EAAAqR,GAAA,YAAAA,EAAO,SAAP,YAAArR,EAAe,OAChD,GAAI,GAACkd,GAAY,CAACA,EAAS,QAI3B,IAAI,CAAC9B,EAAgB,OAAS,CAACC,EAAkB,MAAO,CACtD,MAAM,+BAA+B,EACrC,MACF,CAEA,GAAI,CACF,MAAM8B,EAAW,IAAI,SACrB,UAAWnT,MAAQkT,EACjBC,EAAS,OAAO,QAASnT,EAAI,EAE3BoR,EAAgB,OAClB+B,EAAS,OAAO,YAAa/B,EAAgB,KAAK,EAEhDC,EAAkB,OACpB8B,EAAS,OAAO,aAAc9B,EAAkB,KAAK,EAGvD,MAAM+B,GAAYzB,EAAY,EAC9B,GAAI,CAACyB,GAAW,CACd,MAAM,kDAAkD,EACxD,MACF,CAEA,MAAM9a,GAAW,MAAM,MAAM,uDAAwD,CACnF,OAAQ,OACR,KAAM6a,EACN,QAAS,CACP,sBAAuBC,EAC/B,EACM,YAAa,SACnB,CAAK,EAED,GAAI,CAAC9a,GAAS,GAAI,CAChB,MAAMqK,GAAQ,MAAMrK,GAAS,KAAI,EAAG,MAAM,KAAO,CAAA,EAAG,EACpD,QAAQ,MAAM,yBAA0BqK,EAAK,EAC7C,MAAM,UAAUA,GAAM,SAAW,yBAAyB,EAAE,EAC5D,MACF,CAEA,QAAQ,IAAI,8BAA8B,EACtC0E,GAAA,MAAAA,EAAO,SACTA,EAAM,OAAO,MAAQ,IAEvB,MAAMmL,GAAU,CAClB,OAAS7P,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAC7C,MAAM,0CAA0C,CAClD,QAAC,CACC6O,EAAa,MAAQ,EACvB,EACF,GAEM6B,EAAoBC,GAAYnb,GAAA,sBACpC,MAAMib,EAAYzB,EAAY,EAC9B,GAAI,CAACyB,EAAW,CACd,MAAM,kDAAkD,EACxD,MACF,CACA,MAAM,MAAM,qDAAsD,CAC9D,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,sBAAuBA,CAC/B,EACM,KAAM,KAAK,UAAU,CAAE,SAAUE,CAAO,CAAE,EAC1C,YAAa,SACnB,CAAK,EAAE,KAAMhb,GAAaA,EAAS,KAAI,CAAE,EAEvC,MAAMka,GAAU,CAClB,GAEMe,GAAelM,GAAU,CAC7BA,EAAM,eAAc,EACpBA,EAAM,gBAAe,EACjB,GAAC+J,EAAgB,OAAS,CAACC,EAAkB,SAGjDG,EAAa,MAAQ,GACvB,EAEMgC,EAAcnM,GAAU,CACxB,CAAC+J,EAAgB,OAAS,CAACC,EAAkB,QAGjDhK,EAAM,eAAc,EACpBA,EAAM,gBAAe,EACrBA,EAAM,aAAa,WAAa,OAChCmK,EAAa,MAAQ,GACvB,EAEMiC,EAAepM,GAAU,CAC7BA,EAAM,eAAc,EACpBA,EAAM,gBAAe,EACrBmK,EAAa,MAAQ,EACvB,EAEMkC,EAAgBrM,GAAUlP,GAAA,4BAG9B,GAFAkP,EAAM,eAAc,EACpBA,EAAM,gBAAe,EACjB,CAAC+J,EAAgB,OAAS,CAACC,EAAkB,MAAO,CACtD,MAAM,0CAA0C,EAChD,MACF,CACA,MAAM4B,GAAejd,EAAAqR,EAAM,eAAN,YAAArR,EAAoB,MACrCid,GAAA,MAAAA,EAAc,SAChB,MAAMD,GAAY,KAAMC,CAAY,GAEtCzB,EAAa,MAAQ,EACvB,GAEMmC,EAAoB,IAAM,OAC9B,GAAI,CAACvC,EAAgB,OAAS,CAACC,EAAkB,MAAO,CACtD,MAAM,+BAA+B,EACrC,MACF,EACArb,EAAA0b,EAAa,QAAb,MAAA1b,EAAoB,OACtB,EAEM4d,EAAuB7B,GAAW5Z,GAAA,sBACjC4Z,GAAA,MAAAA,EAAQ,OAGbT,EAAgB,MAAQ,CACtB,GAAGA,EAAgB,MACnB,CACE,GAAIS,EAAO,KACX,MAAOA,EAAO,UACd,WAAYA,EAAO,SACzB,CACA,EACEX,EAAgB,MAAQW,EAAO,KAC/BV,EAAkB,MAAQU,EAAO,UACjC,MAAMS,GAAW,CAAE,SAAUT,EAAO,KAAM,YAAaA,EAAO,UAAW,EAC3E,GAEM8B,EAA8B1d,GAAUgC,GAAA,sBAC5C,GAAIhC,EAAQ,GAAKA,GAASmb,EAAgB,MAAM,OAC9C,OAEF,MAAMwC,EAASxC,EAAgB,MAAMnb,CAAK,EAC1Cmb,EAAgB,MAAQA,EAAgB,MAAM,MAAM,EAAGnb,EAAQ,CAAC,EAChEib,EAAgB,MAAQ0C,EAAO,GAC/BzC,EAAkB,MAAQyC,EAAO,MACjC/C,EAAW,MAAQ+C,EAAO,YAAcA,EAAO,MAC/C,MAAMtB,GAAW,CAAE,SAAUsB,EAAO,GAAI,YAAaA,EAAO,YAAcA,EAAO,MAAO,CAC1F,GAEMC,GAAkB,IAAY5b,GAAA,sBAClC,GAAI,CAACsZ,GAAiB,MAAO,CAC3B,MAAM,8BAA8B,EACpC,MACF,CAEA,GAAI,CAACL,EAAgB,OAAS,CAACC,EAAkB,MAAO,CACtD,MAAM,+BAA+B,EACrC,MACF,CAEA,GAAI,CAEF,MADa,IAAIqB,GAAW,CAAE,KAAM,GAAI,SAAU,GAAO,EAC9C,gBAAgB,CACzB,eAAgBtB,EAAgB,MAChC,iBAAkBC,EAAkB,MACpC,cAAeI,GAAiB,KACtC,CAAK,EAEDA,GAAiB,MAAQ,GACzB,MAAMe,GAAU,CAClB,OAAS7P,EAAO,CACd,QAAQ,MAAM,6BAA8BA,CAAK,EACjD,MAAMA,EAAM,SAAW,8BAA8B,CACvD,CACF,GAGAtM,GAAMya,EAAuBkD,GAAc7b,GAAA,sBACzC,GAAI6b,EACF,GAAI,CAaF,MAAMnC,EAAS,MAZEjd,EAAe,CAC9B,IAAK,0BACL,YAAa,CACX,MAAO,CACL,QAAS,gBACT,UAAW,CAAC,aAAc,iBAAkB,eAAe,EAC3D,QAAS,CACP,KAAMof,CACpB,CACA,CACQ,CACR,CAAO,EAC6B,MAAK,EACnCjD,EAAW,OAAQc,GAAA,YAAAA,EAAQ,aAAc,GACzCT,EAAgB,OAAQS,GAAA,YAAAA,EAAQ,iBAAkB,KAClDR,EAAkB,OAAQQ,GAAA,YAAAA,EAAQ,aAAc,GAChDP,EAAgB,MAAQ,CACtB,CACE,GAAIF,EAAgB,MACpB,MAAOC,EAAkB,MACzB,WAAYN,EAAW,KACjC,CACA,EACMe,EAAS,EACT,MAAMU,GAAW,CACf,SAAUpB,EAAgB,MAC1B,YAAaC,EAAkB,KACvC,CAAO,CACH,OAAS1O,EAAO,CACd,QAAQ,MAAM,6BAA8BA,CAAK,CACnD,MAEAoO,EAAW,MAAQ,GACnBK,EAAgB,MAAQ,KACxBC,EAAkB,MAAQ,GAC1BC,EAAgB,MAAQ,CAAA,EACxBC,EAAW,MAAQ,CAAA,EACnBN,EAAM,MAAQ,CAAA,CAElB,EAAC,EAED,IAAIgD,GAAa,GAEjB,OAAAzW,GAAU,IAAYrF,GAAA,sBACpB8b,GAAa,GACb,MAAMrC,EAAW,EACjB,MAAMU,EAAY,EACdvf,EAAM,gBACR,MAAMif,EAAqBjf,EAAM,cAAe,CAAE,eAAgB,EAAK,CAAE,EAE7E,EAAC,EAEDsD,GACE,IAAMtD,EAAM,cACZ,CAAOmhB,EAAUC,IAAahc,GAAA,sBAC5B,GAAI,CAAC8b,GACH,OAEF,MAAMG,EAAeF,GAAA,YAAAA,EAAU,OACzBG,EAAWF,GAAA,YAAAA,EAAU,OACvB,CAACC,GAAgBA,IAAiBC,IAGtC,MAAMrC,EAAqBoC,CAAY,EACzC,EACF,UAnmBE7a,EAAA,EAAAJ,EAiIM,MAjIN3F,GAiIM,CAhIJsG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAvG,EAA8B,UAA1B,wBAAqB,EAAA,GACzBA,EASM,MAAA,KAAA,CARJA,EAGQ,QAAA,KAAA,IAFNA,EAA4D,QAAA,CAArD,KAAK,6CAAiBsd,EAAY,MAAA9V,GAAE,MAAM,yBAApB8V,EAAA,KAAY,mBAAmB,2BAE9D,EAAA,KACAtd,EAGQ,QAHR6F,GAGQ,IAFN7F,EAA4D,QAAA,CAArD,KAAK,6CAAiBsd,EAAY,MAAA9V,GAAE,MAAM,yBAApB8V,EAAA,KAAY,mBAAmB,sBAE9D,EAAA,OAGSA,EAAA,QAAY,UAAvBtX,IAAAJ,EASM,MATNE,GASM,CARJW,EAOI6D,GAAA,YANOiT,EAAA,2CAAAA,EAAc,MAAA/V,GACvB,QAAQ,gBACR,QAAQ,aACP,MAAOoC,EAAAA,GAAE,iBAAA,8CAMH0T,EAAA,QAAY,cAAvB1X,EAQM,MAAAK,GAAA,IAPJjG,EAA6E,QAAA,CAAtE,KAAK,4CAAgByd,EAAa,MAAAjW,GAAE,YAAY,oCAA3BiW,EAAA,KAAa,IACzChX,EAII6D,GAAA,YAHOsT,EAAA,2CAAAA,EAAM,MAAApW,GACf,QAAQ,SACP,MAAOoC,EAAAA,GAAE,iBAAA,kCAEZ5J,EAAoD,SAAA,CAA3C,QAAOkf,EAAY,EAAE,eAAa,cAGlC3B,EAAA,OAAXvX,IAAAJ,EA8FM,MA9FNM,GA8FM,CA7FJlG,EAcM,MAAA,KAAA,CAbJA,EAAiF,MAAjFmG,GAAiFJ,EAA7B6D,EAAAA,GAAE,gBAAA,CAAA,EAAA,CAAA,EACtD5J,EAWM,MAXNoG,GAWM,EAVJJ,EAAA,EAAA,EAAAJ,EASWoB,GAAA,KAAAC,GATwB8W,EAAA,MAAe,CAAhCgD,EAAOne,eAAiC,IAAAme,EAAM,IAAE,GAAOA,EAAM,KAAK,IAAIne,CAAK,KAC3F5C,EAMS,SAAA,CALP,KAAK,SACL,MAAM,6FACL,QAAKwH,GAAE8Y,EAAqB1d,CAAK,CAE/B,EAAAmD,EAAAgb,EAAM,KAAK,EAAA,EAAA1a,EAAA,EAEJzD,EAAQmb,EAAA,MAAgB,OAAM,GAA1C/X,EAAA,EAAAJ,EAAwD,UAAR,GAAC,6BAKvD5F,EAUM,MAVNwG,GAUM,IATJxG,EAKE,QAAA,CAJA,KAAK,4CACIke,GAAgB,MAAA1W,GACxB,YAAaoC,EAAAA,GAAE,qBAAA,EAChB,MAAM,0HAFGsU,GAAA,KAAgB,IAI3BzX,EAES3G,EAAAgH,CAAA,EAAA,CAFD,KAAK,KAAM,QAAO0Z,eACxB,IAA6B,MAA1B5W,EAAAA,GAAE,mBAAA,CAAA,EAAA,CAAA,YAIT5J,EAoBM,MAAA,KAAA,CAnBJA,EAAmF,KAAnF4G,GAAmFb,EAAzB6D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,EAChDoU,EAAA,MAAW,QAGvBhY,IAAAJ,EAcK,KAdL0H,GAcK,QAbH1H,EAYKoB,GAAA,KAAAC,GAXc+W,EAAA,MAAVQ,QADT5Y,EAYK,KAAA,CAVF,IAAK4Y,EAAO,KACb,MAAM,4HAENxe,EAMS,SAAA,CALP,KAAK,SACL,MAAM,qEACL,QAAKwH,GAAE6Y,EAAc7B,CAAM,CAEzB,EAAAzY,EAAAyY,EAAO,SAAS,EAAA,EAAAzX,EAAA,oBAdzBnB,EAEM,MAFNiB,GAEMd,EADD6D,EAAAA,GAAE,qBAAA,CAAA,EAAA,CAAA,KAmBT5J,EA0BM,MAAA,KAAA,CAzBJA,EAA6E,KAA7EkH,GAA6EnB,EAAnB6D,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,EAChD8T,EAAA,MAAM,QAGlB1X,IAAAJ,EAoBK,KApBLwB,GAoBK,QAnBHxB,EAkBKoB,GAAA,KAAAC,GAjBYyW,EAAA,MAARjR,QADT7G,EAkBK,KAAA,CAhBF,IAAK6G,EAAK,UAAYA,EAAK,KAC5B,MAAM,kHAENzM,EAMI,IAAA,CALD,KAAMyM,EAAK,SACZ,SAAA,GACA,MAAM,uDAEH,EAAA1G,EAAA0G,EAAK,SAAS,EAAA,EAAApF,EAAA,EAEnBZ,EAKU3G,EAAAC,EAAA,EAAA,CALA,KAAM6J,EAAAA,GAAE,aAAA,EAAiB,UAAU,qBAC3C,IAGE,CAHFnD,EAGE3G,EAAAkhB,EAAA,EAAA,CAFC,QAAKC,GAAAzZ,GAAUsY,EAAWrT,EAAK,QAAQ,EAAA,CAAA,SAAA,CAAA,EACxC,MAAM,mGAnBd7G,EAEM,MAFNuB,GAEMpB,EADD6D,EAAAA,GAAE,gCAAA,CAAA,EAAA,CAAA,KAyBT5J,EAcM,MAAA,CAbJ,MAAKE,GAAA,CAAC,6IAA4I,CAAA,2CAC5F+d,EAAA,KAAY,CAAA,CAAA,EACjE,eAAwB+B,GAAW,CAAA,UAAA,MAAA,CAAA,EACnC,cAAuBC,EAAU,CAAA,UAAA,MAAA,CAAA,EACjC,eAAwBC,EAAW,CAAA,UAAA,MAAA,CAAA,EACnC,UAAmBC,EAAM,CAAA,UAAA,MAAA,CAAA,EACzB,QAAOC,IAERpgB,EAAyE,IAAzEsH,GAAyEvB,EAA/C6D,EAAAA,GAAE,oCAAA,CAAA,EAAA,CAAA,EAC5B5J,EAEI,IAFJ6N,GAEI9H,EADC6D,KAAE,wBAAA,CAAA,EAA6B,MAAIkU,EAAA,KAAiB,EAAA,CAAA,EAEzD9d,EAAsF,QAAA,SAA3E,eAAJ,IAAIme,EAAe,KAAK,OAAO,MAAM,SAAS,SAAA,GAAU,SAAQsB,27BCpD/E,MAAMjgB,EAAQC,EAORyhB,EAAavhB,GAAS,IACtB,OAAOH,EAAM,QAAW,SACnBA,EAAM,OAEXA,EAAM,QAAU,OAAOA,EAAM,QAAW,WACnCA,EAAM,OAAO,QAAUA,EAAM,OAAO,aAAc,EAG5D,EAEK2hB,EAAY7gB,EAAI,EAAK,EACrB8gB,EAAe9gB,EAAI,EAAE,EACrBod,EAAQpd,EAAI,CAAA,CAAE,EACd0d,EAAa1d,EAAI,CAAA,CAAE,EACnBud,EAAkBvd,EAAI,IAAI,EAC1Bwd,EAAoBxd,EAAI,EAAE,EAC1Byd,EAAkBzd,EAAI,CAAA,CAAE,EAC9B,IAAIogB,EAAa,GAEjB,MAAMW,EAAiB7d,GAAU,CAC/B,GAAI,CAACA,GAASA,IAAU,EACtB,MAAO,GAET,MAAM8d,EAAO,OAAO9d,CAAK,EACzB,OAAI,OAAO,MAAM8d,CAAI,EACZ,GAELA,GAAQ,QACH,IAAIA,EAAO,SAAS,QAAQ,CAAC,CAAC,MAEnCA,GAAQ,KACH,IAAIA,EAAO,MAAM,QAAQ,CAAC,CAAC,MAE7B,GAAGA,CAAI,IAChB,EAEMC,EAAc,CAAC,CAAE,SAAAnC,EAAW,KAAM,YAAAR,EAAc,IAAI,IAAO,CAC/D,MAAM4C,EAAS,CAAA,EACXpC,IACFoC,EAAO,UAAYpC,GAErB,MAAMqC,EAAiB7C,GAAA,KAAAA,EAAesC,EAAW,MACjD,MAAI,CAAC9B,GAAYqC,IACfD,EAAO,WAAaC,GAEfD,CACT,EAEME,EAAa,IAAwDhD,IAAA9Z,GAAA,SAAA8Z,GAAA,UAAjD,CAAE,SAAAU,EAAW,KAAM,YAAAR,EAAc,IAAI,EAAK,GAAO,CACzE,MAAM4C,EAASD,EAAY,CAAE,SAAAnC,EAAU,YAAAR,CAAW,CAAE,EACpD,GAAI,CAAC4C,EAAO,WAAa,CAACA,EAAO,WAC/B,OAAO,KAETL,EAAU,MAAQ,GAClBC,EAAa,MAAQ,GAErB,GAAI,CAMF,MAAM9C,GAAS,MALEjd,EAAe,CAC9B,IAAK,iDACL,OAAAmgB,EACA,KAAM,EACZ,CAAK,EAC6B,MAAK,EAC7BjC,IAAUjB,IAAA,YAAAA,GAAQ,UAAW,CAAA,EACnC,OAAAN,EAAW,MAAQuB,GAAQ,OAAQC,IAAUA,GAAM,SAAS,EAC5D9B,EAAM,MAAQ6B,GAAQ,OAAQC,IAAU,CAACA,GAAM,SAAS,EACxD3B,EAAgB,OAAQS,IAAA,YAAAA,GAAQ,YAAac,GAAY,KACzDtB,EAAkB,OAAQQ,IAAA,YAAAA,GAAQ,cAAeM,GAAesC,EAAW,OAAS,GAC7E,CACL,GAAIrD,EAAgB,MACpB,MAAOC,EAAkB,KAC/B,CACE,OAAS1O,EAAO,CACd,eAAQ,MAAM,kCAAmCA,CAAK,EACtDgS,EAAa,OAAQhS,GAAA,YAAAA,EAAO,UAAW,GAAG,iCAAiC,EAC3E4O,EAAW,MAAQ,CAAA,EACnBN,EAAM,MAAQ,CAAA,EACP,IACT,QAAC,CACCyD,EAAU,MAAQ,EACpB,CACF,GAEMQ,GAAiB,IAAY/c,GAAA,sBACjC,MAAMgd,EAAO,MAAMF,EAAW,CAAE,YAAaR,EAAW,KAAK,CAAE,EAC3DU,IACF7D,EAAgB,MAAQ,CAAC6D,CAAI,EAEjC,GAEMvB,EAAuB7B,GAAW5Z,GAAA,sBACtC,GAAI,EAAC4Z,GAAA,MAAAA,EAAQ,MACX,OAEF,MAAMuC,EAAQ,MAAMW,EAAW,CAAE,SAAUlD,EAAO,KAAM,YAAaA,EAAO,SAAS,CAAE,EACnFuC,IACFhD,EAAgB,MAAQ,CAAC,GAAGA,EAAgB,MAAOgD,CAAK,EAE5D,GAEMT,EAA8B1d,GAAUgC,GAAA,sBAC5C,GAAIhC,EAAQ,GAAKA,GAASmb,EAAgB,MAAM,OAC9C,OAEF,MAAMwC,EAASxC,EAAgB,MAAMnb,CAAK,EACpCme,EAAQ,MAAMW,EAAW,CAAE,SAAUnB,EAAO,GAAI,YAAaA,EAAO,KAAK,CAAE,EAC7EQ,IACFhD,EAAgB,MAAQ,CAAC,GAAGA,EAAgB,MAAM,MAAM,EAAGnb,CAAK,EAAGme,CAAK,EAE5E,GAEA,OAAA9W,GAAU,IAAYrF,GAAA,sBACpB8b,EAAa,GACb,MAAMiB,GAAc,CACtB,EAAC,EAED7e,GACE,IAAMoe,EAAW,MACjB,CAAOP,EAAUC,IAAahc,GAAA,sBAC5B,GAAI,CAAC8b,EACH,OAEF,MAAMmB,GAAWlB,GAAY,IAAI,KAAI,EAC/BG,GAAYF,GAAY,IAAI,KAAI,EAClC,CAACiB,GAAWA,IAAYf,IAG5B,MAAMa,GAAc,EACtB,EACF,UAlNE3b,EAAA,EAAAJ,EAmEM,MAnEN3F,GAmEM,CAlEJD,EAeM,MAfN6F,GAeM,CAdJ7F,EAA4F,KAA5F8F,GAA4FC,EAAvC+X,EAAA,OAAqBoD,EAAA,KAAU,EAAA,CAAA,EACPnD,EAAA,MAAgB,QAA7F/X,IAAAJ,EAYM,MAZNK,GAYM,EAXJD,EAAA,EAAA,EAAAJ,EAUWoB,GAAA,KAAAC,GAVwB8W,EAAA,MAAe,CAAhCgD,EAAOne,eAAiC,IAAAme,EAAM,IAAE,GAAOA,EAAM,KAAK,IAAIne,CAAK,KAC3F5C,EAOS,SAAA,CANP,KAAK,SACL,UAAM,6EACE4C,IAAUmb,EAAA,MAAgB,OAAM,EAAA,6CAAA,iBAAA,CAAA,EACvC,QAAKvW,GAAE5E,IAAUmb,EAAA,MAAgB,OAAM,EAAA,KAAcuC,EAAqB1d,CAAK,CAE7E,EAAAmD,EAAAgb,EAAM,KAAK,EAAA,GAAA7a,EAAA,EAEJtD,EAAQmb,EAAA,MAAgB,OAAM,GAA1C/X,EAAA,EAAAJ,EAAwD,UAAR,GAAC,uCAK5Cwb,EAAA,WAAXxb,EAEM,MAFNQ,GAEML,EADDqb,EAAA,KAAY,EAAA,CAAA,GAEDD,EAAA,WAAhBvb,EAEM,MAFNS,GAEMN,EADD6D,EAAAA,GAAE,0BAAA,CAAA,EAAA,CAAA,QAEPhE,EA0CWoB,GAAA,CAAA,IAAA,CAAA,EAAA,CAzCThH,EAqBU,UArBVsG,GAqBU,CApBRtG,EAA8E,KAA9EwG,GAA8ET,EAAzB6D,EAAAA,GAAE,aAAA,CAAA,EAAA,CAAA,EAC3CoU,EAAA,MAAW,QAGvBhY,IAAAJ,EAeK,KAfLgB,GAeK,QAdHhB,EAaKoB,GAAA,KAAAC,GAZc+W,EAAA,MAAVQ,QADT5Y,EAaK,KAAA,CAXF,IAAK4Y,EAAO,KACb,MAAM,4HAENxe,EAMS,SAAA,CALP,KAAK,SACL,MAAM,8DACL,QAAKwH,GAAE6Y,EAAc7B,CAAM,CAEzB,EAAAzY,EAAAyY,EAAO,SAAS,EAAA,EAAA3X,EAAA,EAErB7G,EAA+D,OAA/DsN,GAA+DvH,EAAtB6D,EAAAA,GAAE,QAAA,CAAA,EAAA,CAAA,oBAhB/ChE,EAEM,MAFNe,GAEMZ,EADD6D,EAAAA,GAAE,kCAAA,CAAA,EAAA,CAAA,KAoBT5J,EAiBU,UAjBV+G,GAiBU,CAhBR/G,EAAwE,KAAxEkH,GAAwEnB,EAAnB6D,EAAAA,GAAE,OAAA,CAAA,EAAA,CAAA,EAC3C8T,EAAA,MAAM,QAGlB1X,IAAAJ,EAWK,KAXLwB,GAWK,QAVHxB,EASKoB,GAAA,KAAAC,GARYyW,EAAA,MAARjR,QADT7G,EASK,KAAA,CAPF,IAAK6G,EAAK,UAAYA,EAAK,KAC5B,MAAM,kHAENzM,EAEI,IAAA,CAFA,KAAMyM,EAAK,SAAU,SAAA,GAAS,MAAM,uDACnC,EAAA1G,EAAA0G,EAAK,SAAS,EAAA,EAAApF,EAAA,EAEnBrH,EAAgF,OAAhFsH,GAAgFvB,EAAvCsb,EAAc5U,EAAK,SAAS,CAAA,EAAA,CAAA,oBAZzE7G,EAEM,MAFNuB,GAEMpB,EADD6D,EAAAA,GAAE,oCAAA,CAAA,EAAA,CAAA,gBC7CTwU,GAAe,IAAM,SACzB,OAAI,OAAO,QAAW,YACb,KAGP,OAAO,cACP3b,EAAA,OAAO,SAAP,YAAAA,EAAe,eACfC,EAAA,SAAS,cAAc,yBAAyB,IAAhD,YAAAA,EAAmD,aAAa,aAChE,IAEJ,EAEO,MAAMyc,EAAW,CACtB,YAAY,CAAE,KAAA5d,EAAM,IAAAiJ,EAAK,SAAAC,CAAQ,EAAI,CACnC,KAAK,KAAOlJ,EACZ,KAAK,SAAWkJ,EAChB,KAAK,IAAMD,EACX,KAAK,QAAU,OACf,KAAK,OAAS,IAChB,CAEA,WAAW,SAAU,CACnB,MAAME,EAAMC,GAAU,CACpB,OAAQ,IACNC,GAAEkX,GAAY,CAAE,KAAM,GAAI,YAAa,IAAK,MAAO,QAAS,CACpE,CAAK,EAEKhX,EAAM,SAAS,cAAc,KAAK,EACxC,OAAAJ,EAAI,MAAMI,CAAG,EAEN,CACL,MAAO,SACP,KAAMA,EAAI,SAChB,CACE,CACD,WAAW,qBAAsB,CAChC,MAAO,EACR,CAEC,QAAS,CACP,YAAK,QAAU,SAAS,cAAc,KAAK,EACvC,KAAK,MAAQ,KAAK,KAAK,OACzB,KAAK,aAAa,KAAK,KAAK,MAAM,EAElC,KAAK,kBAAiB,EAEjB,KAAK,OACd,CAEA,YAAa,CACP,KAAK,SACP,KAAK,OAAO,QAAO,EACnB,KAAK,OAAS,MAEZ,KAAK,UACP,KAAK,QAAQ,UAAY,GAE7B,CAEA,aAAaoW,EAAY,CACvB,GAAI,KAAK,SAAU,CACjB,KAAK,WAAU,EACf,KAAK,OAASvW,GAAUoX,GAAa,CACnC,OAAQb,CAChB,CAAO,EACD,KAAK,OAAO,IAAIlW,EAAiB,EACjC,KAAK,OAAO,IAAIhK,EAAM,EACtB,KAAK,OAAO,MAAM,KAAK,OAAO,EAC9B,MACF,CACA,KAAK,kBAAkBkgB,CAAU,CACnC,CAEA,kBAAkBc,EAAgB,KAAM,CAClC,KAAK,WAGT,KAAK,WAAU,EACf,KAAK,OAASrX,GAAUsX,GAAc,CACpC,cAAAD,EACA,WAAaxD,GAAW,CACjB,KAAK,OACR,KAAK,KAAO,CAAA,GAEd,KAAK,KAAK,OAASA,CACrB,CACN,CAAK,EACD,KAAK,OAAO,IAAIxT,EAAiB,EACjC,KAAK,OAAO,IAAIhK,EAAM,EACtB,KAAK,OAAO,MAAM,KAAK,OAAO,EAChC,CAEE,KAAKoK,EAAc,OACjB,MAAO,CACL,QAAQ3I,EAAA,KAAK,OAAL,YAAAA,EAAW,MAC3B,CACI,CAEA,SAAU,CACR,KAAK,WAAU,CACjB,CAEM,mBAAmBiK,EAAYwU,EAAY,QAAAtc,GAAA,sBAC/C,MAAMsd,EAAoBhB,GAAA,YAAAA,EAAY,OACtC,GAAI,CAACgB,EACH,MAAM,IAAI,MAAM,mDAAmD,EAErE,GAAI,CAACxV,EACH,MAAM,IAAI,MAAM,8CAA8C,EAGhE,MAAMmT,EAAYzB,GAAY,EAC9B,GAAI,CAACyB,EACH,MAAM,IAAI,MAAM,8DAA8D,EAGhF,IAAIsC,EACJ,MAAMpd,EAAW,MAAM,MAAM,8BAA+B,CAC1D,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,OAAQ,mBACR,sBAAuB8a,CACjC,EACQ,YAAa,UACb,KAAM,KAAK,UAAU,CACnB,OAAQnT,EACR,WAAYwV,CACtB,CAAS,CACT,CAAO,EACD,GAAI,CACFC,EAAe,MAAMpd,EAAS,KAAI,CACpC,OAASqK,EAAO,CACd+S,EAAe,IACjB,CAEA,GAAI,CAACpd,EAAS,GAAI,CAChB,MAAMqd,GAAgBD,GAAA,YAAAA,EAAc,WAAWA,GAAA,YAAAA,EAAc,MAAOpd,EAAS,WAC7E,MAAM,IAAI,MAAMqd,GAAiB,gCAAgC,CACnE,CAEA,MAAM7gB,GAAO4gB,GAAA,YAAAA,EAAc,OAAQA,EACnC,OAAK,KAAK,OACR,KAAK,KAAO,CAAA,GAEd,KAAK,KAAK,QAAS5gB,GAAA,YAAAA,EAAM,aAAc2gB,EAChC3gB,CACT,GAEM,gBAAgBmd,EAAqD,QAAA9Z,GAAA,yBAArD,CAAE,eAAAyd,EAAgB,iBAAAC,EAAkB,cAAAC,CAAa,EAAI,CACzE,MAAMC,EAAuBD,GAAA,YAAAA,EAAe,OAC5C,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,6BAA6B,EAG/C,GAAI,CAACH,GAAkB,CAACC,EACtB,MAAM,IAAI,MAAM,8DAA8D,EAGhF,MAAMzC,EAAYzB,GAAY,EAC9B,GAAI,CAACyB,EACH,MAAM,IAAI,MAAM,8DAA8D,EAGhF,IAAIsC,EACJ,MAAMpd,EAAW,MAAM,MAAM,0DAA2D,CACtF,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,OAAQ,mBACR,sBAAuB8a,CACjC,EACQ,YAAa,UACb,KAAM,KAAK,UAAU,CACnB,iBAAkBwC,EAClB,kBAAmBC,EACnB,cAAeE,CACzB,CAAS,CACT,CAAO,EAED,GAAI,CACFL,EAAe,MAAMpd,EAAS,KAAI,CACpC,OAASqK,EAAO,CACd+S,EAAe,IACjB,CAEA,GAAI,CAACpd,EAAS,GAAI,CAChB,MAAMqd,GAAgBD,GAAA,YAAAA,EAAc,WAAWA,GAAA,YAAAA,EAAc,MAAOpd,EAAS,WAC7E,MAAM,IAAI,MAAMqd,GAAiB,6BAA6B,CAChE,CAEA,OAAOD,GAAA,YAAAA,EAAc,WAAWA,GAAA,YAAAA,EAAc,OAAQA,CACxD,GACJ,CCpLO,SAASne,GAAYye,EAAS,CACpCnd,GAAMhC,GAAA,CACL,SAAU,gBACPmf,EACH,CACF,CAEO,SAAS5f,GAAQ6f,EAAM,CAC7B,OAAOC,GAAWD,CAAI,EAAE,KACzB,CAsCO,SAASE,GAAaC,EAAQ,CACpC,OAAIA,EAAS,KACJA,EAAS,KAAM,QAAQ,CAAC,EAAI,IAE9BA,CACR,CAeO,SAASrL,GAAYsL,EAAW,CACtC,IAAItf,EAAQ,SAASsf,CAAS,EAC9B,OAAItf,EAAQ,SACHA,EAAQ,SAAS,QAAQ,CAAC,EAAI,IAC5BA,EAAQ,MACVA,EAAQ,MAAM,QAAQ,CAAC,EAAI,IAE7BA,CACR,CAiCO,SAASuf,GAAoBC,EAAM,CACzClgB,GACC,IAAMkgB,EACLA,GAAS,CACT,GAAKA,EAAK,MAAM,MAChB,IAAIA,EAAK,MAAM,OAASA,EAAK,MAAM,SAAU,CAC5C,SAAS,MAAQ,GAAGA,EAAK,MAAM,KAAK,MAAMA,EAAK,MAAM,QAAQ,GAC7D,MACD,CACA,GAAIA,EAAK,MAAM,MAAO,CACrB,SAAS,MAAQ,GAAGA,EAAK,MAAM,KAAK,GACpC,MACD,EACD,EACA,CAAE,UAAW,GAAM,KAAM,EAAI,CAC/B,CACA,CAQO,SAASC,IAAiB,CAChC,MAAO,CACN,OAAQ,CACP,MAAOC,GACP,OAAQ,CACP,YAAa,QACjB,CACA,EACE,WAAYjV,GACZ,KAAMtE,GACN,KAAMoK,GACN,mBAAoB2E,GACpB,OAAQoC,GACR,SAAU,CACT,MAAOM,GACP,cAAe,EAClB,EACE,MAAO+H,GACP,MAAO,CACN,MAAOC,GACP,cAAe,EAClB,EACE,UAAW,CACV,MAAOC,GACP,cAAe,GACf,OAAQ,CACP,cAAe,EACnB,CACA,EACE,QAAS,CACR,MAAOnH,GACP,OAAQ,CACP,SACC,gGACD,UAAW,gBACX,gBAAiB,MACrB,CACA,EACE,KAAM,CACL,MAAOoH,GACP,cAAe,GACf,OAAQ,CACP,aAAc,SAClB,CACA,EACE,WAAY,CACX,MAAOC,GACP,SAAU,aACb,EACE,MAAO,CACN,MAAOC,GACP,cAAe,GACf,OAAQ,CACP,SAAU,CACT,QAAS,CACR,MAAO,0IACP,SACC,iDACD,KAAM,uFACN,OAAQ,IACR,MAAO,IACP,GAAI,CAAC,CAACC,EAAIjC,CAAM,IAAM,CACrB,GAAI,CAACA,GAAUiC,EACd,OAAOA,EAGR,MAAMC,EAAY,CACjB,MAAO,QACP,IAAK,MACL,EAAG,QAEH,cAAe,QACf,KAAM,MACd,EAEO,IAAIC,EAAYnC,EACd,MAAM,CAAC,EACP,MAAM,GAAG,EACT,IAAKoC,GAAU,CACf,KAAM,CAACC,EAAMrgB,CAAK,EAAIogB,EAAM,MAAM,GAAG,EAErC,MAAI,CAACH,GAAMI,IAAS,KACnBJ,EAAKjgB,EAEE,MAGJ,CAACkgB,EAAUG,CAAI,GAKlBrgB,IAAU,MACVA,EAAM,WAAW,MAAM,GACvBA,EAAM,WAAW,IAAI,EAEd,KAGD,GAAGkgB,EAAUG,CAAI,CAAC,IAAIrgB,CAAK,EACnC,CAAC,EACA,OAAQogB,GAAU,CAAC,CAACA,CAAK,EAE3B,OAAOH,EAAK,IAAME,EAAU,KAAK,GAAG,CACrC,CACN,EACK,MAAO,GACP,QAAS,GACT,OAAQ,CACP,MAAO,6DACP,SACC,+EACD,KAAM,gIACN,OAAQ,IACR,MAAO,GACb,EACK,OAAQ,GACR,OAAQ,CACP,MAAO,sEACP,SACC,gEACD,KAAM,6JACZ,EACK,MAAO,CACN,MAAO,uEACP,SACC,2DACD,KAAM,8IACZ,EACK,WAAY,CACX,MAAO,0EACP,SACC,8DACD,KAAM,8IACZ,EACK,aAAc,CACb,MAAO,8EACP,SACC,kEACD,KAAM,8IACZ,EACK,aAAc,CACb,MAAO,8EACP,SACC,gEACD,KAAM,8JACZ,EACK,YAAa,CACZ,MAAO,yEACP,SACC,6FACD,KAAM,6NACZ,CACA,CACA,CACA,EACE,OAAQ,CACP,MAAOxE,GACP,OAAQ,CACP,YAAa,0BACb,eAAgB,qBAChB,YAAczB,GACNA,EAAM,IAAIjR,GAAQ,YAAYA,EAAK,GAAG,cAAcA,EAAK,IAAI,MAAM,EAAE,KAAK,MAAM,CAE5F,CACA,CACA,CACA,CAmNO,SAASqE,GAAYgT,EAAM,CACjC,MAAMC,EAAU,CACf,IAAK,KACL,IAAK,IACL,EAAG,KACH,IAAK,KACL,IAAK,IACL,GAAI,IACJ,EAAG,EACL,EACC,OAAOD,EAAK,QACX,IAAI,OAAO,IAAI,OAAO,KAAKC,CAAO,EAAE,KAAK,GAAG,CAAC,IAAI,EAChDC,GAAMD,EAAQC,CAAC,CAClB,CACA"}