import{r as O,Z,E as W,c as k,I as R,J as Y,a as U,b as o,w as d,e as y,u as s,L as E,g as p,t as i,z as w,N as ee,c0 as G,M as te,H as J,O as F,D as L,Q as se,n as A,h,s as I,R as K,i as T,j,cJ as ae,K as le,b$ as Q,C as re,cc as oe}from"./vendor-CrP-kEM1.js";import{y as ue,c as ne,q as X}from"./frappe-ui-Qp90XKmJ.js";const ie={class:"w-full"},de=["onClick"],ce={class:"flex items-center"},fe={key:0,class:"overflow-hidden text-ellipsis whitespace-nowrap text-base leading-5"},pe={key:1,class:"text-base leading-5 text-ink-gray-4"},me={class:"mt-1 rounded-lg bg-surface-white py-1 text-base shadow-2xl"},ye={class:"relative px-1.5 pt-0.5"},ve={key:0,class:"px-2.5 py-1.5 text-sm font-medium text-ink-gray-4"},be={class:"flex flex-col space-y-1"},ge=["innerHTML"],he={key:0,class:"mt-1.5 rounded-md px-2.5 py-1.5 text-base text-ink-gray-5"},xe={key:0,class:"border-t p-1.5 pb-0.5"},ke={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0}},emits:["update:modelValue","update:query","change"],setup($,{expose:B,emit:v}){const l=$,n=v,c=O(""),x=O(!1),S=O(null),_=Z(),P=W(),q=k(()=>"value"in _),C=k({get(){return q.value?_.value:l.modelValue},set(t){c.value="",t&&(x.value=!1),n(q.value?"change":"update:modelValue",t)}});function D(){x.value=!1}const e=k(()=>{var a;return!l.options||l.options.length==0?[]:((a=l.options[0])!=null&&a.group?l.options:[{group:"",items:l.options}]).map((r,u)=>({key:u,group:r.group,hideLabel:r.hideLabel||!1,items:l.filterable?b(r.items):r.items})).filter(r=>r.items.length>0)});function b(t){return c.value?t.filter(a=>[a.label,a.value].some(u=>(u||"").toString().toLowerCase().includes(c.value.toLowerCase()))):t}function f(t){if(typeof t=="string"){let r=e.value.flatMap(u=>u.items).find(u=>u.value===t);return(r==null?void 0:r.label)||t}return t==null?void 0:t.label}R(c,t=>{n("update:query",t)}),R(x,t=>{t&&Y(()=>{S.value.el.focus()})});const m=k(()=>l.disabled?"text-ink-gray-5":"text-ink-gray-8"),z=k(()=>{let t={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[l.size],a={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[l.size],r=l.disabled?"disabled":l.variant,u={subtle:"border border-gray-100 bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-menu-bar placeholder-ink-gray-3",l.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[r];return[t,a,u,m.value,"transition-colors w-full"]});return B({query:c}),(t,a)=>(o(),U(s(le),{modelValue:C.value,"onUpdate:modelValue":a[3]||(a[3]=r=>C.value=r),nullable:""},{default:d(({open:r})=>[y(s(ue),{class:"w-full",show:x.value,"onUpdate:show":a[2]||(a[2]=u=>x.value=u)},{target:d(({open:u,togglePopover:N})=>[h(t.$slots,"target",T(j({open:u,togglePopover:N})),()=>[p("div",ie,[p("button",{class:A(["flex w-full items-center justify-between focus:outline-none",z.value]),onClick:()=>N()},[p("div",ce,[h(t.$slots,"prefix"),C.value?(o(),i("span",fe,L(f(C.value)),1)):(o(),i("span",pe,L($.placeholder||""),1))]),y(s(ae),{class:"h-4 w-4 stroke-1.5"})],10,de)])])]),body:d(({isOpen:u})=>{var N;return[E(p("div",null,[p("div",me,[p("div",ye,[y(s(ee),{ref_key:"search",ref:S,class:"form-input w-full",type:"text",onChange:a[0]||(a[0]=g=>{c.value=g.target.value}),value:c.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),p("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:a[1]||(a[1]=g=>C.value=null)},[y(s(G),{class:"h-4 w-4 stroke-1.5"})])]),y(s(te),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:d(()=>[(o(!0),i(J,null,F(e.value,g=>E((o(),i("div",{class:"mt-1.5",key:g.key},[g.group&&!g.hideLabel?(o(),i("div",ve,L(g.group),1)):w("",!0),(o(!0),i(J,null,F(g.items,V=>(o(),U(s(se),{as:"template",key:V.value,value:V},{default:d(({active:M,selected:H})=>[p("li",{class:A(["flex items-center rounded px-2.5 py-2 text-base",{"bg-surface-gray-2":M}])},[h(t.$slots,"item-prefix",I({ref_for:!0},{active:M,selected:H,option:V})),h(t.$slots,"item-label",I({ref_for:!0},{active:M,selected:H,option:V}),()=>[p("div",be,[p("div",null,L(V.label),1),V.description?(o(),i("div",{key:0,class:"text-xs text-ink-gray-7",innerHTML:V.description},null,8,ge)):w("",!0)])])],2)]),_:2},1032,["value"]))),128))])),[[K,g.items.length>0]])),128)),e.value.length==0?(o(),i("li",he," No results found ")):w("",!0)]),_:3}),s(P).footer?(o(),i("div",xe,[h(t.$slots,"footer",T(j({value:(N=S.value)==null?void 0:N.el._value,close:D})))])):w("",!0)])],512),[[K,u]])]}),_:3},8,["show"])]),_:3},8,["modelValue"]))}},we={class:"space-y-1.5"},_e={key:0,class:"text-ink-red-3"},Ce={key:0},Ve={key:1,class:"text-sm text-ink-gray-5"},ze={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},modelValue:{type:String,default:""},description:{type:String,default:""}},emits:["update:modelValue","change"],setup($,{emit:B}){const v=$,l=B,n=Z(),c=k(()=>"value"in n),x=k({get:()=>c.value?n.value:v.modelValue,set:e=>(e==null?void 0:e.value)&&l(c.value?"change":"update:modelValue",e==null?void 0:e.value)}),S=O(null),_=O("");Q(()=>{var e;return(e=S.value)==null?void 0:e.query},e=>{e=e||"",_.value!==e&&(_.value=e,q(e))},{debounce:300,immediate:!0}),Q(()=>v.doctype,()=>q(""),{debounce:300,immediate:!0});const P=ne({url:"frappe.desk.search.search_link",cache:[v.doctype,_.value],method:"POST",auto:!0,params:{txt:_.value,doctype:v.doctype,filters:v.filters},transform:e=>e.map(b=>({label:b.label||b.value,value:b.value,description:b.description}))}),q=e=>{P.update({params:{txt:e,doctype:v.doctype,filters:v.filters}}),P.reload()},C=e=>{l(c.value?"change":"update:modelValue",""),e()},D=k(()=>[{sm:"text-xs",md:"text-base"}[n.size||"sm"],"text-ink-gray-5"]);return(e,b)=>(o(),i("div",we,[s(n).label?(o(),i("label",{key:0,class:A(["block",D.value])},[re(L(s(n).label)+" ",1),s(n).required?(o(),i("span",_e,"*")):w("",!0)],2)):w("",!0),y(ke,{ref_key:"autocomplete",ref:S,options:s(P).data,modelValue:x.value,"onUpdate:modelValue":b[0]||(b[0]=f=>x.value=f),size:s(n).size||"sm",variant:s(n).variant,placeholder:s(n).placeholder,filterable:!1},{target:d(({open:f,togglePopover:m})=>[h(e.$slots,"target",T(j({open:f,togglePopover:m})))]),prefix:d(()=>[h(e.$slots,"prefix")]),"item-prefix":d(({active:f,selected:m,option:z})=>[h(e.$slots,"item-prefix",T(j({active:f,selected:m,option:z})))]),"item-label":d(({active:f,selected:m,option:z})=>[h(e.$slots,"item-label",T(j({active:f,selected:m,option:z})))]),footer:d(({value:f,close:m})=>[s(n).onCreate?(o(),i("div",Ce,[y(s(X),{variant:"ghost",class:"w-full !justify-start",label:"Create New",onClick:z=>s(n).onCreate(f,m)},{prefix:d(()=>[y(s(oe),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])):w("",!0),p("div",null,[y(s(X),{variant:"ghost",class:"w-full !justify-start",label:e.__("Clear"),onClick:()=>C(m)},{prefix:d(()=>[y(s(G),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder"]),$.description?(o(),i("p",Ve,L($.description),1)):w("",!0)]))}};export{ze as _};
//# sourceMappingURL=Link-B7v9_qE9.js.map
