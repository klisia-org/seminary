{"version":3,"file":"DiscussionActivities-C054pgf_.js","sources":["../../../../frontend/src/pages/DiscussionActivities.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<router-link\n\t\t\t:to=\"{\n\t\t\t\tname: 'DiscussionActivityForm',\n\t\t\t\tparams: {\n\t\t\t\t\tdiscussionID: 'new',\n\t\t\t\t},\n\t\t\t}\"\n\t\t>\n\t\t\t<Button variant=\"solid\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<Plus class=\"w-4 h-4\" />\n\t\t\t\t</template>\n\t\t\t\t{{ __('New') }}\n\t\t\t</Button>\n\t\t</router-link>\n\t</header>\n\n\t<div class=\"md:w-3/4 md:mx-auto py-5 mx-5\">\n\t\t<div class=\"grid grid-cols-3 gap-5 mb-5\">\n\t\t\t<FormControl v-model=\"titleFilter\" :placeholder=\"__('Search by title')\" />\n\t\t\t<FormControl\n\t\t\t\tv-model=\"courseFilter\"\n\t\t\t\ttype=\"select\"\n\t\t\t\t:options=\"coursesListed\"\n\t\t\t\t:placeholder=\"__('Course')\"\n\t\t\t/>\n\t\n\t\t</div>\n\t\t<ListView\n\t\t\tv-if=\"discussions.data?.length\"\n\t\t\t:columns=\"discussionColumns\"\n\t\t\t:rows=\"discussions.data\"\n\t\t\trow-key=\"name\"\n\t\t\t:options=\"{\n\t\t\t\tshowTooltip: false,\n\t\t\t\tselectable: false,\n\t\t\t\tgetRowRoute: (row) => ({\n\t\t\t\t\tname: 'DiscussionActivityForm',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tdiscussionID: row.name,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t}\"\n\t\t>\n\t\t</ListView>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2\"\n\t\t>\n\t\t\t<Pencil class=\"size-10 mx-auto stroke-1 text-ink-gray-4\" />\n\t\t\t<div class=\"text-xl font-medium\">\n\t\t\t\t{{ __('No discussion activities found') }}\n\t\t\t</div>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'You have not created any discussion activities yet. To create a new discussion activity, click on the \"New\" button above.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tv-if=\"discussions.data && discussions.hasNextPage\"\n\t\t\tclass=\"flex justify-center my-5\"\n\t\t>\n\t\t\t<Button @click=\"discussions.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tButton,\n\tcreateListResource,\n\tFormControl,\n\tListView,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { Plus, Pencil } from 'lucide-vue-next'\nimport { useRouter } from 'vue-router'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst titleFilter = ref('')\nconst courseFilter = ref('')\nconst router = useRouter()\n\nonMounted(() => {\n\tif (!user.data?.is_moderator && !user.data?.is_instructor) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\n\ttitleFilter.value = router.currentRoute.value.query.title\n\tcourseFilter.value = router.currentRoute.value.query.course\n})\n\nwatch([titleFilter, courseFilter], () => {\n\trouter.push({\n\t\tquery: {\n\t\t\ttitle: titleFilter.value,\n\t\t\tcourse: courseFilter.value,\n\t\t},\n\t})\n\treloadDiscussions()\n})\n\nconst reloadDiscussions = () => {\n\tdiscussions.update({\n\t\tfilters: discussionFilter.value,\n\t})\n\tdiscussions.reload()\n}\n\nconst discussionFilter = computed(() => {\n\tlet filters = {}\n\tif (titleFilter.value) {\n\t\tfilters.title = ['like', `%${titleFilter.value}%`]\n\t}\n\tif (courseFilter.value) {\n\t\tfilters.course = courseFilter.value\n\t}\n\tif (!user.data?.is_moderator) {\n\t\tfilters.owner = user.data?.email\n\t}\n\treturn filters\n})\n\nconst discussions = createListResource({\n\tdoctype: 'Discussion Activity',\n\tfields: ['name', 'discussion_name', 'course', 'post_before', 'use_studentgroup', 'creation'],\n\torderBy: 'modified desc',\n\tcache: ['discussions'],\n\ttransform(data) {\n\t\treturn data.map((row) => {\n\t\t\treturn {\n\t\t\t\t...row,\n\t\t\t\tcreation: dayjs(row.creation).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\nconst discussionColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Title'),\n\t\t\tkey: 'discussion_name',\n\t\t\twidth: 2,\n\t\t},\n\t\t{\n\t\t\tlabel: __('Course'),\n\t\t\tkey: 'course',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Post Before Reply is Mandatory'),\n\t\t\tkey: 'post_before',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Use Student Group'),\n\t\t\tkey: 'use_studentgroup',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Created'),\n\t\t\tkey: 'creation',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t},\n\t]\n})\n\n\n\nconst coursesListed = computed(() => {\n\tif (!discussions.data) return []\n\tlet courses = Array.from(\n\t\tnew Set(discussions.data.map((discussion) => discussion.course))\n\t)\n\treturn courses.map((course) => {\n\t\treturn {\n\t\t\tlabel: course,\n\t\t\tvalue: course,\n\t\t}\n\t})\n})\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: 'Discussion Activities',\n\t\troute: { name: 'DiscussionActivities' },\n\t},\n])\n</script>\n"],"names":["user","inject","dayjs","titleFilter","ref","courseFilter","router","useRouter","onMounted","_a","_b","watch","reloadDiscussions","discussions","discussionFilter","computed","filters","createListResource","data","row","__spreadProps","__spreadValues","discussionColumns","coursesListed","discussion","course","breadcrumbs","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_component_router_link","Button","Plus","_createTextVNode","__","_hoisted_2","_hoisted_3","FormControl","$event","_createBlock","ListView","_openBlock","_createElementBlock","_hoisted_4","Pencil","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_cache"],"mappings":"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"}