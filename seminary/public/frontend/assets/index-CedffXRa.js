var Rt=Object.defineProperty,qt=Object.defineProperties;var Ut=Object.getOwnPropertyDescriptors;var Ye=Object.getOwnPropertySymbols;var ft=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var ot=(m,e,t)=>e in m?Rt(m,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[e]=t,qe=(m,e)=>{for(var t in e||(e={}))ft.call(e,t)&&ot(m,t,e[t]);if(Ye)for(var t of Ye(e))_t.call(e,t)&&ot(m,t,e[t]);return m},Ge=(m,e)=>qt(m,Ut(e));var ht=m=>typeof m=="symbol"?m:m+"",vt=(m,e)=>{var t={};for(var l in m)ft.call(m,l)&&e.indexOf(l)<0&&(t[l]=m[l]);if(m!=null&&Ye)for(var l of Ye(m))e.indexOf(l)<0&&_t.call(m,l)&&(t[l]=m[l]);return t};var Fe=(m,e,t)=>ot(m,typeof e!="symbol"?e+"":e,t);var se=(m,e,t)=>new Promise((l,d)=>{var u=h=>{try{b(t.next(h))}catch(g){d(g)}},p=h=>{try{b(t.throw(h))}catch(g){d(g)}},b=h=>h.done?l(h.value):Promise.resolve(h.value).then(u,p);b((t=t.apply(m,e)).next())});import{b as dt,c as W,q as G,w as Pe,n as ze,r as He,H as Ue,t as ke,D as $t,G as ct,z as We,d as Ot,J as Vt,v as St}from"./frappe-ui-DY2hYblR.js";import{c as oe,a as z,b as o,w as q,g as s,m as Ht,n as Oe,u as a,bk as Ae,r as T,am as Je,F as Ze,I as ue,t as i,z as D,D as n,e as N,H as de,O as pe,L as $e,cl as nt,cm as gt,cn as rt,R as Bt,C as ie,av as Ee,J as Ct,aL as fe,q as Re,c8 as jt,bg as mt,c3 as Xe,c1 as Tt,cf as Gt,s as Qt,U as At,V as it,o as Jt,b_ as Wt,co as Yt,cp as Xt,cc as pt,a8 as Kt,cq as Zt,aw as Ne,cr as Dt,bU as es,ci as lt,cj as ts,aR as ss,cs as as,ct as Ft,cu as Mt,cv as Et,cw as Nt,cx as os,cy as ns,cz as rs,cA as ls,cB as yt,bW as is,ce as bt,bX as us,S as Qe,cC as ds,cD as cs,cE as ms,cF as ps,cG as fs,cH as _s,cI as hs,cJ as vs,cK as gs}from"./vendor-BwXEY6tq.js";import{_ as Ve}from"./Link-B7-sIXzn.js";import{t as De,r as Me,u as et,i as It}from"./index-C-gjsqqd.js";const ys={class:"w-full bg-surface-gray-3 rounded-full h-1"},Lt={__name:"ProgressBar",props:{progress:{type:Number,default:0},size:{type:String,default:"sm"}},setup(m){const e=m,t=oe(()=>`${Math.min(Math.ceil(e.progress),100)}%`),l=oe(()=>{if(e.size==="sm")return"h-1";if(e.size==="md")return"h-2";if(e.size==="lg")return"h-3"});return(d,u)=>(o(),z(a(dt),{text:`${e.progress}%`},{default:q(()=>[s("div",ys,[s("div",{class:Oe(["bg-surface-gray-7 rounded-full",l.value]),style:Ht({width:t.value})},null,6)])]),_:1},8,["text"]))}},bs={key:0},ks={class:"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900"},ws={class:"leading-5"},xs={key:0,class:"leading-5"},$s={key:1,class:"leading-5"},Ss={key:2,class:"leading-relaxed"},Cs={key:3,class:"leading-relaxed"},Ts={key:0,class:"flex flex-col space-x-1 my-4"},As={class:"mb-2"},Ds={class:""},Fs={class:"font-semibold"},Ms={key:1},Es={class:"border text-center p-20 rounded-md"},Ns={class:"font-semibold text-lg"},Is={key:2},Ls={key:2},zs={key:0,class:"border rounded-md p-5"},Ps={class:"flex justify-between"},Rs={class:"text-sm text-ink-gray-5"},qs={class:"mr-2"},Us={class:"text-ink-gray-9 text-sm font-semibold item-left"},Os=["innerHTML"],Vs={key:0,class:"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600"},Hs=["name","onChange"],Bs=["name","onChange"],js={key:0},Gs=["innerHTML"],Qs={key:1},Js={key:0},Ws={key:2},Ys={class:"flex items-center justify-between mt-4"},Xs={class:"text-sm text-ink-gray-5"},Ks={key:3},Zs={class:"flex justify-between"},ea={class:"text-sm text-ink-gray-5"},ta={class:"mr-2"},sa={class:"text-ink-gray-9 text-sm font-semibold item-left"},aa=["innerHTML"],oa={key:0,class:"flex items-center bg-surface-gray-3 rounded-md p-3 mt-4 w-full cursor-pointer focus:border-blue-600"},na=["name","onChange"],ra=["name","onChange"],la=["innerHTML"],ia={key:1},ua={class:"text-center mt-4"},da={key:4,class:"border rounded-md p-20 text-center space-y-4"},ca={class:"text-lg font-semibold"},ma={class:"text-ink-gray-9"},pa={class:"mt-6"},fa={class:"flex justify-between"},_a={class:"text-lg text-ink-gray-5"},ha={class:"mr-2"},va=["innerHTML"],ga={class:"bg-surface-gray-3 rounded-md p-3 mt-4"},ya={class:"bg-surface-gray-3 rounded-md p-3 mt-4"},ba={key:0,class:"bg-surface-gray-3 rounded-md p-3 mt-4"},ka={class:"mt-4"},wa={key:1},xa={__name:"Quiz",props:{quizName:{type:String,required:!0}},setup(m){const e=Ae("$user"),t=T(!1),l=T(0),d=T(""),u=Je([0,0,0,0]),p=Je([]);let b=Je([]);const h=T(null),g=T(0);let x=null;const _=Ze(),R=T(0),v=Je({}),ae=m,y=W({url:"frappe.client.get",makeParams(c){return{doctype:"Quiz",name:ae.quizName}},cache:["quiz",ae.quizName],auto:!0,transform(c){return c?(c.duration=parseInt(c.duration)||0,c):(console.error("Quiz data is null or undefined."),null)},onSuccess(c){c?(P(),F()):console.error("Failed to load quiz data.")},onError(c){console.error("Error loading quiz data:",c)}}),B=oe(()=>!!y.data),P=()=>{let c=y.data;if(c.shuffle_questions){const $=ne([...c.questions]);b=c.limit_questions_to?$.slice(0,c.limit_questions_to):$}else b=c.questions},F=()=>{y.data.duration&&(g.value=y.data.duration*60)},S=()=>{x=setInterval(()=>{y.data.duration&&(g.value--,g.value==0&&(clearInterval(x),f())),R.value++},1e3)},O=c=>{const $=Math.floor(c/3600).toString().padStart(2,"0"),j=Math.floor(c%3600/60).toString().padStart(2,"0"),te=(c%60).toString().padStart(2,"0");return $!="00"?`${$}:${j}:${te}`:`${j}:${te}`},U=oe(()=>g.value/(y.data.duration*60)*100),ne=c=>{for(let $=c.length-1;$>0;$--){const j=Math.floor(Math.random()*($+1));[c[$],c[j]]=[c[j],c[$]]}return c},ee=W({url:"frappe.client.get_list",makeParams(c){var $,j;return{doctype:"Quiz Submission",filters:{member:($=e.data)==null?void 0:$.name,quiz:(j=y.data)==null?void 0:j.name},fields:["name","creation","score","score_out_of","percentage","passing_percentage"],order_by:"creation desc"}},transform(c){c.forEach(($,j)=>{$.creation=st($.creation),$.idx=j+1})}});ue(()=>y.data,c=>{c&&P(),c&&y.data.max_attempts&&(ee.reload(),M())});const re=W({url:"seminary.seminary.doctype.quiz.quiz.quiz_summary",makeParams(c){if(!y.data)return{};const $=y.data.duration?y.data.duration*60-(g.value||0):R.value||0;return{quiz:y.data.name,course:_.currentRoute.value.params.courseName,results:(c==null?void 0:c.results)||localStorage.getItem(`${y.data.name}_results`),time_taken:$}},onSuccess(c){c.corrected_answers&&(he.data=c.corrected_answers.map($=>Ge(qe({},$),{user_answer:$.user_answer||null,correct_answer:$.correct_answer||null})))},onError(c){console.error("Error loading quiz summary:",c)},auto:!0}),X=W({url:"seminary.seminary.utils.get_question_details",makeParams(c){return{question:d.value}}});ue(l,c=>{c>0&&(d.value=y.data.questions[c-1].question,X.reload())}),ue(()=>ae.quizName,c=>{c&&y.reload()});const he=W({url:"seminary.seminary.utils.get_all_questions_details",makeParams(c){return{questions:b.map($=>$.name)}}}),C=()=>{l.value=1,localStorage.removeItem(y.data.title),S()},L=()=>{localStorage.removeItem(y.data.title),t.value=!0,S(),he.reload()},Y=c=>{X.data.multiple||u.splice(0,u.length,0,0,0,0),u[c-1]=u[c-1]?0:1},k=()=>{let c=[];return X.data.type=="Choices"?u.forEach((j,te)=>{u[te]&&c.push(X.data[`option_${te+1}`])}):c.push(h.value),c},H=()=>{let c=k();if(!c.length){fi({title:__("Please select an option"),icon:"alert-circle",iconClasses:"text-yellow-600 bg-yellow-100 rounded-full",position:"top-center"});return}W({url:"seminary.seminary.doctype.quiz.quiz.check_answer",params:{question:d.value,type:X.data.type,answers:JSON.stringify(c)},auto:!0,onSuccess($){X.data.type==="Choices"?u.forEach((te,le)=>{te?p[le]=te&&$[le]:$[le]===2?p[le]=2:p[le]=void 0}):p.push($),K(),y.data.show_answers||_e()}})},K=()=>{let c=JSON.parse(localStorage.getItem(y.data.title))||[],$={question_name:d.value,answer:k().join(),is_correct:p.filter(te=>te!=null)};const j=c.findIndex(te=>te.question_name===$.question_name);j!==-1?c[j]=$:c?c.push($):c=[$],localStorage.setItem(y.data.title,JSON.stringify(c)),localStorage.setItem(`${y.data.name}_results`,JSON.stringify(c))},ce=()=>{y.data.show_answers?(K(),_e()):H()},_e=()=>{l.value!=y.data.questions.length&&(l.value=l.value+1,u.splice(0,u.length,0,0,0,0),p.length=0,h.value=null)},f=()=>{if(!y.data.show_answers){H(),setTimeout(()=>{I()},500);return}I(),console.log("Quiz submitted with Submit Quiz button and asnwers shown")},A=()=>se(null,null,function*(){var j;const c=[],$=[];for(let te=0;te<he.data.length;te++){const le=he.data[te],we=((j=v[te])==null?void 0:j[0])||"",Q=yield Ue("seminary.seminary.doctype.quiz.quiz.check_answer",{question:le.question,type:le.type,answers:JSON.stringify([we])}),ve=Array.isArray(Q)?[Q.find(r=>r===1)||0]:[Q];c.push({question_name:le.question,answer:we,is_correct:ve}),$.push({question_name:le.question,question_detail:le.question_detail,user_answer:we,correct_answer:null,explanation:le.explanation||null})}re.submit({results:JSON.stringify(c)},{onSuccess:te=>se(null,null,function*(){const le=yield Ue("seminary.seminary.doctype.quiz.quiz.get_all_question_results",{questions:b.map(we=>we.question)});$.forEach(we=>{const Q=le.find(ve=>ve.name===we.question_name);Q&&(we.correct_answer=Q.correct_option,we.explanation=Q.correct_explanation||we.explanation)}),localStorage.setItem(`${y.data.name}_questions`,JSON.stringify($)),localStorage.setItem(`${y.data.name}_results`,JSON.stringify(c)),localStorage.setItem(`${y.data.name}_summary`,JSON.stringify(te)),re.reload(),t.value=!1}),onError(te){console.error("Error submitting quiz:",te)}})}),I=()=>{const c=localStorage.getItem(`${y.data.name}_results`);if(!c){console.error("No results found to submit.");return}re.submit({results:c},{onSuccess($){ge(),y.data&&y.data.max_attempts&&ee.reload(),y.data.duration&&clearInterval(x)},onError($){var te,le;(($==null?void 0:$.message)||"").includes("MaximumAttemptsExceededError")&&((te=$.messages)!=null&&te[0],ke.error(((le=$.messages)==null?void 0:le[0])||$),setTimeout(()=>{window.location.reload()},3e3))}})},M=()=>{l.value=0,u.splice(0,u.length,0,0,0,0),p.length=0,re.reset(),P(),F(),R.value=0},V=c=>c.type=="Choices"?c.multiple?__("Choose all answers that apply"):__("Choose one answer"):__("Type your answer"),ge=()=>{_.currentRoute.value.name==="Lesson"&&Ue("seminary.seminary.api.mark_lesson_progress",{course:_.currentRoute.value.params.courseName,chapter_number:_.currentRoute.value.params.chapterNumber,lesson_number:_.currentRoute.value.params.lessonNumber}).then(()=>{t.value&&re.reload()})},be=(c,$)=>{v[c]=[$]},me=(c,$)=>{v[c]||(v[c]=[]);const j=v[c].indexOf($);j===-1?v[c].push($):v[c].splice(j,1)};ue(()=>he.data,c=>{c?console.log("All questions details updated"):console.warn("No data available in all_questions_details.")});const Se=T([]),xe=T([]);return ue(()=>re.data,()=>{if(re.data){const c=localStorage.getItem(`${y.data.name}_questions`),$=localStorage.getItem(`${y.data.name}_results`);Se.value=c?JSON.parse(c):[],xe.value=$?JSON.parse($):[]}}),(c,$)=>{var j,te,le,we;return B.value?(o(),i("div",bs,[s("div",ks,[s("div",ws,n(c.__(`This quiz consists of '${a(b).length}' questions`)),1),(j=a(y).data)!=null&&j.duration?(o(),i("div",xs,n(c.__(`Please ensure that you complete all the questions in ${a(y).data.duration} minutes.`)),1)):D("",!0),(te=a(y).data)!=null&&te.duration?(o(),i("div",$s,n(c.__("If you fail to do so, the quiz will be automatically submitted when the timer ends.")),1)):D("",!0),a(y).data.passing_percentage?(o(),i("div",Ss,n(c.__(`You will have to get ${a(y).data.passing_percentage}% correct answers in order to pass the quiz.`)),1)):D("",!0),a(y).data.max_attempts?(o(),i("div",Cs,n(c.__(`You can attempt this quiz ${a(y).data.max_attempts===1?c.__("1 time"):`${a(y).data.max_attempts}
				times`}.`)),1)):D("",!0)]),a(y).data.duration?(o(),i("div",Ts,[s("div",As,[s("span",Ds,n(c.__("Time"))+": ",1),s("span",Fs,n(O(g.value)),1)]),N(Lt,{progress:U.value},null,8,["progress"])])):D("",!0),t.value?D("",!0):(o(),i("div",Ms,[s("div",Es,[s("div",Ns,n(a(y).data.title),1),(!a(y).data.max_attempts||((le=a(ee).data)==null?void 0:le.length)<a(y).data.max_attempts)&&a(y).data.qbyquestion?(o(),z(a(G),{key:0,onClick:C,class:"mt-2"},{default:q(()=>[s("span",null,n(c.__("Start")),1)]),_:1})):!a(y).data.max_attempts||((we=a(ee).data)==null?void 0:we.length)<a(y).data.max_attempts?(o(),z(a(G),{key:1,onClick:L,class:"mt-2"},{default:q(()=>[...$[7]||($[7]=[s("span",null,n("Start full quiz"),-1)])]),_:1})):(o(),i("div",Is,n(c.__("You have already exceeded the maximum number of attempts allowed for this quiz.")),1))])])),t.value===!1&&l.value!==0&&!a(re).data&&a(y).data.qbyquestion?(o(),i("div",Ls,[(o(!0),i(de,null,pe(a(b),(Q,ve)=>(o(),i("div",null,[ve==l.value-1&&a(X).data?(o(),i("div",zs,[s("div",Ps,[s("div",Rs,[s("span",qs,n(c.__("Question"))+" "+n(l.value)+": ",1),s("span",null,n(V(a(X).data)),1)]),s("div",Us,n(Q.points)+" "+n(Q.points==1?c.__("Point"):c.__("Points")),1)]),s("div",{class:"text-ink-gray-9 font-semibold mt-2 leading-5",innerHTML:a(X).data.question},null,8,Os),a(X).data.type=="Choices"?(o(),i(de,{key:0},pe(4,r=>s("div",null,[a(X).data[`option_${r}`]?(o(),i("label",Vs,[!p.length&&!a(X).data.multiple?(o(),i("input",{key:0,type:"radio",name:encodeURIComponent(a(X).data.question),class:"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals",onChange:w=>Y(r)},null,40,Hs)):!p.length&&a(X).data.multiple?(o(),i("input",{key:1,type:"checkbox",name:encodeURIComponent(a(X).data.question),class:"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals",onChange:w=>Y(r)},null,40,Bs)):a(y).data.show_answers?(o(!0),i(de,{key:2},pe(p,(w,Z)=>(o(),i("div",null,[r-1==Z?(o(),i("div",js,[w==1?(o(),z(a(nt),{key:0,class:"w-4 h-4 text-green-800"})):w==2?(o(),z(a(gt),{key:1,class:"w-4 h-4 text-ink-green-2"})):w==0?(o(),z(a(rt),{key:2,class:"w-4 h-4 text-red-600"})):(o(),z(a(gt),{key:3,class:"w-4 h-4"}))])):D("",!0)]))),256)):D("",!0),s("span",{class:"ml-2",innerHTML:a(X).data[`option_${r}`]},null,8,Gs)])):D("",!0),a(X).data[`explanation_${r}`]?$e((o(),i("div",{key:1,class:"mt-2 text-xs"},n(a(X).data[`explanation_${r}`]),513)),[[Bt,p.length]]):D("",!0)])),64)):a(X).data.type=="User Input"?(o(),i("div",Qs,[N(a(Pe),{modelValue:h.value,"onUpdate:modelValue":$[0]||($[0]=r=>h.value=r),type:"textarea",disabled:!!p.length,class:"my-2"},null,8,["modelValue","disabled"]),p.length?(o(),i("div",Js,[p[0]?(o(),z(a(ze),{key:0,label:c.__("Correct"),theme:"green"},{prefix:q(()=>[N(a(nt),{class:"w-4 h-4 text-ink-green-2 mr-1"})]),_:1},8,["label"])):(o(),z(a(ze),{key:1,theme:"red",label:c.__("Incorrect")},{prefix:q(()=>[N(a(rt),{class:"w-4 h-4 text-ink-red-3 mr-1"})]),_:1},8,["label"]))])):D("",!0)])):(o(),i("div",Ws,[N(a(He),{class:"mt-4",content:h.value,onChange:$[1]||($[1]=r=>h.value=r),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])),s("div",Ys,[s("div",Xs,n(c.__("Question"))+" "+n(l.value)+" "+n(c.__("of"))+" "+n(a(b).length),1),a(y).data.show_answers&&!p.length?(o(),z(a(G),{key:0,onClick:$[2]||($[2]=r=>H())},{default:q(()=>[s("span",null,n(c.__("Check")),1)]),_:1})):l.value!=a(b).length?(o(),z(a(G),{key:1,onClick:$[3]||($[3]=r=>ce())},{default:q(()=>[s("span",null,n(c.__("Next")),1)]),_:1})):(o(),z(a(G),{key:2,onClick:$[4]||($[4]=r=>f())},{default:q(()=>[s("span",null,n(c.__("Submit")),1)]),_:1}))])])):D("",!0)]))),256))])):D("",!0),t.value&&a(he).data&&a(he).data.length>0?(o(),i("div",Ks,[(o(!0),i(de,null,pe(a(he).data,(Q,ve)=>(o(),i("div",{key:Q.name,class:"border rounded-md p-5 mb-4"},[s("div",Zs,[s("div",ea,[s("span",ta,n(c.__("Question"))+" "+n(ve+1)+":",1),s("span",null,n(V(Q)),1)]),s("div",sa,n(Q.points||0)+" "+n(Q.points==1?c.__("Point"):c.__("Points")),1)]),s("div",{class:"text-ink-gray-9 font-semibold mt-2 leading-5",innerHTML:Q.question_detail},null,8,aa),Q.type=="Choices"?(o(),i(de,{key:0},pe(4,r=>s("div",null,[Q[`option_${r}`]?(o(),i("label",oa,[Q.multiple?Q.multiple?(o(),i("input",{key:1,type:"checkbox",name:`question_${ve}`,class:"w-3.5 h-3.5 text-ink-gray-9 rounded-sm focus:ring-outline-gray-modals",onChange:w=>me(ve,Q[`option_${r}`])},null,40,ra)):D("",!0):(o(),i("input",{key:0,type:"radio",name:`question_${ve}`,class:"w-3.5 h-3.5 text-ink-gray-9 focus:ring-outline-gray-modals",onChange:w=>be(ve,Q[`option_${r}`])},null,40,na)),s("span",{class:"ml-2",innerHTML:Q[`option_${r}`]},null,8,la)])):D("",!0)])),64)):Q.type=="User Input"?(o(),i("div",ia,[N(a(Pe),{modelValue:v[ve],"onUpdate:modelValue":r=>v[ve]=r,type:"textarea",class:"my-2"},null,8,["modelValue","onUpdate:modelValue"])])):D("",!0)]))),128)),s("div",ua,[N(a(G),{onClick:$[5]||($[5]=Q=>A())},{default:q(()=>[s("span",null,n(c.__("Submit Your Quiz")),1)]),_:1})])])):a(re).data?(o(),i("div",da,[s("div",ca,n(c.__("Quiz Summary")),1),s("div",ma,n(c.__(`You got ${Math.ceil(a(re).data.percentage)}% correct answers with a score of
				${a(re).data.score} out of ${a(re).data.score_out_of}`)),1),s("div",pa,[(o(!0),i(de,null,pe(Se.value,(Q,ve)=>{var r,w;return o(),i("div",{key:Q.question_name,class:"border rounded-md p-5 mb-4"},[s("div",fa,[s("div",_a,[s("span",ha,n(c.__("Question"))+" "+n(ve+1)+":",1),s("span",{innerHTML:Q.question_detail},null,8,va)])]),s("div",ga,[s("strong",null,n(c.__("Your Answer:")),1),ie(" "+n(Q.user_answer||c.__("No Answer")),1)]),s("div",ya,[s("strong",null,n(c.__("Correct Answer:")),1),ie(" "+n(Q.correct_answer||c.__("No Correct Answer")),1)]),Q.explanation?(o(),i("div",ba,[s("strong",null,n(c.__("Explanation:")),1),ie(" "+n(Q.explanation),1)])):D("",!0),s("div",ka,[((w=(r=xe.value[ve])==null?void 0:r.is_correct)==null?void 0:w[0])===1?(o(),z(a(ze),{key:0,label:c.__("Correct"),theme:"green"},{prefix:q(()=>[N(a(nt),{class:"w-4 h-4 text-ink-green-2 mr-1"})]),_:1},8,["label"])):(o(),z(a(ze),{key:1,label:c.__("Incorrect"),theme:"red"},{prefix:q(()=>[N(a(rt),{class:"w-4 h-4 text-ink-red-3 mr-1"})]),_:1},8,["label"]))])])}),128))]),N(a(G),{onClick:$[6]||($[6]=Q=>M()),class:"mt-4"},{default:q(()=>[s("span",null,n(c.__("Try Again")),1)]),_:1})])):D("",!0)])):(o(),i("div",wa,[...$[8]||($[8]=[s("p",null,"Loading quiz data...",-1)])]))}}},$a={key:1,class:"border rounded-md text-center py-20"},Sa={__name:"QuizBlock",props:{quiz:{type:String,required:!0}},setup(m){const e=Ae("$user"),t=()=>{window.location.href="/login"};return(l,d)=>a(e).data?(o(),z(xa,{key:0,quizName:m.quiz},null,8,["quizName"])):(o(),i("div",$a,[s("div",null,n(l.__("Please login to access the quiz.")),1),N(a(G),{onClick:d[0]||(d[0]=u=>t()),class:"mt-2"},{default:q(()=>[s("span",null,n(l.__("Login")),1)]),_:1})]))}},Ca={class:"p-5 space-y-4"},Ta={key:0,class:"text-lg font-semibold"},Aa={key:1,class:"text-lg font-semibold"},Da={key:2,class:"text-lg font-semibold"},Fa={key:3,class:"text-lg font-semibold"},Ma={class:"flex justify-end space-x-2"},tt={__name:"AssessmentPlugin",props:{type:{type:String,required:!0},onAddition:{type:Function,required:!0}},setup(m){const e=T(!1),t=T(null),l=T(null),d=T(null),u=T(null),p=m;Ee(()=>se(null,null,function*(){yield Ct(),e.value=!0}));const b=()=>{p.type=="quiz"?p.onAddition(t.value):p.type=="exam"?p.onAddition(d.value):p.type=="discussionactivity"?p.onAddition(u.value):p.onAddition(l.value),e.value=!1},h=()=>{p.type=="quiz"?window.open("/seminary/quizzes/new","_blank"):p.type=="exam"?window.open("/seminary/exams/new","_blank"):p.type=="discussionactivity"?window.open("/seminary/discussion-activity/new","_blank"):window.open("/seminary/assignments/new","_blank")};return(g,x)=>(o(),z(a($t),{modelValue:e.value,"onUpdate:modelValue":x[5]||(x[5]=_=>e.value=_),options:{size:"xl"}},{body:q(()=>[x[6]||(x[6]=s("button",{style:{opacity:"0",position:"absolute"}},"Fallback Focus",-1)),s("div",Ca,[m.type=="quiz"?(o(),i("div",Ta,n(g.__("Add a quiz to your lesson")),1)):m.type=="exam"?(o(),i("div",Aa,n(g.__("Add an exam to your lesson")),1)):m.type=="discussionactivity"?(o(),i("div",Da,n(g.__("Add a discussion activity to your lesson")),1)):(o(),i("div",Fa,n(g.__("Add an assignment to your lesson")),1)),s("div",null,[m.type=="quiz"?(o(),z(Ve,{key:0,modelValue:t.value,"onUpdate:modelValue":x[0]||(x[0]=_=>t.value=_),doctype:"Quiz",label:g.__("Select a quiz"),onCreate:(_,R)=>h()},null,8,["modelValue","label","onCreate"])):m.type=="exam"?(o(),z(Ve,{key:1,modelValue:d.value,"onUpdate:modelValue":x[1]||(x[1]=_=>d.value=_),doctype:"Exam Activity",label:g.__("Select an exam"),onCreate:(_,R)=>h()},null,8,["modelValue","label","onCreate"])):m.type=="discussionactivity"?(o(),z(Ve,{key:2,modelValue:u.value,"onUpdate:modelValue":x[2]||(x[2]=_=>u.value=_),doctype:"Discussion Activity",label:g.__("Select a discussion activity"),onCreate:(_,R)=>h()},null,8,["modelValue","label","onCreate"])):(o(),z(Ve,{key:3,modelValue:l.value,"onUpdate:modelValue":x[3]||(x[3]=_=>l.value=_),doctype:"Assignment Activity",label:g.__("Select an assignment"),onCreate:(_,R)=>h()},null,8,["modelValue","label","onCreate"]))]),s("div",Ma,[N(a(G),{variant:"solid",onClick:x[4]||(x[4]=_=>b())},{default:q(()=>[ie(n(g.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"]))}};class Ea{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l}static get toolbox(){const e=fe({render:()=>Re(jt,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:__("Quiz"),icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderQuiz(this.data.quiz):this.renderQuizModal(),this.wrapper}renderQuiz(e){if(this.readOnly){const t=fe(Sa,{quiz:e});t.use(De),t.use(Me);const{userResource:l}=et();t.provide("$user",l),t.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Quiz: ${e}
            </span>
        </div>`}renderQuizModal(){if(this.readOnly)return;const e=fe(tt,{type:"quiz",onAddition:t=>{this.data.quiz=t,this.renderQuiz(t)}});e.use(De),e.use(Me),e.mount(this.wrapper)}save(e){return{quiz:this.data.quiz}}}const Na={class:"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]"},Ia={key:0,class:"text-lg font-semibold mb-5 text-ink-gray-9"},La={key:0},za={key:1},Pa={class:"text-sm text-ink-gray-7 font-medium mb-2"},Ra=["innerHTML"],qa={class:"flex flex-col"},Ua={class:"p-5"},Oa={class:"flex items-center justify-between mb-4"},Va={class:"font-semibold text-ink-gray-9"},Ha={class:"flex items-center space-x-2"},Ba={key:0,class:"bg-blue-200 p-3 rounded-md leading-5 text-sm mb-4"},ja={key:1},Ga={class:"text-xs text-ink-gray-5 mt-1 mb-2"},Qa={key:1},Ja={class:"flex text-ink-gray-7"},Wa={class:"border self-start rounded-md p-2 mr-2"},Ya=["href"],Xa={class:"text-sm leading-5"},Ka={class:"text-sm text-ink-gray-5 mt-1"},Za={key:2},eo={class:"text-xs text-ink-gray-5 mb-1"},to={key:3},so={class:"text-sm mb-4"},ao={key:4,class:"mt-8 p-3 bg-blue-200 rounded-md"},oo={class:"text-sm text-ink-gray-5 font-medium mb-2"},no={class:"leading-5"},ro=["innerHTML"],lo={key:5,class:"mt-8 space-y-4"},io={class:"font-semibold mb-2 text-ink-gray-9"},uo={class:"text-sm text-ink-gray-5 mb-1"},co={__name:"Assignment",props:{assignmentID:{type:String,required:!0},submissionName:{type:String,default:"new"}},setup(m){var he;const e=T(null),t=T(null),l=T(null),d=Ze(),u=Ae("$user"),p=d.currentRoute.value.name=="AssignmentSubmission",b=T(!1),h=m;Ee(()=>{window.addEventListener("keydown",g),console.log("User: ",u.data)});const g=C=>{C.key==="s"&&(C.ctrlKey||C.metaKey)&&(ae(),C.preventDefault())};mt(()=>{window.removeEventListener("keydown",g)});const x=W({url:"frappe.client.get",params:{doctype:"Assignment Activity",name:h.assignmentID},auto:!0,onSuccess(C){h.submissionName!="new"&&v.reload()}}),_=W({url:"frappe.client.insert",makeParams(C){var Y;let L={doctype:"Assignment Submission",assignment:h.assignmentID,member:(Y=u.data)==null?void 0:Y.name,course:d.currentRoute.value.params.courseName};return X()?L.assignment_attachment=e.value.file_url:L.answer=t.value,{doc:L}}}),R=W({url:"seminary.seminary.api.get_file_info",makeParams(C){return{file_url:C.image}},auto:!1,onSuccess(C){e.value=C}}),v=ct({doctype:"Assignment Submission",name:h.submissionName,onError(C){var L;ke.error(((L=C.messages)==null?void 0:L[0])||C)},auto:!1,cache:[(he=u.data)==null?void 0:he.name,h.assignmentID]});ue(v,()=>{v.doc&&(v.doc.assignment_attachment&&R.reload({image:v.doc.assignment_attachment}),v.doc.answer&&(t.value=v.doc.answer),v.doc.comments&&(l.value=v.doc.comments),v.isDirty||X()&&!e.value||!X()&&!t.value?b.value=!0:b.value=!1)}),ue(e,()=>{h.submissionName=="new"&&e.value&&(b.value=!0)}),ue(()=>{var C;return(C=v.doc)==null?void 0:C.grade},(C,L)=>{C!==L&&v.doc&&(v.doc.status="Graded",b.value=!0)});const ae=()=>{var C,L,Y;if(h.submissionName!="new"){let k=v.doc&&v.doc.owner!=((C=u.data)==null?void 0:C.name)?(L=u.data)==null?void 0:L.name:null;v.setValue.submit(Ge(qe({},v.doc),{assignment_attachment:(Y=e.value)==null?void 0:Y.file_url,evaluator:k,comments:l.value,answer:t.value}),{onSuccess(H){ke.success(__("Changed successfully")),b.value=!1}})}else y()},y=()=>{_.submit({},{onSuccess(C){ke.success(__("Assignment submitted successfully")),d.currentRoute.value.name=="AssignmentSubmission"?d.push({name:"AssignmentSubmission",params:{assignmentID:h.assignmentID,submissionName:C.name}}):(P(),d.go()),v.name=C.name,b.value=!1,v.reload()},onError(C){var L;ke.error(((L=C.messages)==null?void 0:L[0])||C)}})},B=C=>{b.value=!0,e.value=C},P=()=>{if(d.currentRoute.value.name=="Lesson"){let C=d.currentRoute.value.params.courseName,L=d.currentRoute.value.params.chapterNumber,Y=d.currentRoute.value.params.lessonNumber;console.log("Chapter Number: ",L),console.log("Lesson Number: ",Y),Ue("seminary.seminary.api.mark_lesson_progress",{course:C,chapter_number:L,lesson_number:Y})}},F=()=>{var L;const C=(L=x.data)==null?void 0:L.type;if(C=="Image")return["image/*"];if(C=="Document")return[".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];if(C=="PDF")return[".pdf"]},S=C=>{var k;let L=(k=x.data)==null?void 0:k.type,Y=C.name.split(".").pop().toLowerCase();if(L=="Image"&&!["jpg","jpeg","png"].includes(Y))return __("Only image file is allowed.");if(L=="Document"&&!["doc","docx","xml"].includes(Y))return __("Only document file is allowed.");if(L=="PDF"&&!["pdf"].includes(Y))return __("Only PDF file is allowed.")},O=()=>{b.value=!0,e.value=null},U=oe(()=>{var C,L,Y;return(((C=u.data)==null?void 0:C.is_moderator)||((L=u.data)==null?void 0:L.is_evaluator)||((Y=u.data)==null?void 0:Y.is_instructor))&&h.submissionName!="new"&&d.currentRoute.value.name=="AssignmentSubmission"}),ne=oe(()=>{var C,L,Y;return!v.doc||((C=v.doc)==null?void 0:C.owner)==((L=u.data)==null?void 0:L.name)&&((Y=v.doc)==null?void 0:Y.status)=="Not Graded"}),ee=oe(()=>[{label:__("Not Graded"),value:"Not Graded"},{label:__("Graded"),value:"Graded"},{label:__("Pass"),value:"Pass"},{label:__("Fail"),value:"Fail"}]),re=oe(()=>v.doc?v.doc.status=="Pass"||v.doc.status=="Graded"?"green":v.doc.status=="Not Graded"?"blue":"red":"orange"),X=()=>{var C;return["PDF","Image","Document"].includes((C=x.data)==null?void 0:C.type)};return(C,L)=>{var Y,k,H,K,ce,_e,f,A,I,M;return a(x).data?(o(),i("div",{key:0,class:Oe(["grid grid-cols-[65%,35%] h-full",{"border rounded-lg":!p}])},[s("div",Na,[p?(o(),i("div",Ia,[m.submissionName==="new"?(o(),i("div",La,n(C.__("Submission by"))+" "+n((Y=a(u).data)==null?void 0:Y.full_name),1)):(o(),i("div",za,n(C.__("Submission by"))+" "+n((k=a(v).doc)==null?void 0:k.member_name),1))])):D("",!0),s("div",Pa,n(C.__("Question"))+": ",1),s("div",{innerHTML:a(x).data.question,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,Ra)]),s("div",qa,[s("div",Ua,[s("div",Oa,[s("div",Va,n(C.__("Submission")),1),s("div",Ha,[b.value?(o(),z(a(ze),{key:0,theme:"orange"},{default:q(()=>[ie(n(C.__("Not Saved")),1)]),_:1})):(H=a(v).doc)!=null&&H.status?(o(),z(a(ze),{key:1,theme:re.value,size:"lg"},{default:q(()=>{var V;return[ie(n((V=a(v).doc)==null?void 0:V.status),1)]}),_:1},8,["theme"])):D("",!0),N(a(G),{variant:"solid",onClick:L[0]||(L[0]=V=>ae())},{default:q(()=>[ie(n(C.__("Save")),1)]),_:1})])]),m.submissionName!="new"&&!["Pass","Fail","Graded"].includes((K=a(v).doc)==null?void 0:K.status)&&((ce=a(v).doc)==null?void 0:ce.owner)==((_e=a(u).data)==null?void 0:_e.name)?(o(),i("div",Ba,n(C.__("You've successfully submitted the assignment."))+" "+n(C.__("Once the moderator grades your submission, you'll find the details here."))+" "+n(C.__("Feel free to make edits to your submission if needed, until it is graded.")),1)):D("",!0),X()?(o(),i("div",ja,[s("div",Ga,n(C.__("Add your assignment as {0}").format(a(x).data.type)),1),e.value?(o(),i("div",Qa,[s("div",Ja,[s("div",Wa,[N(a(Xe),{class:"h-5 w-5 stroke-1.5"})]),s("a",{href:e.value.file_url,target:"_blank",class:"flex flex-col cursor-pointer !no-underline"},[s("span",Xa,n(e.value.file_name),1),s("span",Ka,n(a(Ke)(e.value.file_size)),1)],8,Ya),ne.value?(o(),z(a(Tt),{key:0,onClick:L[2]||(L[2]=V=>O()),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})):D("",!0)])])):(o(),z(a(We),{key:0,fileTypes:F(),validateFile:S,onSuccess:L[1]||(L[1]=V=>B(V))},{default:q(({uploading:V,progress:ge,openFileSelector:be})=>[N(a(G),{onClick:be,loading:V},{default:q(()=>[ie(n(V?C.__("Uploading {0}%").format(ge):C.__("Upload File")),1)]),_:2},1032,["onClick","loading"])]),_:1},8,["fileTypes"]))])):a(x).data.type=="URL"?(o(),i("div",Za,[s("div",eo,n(C.__("Enter a URL")),1),N(a(Pe),{modelValue:t.value,"onUpdate:modelValue":L[3]||(L[3]=V=>t.value=V),type:"text",readonly:!ne.value},null,8,["modelValue","readonly"])])):(o(),i("div",to,[s("div",so,n(C.__("Write your answer here")),1),N(a(He),{content:t.value,onChange:L[4]||(L[4]=V=>t.value=V),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])),((f=a(u).data)==null?void 0:f.name)==((A=a(v).doc)==null?void 0:A.owner)&&((I=a(v).doc)!=null&&I.comments)?(o(),i("div",ao,[s("div",oo,n(C.__("Comments by"))+": "+n(((M=a(v).doc)==null?void 0:M.evaluator)||C.__("Evaluator")),1),s("div",no,[s("div",{innerHTML:a(v).doc.comments},null,8,ro)])])):D("",!0),U.value?(o(),i("div",lo,[s("div",io,n(C.__("Grading")),1),a(v).doc?(o(),z(a(Pe),{key:0,modelValue:a(v).doc.status,"onUpdate:modelValue":L[5]||(L[5]=V=>a(v).doc.status=V),label:C.__("Grading Status"),type:"select",options:ee.value},null,8,["modelValue","label","options"])):D("",!0),a(v).doc?(o(),z(a(Pe),{key:1,modelValue:a(v).doc.grade,"onUpdate:modelValue":L[6]||(L[6]=V=>a(v).doc.grade=V),label:C.__("Score"),type:"number"},null,8,["modelValue","label"])):D("",!0),s("div",null,[s("div",uo,n(C.__("Comments")),1),N(a(He),{content:l.value,onChange:L[7]||(L[7]=V=>{l.value=V,b.value=!0}),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])])):D("",!0)])])],2)):D("",!0)}}},mo={key:1,class:"border rounded-md text-center py-20"},po={__name:"AssignmentBlock",props:{assignmentID:{type:String,required:!0}},setup(m){const e=Ae("$user"),t=m,l=W({url:"frappe.client.get_value",makeParams(d){var u;return{doctype:"Assignment Submission",fieldname:"name",filters:{assignment:t.assignmentID,member:(u=e.data)==null?void 0:u.name}}},auto:!0});return(d,u)=>{var p;return a(e).data&&a(l).data?(o(),z(co,{key:0,assignmentID:m.assignmentID,submissionName:((p=a(l).data)==null?void 0:p.name)||"new"},null,8,["assignmentID","submissionName"])):(o(),i("div",mo,[s("div",null,n(d.__("Please login to access the assignment.")),1),N(a(G),{onClick:u[0]||(u[0]=b=>d.redirectToLogin()),class:"mt-2"},{default:q(()=>[s("span",null,n(d.__("Login")),1)]),_:1})]))}}};class fo{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l}static get toolbox(){const e=fe({render:()=>Re(Gt,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:__("Assignment"),icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderAssignment(this.data.assignment):this.renderAssignmentModal(),this.wrapper}renderAssignment(e){if(this.readOnly){const t=fe(po,{assignmentID:e});t.use(De),t.use(Me);const{userResource:l}=et();t.provide("$user",l),t.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Assignment: ${e}
            </span>
        </div>`}renderAssignmentModal(){if(this.readOnly)return;const e=fe(tt,{type:"assignment",onAddition:t=>{this.data.assignment=t,this.renderAssignment(t)}});e.use(De),e.use(Me),e.mount(this.wrapper)}save(e){return{assignment:this.data.assignment}}}const _o={key:0,class:"text-center py-5"},ho={key:1,class:"space-y-5"},vo={class:"grid grid-cols-3 gap-3"},go={class:"col-span-3 space-y-4"},yo={class:"space-y-4 border p-2 rounded-md"},bo={class:"flex items-center justify-between py-4"},ko={class:"text-center ml-5"},wo={class:"text-3xl font-bold text-ink-gray-9"},xo={class:"text-center"},$o={class:"text-3xl font-semibold text-ink-gray-9"},So={class:"text-sm text-ink-gray-5"},Co={class:"text-center mr-5"},To={class:"text-3xl font-semibold text-ink-gray-9 mt-2"},Ao={class:"space-y-1"},Do={class:"font-semibold text-ink-gray-9 text-left"},Fo=["innerHTML"],Mo={class:"leading-5 text-ink-gray-7 space-x-1 text-left"},Eo=["innerHTML"],No={class:"flex justify-end items-center space-x-2"},Io={class:"text-sm text-ink-gray-7 text-xl"},Lo={key:0,class:"leading-5 text-ink-gray-7 text-xl space-x-1 text-left"},zo=["innerHTML"],Po={key:2},Ro={__name:"ExamGraded",props:{submission:{type:String,required:!0}},setup(m){const e=m;console.log("ExamGraded received submission:",e.submission);const t=ct({doctype:"Exam Submission",name:e.submission,auto:!0});console.log("ExamGraded submisisonDetails:",t),ue(()=>t.doc,d=>{t.loading=!1,console.log("ExamGraded updated with new submission details:",d)});const l=d=>{if(!d)return"00:00:00";const u=Math.floor(d/3600).toString().padStart(2,"0"),p=Math.floor(d%3600/60).toString().padStart(2,"0"),b=(d%60).toString().padStart(2,"0");return`${u}:${p}:${b}`};return(d,u)=>a(t).loading?(o(),i("div",_o,[...u[0]||(u[0]=[s("p",null,"Loading submission details...",-1)])])):a(t).doc?(o(),i("div",ho,[s("div",vo,[s("div",go,[s("div",yo,[s("div",bo,[s("div",ko,[s("div",wo,n(a(t).doc.percentage||0)+"% ",1),u[1]||(u[1]=s("div",{class:"text-sm text-ink-gray-5"},"Score",-1))]),s("div",xo,[s("div",$o,n(a(t).doc.score),1),s("div",So," Out of "+n(a(t).doc.score_out_of)+" Points ",1)]),s("div",Co,[s("div",To,n(l(a(t).doc.time_taken)),1),u[2]||(u[2]=s("div",{class:"text-sm text-ink-gray-5"},"Time taken",-1))])])]),(o(!0),i(de,null,pe(a(t).doc.result,(p,b)=>(o(),i("div",{key:b,class:"border p-5 rounded-md space-y-4"},[s("div",Ao,[s("div",Do,n(d.__("Question"))+" "+n(b+1)+": ",1),s("div",{class:"leading-5 text-ink-gray-9 text-left",innerHTML:p.question_name},null,8,Fo)]),s("div",Mo,[s("span",null,n(d.__("Your Answer"))+": ",1),s("span",{innerHTML:p.answer},null,8,Eo)]),s("div",No,[s("span",Io,n(p.points)+" / "+n(parseInt(p.points_out_of,10))+" "+n(d.__("Points")),1)]),p.comments?(o(),i("div",Lo,[s("span",null,n(d.__("Comments"))+": ",1),s("span",{innerHTML:p.comments},null,8,zo)])):D("",!0)]))),128))])])])):(o(),i("div",Po,[...u[3]||(u[3]=[s("p",null,"Debug: No submission details found.",-1)])]))}},zt={__name:"UserAvatar",props:{user:{type:Object,default:null},size:{type:String}},setup(m){return(e,t)=>(o(),z(a(dt),{text:m.user.full_name},{default:q(()=>[m.user?(o(),z(a(Ot),Qt({key:0,class:"avatar border border-outline-gray-2 cursor-auto",label:m.user.full_name,image:m.user.user_image,size:m.size},e.$attrs),null,16,["label","image","size"])):D("",!0)]),_:1},8,["text"]))}},qo={class:"mt-6"},Uo={key:0,class:"flex items-center mb-5"},Oo={class:"text-lg font-semibold ml-2 text-ink-gray-9"},Vo={class:"flex items-center justify-between mb-2"},Ho={class:"flex items-center text-ink-gray-5"},Bo={class:"text-sm ml-2"},jo={key:1},Go={key:2,class:"flex justify-between mt-2"},kt={__name:"DiscussionReplies",props:At({topic:{type:Object,required:!0},singleThread:{type:Boolean,default:!1}},{showTopics:{},showTopicsModifiers:{}}),emits:["update:showTopics"],setup(m){const e=it(m,"showTopics"),t=T(""),l=Ae("$user"),d=Ae("$allUsers"),u=T([]),p=T(!1),b=window.read_only_mode,h=T(!1),g=It();g?(console.log("Socket connection initialized in Discussions.vue:",g),g.on("connect",()=>{console.log("Socket connected:",g.id),h.value=!0}),g.on("connect_error",S=>{console.error("Socket connection error:",S)}),g.on("disconnect",S=>{console.warn("Socket disconnected:",S),h.value=!1})):console.error("Socket connection not initialized in Discussions.vue.");const x=m;Ee(()=>{g.on("publish_message",S=>{_.reload()}),g.on("update_message",S=>{_.reload()}),g.on("delete_message",S=>{_.reload()}),v()});const _=W({url:"seminary.seminary.utils.get_discussion_replies",cache:["replies",x.topic],makeParams(S){return{topic:x.topic.name}},auto:!0}),R=W({url:"frappe.client.insert",makeParams(S){return{doc:{doctype:"Discussion Reply",reply:t.value,topic:x.topic.name}}}}),v=()=>{var S;(S=l.data)!=null&&S.is_student?p.value=!0:d.reload({},{onSuccess(O){u.value=Object.values(O).map(U=>({value:U.name,label:U.full_name})),p.value=!0}})},ae=()=>{R.submit({},{validate(){if(!t.value)return __("Reply cannot be empty")},onSuccess(){t.value="",_.reload()},onError(S){var O;ke.error(((O=S.messages)==null?void 0:O[0])||S)}})},y=W({url:"frappe.client.set_value",makeParams(S){return{doctype:"Discussion Reply",name:S.name,fieldname:"reply",value:S.reply}}}),B=S=>{y.submit({name:S.name,reply:S.reply},{validate(){if(!S.reply)return __("Reply cannot be empty")},onSuccess(){S.editable=!1,_.reload()}})},P=W({url:"frappe.client.delete",makeParams(S){return{doctype:"Discussion Reply",name:S.name}}}),F=S=>{P.submit({name:S.name},{onSuccess(){_.reload()}})};return Jt(()=>{g.off("publish_message"),g.off("update_message"),g.off("delete_message")}),(S,O)=>(o(),i("div",qo,[m.singleThread?D("",!0):(o(),i("div",Uo,[N(a(G),{variant:"outline",onClick:O[0]||(O[0]=U=>e.value=!0)},{icon:q(()=>[N(a(Wt),{class:"w-5 h-5 stroke-1.5 text-ink-gray-7"})]),_:1}),s("span",Oo,n(m.topic.title),1)])),(o(!0),i(de,null,pe(a(_).data,(U,ne)=>(o(),i("div",null,[s("div",{class:Oe(["py-3",{"border-b":ne+1!=a(_).data.length}])},[s("div",Vo,[s("div",Ho,[N(zt,{user:U.user,class:"mr-2"},null,8,["user"]),s("span",null,n(U.user.full_name),1),s("span",Bo,n(a(st)(U.creation)),1)]),a(l).data.name==U.owner&&!U.editable&&!a(b)?(o(),z(a(Vt),{key:0,options:[{label:S.__("Edit"),onClick(){U.editable=!0}},{label:S.__("Delete"),onClick(){F(U)}}]},{default:q(({open:ee})=>[N(a(Yt),{class:"w-4 h-4 stroke-1.5 cursor-pointer"})]),_:1},8,["options"])):D("",!0),U.editable?(o(),i("div",jo,[N(a(G),{variant:"ghost",onClick:ee=>B(U)},{default:q(()=>[ie(n(S.__("Post")),1)]),_:1},8,["onClick"]),N(a(G),{variant:"ghost",onClick:ee=>U.editable=!1},{default:q(()=>[ie(n(S.__("Discard")),1)]),_:1},8,["onClick"])])):D("",!0)]),N(a(He),{content:U.reply,onChange:ee=>U.reply=ee,editable:U.editable||!1,fixedMenu:U.editable||!1,editorClass:U.editable?"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none":"prose-sm"},null,8,["content","onChange","editable","fixedMenu","editorClass"])],2)]))),256)),p.value&&!a(b)?(o(),z(a(He),{key:1,class:"mt-5",content:t.value,mentions:u.value,onChange:O[1]||(O[1]=U=>t.value=U),placeholder:"Type your reply here...",fixedMenu:!0,editorClass:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none border border-outline-gray-2 rounded-b-md min-h-[7rem] py-1 px-2"},null,8,["content","mentions"])):D("",!0),a(b)?D("",!0):(o(),i("div",Go,[O[3]||(O[3]=s("span",null,null,-1)),N(a(G),{onClick:O[2]||(O[2]=U=>ae())},{default:q(()=>[s("span",null,n(S.__("Post")),1)]),_:1})]))]))}},Qo={class:"discussion-dialog flex flex-col gap-4 max-h-[70vh] overflow-y-auto"},Jo={class:"mb-1.5 text-sm text-ink-gray-5"},wt={__name:"DiscussionModal",props:At({title:{type:String,required:!0},doctype:{type:String,required:!0},docname:{type:String,required:!0}},{modelValue:{},modelModifiers:{},reloadTopics:{},reloadTopicsModifiers:{}}),emits:["update:modelValue","update:reloadTopics"],setup(m){const e=it(m,"modelValue"),t=it(m,"reloadTopics"),l=m,d=Je({title:"",reply:""}),u=()=>{d.title="",d.reply=""},p=W({url:"frappe.client.insert",makeParams(_){return{doc:{doctype:"Discussion Topic",reference_doctype:l.doctype,reference_docname:l.docname,title:d.title}}}}),b=W({url:"frappe.client.insert",makeParams(_){return{doc:{doctype:"Discussion Reply",topic:_.topic,reply:d.reply}}}}),h=_=>{p.submit({},{validate(){if(!d.title)return __("Title cannot be empty.");if(!d.reply)return __("Reply cannot be empty.")},onSuccess(R){b.submit({topic:R.name},{onSuccess(){e.value=!1,t.value.reload(),u(),_()}})},onError(R){var v;ke.error(((v=R.messages)==null?void 0:v[0])||R)}})},g=_=>{e.value=!1,u(),_==null||_()};ue(e,_=>{_||u()});const x=oe(()=>({title:Pt(l.title),size:"2xl",actions:[{label:__("Post"),variant:"solid",onClick:_=>h(_)},{label:__("Cancel"),variant:"text",onClick:_=>g(_)}]}));return(_,R)=>(o(),z(a($t),{modelValue:e.value,"onUpdate:modelValue":R[2]||(R[2]=v=>e.value=v),disableOutsideClickToClose:!0,options:x.value},{"body-content":q(()=>[s("div",Qo,[s("div",null,[N(a(Pe),{modelValue:d.title,"onUpdate:modelValue":R[0]||(R[0]=v=>d.title=v),label:_.__("Title"),type:"text"},null,8,["modelValue","label"])]),s("div",null,[s("div",Jo,n(_.__("Details")),1),N(a(He),{content:d.reply,onChange:R[1]||(R[1]=v=>d.reply=v),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])])])]),_:1},8,["modelValue","options"]))}};function Wo(){return window.scrollContainer}const Yo={class:"text-xl font-semibold text-ink-gray-9"},Xo={key:0},Ko={key:1},Zo={key:2},en=["onClick"],tn={class:"text-lg font-semibold mb-1 text-ink-gray-7"},sn={class:"flex items-center text-ink-gray-5"},an={class:"text-sm ml-3"},on={key:1},nn={key:3,class:"flex flex-col items-center justify-center border-2 border-dashed mt-5 py-8 rounded-md"},rn={class:""},ln={key:0,class:"font-medium mb-2"},un={class:"text-ink-gray-5"},dn={__name:"Discussions",props:{title:{type:String,required:!0},doctype:{type:String,required:!0},docname:{type:String,required:!0},emptyStateTitle:{type:String,default:""},emptyStateText:{type:String,default:__("Start a discussion")},singleThread:{type:Boolean,default:!1},scrollToBottom:{type:Boolean,default:!1},type:{type:String,default:"multi"}},setup(m){console.log("Discussions.vue script setup executed");const e=T(!0),t=T(null),l=Ae("$user"),d=T(!1),u=T(!0),p=T(!1),b=It();b?(console.log("Socket connection initialized in Discussions.vue:",b),b.on("connect",()=>{console.log("Socket connected:",b.id),p.value=!0}),b.on("connect_error",y=>{console.error("Socket connection error:",y)}),b.on("disconnect",y=>{console.warn("Socket disconnected:",y),p.value=!1})):console.error("Socket connection not initialized in Discussions.vue.");const h=m;ue(p,y=>{y&&(console.log("Socket is connected, proceeding with onMounted logic."),g())});const g=()=>{console.log("onMounted logic executed"),console.log("Props:",h),l.data&&(h.type==="single"?(console.log("Single-topic mode detected"),_.reload(),console.log("Topic",t.value)):u.value=!1,R.reload()),b.on("new_discussion_topic",y=>{R.refresh()}),h.scrollToBottom&&setTimeout(()=>{x()},100)},x=()=>{let y=Wo();y.scrollTop=y.scrollHeight},_=W({url:"seminary.seminary.utils.ensure_single_topic",cache:!1,makeParams(){return{doctype:h.doctype,docname:h.docname,title:h.title}},onSuccess(y){console.log("Ensure single topic response:",y),y&&(t.value=y,console.log("Current topic set:",t.value),e.value=!1,u.value=!1),console.log("Changed loading to:",u.value)},onError(y){console.error("Error ensuring single topic:",y),u.value=!1}}),R=W({url:"seminary.seminary.utils.get_discussion_topics",cache:["topics",h.doctype,h.docname],makeParams(){return{doctype:h.doctype,docname:h.docname,single_thread:h.singleThread}}}),v=y=>{e.value=!1,t.value=y},ae=()=>{d.value=!0};return(y,B)=>{var P;return o(),i(de,null,[s("div",null,[!m.singleThread&&h.type==="multi"?(o(),z(a(G),{key:0,class:"float-right",onClick:B[0]||(B[0]=F=>ae())},{default:q(()=>[ie(n(y.__("New {0}").format(a(Pt)(m.title))),1)]),_:1})):D("",!0),s("div",Yo,n(y.__(m.title)),1)]),u.value&&h.type==="single"?(o(),i("div",Xo,[...B[6]||(B[6]=[s("div",{class:"text-center py-10"},[s("span",null,"Loading discussion...")],-1)])])):D("",!0),h.type==="single"&&!u.value?(o(),i("div",Ko,[B[7]||(B[7]=s("div",{class:"flex flex-col items-center justify-center"},null,-1)),N(wt,{modelValue:d.value,"onUpdate:modelValue":B[1]||(B[1]=F=>d.value=F),title:m.title,doctype:h.doctype,docname:h.docname},null,8,["modelValue","title","doctype","docname"]),t.value.value?(o(),z(kt,{key:0,topic:t.value.value,singleThread:!0,showTopics:e.value,"onUpdate:showTopics":B[2]||(B[2]=F=>e.value=F)},null,8,["topic","showTopics"])):D("",!0)])):D("",!0),(P=a(R).data)!=null&&P.length&&!m.singleThread?(o(),i("div",Zo,[e.value?(o(!0),i(de,{key:0},pe(a(R).data,(F,S)=>(o(),i("div",{key:S},[s("div",{onClick:O=>v(F),class:Oe(["flex items-center cursor-pointer py-5 w-full",{"border-b":S+1!=a(R).data.length}])},[N(zt,{user:F.user,size:"2xl",class:"mr-4"},null,8,["user"]),s("div",null,[s("div",tn,n(F.title),1),s("div",sn,[s("span",null,n(F.user.full_name),1),s("span",an,n(a(st)(F.creation)),1)])])],10,en)]))),128)):(o(),i("div",on,[N(kt,{topic:t.value,showTopics:e.value,"onUpdate:showTopics":B[3]||(B[3]=F=>e.value=F)},null,8,["topic","showTopics"])]))])):(o(),i("div",nn,[N(a(Xt),{class:"w-7 h-7 text-ink-gray-4 stroke-1.5 mr-2"}),s("div",rn,[m.emptyStateTitle?(o(),i("div",ln,n(y.__(m.emptyStateTitle)),1)):D("",!0),s("div",un,n(y.__(m.emptyStateText)),1)])])),N(wt,{modelValue:d.value,"onUpdate:modelValue":B[4]||(B[4]=F=>d.value=F),title:y.__("New {0}").format(m.title),doctype:h.doctype,docname:h.docname,reloadTopics:a(R),"onUpdate:reloadTopics":B[5]||(B[5]=F=>pt(R)?R.value=F:null)},null,8,["modelValue","title","doctype","docname","reloadTopics"])],64)}}},cn={key:0},mn={key:0,class:"bg-blue-200 space-y-1 py-4 px-3 mb-4 rounded-md text-lg text-ink-blue-900"},pn={class:"leading-5"},fn={key:0,class:"leading-5"},_n={key:1,class:"leading-5"},hn={key:1,class:"space-y-4 border p-5 rounded-md"},vn={key:2,class:"flex flex-col space-x-1 my-4"},gn={class:"mb-2"},yn={class:""},bn={class:"font-semibold"},kn={key:3},wn={class:"border text-center p-20 rounded-md"},xn={class:"font-semibold text-lg"},$n={key:2,class:"w-full max-w-4xl mx-auto py-5"},Sn={key:3},Cn={key:4},Tn={class:"border text-center p-20 rounded-md"},An={class:"font-semibold text-lg text-ink-gray-9 mt-3 mb-3"},Dn={class:"absolute -top-3 -left-3 bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm"},Fn={class:"text-ink-gray-9 text-sm font-semibold text-right"},Mn={class:"text-ink-gray-9 text-left font-semibold mt-2 leading-5"},En=["innerHTML"],Nn={class:"mt-4"},In=["onUpdate:modelValue","placeholder","onInput"],Ln={class:"text-center mt-4"},zn={__name:"Exam",props:{examName:{type:String,required:!0}},setup(m){var L,Y;const e=Ae("$user"),t=T(0);let l=null;const d=T(0);T("");const u=T({});T([]);const p=T(!1),b=Ze();let h=!1;const g=(k=[])=>{const H=qe({},u.value),K={};k.forEach(ce=>{const _e=H[ce.name];K[ce.name]=typeof _e=="string"?_e:""}),u.value=K},x=m;console.log("Exam Name (PROPS):",x.examName);const _=W({url:"frappe.client.get",makeParams(k){return{doctype:"Exam Activity",name:x.examName}},cache:["exam",x.examName],auto:!0,transform(k){return k?(k.duration=parseInt(k.duration)||0,k):(console.error("Exam data is null or undefined."),null)},onSuccess(k){k?(k.questions=k.questions||[],g(k.questions)):console.error("Failed to load exam data.")},onError(k){console.error("Error loading exam data:",k)}}),R=oe(()=>!!_.data),v=oe(()=>{var k;return((k=ne.data)==null?void 0:k.length)>0}),ae=W({url:"seminary.seminary.utils.get_instructors",makeParams(k){const H=b.currentRoute.value.params.courseName;return H?{course:H}:(console.error("Course name is undefined in route parameters."),{})},auto:!0});ue(()=>ae.data,k=>{var K,ce;if(!Array.isArray(k))return;const H=h;h=k.some(_e=>{var f;return _e.user===((f=e.data)==null?void 0:f.name)}),!H&&h&&((ce=(K=_.data)==null?void 0:K.questions)!=null&&ce.length)&&g(_.data.questions)});const y=()=>(ae.data&&ae.data.forEach(k=>{var H;k.user===((H=e.data)==null?void 0:H.name)&&(h=!0)}),h);let B=null;const P=()=>{if(_.data.duration){t.value=_.data.duration*60,B=Date.now();const k=B+t.value*1e3;l=setInterval(()=>{const H=Date.now(),K=Math.max(0,Math.floor((k-H)/1e3));t.value=K,d.value=_.data.duration*60-K,K<=0&&(clearInterval(l),ee())},1e3)}else B=Date.now(),l=setInterval(()=>{const k=Date.now();d.value=Math.floor((k-B)/1e3)},1e3)},F=k=>{const H=Math.floor(k/60).toString().padStart(2,"0"),K=(k%60).toString().padStart(2,"0");return`${H}:${K}`},S=oe(()=>t.value/(_.data.duration*60)*100);ue(u,k=>{},{deep:!0});const O=()=>{const k=Dt(u.value);return Object.entries(k).map(([H,K])=>({question:H,answer:K}))},U=(k,H)=>{u.value[k]=H},ne=W({url:"frappe.client.get_list",makeParams(k){var H;return{doctype:"Exam Submission",filters:{member:(H=e.data)==null?void 0:H.name,exam:x.examName},fields:["name","creation"],order_by:"creation desc"}},auto:!0,transform(k){k.forEach((H,K)=>{H.creation=st(H.creation),H.idx=K+1})}});ue(()=>ne.data,k=>{console.log("Attempts data updated:",k)});const ee=()=>se(null,null,function*(){var k,H;try{const K=O(),ce=_.data.duration?_.data.duration*60-(t.value||0):d.value||0;yield Ue("seminary.seminary.doctype.exam_submission.exam_submission.create_exam_submission",{exam:x.examName,course:b.currentRoute.value.params.courseName,member:(k=e.data)==null?void 0:k.name,answers:K,time_taken:ce}),ke.success(__("Your exam was submitted successfully.")),clearInterval(l)}catch(K){console.error("Error during exam submission:",K),ke.error(((H=err.messages)==null?void 0:H[0])||err)}}),re=()=>{var k;activeQuestion.value=1,localStorage.removeItem(_.data.title),P(),g(((k=_.data)==null?void 0:k.questions)||[])},X=()=>{var k;localStorage.removeItem(_.data.title),p.value=!0,P(),g(((k=_.data)==null?void 0:k.questions)||[])},he=W({url:"frappe.client.get_value",params:{doctype:"Exam Submission",fieldname:"name",filters:{exam:x.examName,member:(L=e.data)==null?void 0:L.name,status:"Graded"}},auto:!1,transform(k){return console.log("Fetched submission data:",k),k},onError(k){console.error("Error fetching submission:",k)}}),C=W({url:"frappe.client.get_value",params:{doctype:"Exam Submission",fieldname:"name",filters:{exam:x.examName,member:(Y=e.data)==null?void 0:Y.name}},auto:!1,transform(k){return console.log("Fetched submission AnyStatus:",k.name),k},onError(k){console.error("Error fetching submission:",k)}});return Ee(()=>{he.reload(),C.reload()}),mt(()=>{l&&clearInterval(l)}),(k,H)=>{var ce,_e,f,A,I,M,V,ge,be,me,Se,xe,c,$;const K=Kt("router-link");return R.value?(o(),i("div",cn,[v.value?D("",!0):(o(),i("div",mn,[s("div",pn,n(k.__("This exam consists of ")+a(_).data.questions.length)+" "+n(a(_).data.questions.length===1?k.__("question"):k.__("questions"))+". ",1),(ce=a(_).data)!=null&&ce.duration?(o(),i("div",fn,n(`Please ensure that you complete all the questions in ${a(_).data.duration} minutes.`),1)):D("",!0),(_e=a(_).data)!=null&&_e.duration?(o(),i("div",_n,n(k.__("If you fail to do so, the exam will be automatically submitted when the timer ends.")),1)):D("",!0)])),v.value&&((f=a(C))!=null&&f.data||(A=a(ne).data)!=null&&A[0])?(o(),i("div",hn,[(o(),z(dn,{title:"Exam Comments",doctype:"Exam Submission",docname:((M=(I=a(C))==null?void 0:I.data)==null?void 0:M.name)||((ge=(V=a(ne).data)==null?void 0:V[0])==null?void 0:ge.name),key:((me=(be=a(C))==null?void 0:be.data)==null?void 0:me.name)||((xe=(Se=a(ne).data)==null?void 0:Se[0])==null?void 0:xe.name),type:"single"},null,8,["docname"]))])):D("",!0),a(_).data.duration&&!v.value?(o(),i("div",vn,[s("div",gn,[s("span",yn,n(k.__("Time"))+": ",1),s("span",bn,n(F(t.value)),1)]),N(Lt,{progress:S.value},null,8,["progress"])])):D("",!0),!p.value&&!y()?(o(),i("div",kn,[s("div",wn,[s("div",xn,n(a(_).data.title),1),a(_).data.qbyquestion&&!v.value?(o(),z(a(G),{key:0,onClick:re,class:"mt-2"},{default:q(()=>[s("span",null,n(k.__("Start")),1)]),_:1})):v.value?v.value&&(($=(c=a(he))==null?void 0:c.data)!=null&&$.name)?(o(),i("div",$n,[N(Ro,{submission:a(he).data.name},null,8,["submission"])])):(o(),i("div",Sn,n(k.__("You have already submitted this exam. As soon as it is graded, you will see the feedback here.")),1)):(o(),z(a(G),{key:1,onClick:X,class:"mt-2"},{default:q(()=>[s("span",null,n(k.__("Start Exam")),1)]),_:1}))])])):D("",!0),p.value||y()?(o(),i("div",Cn,[s("div",Tn,[s("div",An,n(a(_).data.title),1),y()?(o(),z(K,{key:0,to:{name:"ExamForm",params:{examID:a(_).data.name}},class:"flex items-center text-gray-400 mb-3 mr-4 hover:text-gray-600"},{default:q(()=>[N(a(Zt),{class:"w-5 h-5 mr-2"}),H[0]||(H[0]=s("span",{class:"tooltip","data-tooltip":"Edit this exam"},"Edit",-1))]),_:1},8,["to"])):D("",!0),(o(!0),i(de,null,pe(a(_).data.questions,(j,te)=>(o(),i("div",{key:j.name,class:"relative border rounded-md p-5 mb-4"},[s("div",Dn,n(te+1),1),s("div",Fn,n(j.points)+" "+n(j.points===1?k.__("Point"):k.__("Points")),1),s("div",Mn,[s("div",{innerHTML:j.question_detail||k.__("No question detail provided.")},null,8,En)]),s("div",Nn,[u.value&&u.value[j.name]!==void 0?$e((o(),i("textarea",{key:0,"onUpdate:modelValue":le=>u.value[j.name]=le,rows:"7",class:"border rounded-md p-2 w-full resize-y",placeholder:k.__("Type your answer here"),onInput:le=>U(j.name,le.target.value)},null,40,In)),[[Ne,u.value[j.name]]]):D("",!0)])]))),128)),s("div",Ln,[N(a(G),{onClick:ee},{default:q(()=>[s("span",null,n(k.__("Submit Your Exam")),1)]),_:1})])])])):D("",!0)])):D("",!0)}}},Pn={key:1,class:"border rounded-md text-center py-20"},Rn={__name:"ExamBlock",props:{exam:{type:String,required:!0}},setup(m){const e=Ae("$user"),t=()=>{window.location.href="/login"};return(l,d)=>a(e).data?(o(),z(zn,{key:0,examName:m.exam},null,8,["examName"])):(o(),i("div",Pn,[s("div",null,n(l.__("Please login to access the exam.")),1),N(a(G),{onClick:d[0]||(d[0]=u=>t()),class:"mt-2"},{default:q(()=>[s("span",null,n(l.__("Login")),1)]),_:1})]))}};class qn{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l}static get toolbox(){const e=fe({render:()=>Re(es,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:__("Exam"),icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),Object.keys(this.data).length?this.renderExam(this.data.exam):this.renderExamModal(),this.wrapper}renderExam(e){if(this.readOnly){const t=fe(Rn,{exam:e});t.use(De),t.use(Me);const{userResource:l}=et();t.provide("$user",l),t.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Exam: ${e}
            </span>
        </div>`}renderExamModal(){if(this.readOnly)return;const e=fe(tt,{type:"exam",onAddition:t=>{this.data.exam=t,this.renderExam(t)}});e.use(De),e.use(Me),e.mount(this.wrapper)}save(e){return{exam:this.data.exam}}}const Un={class:"border-r p-5 overflow-y-auto h-[calc(100vh-3.2rem)]"},On={key:0,class:"text-lg font-semibold mb-5 text-ink-gray-9"},Vn={key:0},Hn={key:1},Bn={class:"text-lg text-ink-gray-7 font-medium mb-2"},jn=["innerHTML"],Gn={key:1,class:"flex-1 border-l p-5 overflow-y-auto h-[calc(100vh-3.2rem)]"},Qn={key:0,class:"mb-4 mt-4"},Jn={for:"groupFilter",class:"block text-sm font-medium text-gray-700"},Wn={value:"all"},Yn=["value"],Xn={class:"original-post mb-4"},Kn={class:"font-semibold"},Zn=["innerHTML"],er={class:"text-sm text-ink-gray-5 mt-1 mb-2"},tr=["href"],sr={class:"replies pl-4 border-l border-gray-300"},ar={class:"font-semibold"},or={class:"text-sm text-ink-gray-5 mt-1 mb-2"},nr=["innerHTML"],rr=["href"],lr={class:"new-reply mt-4 space-y-2"},ir=["onUpdate:modelValue","placeholder"],ur={class:"flex items-center justify-between"},dr={class:"flex items-center space-x-3"},cr={key:1,class:"flex items-center space-x-2 text-ink-gray-7"},mr={class:"border rounded-md p-2"},pr={class:"flex flex-col leading-5"},fr={class:"text-sm"},_r={class:"text-xs text-ink-gray-5"},hr={key:2,class:"text-ink-gray-5 mt-5"},vr={key:3,class:"text-ink-gray-5 mt-5"},gr={key:0,class:"mt-8 space-y-4"},yr={class:"font-semibold mb-2 text-ink-gray-9"},br={class:"text-sm text-ink-gray-5 mb-1"},kr={key:1,class:"text-md mb-4"},wr={class:"flex flex-col"},xr={class:"p-5"},$r={class:"flex items-center justify-between mb-4"},Sr={class:"flex items-center space-x-2"},Cr={key:0,class:"text-md mb-4"},Tr={class:"text-md text-ink-gray-5 mt-1 mb-2"},Ar={key:1},Dr={class:"flex text-ink-gray-7"},Fr={class:"border self-start rounded-md p-2 mr-2"},Mr=["href"],Er={class:"text-sm leading-5"},Nr={class:"text-sm text-ink-gray-5 mt-1"},Ir={key:2,class:"text-md mb-4 ml-2"},Lr={class:"text-sm text-ink-gray-5 font-medium mb-2 mt-4"},zr={class:"font-semibold mb-1"},Pr=["href"],Rr={class:"replies pl-4 border-l border-gray-300"},qr={class:"font-semibold"},Ur={class:"text-sm text-ink-gray-5 mt-1 mb-2"},Or=["innerHTML"],Vr=["href"],Hr={class:"new-reply mt-4 space-y-2"},Br=["onUpdate:modelValue","placeholder"],jr={class:"flex items-center justify-between"},Gr={class:"flex items-center space-x-3"},Qr={key:1,class:"flex items-center space-x-2 text-ink-gray-7"},Jr={class:"border rounded-md p-2"},Wr={class:"flex flex-col leading-5"},Yr={class:"text-sm"},Xr={class:"text-xs text-ink-gray-5"},Kr={key:3,class:"mt-8 p-3 bg-blue-200 rounded-md"},Zr={class:"text-sm text-ink-gray-5 font-medium mb-2"},el={class:"leading-5"},tl=["innerHTML"],sl={__name:"DiscussionActivity",props:{discussionID:{type:String,required:!0},submissionName:{type:String,default:"new"},canGradeSubmission:{type:Boolean,default:!1,required:!1}},setup(m){var ve;const e=typeof lt=="function"?lt:lt.default;e.extend(ts);const t=T(null),l=T(""),d=T(""),u=Ze(),p=Ae("$user"),b=u.currentRoute.value.name=="DiscussionActivitySubmission",h=T(!1),g=T({}),x=oe(()=>{var r;return((r=p.data)==null?void 0:r.is_student)||!1}),_=T([]),R=T("all"),v=T(""),ae=oe(()=>u.currentRoute.value.params.courseName),y=oe(()=>U.discussionID),B=oe(()=>{var r;return(r=p.data)==null?void 0:r.name}),P=(r,w)=>{g.value=Ge(qe({},g.value),{[r]:w})},F=oe(()=>{ae.value&&y.value&&B.value}),S=r=>{const ye=g.value,{[r]:w}=ye,Z=vt(ye,[ht(r)]);g.value=Z},O=r=>!!(r!=null&&r.new_reply&&r.new_reply.toString().trim().length),U=m;Ee(()=>{var r;window.addEventListener("keydown",ne),console.log("User: ",(r=p.data)==null?void 0:r.name),console.log("Discussion ID: ",U.discussionID),console.log("Course Name: ",u.currentRoute.value.params.courseName),K(),Y.reload().then(()=>{var w;console.log("Student data after reload:",v.value),console.log("Student group:",(w=v.value)==null?void 0:w.student_group)}),console.log("Saved Submission Data on Mount:",k.data),console.log("hasSavedSubmission:",H.value),we(),ce.value});const ne=r=>{r.key==="s"&&(r.ctrlKey||r.metaKey)&&(V(),r.preventDefault())};mt(()=>{window.removeEventListener("keydown",ne)});const ee=W({url:"frappe.client.get",params:{doctype:"Discussion Activity",name:U.discussionID},auto:!0,onSuccess(r){U.submissionName!="new"&&M.reload()}});console.log("Submission Name: ",U.submissionName);const re=oe(()=>{var r;return(r=ee.data)==null?void 0:r.post_before}),X=r=>r&&r.includes(".")?e(r.split(".")[0]).fromNow():e(r).fromNow();function he(){const r=new Date,w=Math.floor(r.getMilliseconds()*1e3);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")} ${String(r.getHours()).padStart(2,"0")}:${String(r.getMinutes()).padStart(2,"0")}:${String(r.getSeconds()).padStart(2,"0")}.${String(w).padStart(6,"0")}`}const C=r=>{var Te,Ie,Le;if(!O(r))return;const w=g.value[r.name],Z=((Te=v.value)==null?void 0:Te.student)||null,ye=((Ie=v.value)==null?void 0:Ie.student_name)||((Le=p.data)==null?void 0:Le.full_name),Ce=he();A.submit({name:r.name,reply:r.new_reply,reply_attach:w,student:Z,member_name:ye,parent:r.name,reply_dt:Ce,parentfield:"replies",parenttype:"Discussion Submission"},{onSuccess(){ke.success(__("Reply posted successfully")),r.new_reply="",w&&S(r.name),_e()},onError(Be){var E;ke.error(((E=Be.messages)==null?void 0:E[0])||Be)}})},L=W({url:"seminary.seminary.api.get_discussion_submissions",makeParams(r){return{course_name:u.currentRoute.value.params.courseName,discussion_id:U.discussionID}},auto:!1,onSuccess(r){r==null||r.forEach(w=>{w&&typeof w.new_reply=="undefined"&&(w.new_reply="")}),console.log("All Discussions Data Fetched: ",r)}}),Y=W({url:"seminary.seminary.api.get_student_group",makeParams(r){var w;return{course_name:u.currentRoute.value.params.courseName,user:(w=p.data)==null?void 0:w.name}},auto:!1,onSuccess(r){v.value=r,console.log("Student fetched:",v.value)}}),k=W({url:"seminary.seminary.api.get_user_discussion_submission",makeParams(r){var w;return{course_name:u.currentRoute.value.params.courseName,discussion_id:U.discussionID,owner:(w=p.data)==null?void 0:w.name}},auto:!1,onSuccess(r){console.log("Saved submission fetched:",r)}}),H=oe(()=>Array.isArray(k.data)&&k.data.length>0);ue(F,r=>se(null,null,function*(){r&&(yield K())}));const K=()=>se(null,null,function*(){try{yield L.reload({course_name:ae.value,discussion_id:y.value}),yield k.reload({course_name:ae.value,discussion_id:y.value,owner:B.value})}catch(r){console.error("Error reloading discussion lists:",r)}}),ce=oe(()=>{var w;let r=Dt(L.data);if(console.log("Discussions before filtering: ",r),x.value)if((w=ee.data)!=null&&w.use_studentgroup){let Z=Q;return r.filter(ye=>ye.student_group===Z.value)}else return r;else return!x.value&&R.value!=="all"?r.filter(Z=>Z.student_group===R.value):r}),_e=()=>{K()},f=W({url:"frappe.client.insert",makeParams(r){var Z,ye,Ce,Te,Ie,Le;return{doc:{doctype:"Discussion Submission",disc_activity:U.discussionID,disc_title:(Z=ee.data)==null?void 0:Z.discussion_name,member:(ye=p.data)==null?void 0:ye.name,coursesc:u.currentRoute.value.params.courseName,original_post:l.value,original_attachment:((Ce=t.value)==null?void 0:Ce.file_url)||null,student_name:((Te=v.value)==null?void 0:Te.student_name)||((Ie=p.data)==null?void 0:Ie.full_name),student:((Le=v.value)==null?void 0:Le.student)||null}}}}),A=W({url:"frappe.client.insert",makeParams(r){var Z,ye;const w=r.reply_attach;return{doc:{doctype:"Discussion Submission Replies",member:(Z=p.data)==null?void 0:Z.name,reply:r.reply,student:r.student,member_name:r.member_name||((ye=p.data)==null?void 0:ye.full_name),reply_dt:r.reply_dt,parent:r.name,parentfield:"replies",parenttype:"Discussion Submission",reply_attach:(w==null?void 0:w.file_url)||null}}},auto:!1}),I=W({url:"seminary.seminary.api.get_file_info",makeParams(r){return{file_url:r.image}},auto:!1,onSuccess(r){t.value=r}}),M=ct({doctype:"Discussion Submission",name:U.submissionName,onError(r){var w;ke.error(((w=r.messages)==null?void 0:w[0])||r)},auto:!1,cache:[(ve=p.data)==null?void 0:ve.name,U.discussionID]});ue(M,()=>{if(M.doc){M.doc.original_attachment&&I.reload({image:M.doc.original_attachment}),l.value=M.doc.original_post||"",console.log("Original Post: ",l.value),d.value=M.doc.comments||"";const r=!!t.value,w=!!l.value;M.isDirty||!r&&!w?h.value=!0:h.value=!1}}),ue(t,()=>{U.submissionName=="new"&&t.value&&(h.value=!0)}),ue(()=>{var r;return(r=M.doc)==null?void 0:r.grade},(r,w)=>{r!==w&&M.doc&&(M.doc.status="Graded",h.value=!0)});const V=()=>{var r,w,Z;if(U.submissionName!="new"){let ye=M.doc&&M.doc.owner!=((r=p.data)==null?void 0:r.name)?(w=p.data)==null?void 0:w.name:null;M.setValue.submit(Ge(qe({},M.doc),{original_attachment:(Z=t.value)==null?void 0:Z.file_url,evaluator:ye,comments:d.value,original_post:l.value}),{onSuccess(Ce){ke.success(__("Changed successfully")),h.value=!1,_e()}})}else ge()},ge=()=>{f.submit({},{onSuccess(r){ke.success(__("Discussion submitted successfully")),u.currentRoute.value.name=="DiscussionSubmission"?u.push({name:"DiscussionSubmission",params:{discussionID:U.discussionID,submissionName:r.name}}):(me(),u.go()),M.name=r.name,h.value=!1,M.reload(),_e()},onError(r){var w;ke.error(((w=r.messages)==null?void 0:w[0])||r)}})},be=r=>{h.value=!0,t.value=r},me=()=>{if(u.currentRoute.value.name=="Lesson"){let r=u.currentRoute.value.params.courseName,w=u.currentRoute.value.params.chapterNumber,Z=u.currentRoute.value.params.lessonNumber;console.log("Chapter Number: ",w),console.log("Lesson Number: ",Z),Ue("seminary.seminary.api.mark_lesson_progress",{course:r,chapter_number:w,lesson_number:Z})}},Se=()=>["image/*",".pdf",".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xe=r=>{var Ce,Te;const w=(Ce=r.name.split(".").pop())==null?void 0:Ce.toLowerCase(),Z=["jpg","jpeg","png","gif","pdf","doc","docx","xml"];if(!((Te=r.type)!=null&&Te.startsWith("image/"))&&(!w||!Z.includes(w)))return __("Only images, PDF, or Word documents are allowed.")},c=()=>{h.value=!0,t.value=null},$=oe(()=>{var r,w,Z;return(((r=p.data)==null?void 0:r.is_moderator)||((w=p.data)==null?void 0:w.is_evaluator)||((Z=p.data)==null?void 0:Z.is_instructor))&&U.submissionName!="new"&&u.currentRoute.value.name=="DiscussionActivitySubmission"}),j=oe(()=>{var r,w,Z;return!M.doc||((r=M.doc)==null?void 0:r.owner)==((w=p.data)==null?void 0:w.name)&&((Z=M.doc)==null?void 0:Z.status)=="Not Graded"}),te=oe(()=>[{label:__("Not Graded"),value:"Not Graded"},{label:__("Graded"),value:"Graded"},{label:__("Pass"),value:"Pass"},{label:__("Fail"),value:"Fail"}]),le=oe(()=>M.doc?M.doc.status=="Pass"||M.doc.status=="Graded"?"green":M.doc.status=="Not Graded"?"blue":"red":"orange"),we=()=>{if(!u.currentRoute.value.params.courseName){console.warn("Cannot fetch student groups: Missing course name.");return}Ue("seminary.seminary.api.get_student_groups_simple",{course_name:u.currentRoute.value.params.courseName}).then(r=>{_.value=r||[],console.log("Student groups fetched:",_.value)}).catch(r=>{console.error("Error fetching student groups:",r)})},Q=oe(()=>{var r;return Y.loading?__("Loading..."):((r=v.value)==null?void 0:r.student_group)||__("No group assigned")});return ue(()=>Y.loading,r=>{r||console.log("Student data loaded on watch:",Y.data)}),ue(()=>R.value,r=>{console.log("Selected group changed to:",r),ce.value}),(r,w)=>{var Z,ye,Ce,Te,Ie,Le,Be;return a(ee).data?(o(),i("div",{key:0,class:Oe(["grid grid-cols-[65%,35%] h-full",{"border rounded-lg":!b}])},[s("div",Un,[b?(o(),i("div",On,[m.submissionName==="new"?(o(),i("div",Vn,n(r.__("Submission by"))+" "+n((Z=a(p).data)==null?void 0:Z.full_name),1)):(o(),i("div",Hn,n(r.__("Submission by"))+" "+n((ye=a(M).doc)==null?void 0:ye.member_name),1))])):D("",!0),s("div",Bn,n(r.__("Discussion Prompt"))+": ",1),s("div",{innerHTML:a(ee).data.prompt,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal"},null,8,jn),a(L).data&&(H.value||!H.value&&!re.value||!x.value)?(o(),i("div",Gn,[x.value?D("",!0):(o(),i("div",Qn,[s("label",Jn,n(r.__("Filter by Group")),1),$e(s("select",{id:"groupFilter","onUpdate:modelValue":w[0]||(w[0]=E=>R.value=E),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[s("option",Wn,n(r.__("All Groups")),1),(o(!0),i(de,null,pe(_.value,E=>(o(),i("option",{key:E.student_group,value:E.student_group},n(E.student_group||"No group"),9,Yn))),128))],512),[[ss,R.value]])])),(o(!0),i(de,null,pe(ce.value,E=>(o(),i("div",{key:E.name,class:"mb-6 border-round border-gray-300 p-4 bg-surface-white shadow-sm"},[s("div",Xn,[s("div",Kn,n(E.student_name),1),s("div",{innerHTML:E.original_post,class:"text-sm"},null,8,Zn),s("div",er,n(X(E.creation)),1),E.original_attachment?(o(),i("a",{key:0,href:E.original_attachment,target:"_blank",class:"text-blue-500 underline"},n(r.__("View Attachment")),9,tr)):D("",!0)]),s("div",sr,[(o(!0),i(de,null,pe(E.replies,J=>(o(),i("div",{key:J.creation,class:"mb-2"},[s("div",ar,n(J.member_name||J.owner),1),s("div",or,n(X(J.reply_dt)),1),s("div",{innerHTML:J.reply,class:"text-sm"},null,8,nr),J.reply_attach?(o(),i("a",{key:0,href:J.reply_attach,target:"_blank",class:"text-blue-500 underline"},n(r.__("View Attachment")),9,rr)):D("",!0)]))),128))]),s("div",lr,[$e(s("textarea",{"onUpdate:modelValue":J=>E.new_reply=J,placeholder:r.__("Write a reply..."),class:"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none"},null,8,ir),[[Ne,E.new_reply]]),s("div",ur,[s("div",dr,[g.value[E.name]?(o(),i("div",cr,[s("div",mr,[N(a(Xe),{class:"h-4 w-4"})]),s("div",pr,[s("span",fr,n(g.value[E.name].file_name),1),s("span",_r,n(a(Ke)(g.value[E.name].file_size)),1)]),N(a(G),{variant:"subtle",size:"sm",onClick:J=>S(E.name)},{default:q(()=>[ie(n(r.__("Remove")),1)]),_:1},8,["onClick"])])):(o(),z(a(We),{key:0,fileTypes:Se(),validateFile:xe,onSuccess:J=>P(E.name,J)},{default:q(({uploading:J,progress:je,openFileSelector:at})=>[N(a(G),{onClick:at,loading:J,variant:"outline"},{default:q(()=>[ie(n(J?r.__("Uploading {0}%").format(je):r.__("Attach File")),1)]),_:2},1032,["onClick","loading"])]),_:1},8,["fileTypes","onSuccess"]))]),N(a(G),{variant:"solid",disabled:!O(E),onClick:J=>C(E)},{default:q(()=>[ie(n(r.__("Post Reply")),1)]),_:1},8,["disabled","onClick"])])])]))),128))])):!H.value&&re.value&&x.value?(o(),i("div",hr,n(r.__("You have to make your original post before seeing other posts.")),1)):(o(),i("div",vr,n(r.__("No discussions available yet."))+" "+n("All discussions",a(L).data)+" "+n("hasSavedSubmission",H.value),1))]),$.value?(o(),i("div",gr,[s("div",yr,n(r.__("Grading")),1),a(M).doc?(o(),z(a(Pe),{key:0,modelValue:a(M).doc.status,"onUpdate:modelValue":w[1]||(w[1]=E=>a(M).doc.status=E),label:r.__("Grading Status"),type:"select",options:te.value},null,8,["modelValue","label","options"])):D("",!0),a(M).doc?(o(),z(a(Pe),{key:1,modelValue:a(M).doc.grade,"onUpdate:modelValue":w[2]||(w[2]=E=>a(M).doc.grade=E),label:r.__("Score"),type:"number"},null,8,["modelValue","label"])):D("",!0),s("div",null,[s("div",br,n(r.__("Comments")),1),$e(s("textarea",{"onUpdate:modelValue":w[3]||(w[3]=E=>d.value=E),onInput:w[4]||(w[4]=E=>h.value=!0),class:"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none"},null,544),[[Ne,d.value]])])])):D("",!0),H.value?(o(),i("div",Ir,[s("div",Lr,n(r.__("Your submission has been saved:")),1),(o(!0),i(de,null,pe(a(k).data,E=>(o(),i("div",{key:E.name||E.creation},[s("div",zr,n(X(E.creation)),1),s("div",null,n(E.original_post),1),E.original_attachment?(o(),i("a",{key:0,href:E.original_attachment,target:"_blank",class:"text-blue-500 underline"},n(r.__("View Attachment")),9,Pr)):D("",!0),s("div",Rr,[(o(!0),i(de,null,pe(E.replies,J=>(o(),i("div",{key:J.creation,class:"mb-2"},[s("div",qr,n(J.member_name||J.owner),1),s("div",Ur,n(X(J.reply_dt)),1),s("div",{innerHTML:J.reply,class:"text-sm"},null,8,Or),J.reply_attach?(o(),i("a",{key:0,href:J.reply_attach,target:"_blank",class:"text-blue-500 underline"},n(r.__("View Attachment")),9,Vr)):D("",!0)]))),128))]),s("div",Hr,[$e(s("textarea",{"onUpdate:modelValue":J=>E.new_reply=J,placeholder:r.__("Write a reply..."),class:"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[6rem] w-full focus:outline-none"},null,8,Br),[[Ne,E.new_reply]]),s("div",jr,[s("div",Gr,[g.value[E.name]?(o(),i("div",Qr,[s("div",Jr,[N(a(Xe),{class:"h-4 w-4"})]),s("div",Wr,[s("span",Yr,n(g.value[E.name].file_name),1),s("span",Xr,n(a(Ke)(g.value[E.name].file_size)),1)]),N(a(G),{variant:"subtle",size:"sm",onClick:J=>S(E.name)},{default:q(()=>[ie(n(r.__("Remove")),1)]),_:1},8,["onClick"])])):(o(),z(a(We),{key:0,fileTypes:Se(),validateFile:xe,onSuccess:J=>P(E.name,J)},{default:q(({uploading:J,progress:je,openFileSelector:at})=>[N(a(G),{onClick:at,loading:J,variant:"outline"},{default:q(()=>[ie(n(J?r.__("Uploading {0}%").format(je):r.__("Attach File")),1)]),_:2},1032,["onClick","loading"])]),_:1},8,["fileTypes","onSuccess"]))]),N(a(G),{variant:"solid",disabled:!O(E),onClick:J=>C(E)},{default:q(()=>[ie(n(r.__("Post Reply")),1)]),_:1},8,["disabled","onClick"])])])]))),128))])):(o(),i("div",kr,[s("div",wr,[s("div",xr,[s("div",$r,[s("div",Sr,[h.value?(o(),z(a(ze),{key:0,theme:"orange"},{default:q(()=>[ie(n(r.__("Not Saved")),1)]),_:1})):(Ce=a(M).doc)!=null&&Ce.status?(o(),z(a(ze),{key:1,theme:le.value,size:"lg"},{default:q(()=>{var E;return[ie(n((E=a(M).doc)==null?void 0:E.status),1)]}),_:1},8,["theme"])):D("",!0),N(a(G),{variant:"solid",onClick:w[5]||(w[5]=E=>V())},{default:q(()=>[ie(n(r.__("Save")),1)]),_:1})])]),H.value?D("",!0):(o(),i("div",Cr,[ie(n(r.__("Write your main post here"))+" ",1),$e(s("textarea",{"onUpdate:modelValue":w[6]||(w[6]=E=>l.value=E),onInput:w[7]||(w[7]=E=>h.value=!0),class:"prose-sm max-w-none border border-outline-gray-3 bg-surface-gray-2 rounded-md py-2 px-3 min-h-[7rem] w-full focus:outline-none"},null,544),[[Ne,l.value]]),s("div",Tr,n(r.__("You may also add an attachment")),1),t.value?(o(),i("div",Ar,[s("div",Dr,[s("div",Fr,[N(a(Xe),{class:"h-5 w-5 stroke-1.5"})]),s("a",{href:t.value.file_url,target:"_blank",class:"flex flex-col cursor-pointer !no-underline"},[s("span",Er,n(t.value.file_name),1),s("span",Nr,n(a(Ke)(t.value.file_size)),1)],8,Mr),j.value?(o(),z(a(Tt),{key:0,onClick:w[9]||(w[9]=E=>c()),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})):D("",!0)])])):(o(),z(a(We),{key:0,fileTypes:Se(),validateFile:xe,onSuccess:w[8]||(w[8]=E=>be(E))},{default:q(({uploading:E,progress:J,openFileSelector:je})=>[N(a(G),{onClick:je,loading:E},{default:q(()=>[ie(n(E?r.__("Uploading {0}%").format(J):r.__("Upload File")),1)]),_:2},1032,["onClick","loading"])]),_:1},8,["fileTypes"]))]))])])])),((Te=a(p).data)==null?void 0:Te.name)==((Ie=a(M).doc)==null?void 0:Ie.owner)&&((Le=a(M).doc)!=null&&Le.comments)?(o(),i("div",Kr,[s("div",Zr,n(r.__("Comments by"))+": "+n(((Be=a(M).doc)==null?void 0:Be.evaluator)||r.__("Evaluator")),1),s("div",el,[s("div",{innerHTML:a(M).doc.comments},null,8,tl)])])):D("",!0)],2)):D("",!0)}}},al={key:1,class:"border rounded-md text-center py-20"},ol={__name:"DiscussionActivityBlock",props:{discussionID:{type:String,required:!0}},setup(m){const e=Ae("$user");return console.log("Discussion ID in Block: ",m.discussionID),(l,d)=>a(e).data?(o(),z(sl,{key:0,discussionID:m.discussionID},null,8,["discussionID"])):(o(),i("div",al,[s("div",null,n(l.__("Please login to access the Discussion Activity.")),1),N(a(G),{onClick:d[0]||(d[0]=u=>l.redirectToLogin()),class:"mt-2"},{default:q(()=>[s("span",null,n(l.__("Login")),1)]),_:1})]))}};class nl{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l}static get toolbox(){const e=fe({render:()=>Re(as,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:__("Discussion Activity"),icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){this.wrapper=document.createElement("div");const e=this.data.discussion||this.data.discussionID;return e?this.renderDiscussionActivity(e):this.renderDiscussionActivityModal(),this.wrapper}renderDiscussionActivity(e){if(!e){console.warn("[DiscussionActivity] Missing discussion id; falling back to selector"),this.renderDiscussionActivityModal();return}if(this.readOnly){const t=fe(ol,{discussionID:e});t.use(De),t.use(Me);const{userResource:l}=et();t.provide("$user",l),t.mount(this.wrapper);return}this.wrapper.innerHTML=`<div class='border rounded-md p-10 text-center bg-surface-menu-bar mb-2'>
            <span class="font-medium">
                Discussion Activity: ${e}
            </span>
        </div>`}renderDiscussionActivityModal(){if(this.readOnly)return;const e=fe(tt,{type:"discussionactivity",onAddition:t=>{this.data.discussion=t,this.data.discussionID=t,this.renderDiscussionActivity(t)}});e.use(De),e.use(Me),e.mount(this.wrapper)}save(e){const t=this.data.discussion||this.data.discussionID;return t?{discussion:t,discussionID:t}:{}}}const rl=["src"],ll={class:"flex items-center space-x-2 shadow rounded-lg p-1 w-1/2"},il=["max"],ul={class:"text-xs text-ink-gray-9 font-medium"},dl={__name:"AudioBlock",props:{file:{type:String,required:!0}},setup(m){const e=T(!1),t=T(null);let l=T(!1),d=T(0),u=T(0);Ee(()=>{setTimeout(()=>{t.value=document.querySelector("audio"),t.value.onloadedmetadata=()=>{u.value=t.value.duration},t.value.ontimeupdate=()=>{d.value=t.value.currentTime}},0)});const p=()=>{t.value.paused?(t.value.play(),e.value=!0):(t.value.pause(),e.value=!1)},b=()=>{t.value.muted=!t.value.muted,l.value=t.value.muted},h=()=>{t.value.currentTime=d.value},g=()=>{e.value=!1},x=_=>{const R=Math.floor(_/60),v=Math.floor(_%60);return`${R}:${v<10?"0":""}${v}`};return ue(e,_=>{_?t.value.play():t.value.pause()}),(_,R)=>(o(),i("div",null,[s("audio",{onEnded:g,controlsList:"nodownload",class:"mb-4"},[s("source",{src:encodeURI(m.file),type:"audio/mp3"},null,8,rl)],32),s("div",ll,[N(a(G),{variant:"ghost",onClick:p},{icon:q(()=>[e.value?(o(),z(a(Mt),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(o(),z(a(Ft),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),$e(s("input",{type:"range",min:"0",max:a(u),step:"0.1","onUpdate:modelValue":R[0]||(R[0]=v=>pt(d)?d.value=v:d=v),onInput:h,class:"duration-slider w-full h-1"},null,40,il),[[Ne,a(d)]]),s("span",ul,n(x(a(d)))+" / "+n(x(a(u))),1),N(a(G),{variant:"ghost",onClick:b},{icon:q(()=>[a(l)?(o(),z(a(Nt),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(o(),z(a(Et),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1})])]))}},cl=["src","type"],ml={class:"flex items-center space-x-2 bg-surface-gray-3 rounded-md p-0.5 absolute bottom-3 w-[98%] left-0 right-0 mx-auto invisible group-hover:visible"},pl=["max"],fl={class:"text-xs font-medium"},_l={__name:"VideoBlock",props:{file:{type:String,required:!0},type:{type:String,default:"video/mp4"}},setup(m){const e=T(null),t=T(null);let l=T(!1),d=T(0),u=T(0),p=T(!1);const b=m;Ee(()=>{setTimeout(()=>{e.value.onloadedmetadata=()=>{u.value=e.value.duration},e.value.ontimeupdate=()=>{d.value=e.value.currentTime}},0)});const h=oe(()=>{if(g){let F=b.file;return F.includes("watch?v=")&&(F=F.replace("watch?v=","embed/")),`${F}?autoplay=0&controls=0&disablekb=1&playsinline=1&cc_load_policy=1&cc_lang_pref=auto`}return b.file}),g=oe(()=>b.type=="video/youtube"),x=()=>{e.value.play(),l.value=!0},_=()=>{e.value.pause(),l.value=!1},R=()=>{l.value?_():x()},v=()=>{l.value=!1},ae=()=>{e.value.muted=!e.value.muted,p.value=e.value.muted},y=()=>{e.value.currentTime=d.value},B=F=>{const S=Math.floor(F/60),O=Math.floor(F%60);return`${S}:${O<10?"0":""}${O}`},P=()=>{document.fullscreenElement?document.exitFullscreen():t.value.requestFullscreen()};return(F,S)=>(o(),i("div",{ref_key:"videoContainer",ref:t,class:"video-block group relative"},[s("video",{onTimeupdate:S[0]||(S[0]=(...O)=>F.updateTime&&F.updateTime(...O)),onEnded:v,onClick:R,oncontextmenu:"return false",class:"rounded-lg border border-gray-100 group cursor-pointer",ref_key:"videoRef",ref:e},[s("source",{src:h.value,type:m.type},null,8,cl)],544),s("div",ml,[N(a(G),{variant:"ghost"},{icon:q(()=>[a(l)?(o(),z(a(Mt),{key:1,onClick:_,class:"w-4 h-4 text-ink-gray-9"})):(o(),z(a(Ft),{key:0,onClick:x,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),N(a(G),{variant:"ghost",onClick:ae},{icon:q(()=>[a(p)?(o(),z(a(Nt),{key:1,class:"w-4 h-4 text-ink-gray-9"})):(o(),z(a(Et),{key:0,class:"w-4 h-4 text-ink-gray-9"}))]),_:1}),$e(s("input",{type:"range",min:"0",max:a(u),step:"0.1","onUpdate:modelValue":S[1]||(S[1]=O=>pt(d)?d.value=O:d=O),onInput:y,class:"duration-slider w-full h-1"},null,40,pl),[[Ne,a(d)]]),s("span",fl,n(B(a(d)))+" / "+n(B(a(u))),1),N(a(G),{variant:"ghost",onClick:P},{icon:q(()=>[N(a(os),{class:"w-4 h-4 text-ink-gray-9"})]),_:1})])],512))}},hl=St(_l,[["__scopeId","data-v-edd7c5f4"]]),vl={__name:"UploadPlugin",props:{onFileUploaded:{type:Function,required:!0}},emits:["fileUploaded"],setup(m,{emit:e}){const t=T(null),l=m;Ee(()=>se(null,null,function*(){yield Ct();const p=t.value.$el.querySelector('input[type="file"]');p&&p.click()}));const d=p=>{l.onFileUploaded({file_url:p.file_url,file_type:p.file_type})},u=p=>{let b=p.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png","mp4","mov","mp3","pdf"].includes(b))return"Only image and video files are allowed."};return(p,b)=>(o(),z(a(We),{fileTypes:["image/*","video/*","audio/*",".pdf"],validateFile:u,onSuccess:b[0]||(b[0]=h=>d(h)),ref_key:"fileUploader",ref:t,class:"hide"},null,512))}};class gl{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l}static get toolbox(){const e=fe({render:()=>Re(ns,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:"Upload",icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),this.data&&this.data.file_url?this.renderFile(this.data):this.renderFileUploader(),this.wrapper}renderFile(e){if(this.isVideo(e.file_type)){fe(hl,{file:e.file_url}).mount(this.wrapper);return}else if(this.isAudio(e.file_type)){fe(dl,{file:e.file_url}).mount(this.wrapper);return}else if(e.file_type=="PDF"){this.wrapper.innerHTML=`<iframe src="https://docs.google.com/viewer?url=${window.location.origin}${encodeURI(e.file_url)}&embedded=true" width='100%' height='700px' class="mb-4" type="application/pdf"></iframe>`;return}else{this.wrapper.innerHTML=`<img class="mb-4" src=${encodeURI(e.file_url)} width='100%'>`;return}}renderFileUploader(){const e=fe(vl,{onFileUploaded:t=>{this.data.file_url=t.file_url,this.data.file_type=t.file_type,this.renderFile(t)}});e.use(De),e.mount(this.wrapper)}validate(e){return!(!e.file_url||!e.file_type)}save(e){return{file_url:this.data.file_url,file_type:this.data.file_type}}isVideo(e){return["mov","mp4","avi","mkv","webm"].includes(e.toLowerCase())}isAudio(e){return["mp3","wav","ogg"].includes(e.toLowerCase())}}class yl{constructor({data:e,api:t,readOnly:l,config:d}){this.api=t,this.data=e||{},this.config=d||{},this.text=e.text||"",this.readOnly=l,this.placeholder=__("Type '/' for commands or select text to format")}static get isReadOnlySupported(){return!0}static get conversionConfig(){return{export:"text",import:"text"}}static get toolbox(){const e=fe({render:()=>Re(rs,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:"",icon:t.innerHTML}}onPaste(e){const t={text:e.detail.data.innerHTML};this.data=t,window.requestAnimationFrame(()=>{this.wrapper&&(this.wrapper.innerHTML=this.data.text||"")})}static get pasteConfig(){return{tags:["P"]}}render(){return this.wrapper=document.createElement("div"),this.wrapper.classList.add("cdx-block","ce-paragraph"),this.wrapper.innerHTML=this.text,this.readOnly||(this.wrapper.contentEditable=!0,this.wrapper.innerHTML=this.text,this.wrapper.addEventListener("input",e=>{let t=e.target.textContent;e.keyCode===32&&t.startsWith("#")?this.convertToHeader(e,t):e.keyCode==189?this.convertBlock("list",{style:"unordered"}):/^[a-zA-Z]/.test(e.key)?this.convertBlock("paragraph",{text:t}):(e.keyCode===13||e.keyCode===190)&&this.parseContent(e)})),this.wrapper}_togglePlaceholder(){document.querySelectorAll(".cdx-block.ce-paragraph[data-placeholder]").forEach(t=>{t!==this.wrapper&&delete t.dataset.placeholder}),this.wrapper.innerHTML.trim()===""?this.wrapper.dataset.placeholder=this.placeholder:delete this.wrapper.dataset.placeholder}convertToHeader(e,t){if(e.preventDefault(),["#","##","###","####","#####","######"].includes(t)){let l=t.length;e.target.textContent="",this.convertBlock("header",{level:l})}}parseContent(e){e.preventDefault();let t=this.wrapper.textContent;if(e.keyCode===190&&(t=t+"."),t&&this.hasImage(t))this.wrapper.textContent="",this.convertBlock("image");else if(t&&this.hasLink(t)){const{text:l,url:d}=this.extractLink(t),u=`<a href="${d}" target="_blank">${l}</a>`;this.convertBlock("paragraph",{text:t.replace(/\[.+?\]\(.+?\)/,u)})}else t&&t.startsWith("- ")?this.convertBlock("list",{style:"unordered",items:[{content:t.replace("- ","")}]}):t&&t.startsWith("1.")?this.convertBlock("list",{style:"ordered",items:[{content:t.replace("1.","")}]}):t&&this.canBeEmbed(t)?(this.wrapper.textContent="",this.convertBlock("embed",{source:t})):this.convertBlock("paragraph",{text:t})}convertBlock(e,t,l=null){return se(this,null,function*(){const d=this.api.blocks.getCurrentBlockIndex(),u=this.api.blocks.getBlockByIndex(d);yield this.api.blocks.convert(u.id,e,t),this.api.caret.focus(!0)})}save(e){return{text:e.innerHTML}}hasImage(e){return/!\[.+?\]\(.+?\)/.test(e)}extractImage(e){const t=e.match(/!\[(.+?)\]\((.+?)\)/);return t?{alt:t[1],url:t[2]}:{alt:"",url:""}}hasLink(e){return/\[.+?\]\(.+?\)/.test(e)}extractLink(e){const t=e.match(/\[(.+?)\]\((.+?)\)/);return t?{text:t[1],url:t[2]}:{text:"",url:""}}canBeEmbed(e){return/^https?:\/\/.+/.test(e.trim())}}const bl=["light","dark"],kl={none:"Auto-detect",apache:"Apache",bash:"Bash",cs:"C#",cpp:"C++",css:"CSS",coffeescript:"CoffeeScript",diff:"Diff",go:"Go",html:"HTML, XML",http:"HTTP",json:"JSON",java:"Java",javascript:"JavaScript",kotlin:"Kotlin",less:"Less",lua:"Lua",makefile:"Makefile",markdown:"Markdown",nginx:"Nginx",objectivec:"Objective-C",php:"PHP",perl:"Perl",properties:"Properties",python:"Python",ruby:"Ruby",rust:"Rust",scss:"SCSS",sql:"SQL",shell:"Shell Session",swift:"Swift",toml:"TOML, also INI",typescript:"TypeScript",yaml:"YAML",plaintext:"Plaintext"};class wl{constructor({data:e,api:t,config:l,readOnly:d}){Fe(this,"api");Fe(this,"config");Fe(this,"readOnly");Fe(this,"data");Fe(this,"highlightScriptID");Fe(this,"highlightCSSID");Fe(this,"codeArea");Fe(this,"selectInput");Fe(this,"selectDropIcon");this.api=t,this.readOnly=d,this.config={themeName:l.themeName&&typeof l.themeName=="string"?l.themeName:"",themeURL:l.themeURL&&typeof l.themeURL=="string"?l.themeURL:"",useDefaultTheme:l.useDefaultTheme&&typeof l.useDefaultTheme=="string"&&bl.includes(l.useDefaultTheme.toLowerCase())?l.useDefaultTheme:"dark"},this.data={code:e.code&&typeof e.code=="string"?e.code:"",language:e.language&&typeof e.language=="string"?e.language:"Auto-detect",theme:e.theme&&typeof e.theme=="string"?e.theme:this._getThemeURLFromConfig()},this.highlightScriptID="highlightJSScriptElement",this.highlightCSSID="highlightJSCSSElement",this.codeArea=document.createElement("div"),this.selectInput=document.createElement("input"),this.selectDropIcon=document.createElement("i"),this._injectHighlightJSCSSElement(),this.api.listeners.on(window,"click",this._closeAllLanguageSelects,!0)}static get isReadOnlySupported(){return!0}static get sanitize(){return{code:!0,language:!1,theme:!1}}static get toolbox(){const e=fe({render:()=>Re(ls,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:"CodeBox",icon:t.innerHTML}}static get displayInToolbox(){return!0}static get enableLineBreaks(){return!0}render(){const e=document.createElement("pre"),t=this._createLanguageSelectElement();return e.setAttribute("class","codeBoxHolder"),this.codeArea.setAttribute("class",`codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`),this.codeArea.setAttribute("contenteditable","true"),this.codeArea.innerHTML=this.data.code,this.api.listeners.on(this.codeArea,"blur",l=>this._highlightCodeArea(l),!1),this.api.listeners.on(this.codeArea,"paste",l=>this._handleCodeAreaPaste(l),!1),e.appendChild(this.codeArea),!this.readOnly&&e.appendChild(t),e}save(e){return Object.assign(this.data,{code:this.codeArea.innerHTML,theme:this._getThemeURLFromConfig()})}validate(e){return!!e.code.trim()}destroy(){this.api.listeners.off(window,"click",this._closeAllLanguageSelects,!0),this.api.listeners.off(this.codeArea,"blur",e=>this._highlightCodeArea(e),!1),this.api.listeners.off(this.codeArea,"paste",e=>this._handleCodeAreaPaste(e),!1),this.api.listeners.off(this.selectInput,"click",e=>this._handleSelectInputClick(e),!1)}_createLanguageSelectElement(){const e=document.createElement("div"),t=document.createElement("div"),l=Object.entries(kl);return e.setAttribute("class","codeBoxSelectDiv"),this.selectDropIcon.setAttribute("class",`codeBoxSelectDropIcon ${this.config.useDefaultTheme}`),this.selectDropIcon.innerHTML="&#8595;",this.selectInput.setAttribute("class",`codeBoxSelectInput ${this.config.useDefaultTheme}`),this.selectInput.setAttribute("type","text"),this.selectInput.setAttribute("readonly","true"),this.selectInput.value=this.data.language,this.api.listeners.on(this.selectInput,"click",d=>this._handleSelectInputClick(d),!1),t.setAttribute("class","codeBoxSelectPreview"),l.forEach(d=>{const u=document.createElement("p");u.setAttribute("class",`codeBoxSelectItem ${this.config.useDefaultTheme}`),u.setAttribute("data-key",d[0]),u.textContent=d[1],this.api.listeners.on(u,"click",p=>this._handleSelectItemClick(p,d),!1),t.appendChild(u)}),e.appendChild(this.selectDropIcon),e.appendChild(this.selectInput),e.appendChild(t),e}_highlightCodeArea(e){yt.highlightBlock(this.codeArea)}_handleCodeAreaPaste(e){e.stopPropagation()}_handleSelectInputClick(e){e.target.nextSibling.classList.toggle("codeBoxShow")}_handleSelectItemClick(e,t){e.target.parentNode.parentNode.querySelector(".codeBoxSelectInput").value=t[1],e.target.parentNode.classList.remove("codeBoxShow"),this.codeArea.removeAttribute("class"),this.data.language=t[0],this.codeArea.setAttribute("class",`codeBoxTextArea ${this.config.useDefaultTheme} ${this.data.language}`),yt.highlightElement(this.codeArea)}_closeAllLanguageSelects(){const e=document.querySelectorAll(".codeBoxSelectPreview");for(let t=0,l=e.length;t<l;t++)e[t].classList.remove("codeBoxShow")}_injectHighlightJSCSSElement(){const e=document.querySelector(`#${this.highlightCSSID}`);let t=this._getThemeURLFromConfig();if(e)e.setAttribute("href",t);else{const l=document.createElement("link"),d=document.querySelector("head");l.setAttribute("rel","stylesheet"),l.setAttribute("href",t),l.setAttribute("id",this.highlightCSSID),d&&d.appendChild(l)}}_getThemeURLFromConfig(){let e=`https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-${this.config.useDefaultTheme}.min.css`;return this.config.themeName&&(e=`https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/${this.config.themeName}.min.css`),this.config.themeURL&&(e=this.config.themeURL),e}}const xl={class:"Folder"},$l={class:"ml-4"},Sl={key:0,class:"mt-4 mb-4"},Cl={key:1},Tl=["placeholder"],Al={key:2,class:"block mt-6 space-y-6"},Dl={class:"text-sm font-medium text-ink-gray-9"},Fl={class:"mt-1 flex flex-wrap items-center gap-1 text-sm text-ink-gray-6"},Ml=["onClick"],El={key:0},Nl={class:"flex flex-wrap items-center gap-2"},Il=["placeholder"],Ll={class:"mb-2 text-sm font-semibold text-ink-gray-9"},zl={key:0,class:"text-sm text-ink-gray-5"},Pl={key:1,class:"space-y-2"},Rl=["onClick"],ql={class:"mb-2 text-sm font-semibold text-ink-gray-9"},Ul={key:0,class:"text-sm text-ink-gray-5"},Ol={key:1,class:"space-y-2"},Vl=["href"],Hl={class:"font-medium"},Bl={class:"mt-1 text-ink-gray-6"},jl={__name:"FolderPlugin",props:{onAddition:{type:Function,required:!1},initialFolder:{type:String,default:null}},setup(m){const e=is(),t=T("select"),l=T(null),d=T(""),u=T(""),p=T([]),b=T([]),h=T(null),g=T(null),x=T(""),_=T([]),R=T([]),v=T(!1),ae=T(""),y=T(null),B=()=>{var f,A;return typeof window=="undefined"?null:window.csrf_token||((f=window.frappe)==null?void 0:f.csrf_token)||((A=document.querySelector('meta[name="csrf-token"]'))==null?void 0:A.getAttribute("content"))||null},P=()=>se(null,null,function*(){const f=e.params.courseName;if(console.log("Course Name: ",f),f){const I=yield W({url:"frappe.client.get_value",makeParams(M){return{doctype:"Course Schedule",fieldname:"course",filters:{name:f}}}}).fetch();h.value=I.course,console.log("Fetched Course: ",h.value)}else return console.error("Course name not found in route params"),null}),F=m,S=()=>{if(!d.value)return;const f=d.value;typeof F.onAddition=="function"&&F.onAddition(f)},O=(I,...M)=>se(null,[I,...M],function*(f,{refreshFolders:A=!0}={}){const V=f==null?void 0:f.trim();if(!V)return;(A||!b.value.length)&&(yield U());const ge=b.value.find(be=>be.foldername===V||be.name===V);if(ge){l.value!==ge.name&&(l.value=ge.name);return}d.value=V,x.value=V,_.value=[{id:null,label:V,folderName:V}],yield ee({folderLabel:V}),_.value=[{id:g.value,label:x.value||V,folderName:d.value||V}]}),U=()=>se(null,null,function*(){if(h.value||(yield P()),!h.value)return[];const A=yield W({url:"frappe.client.get_list",makeParams(){return{doctype:"Course Folder",filters:{course:h.value},fields:["name","foldername","file_reference","parent_folder"]}}}).fetch();return b.value=A,b.value}),ne=()=>se(null,null,function*(){if(!u.value){alert(__("Folder name is required"));return}if(h.value||(yield P()),!h.value){alert(__("Please select a course before creating a folder."));return}try{const A=yield new ut({data:{},readOnly:!1}).createCourseFolder(h.value,u.value);b.value.push({name:A.name,foldername:A.foldername,file_reference:A.file_reference,parent_folder:A.parent_folder}),d.value=A.foldername,g.value=A.file_reference,x.value=A.foldername,l.value=A.name,_.value=[{id:g.value,label:x.value,folderName:A.foldername}],t.value="select",u.value="",yield ee({folderId:g.value,folderLabel:x.value})}catch(f){console.error("Error creating folder:",f),alert(f.message||__("Failed to create folder."))}}),ee=(...I)=>se(null,[...I],function*({folderId:f,folderLabel:A}={}){var ge;const M=f!=null?f:g.value,V=(ge=A!=null?A:x.value)!=null?ge:d.value;if(!M&&!V){console.warn("No folder selected for fetching files.");return}try{const me=yield W({url:"seminary.api.folder_upload.get_files_in_folder",params:{folder_id:M,foldername:V},auto:!0}).fetch(),Se=(me==null?void 0:me.entries)||[];R.value=Se.filter(xe=>xe.is_folder),p.value=Se.filter(xe=>!xe.is_folder),g.value=(me==null?void 0:me.folder_id)||M,x.value=(me==null?void 0:me.folder_name)||V,d.value=x.value}catch(be){console.error("Error fetching files:",be),R.value=[],p.value=[]}}),re=(f,A=null)=>se(null,null,function*(){var M;const I=A||((M=f==null?void 0:f.target)==null?void 0:M.files);if(!(!I||!I.length)){if(!g.value&&!x.value){alert(__("Please select a folder first."));return}try{const V=new FormData;for(const me of I)V.append("files",me);g.value&&V.append("folder_id",g.value),x.value&&V.append("foldername",x.value);const ge=B();if(!ge){alert(__("Session expired. Refresh the page and try again."));return}const be=yield fetch("/api/method/seminary.api.folder_upload.upload_folder",{method:"POST",body:V,headers:{"X-Frappe-CSRF-Token":ge},credentials:"include"});if(!be.ok){const me=yield be.json().catch(()=>({}));console.error("Error uploading files:",me),alert(`Error: ${me.message||__("Failed to upload files.")}`);return}console.log("Files uploaded successfully."),f!=null&&f.target&&(f.target.value=""),yield ee()}catch(V){console.error("Error uploading files:",V),alert(__("An error occurred while uploading files."))}finally{v.value=!1}}}),X=f=>se(null,null,function*(){const A=B();if(!A){alert(__("Session expired. Refresh the page and try again."));return}yield fetch("/api/method/seminary.api.folder_upload.delete_file",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":A},body:JSON.stringify({file_url:f}),credentials:"include"}).then(I=>I.json()),yield ee()}),he=f=>{f.preventDefault(),f.stopPropagation(),!(!g.value&&!x.value)&&(v.value=!0)},C=f=>{!g.value&&!x.value||(f.preventDefault(),f.stopPropagation(),f.dataTransfer.dropEffect="copy",v.value=!0)},L=f=>{f.preventDefault(),f.stopPropagation(),v.value=!1},Y=f=>se(null,null,function*(){var I;if(f.preventDefault(),f.stopPropagation(),!g.value&&!x.value){alert(__("Please select a folder before uploading."));return}const A=(I=f.dataTransfer)==null?void 0:I.files;A!=null&&A.length&&(yield re(null,A)),v.value=!1}),k=()=>{var f;if(!g.value&&!x.value){alert(__("Please select a folder first."));return}(f=y.value)==null||f.click()},H=f=>se(null,null,function*(){f!=null&&f.name&&(_.value=[..._.value,{id:f.name,label:f.file_name,folderName:f.file_name}],g.value=f.name,x.value=f.file_name,yield ee({folderId:f.name,folderLabel:f.file_name}))}),K=f=>se(null,null,function*(){if(f<0||f>=_.value.length)return;const A=_.value[f];_.value=_.value.slice(0,f+1),g.value=A.id,x.value=A.label,d.value=A.folderName||A.label,yield ee({folderId:A.id,folderLabel:A.folderName||A.label})}),ce=()=>se(null,null,function*(){if(!ae.value){alert(__("Sub-folder name is required."));return}if(!g.value&&!x.value){alert(__("Please select a folder first."));return}try{yield new ut({data:{},readOnly:!1}).createSubfolder({parentFolderId:g.value,parentFolderName:x.value,subfolderName:ae.value}),ae.value="",yield ee()}catch(f){console.error("Error creating sub-folder:",f),alert(f.message||__("Failed to create sub-folder."))}});ue(l,f=>se(null,null,function*(){if(f)try{const I=yield W({url:"frappe.client.get_value",makeParams(){return{doctype:"Course Folder",fieldname:["foldername","file_reference","parent_folder"],filters:{name:f}}}}).fetch();d.value=(I==null?void 0:I.foldername)||"",g.value=(I==null?void 0:I.file_reference)||null,x.value=(I==null?void 0:I.foldername)||"",_.value=[{id:g.value,label:x.value,folderName:d.value}],S(),yield ee({folderId:g.value,folderLabel:x.value})}catch(A){console.error("Error fetching foldername:",A)}else d.value="",g.value=null,x.value="",_.value=[],R.value=[],p.value=[]}));let _e=!1;return Ee(()=>se(null,null,function*(){_e=!0,yield P(),yield U(),F.initialFolder&&(yield O(F.initialFolder,{refreshFolders:!1}))})),ue(()=>F.initialFolder,(f,A)=>se(null,null,function*(){if(!_e)return;const I=f==null?void 0:f.trim(),M=A==null?void 0:A.trim();!I||I===M||(yield O(I))})),(f,A)=>(o(),i("div",xl,[s("h3",null,n(f.__("Manage Course Folders")),1),s("div",null,[s("label",null,[$e(s("input",{type:"radio","onUpdate:modelValue":A[0]||(A[0]=I=>t.value=I),value:"select"},null,512),[[bt,t.value]]),ie(" "+n(f.__("Select Existing Folder")),1)]),s("label",$l,[$e(s("input",{type:"radio","onUpdate:modelValue":A[1]||(A[1]=I=>t.value=I),value:"create"},null,512),[[bt,t.value]]),ie(" "+n(f.__("Create New Folder")),1)])]),t.value==="select"?(o(),i("div",Sl,[N(Ve,{modelValue:l.value,"onUpdate:modelValue":A[2]||(A[2]=I=>l.value=I),doctype:"Course Folder",options:"foldername",label:f.__("Select a folder")},null,8,["modelValue","label"])])):D("",!0),t.value==="create"?(o(),i("div",Cl,[$e(s("input",{type:"text","onUpdate:modelValue":A[3]||(A[3]=I=>u.value=I),placeholder:f.__("Enter folder name")},null,8,Tl),[[Ne,u.value]]),N(Ve,{modelValue:h.value,"onUpdate:modelValue":A[4]||(A[4]=I=>h.value=I),doctype:"Course",label:f.__("Select a course")},null,8,["modelValue","label"]),s("button",{onClick:ne},n(f.__("Create Folder")),1)])):D("",!0),l.value?(o(),i("div",Al,[s("div",null,[s("div",Dl,n(f.__("Current Folder")),1),s("div",Fl,[(o(!0),i(de,null,pe(_.value,(I,M)=>(o(),i(de,{key:I.id||`${I.label}-${M}`},[s("button",{type:"button",class:"rounded px-1.5 py-0.5 text-ink-gray-7 transition hover:bg-ink-gray-2 hover:text-ink-gray-9",onClick:V=>K(M)},n(I.label),9,Ml),M<_.value.length-1?(o(),i("span",El,"/")):D("",!0)],64))),128))])]),s("div",Nl,[$e(s("input",{type:"text","onUpdate:modelValue":A[5]||(A[5]=I=>ae.value=I),placeholder:f.__("New sub-folder name"),class:"flex-1 rounded border border-outline-gray-3 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none"},null,8,Il),[[Ne,ae.value]]),N(a(G),{size:"sm",onClick:ce},{default:q(()=>[ie(n(f.__("Create Sub-folder")),1)]),_:1})]),s("div",null,[s("h5",Ll,n(f.__("Sub-folders")),1),R.value.length?(o(),i("ul",Pl,[(o(!0),i(de,null,pe(R.value,I=>(o(),i("li",{key:I.name,class:"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3"},[s("button",{type:"button",class:"flex-1 text-left text-sm font-medium text-blue-600 hover:underline",onClick:M=>H(I)},n(I.file_name),9,Rl)]))),128))])):(o(),i("div",zl,n(f.__("No sub-folders yet.")),1))]),s("div",null,[s("h5",ql,n(f.__("Files")),1),p.value.length?(o(),i("ul",Ol,[(o(!0),i(de,null,pe(p.value,I=>(o(),i("li",{key:I.file_url||I.name,class:"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3"},[s("a",{href:I.file_url,download:"",class:"flex-1 truncate text-sm text-blue-600 hover:underline"},n(I.file_name),9,Vl),N(a(dt),{text:f.__("Delete File"),placement:"bottom"},{default:q(()=>[N(a(us),{onClick:Qe(M=>X(I.file_url),["prevent"]),class:"h-4 w-4 cursor-pointer text-red-500"},null,8,["onClick"])]),_:2},1032,["text"])]))),128))])):(o(),i("div",Ul,n(f.__("No files found in this folder.")),1))]),s("div",{class:Oe(["rounded-md border-2 border-dashed border-outline-gray-3 p-6 text-center text-sm transition-colors duration-200 hover:border-outline-gray-4",{"bg-blue-50 border-blue-500 text-blue-700":v.value}]),onDragenter:Qe(he,["prevent","stop"]),onDragover:Qe(C,["prevent","stop"]),onDragleave:Qe(L,["prevent","stop"]),onDrop:Qe(Y,["prevent","stop"]),onClick:k},[s("p",Hl,n(f.__("Drop files here or click to upload")),1),s("p",Bl,n(f.__("Files will be added to "))+" "+n(x.value),1),s("input",{ref_key:"fileInputRef",ref:y,type:"file",class:"hidden",multiple:"",onChange:re},null,544)],34)])):D("",!0)]))}},Gl=St(jl,[["__scopeId","data-v-3c48677e"]]),Ql={class:"flex flex-col gap-4 rounded-lg border-2 border-gray-200 p-4 mb-4"},Jl={class:"flex flex-col gap-1"},Wl={class:"text-lg font-semibold text-ink-gray-9"},Yl={key:0,class:"text-sm text-ink-gray-6 flex flex-wrap items-center gap-1"},Xl=["onClick"],Kl={key:0},Zl={key:0,class:"rounded border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},ei={key:1,class:"text-sm text-ink-gray-6"},ti={class:"space-y-2"},si={class:"text-sm font-semibold text-ink-gray-9"},ai={key:0,class:"text-sm text-ink-gray-5"},oi={key:1,class:"space-y-2"},ni=["onClick"],ri={class:"text-xs text-ink-gray-5"},li={class:"space-y-2"},ii={class:"text-sm font-semibold text-ink-gray-9"},ui={key:0,class:"text-sm text-ink-gray-5"},di={key:1,class:"space-y-2"},ci=["href"],mi={class:"text-xs text-ink-gray-5"},pi={__name:"FolderBlock",props:{folder:{type:[Object,String],required:!0}},setup(m){const e=m,t=oe(()=>typeof e.folder=="string"?e.folder:e.folder&&typeof e.folder=="object"&&(e.folder.folder||e.folder.foldername)||""),l=T(!1),d=T(""),u=T([]),p=T([]),b=T(null),h=T(""),g=T([]);let x=!1;const _=P=>{if(!P&&P!==0)return"";const F=Number(P);return Number.isNaN(F)?"":F>=1048576?`${(F/1048576).toFixed(2)} MB`:F>=1024?`${(F/1024).toFixed(2)} KB`:`${F} B`},R=({folderId:P=null,folderLabel:F=null})=>{const S={};P&&(S.folder_id=P);const O=F!=null?F:t.value;return!P&&O&&(S.foldername=O),S},v=(...S)=>se(null,[...S],function*({folderId:P=null,folderLabel:F=null}={}){const O=R({folderId:P,folderLabel:F});if(!O.folder_id&&!O.foldername)return null;l.value=!0,d.value="";try{const ne=yield W({url:"seminary.api.folder_upload.get_files_in_folder",params:O,auto:!0}).fetch(),ee=(ne==null?void 0:ne.entries)||[];return p.value=ee.filter(re=>re.is_folder),u.value=ee.filter(re=>!re.is_folder),b.value=(ne==null?void 0:ne.folder_id)||P||null,h.value=(ne==null?void 0:ne.folder_name)||F||t.value||"",{id:b.value,label:h.value}}catch(U){return console.error("Error fetching folder contents:",U),d.value=(U==null?void 0:U.message)||__("Unable to load folder contents."),p.value=[],u.value=[],null}finally{l.value=!1}}),ae=()=>se(null,null,function*(){const P=yield v({folderLabel:t.value});P&&(g.value=[P])}),y=P=>se(null,null,function*(){if(!(P!=null&&P.name))return;const F=yield v({folderId:P.name,folderLabel:P.file_name});F&&(g.value=[...g.value,F])}),B=P=>se(null,null,function*(){if(P<0||P>=g.value.length)return;const F=g.value[P],S=yield v({folderId:F.id,folderLabel:F.label});S&&(g.value=[...g.value.slice(0,P),S])});return Ee(()=>se(null,null,function*(){x=!0,yield ae()})),ue(()=>t.value,(P,F)=>se(null,null,function*(){if(!x)return;const S=(P||"").trim(),O=(F||"").trim();!S||S===O||(yield ae())})),(P,F)=>(o(),i("div",Ql,[s("div",Jl,[s("h4",Wl,n(h.value||t.value),1),g.value.length?(o(),i("div",Yl,[(o(!0),i(de,null,pe(g.value,(S,O)=>(o(),i(de,{key:S.id||`${S.label}-${O}`},[s("button",{type:"button",class:Oe(["rounded px-1.5 py-0.5 transition hover:bg-ink-gray-2 hover:text-ink-gray-9",O===g.value.length-1?"font-medium text-ink-gray-8 cursor-default":"text-ink-gray-7"]),onClick:U=>O===g.value.length-1?null:B(O)},n(S.label),11,Xl),O<g.value.length-1?(o(),i("span",Kl,"/")):D("",!0)],64))),128))])):D("",!0)]),d.value?(o(),i("div",Zl,n(d.value),1)):l.value?(o(),i("div",ei,n(P.__("Loading folder contents")),1)):(o(),i(de,{key:2},[s("section",ti,[s("h5",si,n(P.__("Sub-folders")),1),p.value.length?(o(),i("ul",oi,[(o(!0),i(de,null,pe(p.value,S=>(o(),i("li",{key:S.name,class:"flex items-center justify-between rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3"},[s("button",{type:"button",class:"text-left text-sm font-medium text-blue-600 hover:underline",onClick:O=>y(S)},n(S.file_name),9,ni),s("span",ri,n(P.__("Folder")),1)]))),128))])):(o(),i("div",ai,n(P.__("No sub-folders in this location.")),1))]),s("section",li,[s("h5",ii,n(P.__("Files")),1),u.value.length?(o(),i("ul",di,[(o(!0),i(de,null,pe(u.value,S=>(o(),i("li",{key:S.file_url||S.name,class:"flex items-center gap-3 rounded border border-outline-gray-2 px-3 py-2 transition hover:border-outline-gray-3"},[s("a",{href:S.file_url,download:"",class:"flex-1 truncate text-sm text-blue-600 hover:underline"},n(S.file_name),9,ci),s("span",mi,n(_(S.file_size)),1)]))),128))])):(o(),i("div",ui,n(P.__("No files available in this folder.")),1))])],64))]))}},xt=()=>{var m,e;return typeof window=="undefined"?null:window.csrf_token||((m=window.frappe)==null?void 0:m.csrf_token)||((e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"))||null};class ut{constructor({data:e,api:t,readOnly:l}){this.data=e,this.readOnly=l,this.api=t,this.wrapper=void 0,this.vueApp=null}static get toolbox(){const e=fe({render:()=>Re(ds,{size:18,strokeWidth:1.5,color:"black"})}),t=document.createElement("div");return e.mount(t),{title:"Folder",icon:t.innerHTML}}static get isReadOnlySupported(){return!0}render(){return this.wrapper=document.createElement("div"),this.data&&this.data.folder?this.renderFolder(this.data.folder):this.renderFolderModal(),this.wrapper}destroyApp(){this.vueApp&&(this.vueApp.unmount(),this.vueApp=null),this.wrapper&&(this.wrapper.innerHTML="")}renderFolder(e){if(this.readOnly){this.destroyApp(),this.vueApp=fe(pi,{folder:e}),this.vueApp.use(De),this.vueApp.use(Me),this.vueApp.mount(this.wrapper);return}this.renderFolderModal(e)}renderFolderModal(e=null){this.readOnly||(this.destroyApp(),this.vueApp=fe(Gl,{initialFolder:e,onAddition:t=>{this.data||(this.data={}),this.data.folder=t}}),this.vueApp.use(De),this.vueApp.use(Me),this.vueApp.mount(this.wrapper))}save(e){var t;return{folder:(t=this.data)==null?void 0:t.folder}}destroy(){this.destroyApp()}createCourseFolder(e,t){return se(this,null,function*(){const l=t==null?void 0:t.trim();if(!l)throw new Error("Folder name is required to create a course folder");if(!e)throw new Error("Course is required to create a course folder");const d=xt();if(!d)throw new Error("CSRF token not found. Please refresh the page and try again.");let u;const p=yield fetch("/api/resource/Course Folder",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Frappe-CSRF-Token":d},credentials:"include",body:JSON.stringify({course:e,foldername:l})});try{u=yield p.json()}catch(h){u=null}if(!p.ok){const h=(u==null?void 0:u.message)||(u==null?void 0:u.exc)||p.statusText;throw new Error(h||"Failed to create course folder")}const b=(u==null?void 0:u.data)||u;return this.data||(this.data={}),this.data.folder=(b==null?void 0:b.foldername)||l,b})}createSubfolder(d){return se(this,arguments,function*({parentFolderId:e,parentFolderName:t,subfolderName:l}){const u=l==null?void 0:l.trim();if(!u)throw new Error("Sub-folder name is required");if(!e&&!t)throw new Error("Parent folder information is required to create a sub-folder");const p=xt();if(!p)throw new Error("CSRF token not found. Please refresh the page and try again.");let b;const h=yield fetch("/api/method/seminary.api.folder_upload.create_subfolder",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Frappe-CSRF-Token":p},credentials:"include",body:JSON.stringify({parent_folder_id:e,parent_foldername:t,subfoldername:u})});try{b=yield h.json()}catch(g){b=null}if(!h.ok){const g=(b==null?void 0:b.message)||(b==null?void 0:b.exc)||h.statusText;throw new Error(g||"Failed to create sub-folder")}return(b==null?void 0:b.message)||(b==null?void 0:b.data)||b})}}function fi(m){ke(qe({position:"bottom-right"},m))}function st(m){return gs(m).value}function bi(m){return m>999?(m/1e3).toFixed(1)+"k":m}function Ke(m){let e=parseInt(m);return e>1048576?(e/1048576).toFixed(2)+"M":e>1024?(e/1024).toFixed(2)+"K":e}function ki(m){ue(()=>m,e=>{if(e.value.title){if(e.value.title&&e.value.subtitle){document.title=`${e.value.title} | ${e.value.subtitle}`;return}if(e.value.title){document.title=`${e.value.title}`;return}}},{immediate:!0,deep:!0})}function wi(){return{header:{class:vs,config:{placeholder:"Header"}},assignment:fo,quiz:Ea,exam:qn,discussionActivity:nl,upload:gl,markdown:{class:yl,inlineToolbar:!0},image:hs,table:{class:_s,inlineToolbar:!0},paragraph:{class:fs,inlineToolbar:!0,config:{preserveBlank:!0}},codeBox:{class:wl,config:{themeURL:"https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/styles/atom-one-dark.min.css",themeName:"atom-one-dark",useDefaultTheme:"dark"}},list:{class:ps,inlineToolbar:!0,config:{defaultStyle:"ordered"}},inlineCode:{class:ms,shortcut:"CMD+SHIFT+M"},embed:{class:cs,inlineToolbar:!0,config:{services:{youtube:{regex:/(?:https?:\/\/)?(?:www\.)?(?:(?:youtu\.be\/)|(?:youtube\.com)\/(?:v\/|u\/\w\/|embed\/|watch))(?:(?:\?v=)?([^#&?=]*))?((?:[?&]\w*=\w*)*)/,embedUrl:"https://www.youtube.com/embed/<%= remote_id %>",html:'<iframe style="width:100%; height: 30rem;" frameborder="0" allowfullscreen></iframe>',height:320,width:580,id:([m,e])=>{if(!e&&m)return m;const t={start:"start",end:"end",t:"start",time_continue:"start",list:"list"};let l=e.slice(1).split("&").map(d=>{const[u,p]=d.split("=");return!m&&u==="v"?(m=p,null):!t[u]||p==="LL"||p.startsWith("RDMM")||p.startsWith("FL")?null:`${t[u]}=${p}`}).filter(d=>!!d);return m+"?"+l.join("&")}},vimeo:!0,codepen:!0,aparat:{regex:/(?:http[s]?:\/\/)?(?:www.)?aparat\.com\/v\/([^\/\?\&]+)\/?/,embedUrl:"https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame",html:'<iframe style="margin: 0 auto; width: 100%; height: 25rem;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:300,width:600},github:!0,slides:{regex:/https:\/\/docs\.google\.com\/presentation\/d\/([A-Za-z0-9_-]+)\/pub/,embedUrl:"https://docs.google.com/presentation/d/<%= remote_id %>/embed",html:"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0' frameborder='0' allowfullscreen='true'></iframe>"},drive:{regex:/https:\/\/drive\.google\.com\/file\/d\/([A-Za-z0-9_-]+)\/view(\?.+)?/,embedUrl:"https://drive.google.com/file/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 25rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},docsPublic:{regex:/https:\/\/docs\.google\.com\/document\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/document/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},sheetsPublic:{regex:/https:\/\/docs\.google\.com\/spreadsheets\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/spreadsheets/d/<%= remote_id %>/preview",html:"<iframe style='width: 100%; height: 40rem; border: 1px solid #D3D3D3; border-radius: 12px;' frameborder='0' allowfullscreen='true'></iframe>"},slidesPublic:{regex:/https:\/\/docs\.google\.com\/presentation\/d\/([A-Za-z0-9_-]+)\/edit(\?.+)?/,embedUrl:"https://docs.google.com/presentation/d/<%= remote_id %>/embed",html:"<iframe style='width: 100%; height: 30rem; border: 1px solid #D3D3D3; border-radius: 12px; margin: 1rem 0;' frameborder='0' allowfullscreen='true'></iframe>"},codesandbox:{regex:/^https:\/\/codesandbox\.io\/(?:embed\/)?([A-Za-z0-9_-]+)(?:\?[^\/]*)?$/,embedUrl:"https://codesandbox.io/embed/<%= remote_id %>?view=editor+%2B+preview&module=%2Findex.html",html:"<iframe style='width: 100%; height: 500px; border: 0; border-radius: 4px; overflow: hidden;' sandbox='allow-mods allow-forms allow-popups allow-scripts allow-same-origin' frameborder='0' allowfullscreen='true'></iframe>"}}}},folder:{class:ut,config:{placeholder:"Add a folder with files",uploadEndpoint:"/api/upload-folder",renderFiles:m=>m.map(e=>`<a href="${e.url}" download>${e.name}</a>`).join("<br>")}}}}function Pt(m){const e={ves:"fe",ies:"y",i:"us",zes:"ze",ses:"s",es:"e",s:""};return m.replace(new RegExp(`(${Object.keys(e).join("|")})$`),t=>e[t])}export{Sa as _,Rn as a,ol as b,pi as c,dn as d,Lt as e,bi as f,wi as g,Ke as h,xa as i,co as j,zn as k,st as t,ki as u};
//# sourceMappingURL=index-CedffXRa.js.map
